import{i as wh,B as Oa,F as j_,A as PE,a as co,C as yE,P as Y,R as fe,S as Nt,T as Dt,b as LE,c as ze,s as Aa,d as ou,M as ue,e as _u,f as Ss,G as go,g as UE,h as vE,E as bE,j as FE,I as xE,k as GE,l as BE,m as wE,p as HE,n as VE,o as Eo,q as jE,r as YE,t as Vi}from"./vendor-367c1fc6.js";class G{static log(...t){this.LOG_DEBUG&&console.log(this.logPrefix(),...t)}static warn(...t){this.LOG_WARN&&console.warn(this.logPrefix(),...t)}static error(...t){this.LOG_ERROR&&console.error(this.logPrefix(),...t)}static events(...t){this.LOG_EVENTS&&console.log(this.logPrefix(),...t)}static packets(...t){this.LOG_PACKETS&&console.log(this.logPrefix(),...t)}static logPrefix(){return"[Nitro]"}}G.LOG_DEBUG=!1;G.LOG_WARN=!1;G.LOG_ERROR=!1;G.LOG_EVENTS=!1;G.LOG_PACKETS=!1;class Gt{constructor(t=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],t)for(const[s,i]of t.entries())this.add(s,i)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,s){return this._dictionary.get(t)!==null?!1:(this._dictionary.set(t,s),this._array.unshift(s),this._keys.unshift(t),this._length++,!0)}add(t,s){return this._dictionary.get(t)!==void 0?!1:(this._dictionary.set(t,s),this._array[this._length]=s,this._keys[this._length]=t,this._length++,!0)}remove(t){const s=this._dictionary.get(t);if(!s)return null;const i=this._array.indexOf(s);return i>=0&&(this._array.splice(i,1),this._keys.splice(i,1),this._length--),this._dictionary.delete(t),s}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const s of t._keys)this.add(s,t.getValue(s))}clone(){const t=new Gt;return t.concatenate(this),t}}const hu=e=>{let t="";const s=new Uint8Array(e),i=s.byteLength;for(let r=0;r<i;r++)t+=String.fromCharCode(s[r]);return window.btoa(t)};class Sa{constructor(t){this._position=0,this._dataView=new DataView(t)}readBytes(t){const s=new Sa(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,s}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}readFloat(){const t=this._dataView.getFloat32(this._position);return this._position+=4,t}readDouble(){const t=this._dataView.getFloat64(this._position);return this._position+=8,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class Hh{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(t){const s=new Uint8Array(1);return s[0]=t,this.appendArray(s),this}writeBytes(t){const s=new Uint8Array(t);return this.appendArray(s),this}writeShort(t){const s=new Uint8Array(2);return s[0]=t>>8,s[1]=t&255,this.appendArray(s),this}writeInt(t){const s=new Uint8Array(4);return s[0]=t>>24,s[1]=t>>16,s[2]=t>>8,s[3]=t&255,this.appendArray(s),this}writeString(t,s=!0){const i=new TextEncoder().encode(t);return s?(this.writeShort(i.length),this.appendArray(i)):this.appendArray(i),this}appendArray(t){if(!t)return;const s=new Uint8Array(this.position+t.length>this._buffer.length?this.position+t.length:this._buffer.length);s.set(this._buffer),s.set(t,this.position),this._buffer=s,this.position+=t.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(t){this._position=t}toString(t){return new TextDecoder(t).decode(this._buffer)}}const uu=class{constructor(e){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(e)}parse(e){const t=new Sa(e);let s=t.readShort();for(;s>0;){const i=t.readShort(),r=t.readBytes(i).toString(),n=t.readInt(),a=t.readBytes(n);if(r.endsWith(".json")){const o=wh(a.toArrayBuffer());this._jsonFile=JSON.parse(uu.TEXT_DECODER.decode(o))}else{const o=wh(a.toArrayBuffer()),u=hu(o);this._baseTexture=new Oa("data:image/png;base64,"+u)}s--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}};let Y_=uu;Y_.TEXT_DECODER=new TextDecoder("utf-8");class zE extends j_{constructor(t){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;
            
            uniform mat3 projectionMatrix;
            
            varying vec2 vTextureCoord;
            
            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;
            
            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;
            
            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);
            
                if (c.a > 0.0) {
                    c.rgb /= c.a;
            
                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;
            
                    c.rgb *= c.a;
                }
            
                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,t)}apply(t,s,i,r){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,s,i,r)}}const WE=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,kE=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`;class Ma extends j_{constructor(t,s,i){super(WE,kE,{mask:t.castToBaseTexture(),fromChannel:s,toChannel:i})}}Ma.CHANNEL_RED=0;Ma.CHANNEL_GREEN=1;Ma.CHANNEL_BLUE=2;Ma.CHANNEL_ALPHA=3;const fo=class extends PE{constructor(e){super(e),fo.INSTANCE||(fo.INSTANCE=this)}static get instance(){return this.INSTANCE||null}};let Yt=fo;Yt.INSTANCE=null;const Os=()=>{var e;return((e=Yt.instance)==null?void 0:e.ticker)||null},KE=()=>{var e;return((e=Os())==null?void 0:e.FPS)||0},Z=()=>{var e;return((e=Os())==null?void 0:e.lastTime)||0};class Rw extends co{}class XE extends Oa{}class je extends yE{}class qE extends j_{}class $n extends Y{}class Tw extends fe{}class Pt extends Nt{}class lu extends Dt{}class pw extends LE{}const QE=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,JE=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`,ji=class extends qE{constructor(e,t=ji.CHANNEL_RED){super(QE,JE),this._channel=t;let s=[];s=this.getLutForPalette(e),this._lut=XE.fromBuffer(Uint8Array.from(s),s.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(e){const t=[];for(let s=0;s<e.length;s++)t[s*4+ji.CHANNEL_RED]=e[s]>>16&255,t[s*4+ji.CHANNEL_GREEN]=e[s]>>8&255,t[s*4+ji.CHANNEL_BLUE]=e[s]&255,t[s*4+ji.CHANNEL_ALPHA]=e[s]>>24&255;return t}get lut(){return this._lut}get channel(){return this._channel}};let hr=ji;hr.CHANNEL_RED=0;hr.CHANNEL_GREEN=1;hr.CHANNEL_BLUE=2;hr.CHANNEL_ALPHA=3;const cu=class{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(e=>e==null?void 0:e.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(e){return e?this.writeToRenderTexture(new Nt(Dt.EMPTY),e):null}getTextureIdentifier(e,t,s){return`${s??cu.DEFAULT_PLANE_ID}:${e}:${t}`}createRenderTexture(e,t,s=null){if(e<0||t<0)return null;if(!s){const r=ze.create({width:e,height:t});return this.RENDER_TEXTURE_CACHE.push(r),r}s=this.getTextureIdentifier(e,t,s);let i=this.RENDER_TEXTURE_POOL.get(s);return i||(i=ze.create({width:e,height:t}),this.RENDER_TEXTURE_CACHE.push(i),this.RENDER_TEXTURE_POOL.set(s,i)),i}createAndFillRenderTexture(e,t,s=null,i=16777215){if(e<0||t<0)return null;const r=this.createRenderTexture(e,t,s);return this.clearAndFillRenderTexture(r,i)}createAndWriteRenderTexture(e,t,s,i=null,r=null){if(e<0||t<0)return null;const n=this.createRenderTexture(e,t,i);return this.writeToRenderTexture(s,n,!0,r)}clearAndFillRenderTexture(e,t=16777215){if(!e)return null;const s=new Nt(Dt.WHITE);return s.tint=t,s.width=e.width,s.height=e.height,this.writeToRenderTexture(s,e)}writeToRenderTexture(e,t,s=!0,i=null){return!e||!t?null:(this.getRenderer().render(e,{renderTexture:t,clear:s,transform:i}),t)}getPixels(e,t=null){return this.getExtractor().pixels(e)}getRenderer(){return Yt.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}};let du=cu;du.DEFAULT_PLANE_ID="DEFAULT";class Ot{static generateTexture(t,s=null,i=null,r=1){return t?(i===null&&(i=Aa.SCALE_MODE),this.getRenderer().generateTexture(t,{scaleMode:i,resolution:r,region:s})):null}static generateTextureFromImage(t){return t?Dt.from(t):null}static generateImage(t){return t?this.getExtractor().image(t):null}static generateImageUrl(t){return t?this.getExtractor().base64(t):null}static generateCanvas(t){return t?this.getExtractor().canvas(t):null}static clearRenderTexture(t){return t?this.writeToRenderTexture(new Nt(Dt.EMPTY),t):null}static createRenderTexture(t,s){return t<0||s<0?null:ze.create({width:t,height:s})}static createAndFillRenderTexture(t,s,i=16777215){if(t<0||s<0)return null;const r=this.createRenderTexture(t,s);return this.clearAndFillRenderTexture(r,i)}static createAndWriteRenderTexture(t,s,i,r=null){if(t<0||s<0)return null;const n=this.createRenderTexture(t,s);return this.writeToRenderTexture(i,n,!0,r)}static clearAndFillRenderTexture(t,s=16777215){if(!t)return null;const i=new Nt(Dt.WHITE);return i.tint=s,i.width=t.width,i.height=t.height,this.writeToRenderTexture(i,t)}static writeToRenderTexture(t,s,i=!0,r=null){return!t||!s?null:(this.getRenderer().render(t,{renderTexture:s,clear:i,transform:r}),s)}static getPixels(t,s=null){return this.getExtractor().pixels(t)}static getRenderer(){return Yt.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}const yr=class{static createAsset(e,t,s,i,r,n=!1,a=!1,o=!1){const u=yr.GRAPHIC_POOL.length?yr.GRAPHIC_POOL.pop():new yr;return u._name=e,u._source=t||null,s?(u._texture=s,u._initialized=!1):(u._texture=null,u._initialized=!0),u._usesPalette=o,u._x=i,u._y=r,u._flipH=n,u._flipV=a,u._rectangle=null,u}recycle(){this._texture=null,yr.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return Ot.generateImageUrl(new Nt(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new fe(0,0,this.width,this.height)),this._rectangle}};let gu=yr;gu.GRAPHIC_POOL=[];class ZE{constructor(t,s,i){for(this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=s,this._secondaryColor=i}dispose(){}applyPalette(t){var a,o;const s=Ot.createAndWriteRenderTexture(t.width,t.height,new Nt(t)),i=Ot.getPixels(s);for(let u=0;u<i.length;u+=4){let l=this._palette[i[u+1]];l===void 0&&(l=[0,0,0]),i[u]=l[0],i[u+1]=l[1],i[u+2]=l[2]}const r=(a=s.baseTexture._glTextures[1])==null?void 0:a.texture,n=(o=Yt.instance.renderer)==null?void 0:o.gl;return n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,s.width,s.height,0,n.RGBA,n.UNSIGNED_BYTE,i),n.bindTexture(n.TEXTURE_2D,null),s}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const mo=class{constructor(e,t){if(!e)throw new Error("invalid_collection");this._name=e.name,this._baseTexture=t&&t.baseTexture||null,this._data=e,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],t&&this.addLibraryAsset(t.textures),this.define(e)}static removeFileExtension(e){return e.substring(0,e.lastIndexOf("."))||e}dispose(){if(this._palettes){for(const e of this._palettes.values())e.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const e of this._assets.values())e.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=Z()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=Z(),this.disposePaletteAssets(!1))}define(e){const t=e.assets,s=e.palettes;t&&this.defineAssets(t),s&&this.definePalettes(s)}defineAssets(e){if(e)for(const t in e){const s=e[t];if(!s)continue;const i=-s.x||0,r=-s.y||0;let n=!1;const a=!1,o=s.usesPalette||!1;let u=s.source||"";s.flipH&&u.length&&(n=!0),u.length||(u=t);const l=this.getLibraryAsset(u);if(!l)continue;let c=this.createAsset(t,u,l,n,a,i,r,o);if(!c){const g=this.getAsset(t);g&&g.name!==g.source&&(c=this.replaceAsset(t,u,l,n,a,i,r,o))}}}definePalettes(e){if(e)for(const t in e){const s=e[t];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let r=16777215,n=16777215,a=s.color1;a&&a.length>0&&(r=parseInt(a,16)),a=s.color2,a&&a.length>0&&(n=parseInt(a,16)),this._palettes.set(i,new ZE(s.rgb,r,n))}}createAsset(e,t,s,i,r,n,a,o){if(this._assets.get(e))return!1;const u=gu.createAsset(e,t,s,n,a,i,r,o);return this._assets.set(e,u),!0}replaceAsset(e,t,s,i,r,n,a,o){const u=this._assets.get(e);return u&&(this._assets.delete(e),u.recycle()),this.createAsset(e,t,s,i,r,n,a,o)}getAsset(e){if(!e)return null;const t=this._assets.get(e);return t||null}getAssetWithPalette(e,t){const s=e+"@"+t;let i=this.getAsset(s);if(!i){if(i=this.getAsset(e),!i||!i.usesPalette)return i;const r=this.getPalette(t);if(r){const n=r.applyPalette(i.texture);n&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+t,n,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getTexture(e){return this._textures.get(e)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(e){const t=this.getPalette(e);return t?[t.primaryColor,t.secondaryColor]:null}getPalette(e){if(!e)return null;const t=this._palettes.get(e);return t||null}addAsset(e,t,s,i=0,r=0,n=!1,a=!1){if(!e||!t)return!1;const o=this.getLibraryAsset(e);return o?s?(o.baseTexture=t.baseTexture,o.frame=t.frame,o.trim=t.trim,o.updateUvs(),!0):!1:(this._textures.set(e,t),this.createAsset(e,e,t,n,a,i,r,!1))}disposeAsset(e){const t=this._assets.get(e);if(!t)return;this._assets.delete(e);const s=this.getLibraryAsset(t.source);s&&(this._textures.delete(t.source),s.destroy(!0)),t.recycle()}getLibraryAsset(e){if(!e)return null;e=this._name+"_"+e;const t=this._textures.get(e);return t||null}addLibraryAsset(e){if(e)for(const t in e){const s=e[t];s&&this._textures.set(mo.removeFileExtension(t),s)}}disposePaletteAssets(e=!0){if(this._paletteAssetNames&&(e||this._paletteAssetNames.length>mo.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const t of this._paletteAssetNames)this.disposeAsset(t);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};let z_=mo;z_.PALETTE_ASSET_DISPOSE_THRESHOLD=10;const Eu=class{constructor(){this._textures=new Map,this._collections=new Map}getTexture(e){if(!e)return null;const t=this._textures.get(e);return t||null}setTexture(e,t){!e||!t||this._textures.set(e,t)}getAsset(e){if(!e)return null;for(const t of this._collections.values()){if(!t)continue;const s=t.getAsset(e);if(s)return s}return null}getCollection(e){if(!e)return null;const t=this._collections.get(e);return t||null}createCollection(e,t){if(!e)return null;const s=new z_(e,t);if(s){for(const[i,r]of s.textures.entries())this.setTexture(i,r);this._collections.set(s.name,s)}return s}async downloadAsset(e){return await this.downloadAssets([e])}async downloadAssets(e){if(!e||!e.length)return Promise.resolve(!0);try{for(const t of e){const s=await fetch(t);if(s.status!==200)continue;let i="application/octet-stream";switch(s.headers.has("Content-Type")&&(i=s.headers.get("Content-Type")),i){case"application/octet-stream":{const r=await s.arrayBuffer(),n=new Y_(r);await this.processAsset(n.baseTexture,n.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const r=await s.arrayBuffer(),n=hu(r),a=Oa.from(`data:${i};base64,${n}`),o=async()=>{const u=new Dt(a);this.setTexture(t,u)};a.valid?await o():await new Promise((u,l)=>{a.once("update",async()=>(await o(),u()))});break}}}return Promise.resolve(!0)}catch(t){return G.error(t),Promise.resolve(!1)}}async processAsset(e,t){const s=t.spritesheet;if(!e||!s||!Object.keys(s).length){this.createCollection(t,null);return}const i=async()=>{const r=new ou(e,s);await r.parse(),this.createCollection(t,r)};e.valid?await i():await new Promise((r,n)=>{e.once("update",async()=>(await i(),r()))})}get collections(){return this._collections}};let fu=Eu;fu._INSTANCE=new Eu;const Pe=()=>fu._INSTANCE;class $E{constructor(t,s,i){this.name=t,this.textures=s,this.durations=i}}class W_{}W_.UNKNOWN=0;W_.BROWSER=1;class Ca{}Ca.UNKNOWN=0;Ca.FLASH=1;Ca.HTML5=2;class De{}De.CONNECTION_OPENED="open";De.CONNECTION_CLOSED="close";De.CONNECTION_ERROR="error";De.CONNECTION_MESSAGE="message";class W{static parseConfiguration(t,s=!1){if(!t)return!1;try{const i=new RegExp(/\${(.*?)}/g);for(const r in t){let n=t[r];typeof n=="string"&&(n=this.interpolate(n,i)),this._definitions.has(r)?s&&this.setValue(r,n):this.setValue(r,n)}return!0}catch(i){return G.error(i.stack),!1}}static interpolate(t,s=null){s||(s=new RegExp(/\${(.*?)}/g));const i=t.match(s);if(i&&i.length)for(const r of i){const n=this._definitions.get(this.removeInterpolateKey(r));n&&(t=t.replace(r,n))}return t}static removeInterpolateKey(t){return t.replace("${","").replace("}","")}static getValue(t,s=null){let i=this._definitions.get(t);if(i===void 0){if(this._missingKeys.indexOf(t)>=0)return s;this._missingKeys.push(t),G.warn(`Missing configuration key: ${t}`),i=s}return i}static setValue(t,s){const i=t.split(".");let r=this._config;for(let n=0;n<i.length;n++){const a=i[n].toString();if(n!==i.length-1){r[a]||(r[a]={}),r=r[a];continue}r[a]=s}this._definitions.set(t,s)}static get definitions(){return this._definitions}}W._definitions=new Map;W._config={};W._missingKeys=[];const St=class{static getExpressionTimeout(e){switch(e=parseInt(e),e){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(e){return St.EXPRESSION_MAP.indexOf(e)}static getExpression(e){return e>St.EXPRESSION_MAP.length?null:St.EXPRESSION_MAP[e]}static getGestureId(e){return St.GESTURE_MAP.indexOf(e)}static getGesture(e){return e>St.GESTURE_MAP.length?null:St.GESTURE_MAP[e]}static idToAvatarActionState(e){return e==="Lay"?"lay":e==="Float"?"float":e==="Swim"?"swim":e==="Sit"?"sit":e==="Respect"?"respect":e==="Wave"?"wave":e==="Idle"?"idle":e==="Dance"?"dance":e==="UseItem"?"usei":e==="CarryItem"?"cri":e==="Talk"?"talk":e==="Sleep"?"Sleep":e==="Move"?"mv":"std"}};let P=St;P.CARRY_OBJECT="cri";P.DANCE="dance";P.EFFECT="fx";P.EXPRESSION="expression";P.EXPRESSION_BLOW_A_KISS="blow";P.EXPRESSION_CRY="cry";P.EXPRESSION_IDLE="idle";P.EXPRESSION_LAUGH="laugh";P.EXPRESSION_RESPECT="respect";P.EXPRESSION_RIDE_JUMP="ridejump";P.EXPRESSION_SNOWBOARD_OLLIE="sbollie";P.EXPRESSION_SNOWBORD_360="sb360";P.EXPRESSION_WAVE="wave";P.GESTURE="gest";P.GESTURE_AGGRAVATED="agr";P.GESTURE_SAD="sad";P.GESTURE_SMILE="sml";P.GESTURE_SURPRISED="srp";P.GUIDE_STATUS="guide";P.MUTED="muted";P.PET_GESTURE_BLINK="eyb";P.PET_GESTURE_CRAZY="crz";P.PET_GESTURE_JOY="joy";P.PET_GESTURE_MISERABLE="mis";P.PET_GESTURE_PUZZLED="puz";P.PET_GESTURE_TONGUE="tng";P.PLAYING_GAME="playing_game";P.POSTURE="posture";P.POSTURE_FLOAT="float";P.POSTURE_LAY="lay";P.POSTURE_SIT="sit";P.POSTURE_STAND="std";P.POSTURE_SWIM="swim";P.POSTURE_WALK="mv";P.SIGN="sign";P.SLEEP="sleep";P.SNOWWAR_DIE_BACK="swdieback";P.SNOWWAR_DIE_FRONT="swdiefront";P.SNOWWAR_PICK="swpick";P.SNOWWAR_RUN="swrun";P.SNOWWAR_THROW="swthrow";P.TALK="talk";P.BLINK="blink";P.TYPING="typing";P.USE_OBJECT="usei";P.VOTE="vote";P.GESTURE_MAP=["",St.GESTURE_SMILE,St.GESTURE_AGGRAVATED,St.GESTURE_SURPRISED,St.GESTURE_SAD,St.PET_GESTURE_JOY,St.PET_GESTURE_CRAZY,St.PET_GESTURE_TONGUE,St.PET_GESTURE_BLINK,St.PET_GESTURE_MISERABLE,St.PET_GESTURE_PUZZLED];P.EXPRESSION_MAP=["",St.EXPRESSION_WAVE,St.EXPRESSION_BLOW_A_KISS,St.EXPRESSION_LAUGH,St.EXPRESSION_CRY,St.EXPRESSION_IDLE,St.DANCE,St.EXPRESSION_RESPECT,St.EXPRESSION_SNOWBOARD_OLLIE,St.EXPRESSION_SNOWBORD_360,St.EXPRESSION_RIDE_JUMP];class es{}es.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0];es.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1];es.MIN_DIRECTION=0;es.MAX_DIRECTION=7;class vi{}vi.GENERIC="hd";vi.HEAD="head";vi.TORSO="torso";vi.LEGS="legs";vi.HOTLOOKS="hotlooks";vi.WARDROBE="wardrobe";vi.EFFECTS="effects";const ce=class{};let _t=ce;_t.BODY="bd";_t.SHOES="sh";_t.LEGS="lg";_t.CHEST="ch";_t.WAIST_ACCESSORY="wa";_t.CHEST_ACCESSORY="ca";_t.HEAD="hd";_t.HAIR="hr";_t.FACE_ACCESSORY="fa";_t.EYE_ACCESSORY="ea";_t.HEAD_ACCESSORY="ha";_t.HEAD_ACCESSORY_EXTRA="he";_t.COAT_CHEST="cc";_t.CHEST_PRINT="cp";_t.LEFT_HAND_ITEM="li";_t.LEFT_HAND="lh";_t.LEFT_SLEEVE="ls";_t.RIGHT_HAND="rh";_t.RIGHT_SLEEVE="rs";_t.FACE="fc";_t.EYES="ey";_t.HAIR_BIG="hrb";_t.RIGHT_HAND_ITEM="ri";_t.LEFT_COAT_SLEEVE="lc";_t.RIGHT_COAT_SLEEVE="rc";_t.FIGURE_SETS=[ce.SHOES,ce.LEGS,ce.CHEST,ce.WAIST_ACCESSORY,ce.CHEST_ACCESSORY,ce.HEAD,ce.HAIR,ce.FACE_ACCESSORY,ce.EYE_ACCESSORY,ce.HEAD_ACCESSORY,ce.HEAD_ACCESSORY_EXTRA,ce.COAT_CHEST,ce.CHEST_PRINT];class He{}He.NONE=0;He.GUIDE=1;He.REQUESTER=2;class ss{}ss.LARGE="h";ss.SMALL="sh";class ee{}ee.FULL="full";ee.HEAD="head";ee.BODY="body";class Ve{}Ve.VERTICAL="vertical";Ve.SITTING="sitting";Ve.HORIZONTAL="horizontal";Ve.SWIM="swim";Ve.SNOWWARS_HORIZONTAL="swhorizontal";class ht{}ht.DOG=0;ht.CAT=1;ht.CROCODILE=2;ht.TERRIER=3;ht.BEAR=4;ht.PIG=5;ht.LION=6;ht.RHINO=7;ht.SPIDER=8;ht.TURTLE=9;ht.CHICKEN=10;ht.FROG=11;ht.DRAGON=12;ht.MONSTER=13;ht.MONKEY=14;ht.HORSE=15;ht.MONSTERPLANT=16;ht.BUNNY=17;ht.BUNNYEVIL=18;ht.BUNNYDEPRESSED=19;ht.BUNNYLOVE=20;ht.PIGEONGOOD=21;ht.PIGEONEVIL=22;ht.DEMONMONKEY=23;ht.BABYBEAR=24;ht.BABYTERRIER=25;ht.GNOME=26;ht.LEPRECHAUN=27;ht.KITTENBABY=28;ht.PUPPYBABY=29;ht.PIGLETNBABY=30;ht.HALOOMPA=31;ht.FOOLS=32;ht.PTEROSAUR=33;ht.VELOCIRAPTOR=34;class bi{}bi.NONE=0;bi.HEART=1;bi.SMILE=2;bi.BOBBA=3;bi.RELATIONSHIP_TYPES=[0,1,2,3];bi.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];class vs{}vs.HOTEL_VIEW="hotel_view";vs.HOME_ROOM="home_room";vs.NAVIGATOR="navigator";vs.CATALOG="catalog";vs.INVENTORY="inventory";vs.ME_MENU="me_menu";vs.FRIEND_LIST="friendlist";class Fi{}Fi.LOVE_LOCK=0;Fi.CARVE_A_TREE=1;Fi.FRIENDS_PORTRAIT=2;Fi.WILD_WEST_WANTED=3;Fi.HABBOWEEN=4;class k_{}k_.CATALOG="catalog";k_.INVENTORY="inventory";class d{}d.OBJECT_ROOM_ID="object_room_id";d.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value";d.TILE_CURSOR_HEIGHT="tile_cursor_height";d.FIGURE="figure";d.GENDER="gender";d.OWN_USER="own_user";d.FIGURE_CAN_STAND_UP="figure_can_stand_up";d.FIGURE_VERTICAL_OFFSET="figure_vertical_offset";d.FIGURE_TALK="figure_talk";d.FIGURE_DANCE="figure_dance";d.FIGURE_SLEEP="figure_sleep";d.FIGURE_BLINK="figure_blink";d.FIGURE_EFFECT="figure_effect";d.FIGURE_CARRY_OBJECT="figure_carry_object";d.FIGURE_USE_OBJECT="figure_use_object";d.FIGURE_GESTURE="figure_gesture";d.FIGURE_POSTURE="figure_posture";d.FIGURE_POSTURE_PARAMETER="figure_posture_parameter";d.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable";d.FIGURE_HIGHLIGHT="figure_highlight";d.FURNITURE_PURCHASER_NAME="furniture_purchaser_name";d.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure";d.STD="std";d.FIGURE_SIGN="figure_sign";d.FIGURE_FLAT_CONTROL="figure_flat_control";d.FIGURE_IS_TYPING="figure_is_typing";d.FIGURE_IS_MUTED="figure_is_muted";d.FIGURE_GAINED_EXPERIENCE="figure_gained_experience";d.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp";d.FIGURE_NUMBER_VALUE="figure_number_value";d.FIGURE_IS_PLAYING_GAME="figure_is_playing_game";d.FIGURE_GUIDE_STATUS="figure_guide_status";d.FIGURE_EXPRESSION="figure_expression";d.HEAD_DIRECTION="head_direction";d.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables";d.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index";d.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable";d.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation";d.FURNITURE_DATA_FORMAT="furniture_data_format";d.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number";d.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size";d.FURNITURE_CRACKABLE_STATE="furniture_crackable_state";d.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits";d.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target";d.FURNITURE_CREDIT_VALUE="furniture_credit_value";d.FURNITURE_DATA="furniture_data";d.FURNITURE_ITEMDATA="furniture_itemdata";d.FURNITURE_COLOR="furniture_color";d.FURNITURE_LIFT_AMOUNT="furniure_lift_amount";d.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id";d.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name";d.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1";d.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2";d.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time";d.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled";d.FURNITURE_SIZE_X="furniture_size_x";d.FURNITURE_SIZE_Y="furniture_size_y";d.FURNITURE_SIZE_Z="furniture_size_z";d.FURNITURE_CENTER_X="furniture_center_x";d.FURNITURE_CENTER_Y="furniture_center_y";d.FURNITURE_CENTER_Z="furniture_center_z";d.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions";d.FURNITURE_AD_URL="furniture_ad_url";d.FURNITURE_TYPE_ID="furniture_type_id";d.FURNITURE_EXTRAS="furniture_extras";d.FURNITURE_EXPIRY_TIME="furniture_expiry_time";d.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp";d.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object";d.FURNITURE_IS_STICKIE="furniture_is_stickie";d.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status";d.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url";d.FURNITURE_BRANDING_URL="furniture_branding_url";d.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x";d.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y";d.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z";d.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated";d.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status";d.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name";d.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state";d.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier";d.FURNITURE_USAGE_POLICY="furniture_usage_policy";d.FURNITURE_OWNER_ID="furniture_owner_id";d.FURNITURE_OWNER_NAME="furniture_owner_name";d.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue";d.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation";d.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness";d.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask";d.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type";d.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height";d.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result";d.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count";d.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed";d.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name";d.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender";d.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure";d.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type";d.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type";d.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count";d.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_";d.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_";d.FURNITURE_INTERNAL_LINK="furniture_internal_link";d.FURNITURE_CLOTHING_BOY="furniture_clothing_boy";d.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl";d.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data";d.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data";d.PET_PALETTE_INDEX="pet_palette_index";d.PET_COLOR="pet_color";d.PET_HEAD_ONLY="pet_head_only";d.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids";d.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids";d.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids";d.PET_IS_RIDING="pet_is_riding";d.PET_TYPE="pet_type";d.PET_ALLOWED_DIRECTIONS="pet_allowed_directions";d.RACE="race";d.ROOM_MAP_DATA="room_map_data";d.ROOM_PLANE_MASK_XML="room_plane_mask_xml";d.ROOM_FLOOR_TYPE="room_floor_type";d.ROOM_WALL_TYPE="room_wall_type";d.ROOM_LANDSCAPE_TYPE="room_landscape_type";d.ROOM_WALL_THICKNESS="room_wall_thickness";d.ROOM_FLOOR_THICKNESS="room_floor_thickness";d.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time";d.ROOM_FLOOR_VISIBILITY="room_floor_visibility";d.ROOM_WALL_VISIBILITY="room_wall_visibility";d.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility";d.ROOM_DOOR_X="room_door_x";d.ROOM_DOOR_Y="room_door_y";d.ROOM_DOOR_Z="room_door_z";d.ROOM_DOOR_DIR="room_door_dir";d.ROOM_BACKGROUND_COLOR="room_background_color";d.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only";d.ROOM_RANDOM_SEED="room_random_seed";d.ROOM_WORLD_TYPE="room_world_type";d.ROOM_SELECTED_X="room_selected_x";d.ROOM_SELECTED_Y="room_selected_y";d.ROOM_SELECTED_Z="room_selected_z";d.ROOM_SELECTED_PLANE="room_selected_plane";d.IMAGE_QUERY_SCALE="image_query_scale";d.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type";d.SESSION_URL_PREFIX="session_url_prefix";d.SESSION_CURRENT_USER_ID="session_current_user_id";class mu{}mu.UNIQUE_SET=256;class ai{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&mu.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(d.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(d.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(d.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(d.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(t){this._uniqueNumber=t}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(t){this._uniqueSeries=t}get rarityLevel(){return-1}get flags(){return this._flags}set flags(t){this._flags=t}}class ie{}ie.LEGACY_KEY=0;ie.MAP_KEY=1;ie.STRING_KEY=2;ie.VOTE_KEY=3;ie.EMPTY_KEY=4;ie.NUMBER_KEY=5;ie.HIGHSCORE_KEY=6;ie.CRACKABLE_KEY=7;const Iu=class extends ai{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(e){e&&(this._state=e.readString(),this._hits=e.readInt(),this._target=e.readInt(),super.parseWrapper(e))}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._state=e.getValue(d.FURNITURE_CRACKABLE_STATE),this._hits=e.getValue(d.FURNITURE_CRACKABLE_HITS),this._target=e.getValue(d.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,Iu.FORMAT_KEY),e.setValue(d.FURNITURE_CRACKABLE_STATE,this._state),e.setValue(d.FURNITURE_CRACKABLE_HITS,this._hits),e.setValue(d.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(e){return!0}get hits(){return this._hits}get target(){return this._target}};let Io=Iu;Io.FORMAT_KEY=ie.CRACKABLE_KEY;const Ru=class extends ai{parseWrapper(e){e&&(this._state="",super.parseWrapper(e))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,Ru.FORMAT_KEY)}getLegacyString(){return this._state}compare(e){return super.compare(e)}};let Ro=Ru;Ro.FORMAT_KEY=ie.EMPTY_KEY;class Vh{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}const Tu=class extends ai{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(e){if(!e)return;this._state=e.readString(),this._scoreType=e.readInt(),this._clearType=e.readInt();let t=e.readInt();for(;t>0;){const s=new Vh;s.score=e.readInt();let i=e.readInt();for(;i>0;)s.addUsername(e.readString()),i--;this._entries.push(s),t--}super.parseWrapper(e)}initializeFromRoomObjectModel(e){this._scoreType=e.getValue(d.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=e.getValue(d.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const t=e.getValue(d.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<t;){const i=new Vh;i.score=e.getValue(d.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),i.users=e.getValue(d.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(i),s++}super.initializeFromRoomObjectModel(e)}writeRoomObjectModel(e){if(super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,Tu.FORMAT_KEY),e.setValue(d.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),e.setValue(d.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){e.setValue(d.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let t=0;for(;t<this._entries.length;){const s=this._entries[t];e.setValue(d.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+t,s.score),e.setValue(d.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+t,s.users),t++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};let To=Tu;To.FORMAT_KEY=ie.HIGHSCORE_KEY;const pu=class extends ai{constructor(){super(),this._data=""}parseWrapper(e){e&&(this._data=e.readString(),super.parseWrapper(e))}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(d.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,pu.FORMAT_KEY),e.setValue(d.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(e){return this._data===e.getLegacyString()}setString(e){this._data=e}};let me=pu;me.FORMAT_KEY=ie.LEGACY_KEY;const bn=class extends ai{constructor(){super(),this._data={}}parseWrapper(e){if(!e)return;this._data={};const t=e.readInt();if(t)for(let s=0;s<t;s++)this._data[e.readString()]=e.readString();super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(d.FURNITURE_DATA)||{}}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,bn.FORMAT_KEY),e.setValue(d.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const e=this._data[bn.STATE];return e??""}compare(e){return!1}getValue(e){return this._data[e]}get rarityLevel(){if(!this._data)return-1;const e=this._data[bn.RARITY];return e==null?-1:parseInt(e)}get data(){return this._data}};let ni=bn;ni.FORMAT_KEY=ie.MAP_KEY;ni.STATE="state";ni.RARITY="rarity";const Fn=class extends ai{constructor(){super(),this._data=[]}parseWrapper(e){if(!e)return;this._data=[];const t=e.readInt();if(t)for(let s=0;s<t;s++)this._data.push(e.readInt());super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(d.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,Fn.FORMAT_KEY),e.setValue(d.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[Fn.STATE].toString()}compare(e){if(!(e instanceof Fn))return!1;let t=0;for(;t<this._data.length;){if(t!==0){if(this._data[t]!==e.getValue(t))return!1}t++}return!0}getValue(e){if(!this._data||!this._data.length)return-1;const t=this._data[e];return t??-1}};let qr=Fn;qr.FORMAT_KEY=ie.NUMBER_KEY;qr.STATE=0;const xn=class extends ai{constructor(){super(),this._data=[]}parseWrapper(e){if(!e)return;this._data=[];const t=e.readInt();if(t)for(let s=0;s<t;s++)this._data.push(e.readString());super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(d.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,xn.FORMAT_KEY),e.setValue(d.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[xn.STATE]}compare(e){if(!(e instanceof xn))return!1;let t=0;for(;t<this._data.length;){if(t!==0){if(this._data[t]!==e.getValue(t))return!1}t++}return!0}getValue(e){return this._data[e]||""}setValue(e){this._data=e}};let ur=xn;ur.FORMAT_KEY=ie.STRING_KEY;ur.STATE=0;const Ou=class extends ai{constructor(){super(),this._state="",this._result=0}parseWrapper(e){e&&(this._state=e.readString(),this._result=e.readInt(),super.parseWrapper(e))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(d.FURNITURE_DATA_FORMAT,Ou.FORMAT_KEY);const t={};t.S=this._state,t.R=this._result.toString(),e.setValue(d.FURNITURE_DATA,t)}getLegacyString(){return this._state}compare(e){return!0}setString(e){this._state=e}get result(){return this._result}};let ta=Ou;ta.FORMAT_KEY=ie.VOTE_KEY;class $s{static getData(t){let s=null;switch(t&255){case Io.FORMAT_KEY:s=new Io;break;case Ro.FORMAT_KEY:s=new Ro;break;case To.FORMAT_KEY:s=new To;break;case me.FORMAT_KEY:s=new me;break;case ni.FORMAT_KEY:s=new ni;break;case qr.FORMAT_KEY:s=new qr;break;case ur.FORMAT_KEY:s=new ur;break;case ta.FORMAT_KEY:s=new ta;break}return s?(s.flags=t&65280,s):null}}class A{}A.MINIMUM=-2;A.ROOM=0;A.FLOOR=10;A.WALL=20;A.UNIT=100;A.CURSOR=200;class M{}M.FURNITURE_BASIC="furniture_basic";M.FURNITURE_MULTISTATE="furniture_multistate";M.FURNITURE_MULTIHEIGHT="furniture_multiheight";M.FURNITURE_RANDOMSTATE="furniture_randomstate";M.FURNITURE_PLACEHOLDER="furniture_placeholder";M.FURNITURE_CREDIT="furniture_credit";M.FURNITURE_STICKIE="furniture_stickie";M.FURNITURE_PRESENT="furniture_present";M.FURNITURE_TROPHY="furniture_trophy";M.FURNITURE_ECOTRON_BOX="furniture_ecotron_box";M.FURNITURE_DICE="furniture_dice";M.FURNITURE_HOCKEY_SCORE="furniture_hockey_score";M.FURNITURE_HABBOWHEEL="furniture_habbowheel";M.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door";M.FURNITURE_PLANET_SYSTEM="furniture_planet_system";M.FURNITURE_WINDOW="furniture_window";M.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem";M.FURNITURE_ROOMDIMMER="furniture_roomdimmer";M.FURNITURE_SOUND_MACHINE="furniture_sound_machine";M.FURNITURE_JUKEBOX="furniture_jukebox";M.FURNITURE_CRACKABLE="furniture_crackable";M.FURNITURE_PUSHABLE="furniture_pushable";M.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change";M.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";M.FURNITURE_SCORE="furniture_score";M.FURNITURE_ES="furniture_es";M.FURNITURE_FIREWORKS="furniture_fireworks";M.FURNITURE_SONG_DISK="furniture_song_disk";M.FURNITURE_BB="furniture_bb";M.FURNITURE_BG="furniture_bg";M.FURNITURE_WELCOME_GIFT="furniture_welcome_gift";M.FURNITURE_FLOOR_HOLE="furniture_floor_hole";M.FURNITURE_MANNEQUIN="furniture_mannequin";M.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";M.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal";M.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization";M.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock";M.FURNITURE_VOTE_COUNTER="furniture_vote_counter";M.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";M.FURNITURE_SOUNDBLOCK="furniture_soundblock";M.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport";M.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed";M.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing";M.FURNITURE_BACKGROUND_COLOR="furniture_background_color";M.FURNITURE_MYSTERYBOX="furniture_mysterybox";M.FURNITURE_EFFECTBOX="furniture_effectbox";M.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy";M.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution";M.FURNITURE_LOVELOCK="furniture_lovelock";M.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted";M.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock";M.FURNITURE_BADGE_DISPLAY="furniture_badge_display";M.FURNITURE_HIGH_SCORE="furniture_high_score";M.FURNITURE_INTERNAL_LINK="furniture_internal_link";M.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height";M.FURNITURE_YOUTUBE="furniture_youtube";M.FURNITURE_RENTABLE_SPACE="furniture_rentable_space";M.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on";M.FURNITURE_VIMEO="furniture_vimeo";M.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link";M.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link";M.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo";M.ROOM="room";M.USER="user";M.BOT="bot";M.RENTABLE_BOT="rentable_bot";M.PET="pet";M.TILE_CURSOR="tile_cursor";M.SELECTION_ARROW="selection_arrow";M.GAME_SNOWBALL="game_snowball";M.GAME_SNOWSPLASH="game_snowsplash";class K{}K.OBJECT_UNDEFINED="OBJECT_UNDEFINED";K.OBJECT_MOVE="OBJECT_MOVE";K.OBJECT_PLACE="OBJECT_PLACE";K.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE";K.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE";K.OBJECT_MOVE_TO="OBJECT_MOVE_TO";K.OBJECT_PLACE_TO="OBJECT_PLACE_TO";K.OBJECT_PICKUP="OBJECT_PICKUP";K.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT";K.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET";K.OBJECT_EJECT="OBJECT_EJECT";K.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";class Ye{}Ye.USER=1;Ye.PET=2;Ye.BOT=3;Ye.RENTABLE_BOT=4;const fi=class{static getTypeNumber(e){return fi.AVATAR_TYPES[e]}static getTypeString(e){for(const t in fi.AVATAR_TYPES)if(t&&fi.AVATAR_TYPES[t]===e)return t;return null}static getRealType(e){switch(e){case fi.BOT:case fi.RENTABLE_BOT:return fi.USER;default:return e}}};let et=fi;et.USER="user";et.PET="pet";et.BOT="bot";et.RENTABLE_BOT="rentable_bot";et.MONSTER_PLANT="monsterplant";et.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};class y{}y.FURNITURE_STATIC="furniture_static";y.FURNITURE_ANIMATED="furniture_animated";y.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated";y.FURNITURE_POSTER="furniture_poster";y.FURNITURE_EXTERNAL_IMAGE="furniture_external_image";y.FURNITURE_HABBOWHEEL="furniture_habbowheel";y.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer";y.FURNITURE_BOTTLE="furniture_bottle";y.FURNITURE_PLANET_SYSTEM="furniture_planet_system";y.FURNITURE_QUEUE_TILE="furniture_queue_tile";y.FURNITURE_PARTY_BEAMER="furniture_party_beamer";y.FURNITURE_CUBOID="furniture_cuboid";y.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped";y.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks";y.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";y.FURNITURE_WATER_AREA="furniture_water_area";y.FURNITURE_SCORE_BOARD="furniture_score_board";y.FURNITURE_FIREWORKS="furniture_fireworks";y.FURNITURE_BB="furniture_bb";y.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb";y.FURNITURE_BG="furniture_bg";y.FURNITURE_STICKIE="furniture_stickie";y.FURNITURE_MANNEQUIN="furniture_mannequin";y.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";y.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge";y.FURNITURE_VOTE_COUNTER="furniture_vote_counter";y.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";y.FURNITURE_SOUNDBLOCK="furniture_soundblock";y.FURNITURE_BADGE_DISPLAY="furniture_badge_display";y.FURNITURE_YOUTUBE="furniture_youtube";y.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder";y.ROOM="room";y.USER="user";y.PET_ANIMATED="pet_animated";y.BOT="bot";y.RENTABLE_BOT="rentable_bot";y.TILE_CURSOR="tile_cursor";class As{constructor(t,s,i,r=null){this._id=t,this._location=s,this._targetLocation=i,this._movementType=r}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}As.MOVE="mv";As.SLIDE="sld";class K_{}K_.KICKED_OUT_OF_ROOM=4008;K_.STRIP_LOCKED_FOR_TRADING=-13001;class ar{}ar.OLD_IDENTITY=0;ar.NEW_IDENTITY=1;ar.REAL_NOOB=2;class Oe{}Oe.NONE=0;Oe.GUEST=1;Oe.GUILD_MEMBER=2;Oe.GUILD_ADMIN=3;Oe.ROOM_OWNER=4;Oe.MODERATOR=5;const Gn=class{static getLocalizationKey(e){switch(e){case Gn.FREE_TRADING:return"${trading.mode.free}";case Gn.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case Gn.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};let Na=Gn;Na.NO_TRADING=0;Na.ROOM_CONTROLLER_REQUIRED=1;Na.FREE_TRADING=2;class Ke{}Ke.SUPER_USER=9;Ke.ADMINISTRATOR=8;Ke.COMMUNITY=7;Ke.PLAYER_SUPPORT=6;Ke.MODERATOR=5;Ke.EMPLOYEE=4;Ke.BUS_PARTNER=3;Ke.PARTNER=2;Ke.CELEBRITY=1;Ke.NONE=0;var Si=(e=>(e.FLOOR="S",e.WALL="I",e.EFFECT="E",e.BADGE="B",e.ROBOT="R",e.HABBO_CLUB="H",e.PET="P",e))(Si||{});class Le{}Le.MATCH_ALL_PIXELS=-1;Le.MATCH_OPAQUE_PIXELS=128;Le.MATCH_NOTHING=256;class he{}he.DEFAULT=1;he.ROOM_PLANE=2;he.AVATAR=3;he.AVATAR_OWN=4;class Au{}class I{constructor(t=0,s=0,i=0){this._x=t,this._y=s,this._z=i,this._length=NaN}static sum(t,s){return!t||!s?null:new I(t.x+s.x,t.y+s.y,t.z+s.z)}static dif(t,s){return!t||!s?null:new I(t.x-s.x,t.y-s.y,t.z-s.z)}static product(t,s){return t?new I(t.x*s,t.y*s,t.z*s):null}static dotProduct(t,s){return!t||!s?0:t.x*s.x+t.y*s.y+t.z*s.z}static crossProduct(t,s){return!t||!s?null:new I(t.y*s.z-t.z*s.y,t.z*s.x-t.x*s.z,t.x*s.y-t.y*s.x)}static scalarProjection(t,s){if(!t||!s)return-1;const i=s.length;return i>0?(t.x*s.x+t.y*s.y+t.z*s.z)/i:-1}static cosAngle(t,s){if(!t||!s)return 0;const i=t.length*s.length;return i?I.dotProduct(t,s)/i:0}static isEqual(t,s){return!(!t||!s||t.x!==s.x||t.y!==s.y||t.z!==s.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){t&&(this._x/=t,this._y/=t,this._z/=t,this._length=NaN)}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}class F{}F.MOUSE_CLICK="click";F.DOUBLE_CLICK="double_click";F.MOUSE_MOVE="mousemove";F.MOUSE_DOWN="mousedown";F.MOUSE_DOWN_LONG="mousedown_long";F.MOUSE_UP="mouseup";F.ROLL_OVER="mouseover";F.ROLL_OUT="mouseout";F.RIGHT_CLICK="contextmenu";class sn{}sn.TOUCH_START="touchstart";sn.TOUCH_MOVE="touchmove";sn.TOUCH_CANCEL="touchcancel";sn.TOUCH_END="touchend";sn.TOUCH_LONG="touchlong";const Fs=class{constructor(e){this._ordinal=e}get ordinal(){return this._ordinal}equals(e){return e&&e._ordinal==this._ordinal}};let oi=Fs;oi.NONE=new Fs(0);oi.WAVE=new Fs(1);oi.BLOW=new Fs(2);oi.LAUGH=new Fs(3);oi.CRY=new Fs(4);oi.IDLE=new Fs(5);oi.JUMP=new Fs(6);oi.RESPECT=new Fs(7);class Zt{}Zt.DUMMY="DUMMY";Zt.FRIEND_FURNITURE="FRIEND_FURNITURE";Zt.MONSTERPLANT_SEED="MONSTERPLANT_SEED";Zt.MYSTERY_BOX="MYSTERY_BOX";Zt.EFFECT_BOX="EFFECT_BOX";Zt.MYSTERY_TROPHY="MYSTERY_TROPHY";Zt.RANDOM_TELEPORT="RANDOM_TELEPORT";Zt.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING";Zt.GENERIC_USABLE="GENERIC_USABLE";class j{}j.CHAT_WIDGET="RWE_CHAT_WIDGET";j.INFOSTAND="RWE_INFOSTAND";j.ME_MENU="RWE_ME_MENU";j.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET";j.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER";j.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET";j.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET";j.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET";j.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET";j.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET";j.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET";j.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET";j.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET";j.DOORBELL="RWE_DOORBELL";j.LOADINGBAR="RWE_LOADINGBAR";j.ROOM_QUEUE="RWE_ROOM_QUEUE";j.ROOM_POLL="RWE_ROOM_POLL";j.ROOM_VOTE="RWE_ROOM_VOTE";j.USER_CHOOSER="RWE_USER_CHOOSER";j.FURNI_CHOOSER="RWE_FURNI_CHOOSER";j.ROOM_DIMMER="RWE_ROOM_DIMMER";j.FRIEND_REQUEST="RWE_FRIEND_REQUEST";j.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE";j.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING";j.USER_NOTIFICATION="RWE_USER_NOTIFICATION";j.FRIENDS_BAR="RWE_FRIENDS_BAR";j.PURSE_WIDGET="RWE_PURSE_WIDGET";j.AVATAR_INFO="RWE_AVATAR_INFO";j.WELCOME_GIFT="RWE_WELCOME_GIFT";j.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET";j.EFFECTS="RWE_EFFECTS";j.MANNEQUIN="RWE_MANNEQUIN";j.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU";j.LOCATION_WIDGET="RWE_LOCATION_WIDGET";j.CAMERA="RWE_CAMERA";j.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA";j.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR";j.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION";j.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING";j.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM";j.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING";j.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY";j.INTERNAL_LINK="RWE_INTERNAL_LINK";j.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT";j.YOUTUBE="RWE_YOUTUBE";j.RENTABLESPACE="RWE_RENTABLESPACE";j.VIMEO="RWE_VIMEO";j.ROOM_TOOLS="RWE_ROOM_TOOLS";j.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE";j.WORD_QUIZZ="RWE_WORD_QUIZZ";j.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE";j.ROOM_LINK="RWE_ROOM_LINK";j.CRAFTING="RWE_CRAFTING";j.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";class kt{}kt.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM";kt.JUKEBOX="RWEIEP_JUKEBOX";kt.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT";kt.SONGDISK="RWEIEP_SONGDISK";kt.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI";kt.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS";kt.USABLE="RWEIEP_USABLE";class X_{}X_.NOBODY=0;X_.CONTROLLER=1;X_.EVERYBODY=2;class Xs{}Xs.NORMAL=0;Xs.GENERIC=1;Xs.BOT=2;class Ie{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class Me extends Ie{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(t,s){if(!t||!s)return;const i=this._listeners.get(t);if(!i){this._listeners.set(t,[s]);return}i.push(s)}removeEventListener(t,s){if(!t||!s)return;const i=this._listeners.get(t);if(!(!i||!i.length)){for(const[r,n]of i.entries())if(!(!n||n!==s)){i.splice(r,1),i.length||this._listeners.delete(t);return}}}dispatchEvent(t){return t?(G.events("Dispatched Event",t.type),this.processEvent(t),!0):!1}processEvent(t){const s=this._listeners.get(t.type);if(!s||!s.length)return;const i=[];for(const r of s)r&&i.push(r);for(;i.length;){const r=i.shift();try{r(t)}catch(n){G.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}class as extends Ie{constructor(){super(),this._events=new Me,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class tf{constructor(t){this._value=t}get value(){return this._value}}class ef{constructor(t,s){this._header=t,this._buffer=s}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class sf{constructor(t){this._value=t}get value(){return this._value}}class rf{encode(t,s){const i=new Hh;i.writeShort(t);for(const n of s){let a=typeof n;switch(a==="object"&&(n===null?a="null":n instanceof tf?a="byte":n instanceof sf?a="short":n instanceof ArrayBuffer&&(a="arraybuffer")),a){case"undefined":case"null":i.writeShort(0);break;case"byte":i.writeByte(n.value);break;case"short":i.writeShort(n.value);break;case"number":i.writeInt(n);break;case"boolean":i.writeByte(n?1:0);break;case"string":n?i.writeString(n,!0):i.writeShort(0);break;case"arraybuffer":i.writeBytes(n);break}}const r=i.getBuffer();return r?new Hh().writeInt(r.byteLength).writeBytes(r):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const s=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const i=new Sa(t.dataBuffer),r=i.readInt();if(r>t.dataBuffer.byteLength-4)break;const n=i.readBytes(r);s.push(new ef(n.readShort(),n)),t.dataBuffer=t.dataBuffer.slice(r+4)}return s}}class E{constructor(t,s){this._callBack=t,this._parserClass=s,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}class nt{constructor(t){this._type=t}get type(){return this._type}}class jt extends nt{constructor(t,s,i){super(t),this._connection=s,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}jt.CONNECTION_OPENED="SCE_OPEN";jt.CONNECTION_CLOSED="SCE_CLOSED";jt.CONNECTION_ERROR="SCE_ERROR";jt.CONNECTION_MESSAGE="SCE_MESSAGE";class $i extends nt{constructor(t,s){super(t),this._library=s}get library(){return this._library}}$i.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";class Da{}Da.AVATAR_RENDER_READY="AVATAR_RENDER_READY";class tr extends nt{constructor(t,s){super(t),this._library=s}get library(){return this._library}}tr.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";class po extends nt{constructor(t){super(t)}}po.INITIALIZED="RCWM_INITIALIZED";class Jt extends nt{constructor(t,s){super(t),this._connection=s}get connection(){return this._connection}}Jt.CONNECTION_ESTABLISHED="NCE_ESTABLISHED";Jt.CONNECTION_CLOSED="NCE_CLOSED";Jt.CONNECTION_ERROR="NCE_ERROR";Jt.CONNECTION_HANDSHAKING="NCE_HANDSHAKING";Jt.CONNECTION_HANDSHAKED="NCE_HANDSHAKED";Jt.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED";Jt.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";class er extends nt{constructor(t){super(t)}}er.LOADED="NLE_LOADED";er.FAILED="NLE_FAILED";const Oo=class extends nt{constructor(){super(Oo.SETTINGS_UPDATED)}clone(){const e=new Oo;return e._volumeSystem=this._volumeSystem,e._volumeFurni=this._volumeFurni,e._volumeTrax=this._volumeTrax,e._oldChat=this._oldChat,e._roomInvites=this._roomInvites,e._cameraFollow=this._cameraFollow,e._flags=this._flags,e._chatType=this._chatType,e}get volumeSystem(){return this._volumeSystem}set volumeSystem(e){this._volumeSystem=e}get volumeFurni(){return this._volumeFurni}set volumeFurni(e){this._volumeFurni=e}get volumeTrax(){return this._volumeTrax}set volumeTrax(e){this._volumeTrax=e}get oldChat(){return this._oldChat}set oldChat(e){this._oldChat=e}get roomInvites(){return this._roomInvites}set roomInvites(e){this._roomInvites=e}get cameraFollow(){return this._cameraFollow}set cameraFollow(e){this._cameraFollow=e}get flags(){return this._flags}set flags(e){this._flags=e}get chatType(){return this._chatType}set chatType(e){this._chatType=e}};let or=Oo;or.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";class Bn extends nt{constructor(t,s){super(t),this._sampleCode=s}get sampleCode(){return this._sampleCode}}Bn.PLAY_SOUND="NSOE_PLAY_SOUND";class q_ extends nt{constructor(t){super(t)}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}}q_.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK";q_.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";const Su=class extends q_{constructor(e,t,s){super(Su.ANIMATE_ICON),this._image=e,this._x=t,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}};let Ao=Su;Ao.ANIMATE_ICON="NTAIE_ANIMATE_ICON";class ct extends nt{constructor(t,s){super(t),this._roomId=s}get roomId(){return this._roomId}}ct.INITIALIZED="REE_INITIALIZED";ct.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED";ct.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED";ct.NORMAL_MODE="REE_NORMAL_MODE";ct.GAME_MODE="REE_GAME_MODE";ct.ROOM_ZOOMED="REE_ROOM_ZOOMED";ct.DISPOSED="REE_DISPOSED";const Mu=class extends ct{constructor(e,t,s,i){super(Mu.ROOM_COLOR,e),this._color=t,this._brightness=s,this._bgOnly=i}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};let Cu=Mu;Cu.ROOM_COLOR="REE_ROOM_COLOR";class is extends nt{constructor(t,s){super(t),this._contentType=s}get contentType(){return this._contentType}}is.RCLE_SUCCESS="RCLE_SUCCESS";is.RCLE_FAILURE="RCLE_FAILURE";is.RCLE_CANCEL="RCLE_CANCEL";const Nu=class extends ct{constructor(e,t,s){super(Nu.ROOM_DRAG,e),this._offsetX=t,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};let Du=Nu;Du.ROOM_DRAG="RDE_ROOM_DRAG";const Pu=class extends ct{constructor(e,t,s,i,r,n){super(Pu.ROOM_COLOR,e),this._state=t,this._presetId=s,this._effectId=i,this._color=r,this._brightness=n}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};let yu=Pu;yu.ROOM_COLOR="REDSE_ROOM_COLOR";class H extends ct{constructor(t,s,i,r){super(t,s),this._objectId=i,this._category=r}get objectId(){return this._objectId}get category(){return this._category}}H.SELECTED="REOE_SELECTED";H.DESELECTED="REOE_DESELECTED";H.ADDED="REOE_ADDED";H.REMOVED="REOE_REMOVED";H.PLACED="REOE_PLACED";H.PLACED_ON_USER="REOE_PLACED_ON_USER";H.CONTENT_UPDATED="REOE_CONTENT_UPDATED";H.REQUEST_MOVE="REOE_REQUEST_MOVE";H.REQUEST_ROTATE="REOE_REQUEST_ROTATE";H.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION";H.MOUSE_ENTER="REOE_MOUSE_ENTER";H.MOUSE_LEAVE="REOE_MOUSE_LEAVE";H.DOUBLE_CLICK="REOE_DOUBLE_CLICK";class nf extends H{constructor(t,s,i,r,n,a,o,u,l,c,g,f,R){super(t,s,i,r),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=n,this._x=a,this._y=o,this._z=u,this._direction=l,this._placedInRoom=c,this._placedOnFloor=g,this._placedOnWall=f,this._instanceData=R}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class af extends H{constructor(t,s,i,r,n,a){super(t,s,i,r),this._droppedObjectId=n,this._droppedObjectCategory=a}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}class sr extends H{constructor(t,s,i,r,n,a=1){super(t,s,i,r),this._soundId=n,this._pitch=a}get soundId(){return this._soundId}get pitch(){return this._pitch}}sr.PLAY_SOUND="REOPSE_PLAY_SOUND";sr.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";class ti extends H{}ti.FURNI_CLICK="RERAE_FURNI_CLICK";ti.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK";ti.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW";ti.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";class _e extends H{constructor(t,s,i,r,n,a=1){super(t,s,i,r),this._sampleId=n,this._pitch=a}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}_e.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";_e.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";_e.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";_e.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class U extends H{constructor(t,s,i,r,n=null){super(t,s,i,r),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}}U.OPEN_WIDGET="RETWE_OPEN_WIDGET";U.CLOSE_WIDGET="RETWE_CLOSE_WIDGET";U.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU";U.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU";U.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER";U.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI";U.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT";U.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE";U.REQUEST_STICKIE="RETWE_REQUEST_STICKIE";U.REQUEST_PRESENT="RETWE_REQUEST_PRESENT";U.REQUEST_TROPHY="RETWE_REQUEST_TROPHY";U.REQUEST_TEASER="RETWE_REQUEST_TEASER";U.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX";U.REQUEST_DIMMER="RETWE_REQUEST_DIMMER";U.REMOVE_DIMMER="RETWE_REMOVE_DIMMER";U.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE";U.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR";U.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN";U.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";U.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";U.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR";U.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG";U.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG";U.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG";U.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING";U.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED";U.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM";U.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING";U.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING";U.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY";U.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY";U.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK";U.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK";U.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";class ea extends H{constructor(t,s,i,r,n=-1,a=-1){super(t,s,i,r),this._inventoryStripId=n,this._furnitureTypeId=a}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}}ea.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM";ea.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";class ve extends nt{constructor(t,s){super(t),this._object=s}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}class rs extends ve{constructor(t,s,i,r=!0){super(t,s),this._badgeId=i,this._groupBadge=r}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}rs.LOAD_BADGE="ROBAE_LOAD_BADGE";class ye extends ve{constructor(t,s){super(t,s)}}ye.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID";ye.RODRE_URL_PREFIX="RODRE_URL_PREFIX";const Lu=class extends ve{constructor(e,t,s,i,r,n){super(Lu.DIMMER_STATE,e),this._state=t,this._presetId=s,this._effectId=i,this._color=r,this._brightness=n}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};let _r=Lu;_r.DIMMER_STATE="RODSUE_DIMMER_STATE";class $t extends ve{constructor(t,s){super(t,s)}}$t.ADD_HOLE="ROFHO_ADD_HOLE";$t.REMOVE_HOLE="ROFHO_REMOVE_HOLE";class L extends ve{}L.DICE_OFF="ROFCAE_DICE_OFF";L.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE";L.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL";L.STICKIE="ROFCAE_STICKIE";L.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR";L.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT";L.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START";L.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP";L.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE";L.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT";L.JUKEBOX_START="ROFCAE_JUKEBOX_START";L.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP";L.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE";L.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON";L.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";class So extends ct{constructor(t,s,i,r,n,a){super(t,s),this._enable=i,this._hue=r,this._saturation=n,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}So.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class qs extends ve{constructor(t,s,i,r,n,a){super(t,s),this._enable=i,this._hue=r,this._saturation=n,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}qs.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class V extends ve{constructor(t,s,i,r=!1,n=!1,a=!1,o=!1){super(t,s),this._eventId="",this._eventId=i,this._altKey=r,this._ctrlKey=n,this._shiftKey=a,this._buttonDown=o}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}V.CLICK="ROE_MOUSE_CLICK";V.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK";V.MOUSE_MOVE="ROE_MOUSE_MOVE";V.MOUSE_DOWN="ROE_MOUSE_DOWN";V.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG";V.MOUSE_UP="ROE_MOUSE_UP";V.MOUSE_ENTER="ROE_MOUSE_ENTER";V.MOUSE_LEAVE="ROE_MOUSE_LEAVE";class se extends ve{constructor(t,s){super(t,s)}}se.POSITION_CHANGED="ROME_POSITION_CHANGED";se.OBJECT_REMOVED="ROME_OBJECT_REMOVED";class Ms extends L{constructor(t,s,i,r=1){super(t,s),this._soundId=i,this._pitch=r}get soundId(){return this._soundId}get pitch(){return this._pitch}}Ms.PLAY_SOUND="ROPSIE_PLAY_SOUND";Ms.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";class It extends ve{constructor(t,s,i="",r=""){super(t,s),this._imageUrl="",this._clickUrl="",this._imageUrl=i,this._clickUrl=r}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}}It.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE";It.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK";It.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK";It.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW";It.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";class yt extends ve{constructor(t,s,i,r=1){super(t,s),this._sampleId=i,this._pitch=r}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}yt.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";yt.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";yt.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";yt.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class gt extends H{}gt.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT";gt.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON";gt.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF";gt.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE";gt.JUKEBOX_INIT="ROSM_JUKEBOX_INIT";gt.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON";gt.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF";gt.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";class rt extends ve{constructor(t,s,i=0){super(t,s),this._state=i}get state(){return this._state}}rt.STATE_CHANGE="ROSCE_STATE_CHANGE";rt.STATE_RANDOM="ROSCE_STATE_RANDOM";class us extends V{constructor(t,s,i,r,n,a,o=!1,u=!1,l=!1,c=!1){super(t,s,i,o,u,l,c),this._tileX=r,this._tileY=n,this._tileZ=a}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class Yi extends V{constructor(t,s,i,r,n,a,o,u,l,c=!1,g=!1,f=!1,R=!1){super(t,s,i,c,g,f,R),this._wallLocation=new I,this._wallWd=new I,this._wallHt=new I,this._wallLocation.assign(r),this._wallWd.assign(n),this._wallHt.assign(a),this._x=o,this._y=u,this._direction=l}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class p extends ve{constructor(t,s){super(t,s)}}p.OPEN_WIDGET="ROWRE_OPEN_WIDGET";p.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET";p.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU";p.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU";p.PLACEHOLDER="ROWRE_PLACEHOLDER";p.CREDITFURNI="ROWRE_CREDITFURNI";p.STACK_HEIGHT="ROWRE_STACK_HEIGHT";p.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE";p.STICKIE="ROWRE_STICKIE";p.PRESENT="ROWRE_PRESENT";p.TROPHY="ROWRE_TROPHY";p.TEASER="ROWRE_TEASER";p.ECOTRONBOX="ROWRE_ECOTRONBOX";p.DIMMER="ROWRE_DIMMER";p.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER";p.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE";p.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR";p.MANNEQUIN="ROWRE_MANNEQUIN";p.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU";p.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU";p.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";p.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";p.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR";p.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG";p.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG";p.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG";p.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN";p.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING";p.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED";p.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM";p.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING";p.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING";p.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY";p.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY";p.INERNAL_LINK="ROWRE_INTERNAL_LINK";p.ROOM_LINK="ROWRE_ROOM_LINK";p.YOUTUBE="ROWRE_YOUTUBE";class of{constructor(t,s,i,r,n,a,o=0,u=0,l=!1,c=!1,g=!1,f=!1){this._type=t,this._eventId=s,this._canvasId=i,this._spriteTag=r,this._screenX=n,this._screenY=a,this._localX=o,this._localY=u,this._ctrlKey=l,this._altKey=c,this._shiftKey=g,this._buttonDown=f,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}class _f extends nt{constructor(t){super(t)}}class Qr extends _f{constructor(t,s){super(t),this._targetLocation=s}get targetLocation(){return this._targetLocation}}Qr.ROAME_MOVE_TO="ROAME_MOVE_TO";const Uu=class extends ct{constructor(e,t,s=!1,i=!1){super(Uu.ROOM_ZOOM,e),this._level=t,this._forceFlip=s,this._asDelta=i}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};let hf=Uu;hf.ROOM_ZOOM="REE_ROOM_ZOOM";const vu=class extends nt{constructor(e,t){super(vu.IMAGE_READY),this._badgeId=e,this._image=t}get badgeId(){return this._badgeId}get image(){return this._image}};let Jr=vu;Jr.IMAGE_READY="BIME_BADGE_IMAGE_READY";const bu=class extends nt{constructor(e,t){super(bu.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=e,this._keyColor=t}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};let Fu=bu;Fu.MYSTERY_BOX_KEYS_UPDATE="mbke_update";const xu=class extends nt{constructor(){super(xu.PERKS_UPDATED)}};let uf=xu;uf.PERKS_UPDATED="PUE_perks_updated";class k extends nt{constructor(t,s,i=!0){super(t),this._session=s,this._openLandingView=i}get session(){return this._session}get openLandingView(){return this._openLandingView}}k.CREATED="RSE_CREATED";k.STARTED="RSE_STARTED";k.ENDED="RSE_ENDED";k.ROOM_DATA="RSE_ROOM_DATA";class it extends k{constructor(t,s,i,r,n,a=0,o=null,u=-1){super(t,s),this._objectId=i,this._message=r,this._chatType=n,this._links=o,this._extraParam=u,this._style=a}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}it.CHAT_EVENT="RSCE_CHAT_EVENT";it.FLOOD_EVENT="RSCE_FLOOD_EVENT";it.CHAT_TYPE_SPEAK=0;it.CHAT_TYPE_WHISPER=1;it.CHAT_TYPE_SHOUT=2;it.CHAT_TYPE_RESPECT=3;it.CHAT_TYPE_PETRESPECT=4;it.CHAT_TYPE_HAND_ITEM_RECEIVED=5;it.CHAT_TYPE_PETTREAT=6;it.CHAT_TYPE_PETREVIVE=7;it.CHAT_TYPE_PET_REBREED_FERTILIZE=8;it.CHAT_TYPE_PET_SPEED_FERTILIZE=9;it.CHAT_TYPE_MUTE_REMAINING=10;const Gu=class extends k{constructor(e,t,s,i,r,n){super(Gu.CONFIRM_PET_BREEDING,e),this._nestId=t,this._pet1=s,this._pet2=i,this._rarityCategories=r,this._resultPetTypeId=n}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};let Bu=Gu;Bu.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";const wu=class extends k{constructor(e,t,s){super(wu.RSPFUE_CONFIRM_PET_BREEDING_RESULT,e),this._breedingNestStuffId=t,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};let Hu=wu;Hu.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";const Vu=class extends k{constructor(e,t,s){super(Vu.RSDE_DANCE,e),this._roomIndex=t,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};let ju=Vu;ju.RSDE_DANCE="RSDE_DANCE";class lf{constructor(t,s,i,r){this._id=t,this._type=s,this._color=i,this._brightness=r}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}class Mo extends k{constructor(t,s){super(t,s),this._selectedPresetId=0,this._presets=[]}storePreset(t,s,i,r){this._presets[t-1]=new lf(t,s,i,r)}getPreset(t){return t<0||t>=this._presets.length?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(t){this._selectedPresetId=t}}Mo.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";class Cs extends k{constructor(t,s,i){super(t,s),this._userName="",this._userName=i}get userName(){return this._userName}}Cs.DOORBELL="RSDE_DOORBELL";Cs.RSDE_REJECTED="RSDE_REJECTED";Cs.RSDE_ACCEPTED="RSDE_ACCEPTED";class At extends k{constructor(t,s,i=null){super(t,s),this._message=i}get message(){return this._message}}At.RSEME_KICKED="RSEME_KICKED";At.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL";At.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT";At.RSEME_MAX_PETS="RSEME_MAX_PETS";At.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS";At.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET";At.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET";At.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL";At.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT";At.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED";At.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT";At.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";const Yu=class extends k{constructor(e,t,s,i,r){super(Yu.FAVOURITE_GROUP_UPDATE,e),this._roomIndex=t,this._habboGroupId=s,this._habboGroupName=r,this._status=i}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};let zu=Yu;zu.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";const Wu=class extends k{constructor(e,t,s,i){super(Wu.RSFRE_FRIEND_REQUEST,e),this._requestId=0,this._userId=0,this._requestId=t,this._userId=s,this._userName=i}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};let ku=Wu;ku.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";const Ku=class extends k{constructor(e,t,s){super(Ku.NEST_BREEDING_SUCCESS,e),this._petId=t,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};let Xu=Ku;Xu.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";const qu=class extends k{constructor(e,t,s,i){super(qu.PET_BREEDING,e),this._state=t,this._ownPetId=s,this._otherPetId=i}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};let Qu=qu;Qu.PET_BREEDING="RSPFUE_PET_BREEDING";const Ju=class extends k{constructor(e,t,s){super(Ju.PET_BREEDING_RESULT,e),this._resultData=t,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};let Zu=Ju;Zu.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";const $u=class extends k{constructor(e,t,s,i){super($u.PET_COMMANDS,e),this._petId=t,this._allCommandIds=s,this._enabledCommandIds=i}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};let cf=$u;cf.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";const tl=class extends k{constructor(e,t,s){super(tl.PET_FIGURE_UPDATE,e),this._petId=t,this._figure=s}get id(){return this._petId}get figure(){return this._figure}};let el=tl;el.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";const sl=class extends k{constructor(e,t){super(sl.PET_INFO,e),this._petInfo=t}get petInfo(){return this._petInfo}};let il=sl;il.PET_INFO="RSPIUE_PET_INFO";const rl=class extends k{constructor(e,t,s){super(rl.PET_LEVEL_UPDATE,e),this._petId=t,this._level=s}get petId(){return this._petId}get level(){return this._level}};let nl=rl;nl.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";class ir extends k{constructor(t,s,i,r,n,a){super(t,s),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=i,this._figureData=r,this._nameValidationStatus=n,this._nameValidationInfo=a}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}ir.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED";ir.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";const al=class extends k{constructor(e,t,s,i,r,n){super(al.PET_STATUS_UPDATE,e),this._petId=t,this._canBreed=s,this._canHarvest=i,this._canRevive=r,this._hasBreedingPermission=n}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};let ol=al;ol.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";class Ts extends k{constructor(t,s,i){super(t,s),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=i}get id(){return this._id}get headline(){return this._headline}set headline(t){this._headline=t}get summary(){return this._summary}set summary(t){this._summary=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}}Ts.OFFER="RSPE_POLL_OFFER";Ts.ERROR="RSPE_POLL_ERROR";Ts.CONTENT="RSPE_POLL_CONTENT";class Co extends k{constructor(t,s,i,r,n,a,o,u,l){super(t,s),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=i,this._itemType=r,this._productCode=n,this._placedItemId=a,this._placedItemType=o,this._placedInRoom=u,this._petFigureString=l}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}}Co.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";class No extends k{constructor(t,s){super(t,s)}}No.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";const _l=class extends k{constructor(e,t,s,i=!1){super(_l.QUEUE_STATUS,e),this._name=t,this._target=s,this._queues=new Map,this._isActive=i}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(e){return this._queues.get(e)}addQueue(e,t){this._queues.set(e,t)}};let rn=_l;rn.QUEUE_STATUS="RSQE_QUEUE_STATUS";rn.QUEUE_TYPE_CLUB="c";rn.QUEUE_TYPE_NORMAL="d";rn.QUEUE_TARGET_VISITOR=2;rn.QUEUE_TARGET_SPECTATOR=1;class Do extends k{constructor(t,s){super(t,s)}}Do.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";const hl=class extends k{constructor(e,t,s){super(hl.RSUBE_BADGES,e),this._userId=0,this._badges=[],this._userId=t,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}};let ul=hl;ul.RSUBE_BADGES="RSUBE_BADGES";const ll=class extends k{constructor(e,t){super(ll.USER_DATA_UPDATED,e),this._addedUsers=t}get addedUsers(){return this._addedUsers}};let cl=ll;cl.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";const dl=class extends k{constructor(e,t,s,i,r,n){super(dl.USER_FIGURE,e),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=t,this._figure=s,this._gender=i,this._customInfo=r,this._achievementScore=n}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};let gl=dl;gl.USER_FIGURE="RSUBE_FIGURE";const El=class extends nt{constructor(e,t){super(El.UTRE_USER_TAGS_RECEIVED),this._userId=e,this._tags=t}get userId(){return this._userId}get tags(){return this._tags}};let df=El;df.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";class fl extends k{constructor(t,s,i,r,n=null,a=0){super(t,s),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=i,this._choices=r,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=a}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}}fl.VOTE_QUESTION="RSPE_VOTE_QUESTION";fl.VOTE_RESULT="RSPE_VOTE_RESULT";class ps extends k{constructor(t,s,i=-1){super(t,s),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=i}get id(){return this._id}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get pollId(){return this._pollId}set pollId(t){this._pollId=t}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get duration(){return this._duration}set duration(t){this._duration=t}get question(){return this._question}set question(t){this._question=t}get userId(){return this._userId}set userId(t){this._userId=t}get value(){return this._value}set value(t){this._value=t}get answerCounts(){return this._answerCounts}set answerCounts(t){this._answerCounts=t}}ps.QUESTION="RWPUW_NEW_QUESTION";ps.FINISHED="RWPUW_QUESION_FINSIHED";ps.ANSWERED="RWPUW_QUESTION_ANSWERED";const ml=class extends nt{constructor(e){super(ml.UPDATED),this._uiFlags=e}get uiFlags(){return this._uiFlags}};let Il=ml;Il.UPDATED="APUE_UPDATED";const Rl=class extends nt{constructor(e){super(Rl.UNUE_NAME_UPDATED),this._name=e}get name(){return this._name}};let Po=Rl;Po.UNUE_NAME_UPDATED="unue_name_updated";class gf{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[s,i]of t.events)this.registerMessageEventClass(s,i);for(const[s,i]of t.composers)this.registerMessageComposerClass(s,i)}registerMessageEventClass(t,s){!t||!s||this._messageIdByEvent.set(s,t)}registerMessageComposerClass(t,s){!t||!s||this._messageIdByComposer.set(s,t)}registerMessageEvent(t){if(!t)return;const s=this.getEventId(t);if(!s)return;let i=this._messageInstancesById.get(s);(!i||!i.length)&&(i=[],this._messageInstancesById.set(s,i)),i.push(t)}removeMessageEvent(t){if(!t)return;const s=this.getEventId(t);if(!s)return;const i=this._messageInstancesById.get(s);if(i){for(const[r,n]of i.entries())if(n&&n===t){i.splice(r,1),i.length===0&&this._messageInstancesById.delete(s),n.dispose();return}}}getEvents(t){if(!t)return;const s=this._messageInstancesById.get(t);if(s)return s}getEventId(t){if(!t)return-1;const s=t instanceof E?t.constructor:t,i=this._messageIdByEvent.get(s);return i||-1}getComposerId(t){if(!t)return-1;const s=this._messageIdByComposer.get(t.constructor);return s||-1}}class Ef extends Me{constructor(t,s){super(),this._communicationManager=t,this._stateListener=s,this._socket=null,this._messages=new gf,this._codec=new rf,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._stateListener&&this._stateListener.connectionInit(t),this.createSocket(t)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(t){t&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.addEventListener(De.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(De.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(De.CONNECTION_ERROR,this.onError),this._socket.addEventListener(De.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(De.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(De.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(De.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(De.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(t){this.dispatchConnectionEvent(jt.CONNECTION_OPENED,t)}onClose(t){this.dispatchConnectionEvent(jt.CONNECTION_CLOSED,t)}onError(t){this.dispatchConnectionEvent(jt.CONNECTION_ERROR,t)}onMessage(t){if(!t)return;const s=new FileReader;s.readAsArrayBuffer(t.data),s.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,s.result),this.processReceivedData()}}dispatchConnectionEvent(t,s){this.dispatchEvent(new jt(t,this,s))}authenticated(){this._isAuthenticated=!0}send(...t){if(this.disposed||!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...t),!1;for(const s of t){if(!s)continue;const i=this._messages.getComposerId(s);if(i===-1){G.packets("Unknown Composer",s.constructor.name);continue}const r=s.getMessageArray(),n=this._codec.encode(i,r);if(!n){G.packets("Encoding Failed",s.constructor.name);continue}G.packets("OutgoingComposer",i,s.constructor.name,r),this.write(n.getBuffer())}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){G.error(t)}}processData(){const t=this.splitReceivedMessages();if(!(!t||!t.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...t);return}this.processWrappers(...t)}}processWrappers(...t){if(!(!t||!t.length))for(const s of t){if(!s)continue;const i=this.getMessagesForWrapper(s);!i||!i.length||(G.packets("IncomingMessage",s.header,i[0].constructor.name,i[0].parser),this.handleMessages(...i))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(t,s){const i=new Uint8Array(t.byteLength+s.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(s),t.byteLength),i.buffer}getMessagesForWrapper(t){if(!t)return null;const s=this._messages.getEvents(t.header);if(!s||!s.length){G.packets("IncomingMessage",t.header,"UNREGISTERED",t);return}try{const i=new s[0].parserClass;if(!i||!i.flush()||!i.parse(t))return null;for(const r of s)r.parser=i}catch(i){return G.error("Error parsing message",i,s[0].constructor.name),null}return s}handleMessages(...t){t=[...t];for(const s of t)s&&(s.connection=this,s.callBack&&s.callBack(s))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){!t||!this._messages||this._messages.registerMessageEvent(t)}removeMessageEvent(t){!t||!this._messages||this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class ff extends Ie{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const t of this._connections.values())t&&t.dispose()}createConnection(t=null){const s=new Ef(this,t);if(s)return this._connections.push(s),s}update(t){let s=0;for(;s<this._connections.length;){const i=this._connections[s];if(i.processReceivedData(),this.disposed)return;i.disposed?this._connections.splice(s,1):s++}}}class Qs extends nt{constructor(t){super(t)}}Qs.LOADED="NCE_LOADED";Qs.FAILED="NCE_FAILED";class mf extends as{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){W.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=W.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent(Qs.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(t){if(!t||t===""){this.dispatchConfigurationEvent(Qs.FAILED);return}fetch(t).then(s=>s.json()).then(s=>this.onConfigurationLoaded(s,t)).catch(s=>this.onConfigurationFailed(s))}onConfigurationLoaded(t,s){if(t){if(W.parseConfiguration(t)){const i=this._pendingUrls.indexOf(s);i>=0&&this._pendingUrls.splice(i,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent(Qs.FAILED)}}onConfigurationFailed(t){this.dispatchConfigurationEvent(Qs.FAILED)}dispatchConfigurationEvent(t){this.events&&this.events.dispatchEvent(new Qs(t))}getDefaultConfig(){return NitroConfig}}const Lr=class{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`
 %c %c %c Nitro ${Lr.UI_VERSION} - Renderer ${Lr.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...e)}else self.console&&self.console.log(`Nitro ${Lr.UI_VERSION} - Renderer ${Lr.RENDERER_VERSION} `)}};let Pa=Lr;Pa.RENDERER_VERSION="1.6.6";Pa.UI_VERSION="";class If extends Ie{constructor(){super(),Pa.sayHello(),this._configuration=new mf,this._communication=new ff}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}class Rf{constructor(t){this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,t.animated!==void 0&&t.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class Tf{constructor(t){if(this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,t.params&&t.params.length>0)for(const s of t.params)s&&(s.id==="default"?this._defaultParameterValue=s.value:this._params.set(s.id,s.value));if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const i=new Rf(s);this._types.set(i.id,i)}}setOffsets(t,s,i){this._canvasOffsets||(this._canvasOffsets=new Map);let r=this._canvasOffsets.get(t);r||(r=new Map,this._canvasOffsets.set(t,r)),r.set(s,i)}getOffsets(t,s){if(!this._canvasOffsets)return null;const i=this._canvasOffsets.get(t);return i?i.get(s):null}getType(t){if(!t)return null;const s=this._types.get(parseInt(t));return s||null}getParameterValue(t){if(!t)return"";const s=this._params.get(t);return s||this._defaultParameterValue}getPrevents(t){return this._prevents.concat(this.getTypePrevents(t))}getTypePrevents(t){if(!t)return[];const s=this._types.get(parseInt(t));return s?s.prevents:[]}getPreventHeadTurn(t){if(!t)return this._preventHeadTurn;const s=this.getType(t);return s?s.preventHeadTurn:this._preventHeadTurn}isAnimated(t){if(!t)return!0;const s=this.getType(t);return s?s.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class yo{constructor(t,s="",i=0){this._actionType=t||"",this._actionParameter=s||"",this._definition=null,this._startFrame=i||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(t){this._actionParameter=t}get definition(){return this._definition}set definition(t){this._definition=t}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(t){this._overridingAction=t}}class pf{constructor(t,s){this._assets=t,this._actions=new Map,this._defaultAction=null,this.updateActions(s)}updateActions(t){if(t){for(const s of t.actions){if(!s||!s.state)continue;const i=new Tf(s);this._actions.set(i.state,i)}t.actionOffsets&&this.parseActionOffsets(t.actionOffsets)}}parseActionOffsets(t){if(!(!t||!t.length))for(const s of t){const i=this._actions.get(s.action);if(i)for(const r of s.offsets){const n=r.size||"",a=r.direction;if(n===""||a===void 0)continue;const o=r.x||0,u=r.y||0,l=r.z||0;i.setOffsets(n,a,[o,u,l])}}}getActionDefinition(t){if(!t)return null;for(const s of this._actions.values())if(!(!s||s.id!==t))return s;return null}getActionDefinitionWithState(t){const s=this._actions.get(t);return s||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(!(!t||!t.isDefault))return this._defaultAction=t,t;return null}getCanvasOffsets(t,s,i){let r=[];for(const n of t){if(!n)continue;const a=this._actions.get(n.actionType),o=a&&a.getOffsets(s,i);o&&(r=o)}return r}sortActions(t){if(!t)return null;t=this.filterActions(t);const s=[];for(const i of t){if(!i)continue;const r=this._actions.get(i.actionType);r&&(i.definition=r,s.push(i))}return s.sort(this.sortByPrecedence),s}filterActions(t){let s=[];const i=[];for(const r of t){if(!r)continue;const n=this._actions.get(r.actionType);n&&(s=s.concat(n.getPrevents(r.actionParameter)))}for(const r of t){if(!r)continue;let n=r.actionType;r.actionType==="fx"&&(n=n+("."+r.actionParameter)),!(s.indexOf(n)>=0)&&i.push(r)}return i}sortByPrecedence(t,s){if(!t||!s)return 0;const i=t.definition.precedence,r=s.definition.precedence;return i<r?1:i>r?-1:0}}class Of{constructor(t,s){this._name=t,this._link=s.link,this._flipH=s.flipH,this._flipV=s.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class Af{constructor(t,s){this._avatarRenderManager=t,this._aliases=new Map,this._assets=s,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const s=t.data&&t.data.aliases;if(s)for(const i in s){const r=s[i];r&&this._aliases.set(i,new Of(i,r))}}}hasAlias(t){return!!this._aliases.get(t)}getAssetName(t){let s=t,i=5;for(;this.hasAlias(s)&&i>=0;)s=this._aliases.get(s).link,i--;return s}getAsset(t){if(!this._assets)return null;t=this.getAssetName(t);const s=this._assets.getAsset(t);return s||null}}class Sf{constructor(t){this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const s=t.blend;s&&s.length>0&&(this._blend=parseInt(s),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}class we{constructor(t,s,i){if(this._id=t.id,this._animationFrame=t.frame||0,this._dx=t.dx||0,this._dy=t.dy||0,this._dz=t.dz||0,this._directionOffset=t.dd||0,this._type=s,this._base=t.base||"",this._items=new Map,t.items)for(const r of t.items)this._items.set(r.id,r.base);this._base!==""&&this.baseAsInt().toString(),i&&(this._action=new yo(i.state,this.base),this._action.definition=i)}get items(){return this._items}baseAsInt(){let t=0,s=0;for(;s<this._base.length;)t=t+this._base.charCodeAt(s),s++;return t}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}we.BODYPART="bodypart";we.FX="fx";class Mf{constructor(t){this._ink=t.ink;let s=t.foreground,i=t.background;s=s.replace("#",""),i=i.replace("#",""),this._foreGround=parseInt(s,16),this._backGround=parseInt(i,16),this._colorTransform=null,this._rgb=parseInt(s,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new zE({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(t,s){const i=t>>24&255,r=t>>16&255,n=t>>8&255,a=t>>0&255,o=s>>24&255,u=s>>16&255,l=s>>8&255,c=s>>0&255,g=(o-i)/255,f=(u-r)/255,R=(l-n)/255,m=(c-a)/255,T=new Map,O=[],C=[],N=[];let S=i,D=r,v=n,b=a;for(let w=0;w<256;w++)D==r&&v==n&&b==a&&(S=0),S=S+g,D=D+f,v=v+R,b=b+m,O.push(S<<24|D<<16|v<<8|b),C.push(S<<24|D<<16|v<<8|b),N.push(S<<24|D<<16|v<<8|b);return T.set("alphas",O),T.set("reds",O),T.set("greens",C),T.set("blues",N),T}}class Cf{constructor(t){this._offset=t.offset}get offset(){return this._offset}}class Nf{constructor(t,s){this._animation=t,this._id=s.id,this._ink=s.ink,this._member=s.member,this._hasStaticY=!!s.staticY,this._hasDirections=!!s.directions,this._dx=[],this._dy=[],this._dz=[];const i=s.directionList;if(i&&i.length)for(const r of i){const n=r.id;n!==void 0&&(this._dx[n]=r.dx||0,this._dy[n]=r.dy||0,this._dz[n]=r.dz||0)}}getDirectionOffsetX(t){return t<this._dx.length?this._dx[t]:0}getDirectionOffsetY(t){return t<this._dy.length?this._dy[t]:0}getDirectionOffsetZ(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const wn=class{constructor(e,t){if(this._id=t.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=t.resetOnToggle||!1,t.sprites&&t.sprites.length){this._spriteData=[];for(const s of t.sprites)this._spriteData.push(new Nf(this,s))}if(t.avatars&&t.avatars.length&&(this._avatarData=new Mf(t.avatars[0])),t.directions&&t.directions.length&&(this._directionData=new Cf(t.directions[0])),t.removes&&t.removes.length){this._removeData=[];for(const s of t.removes)this._removeData.push(s.id)}if(t.adds&&t.adds.length){this._addData=[];for(const s of t.adds)this._addData.push(new Sf(s))}if(t.overrides&&t.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of t.overrides){const i=s.name,r=s.override;this._overriddenActions.set(r,i);const n=[];this.parseFrames(n,s.frames,e),this._overrideFrames.set(i,n)}}this.parseFrames(this._frames,t.frames,e)}parseFrames(e,t,s){if(!(!t||!t.length))for(const i of t){let r=1;i.repeats&&i.repeats>1&&(r=i.repeats);let n=0;for(;n<r;){const a=[];if(i.bodyparts&&i.bodyparts.length)for(const o of i.bodyparts){const u=s.getActionDefinition(o.action),l=new we(o,we.BODYPART,u);a.push(l)}if(i.fxs&&i.fxs.length)for(const o of i.fxs){const u=s.getActionDefinition(o.action),l=new we(o,we.FX,u);a.push(l)}e.push(a),n++}}}frameCount(e=null){if(!e)return this._frames.length;if(this._overrideFrames){const t=this._overrideFrames.get(e);if(t)return t.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const e=[];for(const t of this._overriddenActions.keys())e.push(t);return e}overridingAction(e){return this._overriddenActions?this._overriddenActions.get(e):null}getFrame(e,t=null){e<0&&(e=0);let s=[];if(!t)this._frames.length>0&&(s=this._frames[e%this._frames.length]);else{const i=this._overrideFrames.get(t);i&&i.length>0&&(s=i[e%i.length])}return s}getAnimatedBodyPartIds(e,t=null){const s=[];for(const i of this.getFrame(e,t))if(i.type===we.BODYPART)s.push(i.id);else if(i.type===we.FX&&this._addData&&this._addData.length)for(const r of this._addData)r.id===i.id&&s.push(r.align);return s}getLayerData(e,t,s=null){for(const i of this.getFrame(e,s)){if(i.id===t)return i;if(i.type===we.FX&&this._addData&&this._addData.length){for(const r of this._addData)if(r.align===t&&r.id===i.id)return i}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(e){if(this._addData){for(const t of this._addData)if(t.id===e)return t}return null}get id(){return this._id}get spriteData(){return this._spriteData||wn.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||wn.EMPTY_ARRAY}get addData(){return this._addData||wn.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};let Tl=wn;Tl.EMPTY_ARRAY=[];class Df{constructor(){this._animations=new Map}registerAnimation(t,s){if(!s)return!1;const i=s[Object.keys(s)[0]],r=new Tl(t,i);return this._animations.set(i.name,r),!0}getAnimation(t){const s=this._animations.get(t);return s||null}getLayerData(t,s,i){const r=this.getAnimation(t);return r?r.getLayerData(s,i):null}get animations(){return this._animations}}const ls=class extends Me{constructor(e,t,s,i){super(),this._state=ls.NOT_LOADED,this._libraryName=e,this._revision=t,this._downloadUrl=i,this._assets=s,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=ls.LOADED)}async downloadAsset(){if(!this._assets||this._state===ls.LOADING||this._state===ls.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=ls.LOADED,this.dispatchEvent(new tr(tr.DOWNLOAD_COMPLETE,this));return}this._state=ls.LOADING,await this._assets.downloadAsset(this._downloadUrl)&&(this._state=ls.LOADED,this.dispatchEvent(new tr(tr.DOWNLOAD_COMPLETE,this)))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===ls.LOADED}};let nn=ls;nn.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE";nn.NOT_LOADED=0;nn.LOADING=1;nn.LOADED=2;const Lo=class extends Me{constructor(e,t){super(),this._assets=e,this._structure=t,this._missingMandatoryLibs=W.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(Da.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const e=new XMLHttpRequest;try{e.open("GET",W.getValue("avatar.figuremap.url")),e.send(),e.onloadend=t=>{if(e.responseText){const s=JSON.parse(e.responseText);this.processFigureMap(s.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new nt(Lo.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_figure_map")}}catch(t){G.error(t)}}processFigureMap(e){if(e)for(const t of e){if(!t)continue;const s=t.id,i=t.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const r=new nn(s,i,this._assets,W.getValue("avatar.asset.url"));r.addEventListener(tr.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const n of t.parts){const a=n.id,u=n.type+":"+a;let l=this._figureMap.get(u);l||(l=[]),l.push(r),this._figureMap.set(u,l)}}}onAvatarRenderReady(e){if(e){for(const[t,s]of this._pendingContainers)this.downloadAvatarFigure(t,s);this._pendingContainers=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const t=[];for(const[i,r]of this._incompleteFigures.entries()){let n=!0;for(const a of r)if(!(!a||a.isLoaded)){n=!1;break}if(n){t.push(i);const a=this._figureListeners.get(i);if(a)for(const o of a)!o||o.disposed||o.resetFigure(i);this._figureListeners.delete(i),this.dispatchEvent(new nt(Lo.LIBRARY_LOADED))}}for(const i of t)i&&this._incompleteFigures.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===e.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const e=this._missingMandatoryLibs.slice();for(const t of e){if(!t)continue;const s=this._figureMap.get(t);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarFigureContainerReady(e){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(e).length}getAvatarFigurePendingLibraries(e){const t=[];if(!e||!this._structure)return t;const s=this._structure.figureData;if(!s)return t;const i=e.getPartTypeIds();for(const r of i){const n=s.getSetType(r);if(!n)continue;const a=n.getPartSet(e.getPartSetId(r));if(a)for(const o of a.parts){if(!o)continue;const u=o.type+":"+o.id,l=this._figureMap.get(u);if(l!==void 0)for(const c of l)!c||c.isLoaded||t.indexOf(c)>=0||t.push(c)}}return t}downloadAvatarFigure(e,t){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([e,t]);return}const s=e.getFigureString(),i=this.getAvatarFigurePendingLibraries(e);if(i&&i.length){if(t&&!t.disposed){let r=this._figureListeners.get(s);r||(r=[],this._figureListeners.set(s,r)),r.push(t)}this._incompleteFigures.set(s,i);for(const r of i)r&&this.downloadLibrary(r)}else t&&!t.disposed&&t.resetFigure(s)}downloadLibrary(e){!e||e.isLoaded||this._pendingDownloadQueue.indexOf(e)>=0||this._currentDownloads.indexOf(e)>=0||(this._pendingDownloadQueue.push(e),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};let Js=Lo;Js.DOWNLOADER_READY="AADM_DOWNLOADER_READY";Js.LIBRARY_LOADED="AADM_LIBRARY_LOADED";Js.MAX_DOWNLOADS=2;class Hn{constructor(t){this._parts=new Map,this.parseFigure(t)}getPartTypeIds(){return this.partSets().keys()}hasPartType(t){return!!this.partSets().get(t)}getPartSetId(t){const s=this.partSets().get(t);return s?s.get("setid"):0}getPartColorIds(t){const s=this.partSets().get(t);return s?s.get("colorids"):null}updatePart(t,s,i){const r=new Map;r.set("type",t),r.set("setid",s),r.set("colorids",i);const n=this.partSets();n.delete(t),n.set(t,r)}removePart(t){this.partSets().delete(t)}getFigureString(){const t=[];for(const s of this.partSets().keys()){if(!s)continue;let i=[];i.push(s),i.push(this.getPartSetId(s)),i=i.concat(this.getPartColorIds(s)),t.push(i.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const s of t.split(".")){const i=s.split("-");if(i.length>=2){const r=i[0],n=parseInt(i[1]),a=[];let o=2;for(;o<i.length;)a.push(parseInt(i[o])),o++;this.updatePart(r,n,a)}}}}class Pf{constructor(){this._cache=new Map,this.setLastAccessTime(Z())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache.clear()}}getDirectionCache(t){const s=this._cache.get(t.toString());return s||null}updateDirectionCache(t,s){this._cache.set(t.toString(),s)}setLastAccessTime(t){this._lastAccessTime=t}getLastAccessTime(){return this._lastAccessTime}debugInfo(t){}}class jh{constructor(){this._cache=new Map}setAction(t,s){this._currentAction||(this._currentAction=t);const i=this.getActionCache(this._currentAction);i&&i.setLastAccessTime(s),this._currentAction=t}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(t,s){if(!(!this._cache||this._disposed))for(const[i,r]of this._cache.entries()){if(!r)continue;const n=r.getLastAccessTime();s-n>=t&&(r.dispose(),this._cache.delete(i))}}getAction(){return this._currentAction}setDirection(t){this._currentDirection=t}getDirection(){return this._currentDirection}getActionCache(t=null){return this._currentAction?(t||(t=this._currentAction),t.overridingAction?this._cache.get(t.overridingAction):this._cache.get(t.id)):null}updateActionCache(t,s){t.overridingAction?this._cache.set(t.overridingAction,s):this._cache.set(t.id,s)}debugInfo(t){}}class yf{constructor(t,s,i){this._image=t,this._regPoint=s,this._offset=new Y(0,0),this._regPoint=s,this._isCacheable=i,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(t){this._regPoint=t,this.cleanPoints()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get regPoint(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class Lf{constructor(t){this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(t){const s=this._images.get(this.getCacheKey(t));return s||null}updateImageContainer(t,s){const i=this.getCacheKey(s),r=this._images.get(i);r&&r.dispose(),this._images.set(i,t)}getCacheKey(t){let s="";for(const i of this._partList)s+=i.getCacheableKey(t)+"/";return s}debugInfo(t){}}class Yh{constructor(t,s,i,r,n,a=null){this._texture=t,this._container=a,this._rect=s,this._regPoint=i,this._flipH=r,this._colorTransform=n,r&&(this._regPoint.x=-this._regPoint.x+s.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new fe(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}class pl{constructor(t,s,i,r){this._structure=t,this._avatar=s,this._assets=i,this._scale=r,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new ue,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}disposeInactiveActions(t=6e4){const s=Z();if(this._cache)for(const i of this._cache.values())i&&i.disposeActions(t,s)}resetBodyPartCache(t){if(this._cache)for(const s of this._cache.values())s&&s.setAction(t,0)}setDirection(t,s){const i=this._structure.getBodyPartsUnordered(t);if(i)for(const r of i){const n=this.getBodyPartCache(r);n&&n.setDirection(s)}}setAction(t,s){const i=this._structure.getActiveBodyPartIds(t,this._avatar);for(const r of i){const n=this.getBodyPartCache(r);n&&n.setAction(t,s)}}setGeometryType(t){if(this._geometryType!==t){if(this._geometryType===Ve.SITTING&&t===Ve.VERTICAL||this._geometryType===Ve.VERTICAL&&t===Ve.SITTING||this._geometryType===Ve.SNOWWARS_HORIZONTAL&&(t=Ve.SNOWWARS_HORIZONTAL)){this._geometryType=t,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=t,this._canvas=null}}getImageContainer(t,s,i=!1){let r=this.getBodyPartCache(t);r||(r=new jh,this._cache.set(t,r));let n=r.getDirection(),a=r.getAction(),o=s;a.definition.startFromFrameZero&&(o-=a.startFrame);let u=a,l=[],c=new Map;const g=new Y;if(!(!a||!a.definition)&&a.definition.isAnimation){let O=n;const C=this._structure.getAnimation(a.definition.state+"."+a.actionParameter),N=s-a.startFrame;if(C){const S=C.getLayerData(N,t,a.overridingAction);S&&(O=n+S.dd,S.dd<0?O<0?O=8+O:O>7&&(O=8-O):O<0?O=O+8:O>7&&(O=O-8),this._scale===ss.LARGE?(g.x=S.dx,g.y=S.dy):(g.x=S.dx/2,g.y=S.dy/2),o=S.animationFrame,S.action&&(a=S.action),S.type===we.BODYPART?(S.action!=null&&(u=S.action),n=O):S.type===we.FX&&(n=O),c=S.items),l=C.removeData}}let f=r.getActionCache(u);(!f||i)&&(f=new Pf,r.updateActionCache(u,f));let R=f.getDirectionCache(n);if(!R||i){const O=this._structure.getParts(t,this._avatar.getFigure(),u,this._geometryType,n,l,this._avatar,c);R=new Lf(O),f.updateDirectionCache(n,R)}let m=R.getImageContainer(o);if(!m||i){const O=R.getPartList();if(m=this.renderBodyPart(n,O,o,a,i),m&&!i)m.isCacheable&&R.updateImageContainer(m,o);else return null}const T=this._structure.getFrameBodyPartOffset(u,n,o,t);return g.x+=T.x,g.y+=T.y,m.offset=g,m}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(t){let s=this._cache.get(t);return s||(s=new jh,this._cache.set(t,s)),s}renderBodyPart(t,s,i,r,n=!1){if(!s||!s.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const a=es.DIRECTION_IS_FLIPPED[t]||!1;let o=r.definition.assetPartDefinition,u=!0,l=s.length-1;for(;l>=0;){const m=s[l];let T=16777215;if(!(t==7&&(m.partType==="fc"||m.partType==="ey"))&&!(m.partType==="ri"&&!m.partId)){const O=m.partId,C=m.getFrameDefinition(i);let N=m.partType,S=0;C?(S=C.number,C.assetPartDefinition&&C.assetPartDefinition!==""&&(o=C.assetPartDefinition)):S=m.getFrameIndex(i);let D=t,v=!1;a&&(o==="wav"&&(N===_t.LEFT_HAND||N===_t.LEFT_SLEEVE||N===_t.LEFT_COAT_SLEEVE)||o==="drk"&&(N===_t.RIGHT_HAND||N===_t.RIGHT_SLEEVE||N===_t.RIGHT_COAT_SLEEVE)||o==="blw"&&N===_t.RIGHT_HAND||o==="sig"&&N===_t.LEFT_HAND||o==="respect"&&N===_t.LEFT_HAND||N===_t.RIGHT_HAND_ITEM||N===_t.LEFT_HAND_ITEM||N===_t.CHEST_PRINT?v=!0:(t===4?D=2:t===5?D=1:t===6&&(D=0),m.flippedPartType!==N&&(N=m.flippedPartType)));let b=this._scale+"_"+o+"_"+N+"_"+O+"_"+D+"_"+S,w=this._assets.getAsset(b);if(w||(b=this._scale+"_std_"+N+"_"+O+"_"+D+"_0",w=this._assets.getAsset(b)),w){const Q=w.texture;if(!Q||!Q.valid||!Q.baseTexture)u=!1;else{m.isColorable&&m.color&&(T=m.color.rgb);const $=new Y(-w.x,-w.y);if(v&&($.x=$.x+(this._scale===ss.LARGE?65:31)),n){const X=new Au;X.name=this._assets.getAssetName(b),X.x=-$.x-33,X.y=-$.y,X.z=this._serverRenderData.length*-1e-4,X.width=w.rectangle.width,X.height=w.rectangle.height,X.flipH=v,o==="lay"&&(X.x=X.x+53),a&&(X.flipH=!X.flipH,X.flipH?X.x=-X.x-Q.width:X.x=X.x+65),m.isColorable&&(X.color=`${T}`),this._serverRenderData.push(X)}this._unionImages.push(new Yh(Q,w.rectangle,$,v,T))}}}l--}if(!this._unionImages.length)return null;const c=this.createUnionImage(this._unionImages,a),g=this._scale===ss.LARGE?this._canvas.height-16:this._canvas.height-8,f=new Y(-c.regPoint.x,g-c.regPoint.y);a&&o!=="lay"&&(f.x=f.x+(this._scale===ss.LARGE?67:31));let R=this._unionImages.length-1;for(;R>=0;){const m=this._unionImages.pop();m&&m.dispose(),R--}return new yf(c.container,f,u)}convertColorToHex(t){let s=(t*255).toString(16);return s.length<2&&(s="0"+s),s}createUnionImage(t,s){const i=new fe;for(const o of t)o&&i.enlarge(o.offsetRect);const r=new Y(-i.x,-i.y),n=new je,a=new Pt(Dt.EMPTY);a.width=i.width,a.height=i.height,n.addChild(a);for(const o of t){if(!o)continue;const u=o.texture,l=o.colorTransform,c=!(s&&o.flipH)&&(s||o.flipH),g=r.clone();g.x-=o.regPoint.x,g.y-=o.regPoint.y,s&&(g.x=n.width-(g.x+o.rect.width)),c?(this._matrix.a=-1,this._matrix.tx=o.rect.x+o.rect.width+g.x,this._matrix.ty=g.y-o.rect.y):(this._matrix.a=1,this._matrix.tx=g.x-o.rect.x,this._matrix.ty=g.y-o.rect.y);const f=new Pt(u);f.tint=l,f.transform.setFromMatrix(this._matrix),n.addChild(f)}return new Yh(null,n.getLocalBounds(),r,s,null,n)}}pl.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;const cs=class{constructor(e,t,s,i,r,n=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=r,this._structure=e,this._assets=t,this._scale=i,this._effectListener=n,this._scale==null&&(this._scale=ss.LARGE),s==null&&(s=new Hn("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=s,this._cache=new pl(this._structure,this,this._assets,this._scale),this.setDirection(cs.DEFAULT_AVATAR_SET,cs.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new yo(P.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(cs.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new Gt,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(ee.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const e of this._fullImageCache.getValues())e&&e.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(e){return this._structure.getPartColor(this._figure,e)}setDirection(e,t){t=t+this._directionOffset,t<es.MIN_DIRECTION&&(t=es.MAX_DIRECTION+(t+1)),t>es.MAX_DIRECTION&&(t=t-(es.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(e)&&(this._mainDirection=t),(e===ee.HEAD||e===ee.FULL)&&(e===ee.HEAD&&this.isHeadTurnPreventedByAction()&&(t=this._mainDirection),this._headDirection=t),this._cache.setDirection(e,t),this._changes=!0}setDirectionAngle(e,t){this.setDirection(e,Math.floor(t/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(e){return this._structure.getBodyPartData(e.animation.id,this._frameCounter,e.id)}updateAnimationByFrames(e=1){this._frameCounter+=e,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const e of this._sortedActions){if(e.actionType=="fx"&&(e.actionParameter=="33"||e.actionParameter=="34"||e.actionParameter=="35"||e.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(e.actionType=="fx"&&(e.actionParameter=="38"||e.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(e.actionType==="dance"&&(e.actionParameter==="1"||e.actionParameter==="2"||e.actionParameter==="3"||e.actionParameter==="4")){let t=this._frameCounter%8;return e.actionParameter==="3"&&(t=this._frameCounter%10),e.actionParameter==="4"&&(t=this._frameCounter%16),this._mainDirection+e.actionType+e.actionParameter+t}}return null}getBodyParts(e,t,s){return(s!=this._cachedBodyPartsDirection||t!=this._cachedBodyPartsGeometryType||e!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=t,this._cachedBodyPartsAvatarSet=e,this._cachedBodyParts=this._structure.getBodyParts(e,t,s)),this._cachedBodyParts}getAvatarPartsForCamera(e){let t;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const i=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection);let r=i.length-1;for(;r>=0;)t=i[r],this._cache.getImageContainer(t,this._frameCounter,!0),r--}getImage(e,t,s=1,i=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const r=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!r)return null;this._image&&(this._image.width!==r.width||this._image.height!==r.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const n=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const a=new je;let o=!0,u=n.length-1;for(;u>=0;){const l=n[u],c=this._cache.getImageContainer(l,this._frameCounter);if(c){const g=c.image;if(!g)return a.destroy({children:!0}),null;o=o&&c.isCacheable;const f=c.regPoint.clone();if(f){f.x+=r.offset.x,f.y+=r.offset.y,f.x+=r.regPoint.x,f.y+=r.regPoint.y;const R=new je;R.addChild(g),R&&(R.position.set(f.x,f.y),a.addChild(R))}}u--}return this._avatarSpriteData&&(a.filters||(a.filters=[]),this._avatarSpriteData.colorTransform&&a.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(a),a.filters.push(new hr(this._avatarSpriteData.reds,hr.CHANNEL_RED)))),i?(this._reusableTexture?(Yt.instance.renderer.render(a,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=Ot.generateTexture(a,new fe(0,0,r.width,r.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):Ot.generateTexture(a,new fe(0,0,r.width,r.height))}applyPalette(e,t=[],s=[],i=[]){const r=Ot.generateCanvas(e),n=r.getContext("2d"),a=n.getImageData(0,0,r.width,r.height),o=a.data;for(let l=0;l<o.length;l+=4){if(t.length==256){let c=t[o[l]];c===void 0&&(c=0),o[l]=c>>16&255,o[l+1]=c>>8&255,o[l+2]=c&255}if(s.length==256){let c=s[o[l+1]];c===void 0&&(c=0),o[l]=c>>16&255,o[l+1]=c>>8&255,o[l+2]=c&255}if(i.length==256){let c=s[o[l+2]];c===void 0&&(c=0),o[l]=c>>16&255,o[l+1]=c>>8&255,o[l+2]=c&255}}n.putImageData(a,0,0);const u=new Nt(Dt.from(r));return Yt.instance.renderer.render(u,{renderTexture:e,clear:!0}),e}getImageAsSprite(e,t=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),r=new Pt,n=new Pt(Dt.EMPTY);n.width=s.width,n.height=s.height,r.addChild(n);let a=i.length-1;for(;a>=0;){const o=i[a],u=this._cache.getImageContainer(o,this._frameCounter);if(u){const l=u.image;if(!l)return r.destroy({children:!0}),null;const c=u.regPoint.clone();if(c){c.x+=s.offset.x,c.y+=s.offset.y,c.x+=s.regPoint.x,c.y+=s.regPoint.y;const g=new je;g.addChild(l),g.position.set(c.x,c.y),r.addChild(g)}}a--}return r}getCroppedImage(e,t=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),r=new je;let n=i.length-1;for(;n>=0;){const u=i[n],l=this._cache.getImageContainer(u,this._frameCounter);if(l){const c=l.image;if(!c)return r.destroy({children:!0}),null;const g=l.regPoint.clone();if(g){g.x+=s.offset.x,g.y+=s.offset.y,g.x+=s.regPoint.x,g.y+=s.regPoint.y;const f=new je;f.addChild(c),f&&(f.position.set(g.x,g.y),r.addChild(f))}}n--}const a=Ot.generateTexture(r,new fe(0,0,s.width,s.height)),o=Ot.generateImage(a);return o||null}getFullImage(e){const t=this._fullImageCache.getValue(e);return t?(t.valid||(this._fullImageCache.remove(e),t.destroy(!0)),t):null}cacheFullImage(e,t){const s=this._fullImageCache.getValue(e);if(s&&(this._fullImageCache.remove(e),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const i=this._fullImageCache.getKey(0);i&&this._fullImageCache.remove(i).destroy(!0)}this._fullImageCache.add(e,t)}getAsset(e){return this._assets.getAsset(e)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const e of this._sortedActions)e.actionType===P.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(e.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(e.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(e,...t){let s="";switch(this._actionsSorted=!1,t&&t.length>0&&(s=t[0]),s!=null&&(s=s.toString()),e){case P.POSTURE:switch(s){case P.POSTURE_LAY:case P.POSTURE_WALK:case P.POSTURE_STAND:case P.POSTURE_SWIM:case P.POSTURE_FLOAT:case P.POSTURE_SIT:case P.SNOWWAR_RUN:case P.SNOWWAR_DIE_FRONT:case P.SNOWWAR_DIE_BACK:case P.SNOWWAR_PICK:case P.SNOWWAR_THROW:(s===P.POSTURE_LAY||s===P.POSTURE_LAY||s===P.POSTURE_LAY)&&(s===P.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(ee.FULL,4):this.setDirection(ee.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(s);break}break;case P.GESTURE:switch(s){case P.GESTURE_AGGRAVATED:case P.GESTURE_SAD:case P.GESTURE_SMILE:case P.GESTURE_SURPRISED:this.addActionData(s);break}break;case P.EFFECT:case P.DANCE:case P.TALK:case P.EXPRESSION_WAVE:case P.SLEEP:case P.SIGN:case P.EXPRESSION_RESPECT:case P.EXPRESSION_BLOW_A_KISS:case P.EXPRESSION_LAUGH:case P.EXPRESSION_CRY:case P.EXPRESSION_IDLE:case P.EXPRESSION_SNOWBOARD_OLLIE:case P.EXPRESSION_SNOWBORD_360:case P.EXPRESSION_RIDE_JUMP:s===P.EFFECT&&(s==="33"||s==="34"||s==="35"||s==="36"||s==="38"||s==="39")&&(this._useFullImageCache=!0),this.addActionData(e,s);break;case P.CARRY_OBJECT:case P.USE_OBJECT:{const i=this._structure.getActionDefinitionWithState(e);i&&(s=i.getParameterValue(s)),this.addActionData(e,s);break}}return!0}addActionData(e,t=""){let s;this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(s=this._actions[i],s.actionType==e&&s.actionParameter==t)return;i++}this._actions.push(new yo(e,t,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let e,t;if(this._sortedActions==null)return!1;for(const s of this._sortedActions)e=this._structure.getActionDefinitionWithState(s.actionType),e!=null&&e.getPreventHeadTurn(s.actionParameter)&&(t=!0);return t}sortActions(){let e,t,s;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(s=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const i of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(i.actionType+i.actionParameter),i.actionType===P.EFFECT){const r=parseInt(i.actionParameter);this._effectIdInUse!==r&&(e=!0),this._effectIdInUse=r,t=!0}t||(this._effectIdInUse>-1&&(e=!0),this._effectIdInUse=-1),e&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,s}setActionsToParts(){if(!this._sortedActions==null)return;const e=Z(),t=[];for(const s of this._sortedActions)t.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);if(i&&i.hasOverriddenActions()){const r=i.overriddenActionNames();if(r)for(const n of r)t.indexOf(n)>=0&&(s.overridingAction=i.overridingAction(n))}i&&i.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(!(!s||!s.definition)&&(s.definition.isAnimation&&s.actionParameter===""&&(s.actionParameter="1"),this.setActionToParts(s,e),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);i&&(this._sprites=this._sprites.concat(i.spriteData),i.hasDirectionData()&&(this._directionOffset=i.directionData.offset),i.hasAvatarData()&&(this._avatarSpriteData=i.avatarData))}}setActionToParts(e,t){e==null||e.definition==null||e.definition.assetPartDefinition!=""&&(e.definition.isMain&&(this._mainAction=e,this._cache.setGeometryType(e.definition.geometryType)),this._cache.setAction(e,t),this._changes=!0)}resetBodyPartCache(e){e&&e.definition.assetPartDefinition!==""&&(e.definition.isMain&&(this._mainAction=e,this._cache.setGeometryType(e.definition.geometryType)),this._cache.resetBodyPartCache(e),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(e,t="CHANNELS_EQUAL"){let s=.33,i=.33,r=.33;switch(t){case cs.CHANNELS_UNIQUE:s=.3,i=.59,r=.11;break;case cs.CHANNELS_RED:s=1,i=0,r=0;break;case cs.CHANNELS_GREEN:s=0,i=1,r=0;break;case cs.CHANNELS_BLUE:s=0,i=0,r=1;break;case cs.CHANNELS_DESATURATED:s=.3086,i=.6094,r=.082;break}const n=new _u;return n.matrix=[s,i,r,0,0,s,i,r,0,0,s,i,r,0,0,0,0,0,1,0],e.filters.push(n),e}errorThis(e){}logThis(e){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(e){e===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(e))}};let Xe=cs;Xe.CHANNELS_EQUAL="CHANNELS_EQUAL";Xe.CHANNELS_UNIQUE="CHANNELS_UNIQUE";Xe.CHANNELS_RED="CHANNELS_RED";Xe.CHANNELS_GREEN="CHANNELS_GREEN";Xe.CHANNELS_BLUE="CHANNELS_BLUE";Xe.CHANNELS_DESATURATED="CHANNELS_DESATURATED";Xe.DEFAULT_ACTION="Default";Xe.DEFAULT_DIRECTION=2;Xe.DEFAULT_AVATAR_SET=ee.FULL;class Vn{constructor(t){this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class Uf{constructor(t){if(this._frames=[],t.frames&&t.frames.length>0)for(const s of t.frames){if(!s)continue;this._frames.push(new Vn(s));let i=s.repeats||0;if(i>1)for(;--i>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const jn=class{constructor(e){if(this._id=e.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],e.parts&&e.parts.length>0)for(const t of e.parts){if(!t)continue;const s=new Uf(t);this._actionParts.set(t.setType,s),this._frameCount=Math.max(this._frameCount,s.frames.length)}if(e.offsets&&e.offsets.frames&&e.offsets.frames.length>0)for(const t of e.offsets.frames){if(!t)continue;const s=t.id;this._frameCount=Math.max(this._frameCount,s);const i=new Map;if(this._bodyPartOffsets.set(s,i),t.directions&&t.directions.length>0)for(const r of t.directions){if(!r)continue;const n=r.id,a=new Map;if(i.set(n,a),r.bodyParts&&r.bodyParts.length>0)for(const o of r.bodyParts){if(!o)continue;const u=o.id;let l=0,c=0;o.dx!==void 0&&(l=o.dx),o.dy!==void 0&&(c=o.dy),a.set(u,new Y(l,c))}}if(this._frameIndexes.push(s),t.repeats!==void 0){let r=t.repeats||0;if(r>1)for(;--r>0;)this._frameIndexes.push(s)}}}getPart(e){if(!e)return null;const t=this._actionParts.get(e);return t||null}getFrameBodyPartOffset(e,t,s){const i=t%this._frameIndexes.length,r=this._frameIndexes[i],n=this._bodyPartOffsets.get(r);if(!n)return jn.DEFAULT_OFFSET;const a=n.get(e);if(!a)return jn.DEFAULT_OFFSET;const o=a.get(s);return o||jn.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};let sa=jn;sa.DEFAULT_OFFSET=new Y(0,0);class vf{constructor(){this._actions=new Map}parse(t){if(t&&t.length>0)for(const s of t){if(!s)continue;const i=new sa(s);this._actions.set(i.id,i)}return!0}appendJSON(t){for(const s of t.action)this._actions.set(s.id,new sa(s));return!0}getAction(t){const s=this._actions.get(t.id);return s||null}getFrameCount(t){const s=this.getAction(t);return s?s.frameCount:0}}class bf{constructor(t,s){this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new Y(t.dx,t.dy),s==ss.LARGE?this._regPoint=new Y((this._width-64)/2,0):this._regPoint=new Y((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}const Ol=class extends Me{constructor(e,t){super(),this._dataReceiver=t,this.download(e)}download(e){const t=new XMLHttpRequest;try{t.open("GET",e),t.send(),t.onloadend=s=>{const i=t.responseText;if(!i||!i.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(i)),this.dispatchEvent(new nt(Ol.AVATAR_STRUCTURE_DONE))},t.onerror=s=>{throw new Error("invalid_avatar_figure_data")}}catch(s){G.error(s)}}};let Uo=Ol;Uo.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";class Ff{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._type=t.type,this._index=t.index,this._colorLayerIndex=t.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class xf{constructor(t,s){if(!t||!s)throw new Error("invalid_data");this._id=s.id,this._type=t,this._gender=s.gender,this._clubLevel=s.club,this._isColorable=s.colorable,this._isSelectable=s.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=s.preselectable,this._isSellable=s.sellable;for(const i of s.parts){const r=new Ff(i),n=this.getPartIndex(r);n!==-1?this._parts.splice(n,0,r):this._parts.push(r)}if(s.hiddenLayers)for(const i of s.hiddenLayers)this._hiddenLayers.push(i.partType)}dispose(){for(const t of this._parts)t.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(t){const s=this._parts.length;if(!s)return-1;for(let i=0;i<s;i++){const r=this._parts[i];if(r&&!(r.type!==t.type||r.index>t.index))return i}return-1}getPart(t,s){for(const i of this._parts)if(!(i.type!==t||i.id!==s))return i;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class Gf{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._index=t.index,this._clubLevel=t.club||0,this._isSelectable=t.selectable,this._rgb=parseInt("0x"+t.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class zh{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._colors=new Gt,this.append(t)}append(t){for(const s of t.colors){const i=new Gf(s);this._colors.add(s.id.toString(),i)}}getColor(t){return t===void 0||t<0?null:this._colors.getValue(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class ao{constructor(t){if(!t)throw new Error("invalid_data");this._type=t.type,this._paletteId=t.paletteId,this._isMandatory={},this._isMandatory.F=[t.mandatory_f_0,t.mandatory_f_1],this._isMandatory.M=[t.mandatory_m_0,t.mandatory_m_1],this._partSets=new Gt,this.append(t)}dispose(){for(const t of this._partSets.getValues())t.dispose();this._partSets=null}cleanUp(t){for(const s of t.sets){const i=s.id.toString(),r=this._partSets.getValue(i);r&&(r.dispose(),this._partSets.remove(i))}}append(t){if(!(!t||!t.sets))for(const s of t.sets)this._partSets.add(s.id.toString(),new xf(this._type,s))}getDefaultPartSet(t){for(const s of this._partSets.getValues())if(s&&s.clubLevel===0&&(s.gender===t||s.gender==="U"))return s;return null}getPartSet(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(t,s){return this._isMandatory[t.toUpperCase()][Math.min(s,1)]}optionalFromClubLevel(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class Bf{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const s of t.palettes){const i=new zh(s);i&&this._palettes.set(i.id.toString(),i)}for(const s of t.setTypes){const i=new ao(s);i&&this._setTypes.set(i.type,i)}return!0}injectJSON(t){for(const s of t.setTypes){const i=this._setTypes.get(s.type);i?i.cleanUp(s):this._setTypes.set(s.type,new ao(s))}this.appendJSON(t)}appendJSON(t){if(!t)return!1;for(const s of t.palettes){const i=s.id.toString(),r=this._palettes.get(i);r?r.append(s):this._palettes.set(i,new zh(s))}for(const s of t.setTypes){const i=s.type,r=this._setTypes.get(i);r?r.append(s):this._setTypes.set(i,new ao(s))}return!1}getMandatorySetTypeIds(t,s){const i=[];for(const r of this._setTypes.values())!r||!r.isMandatory(t,s)||i.push(r.type);return i}getDefaultPartSet(t,s){const i=this._setTypes.get(t);return i?i.getDefaultPartSet(s):null}getSetType(t){return this._setTypes.get(t)||null}getPalette(t){return this._palettes.get(t.toString())||null}getFigurePartSet(t){for(const s of this._setTypes.values()){const i=s.getPartSet(t);if(i)return i}return null}}class Wh{constructor(t){if(this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const s of t.activeParts)s&&this._parts.push(s.setType)}get parts(){return this._parts}}class oo{constructor(t){if(!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(t){this._staticId=t}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(t){this._flippedSetType=t}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(t){this._appendToFigure=t}}class wf{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const s of t.partSet)s&&this._parts.set(s.setType,new oo(s));if(t.activePartSets&&t.activePartSets.length>0)for(const s of t.activePartSets)s&&this._activePartSets.set(s.id,new Wh(s));return!0}appendJSON(t){if(t.partSet&&t.partSet.length>0)for(const s of t.partSet)s&&this._parts.set(s.setType,new oo(s));if(t.activePartSets&&t.activePartSets.length>0)for(const s of t.activePartSets)s&&this._activePartSets.set(s.id,new Wh(s));return!1}getActiveParts(t){const s=this._activePartSets.get(t.activePartSet);return s?s.parts:[]}getPartDefinition(t){const s=this._parts.get(t);return s||null}addPartDefinition(t){const s=t.setType;let i=this._parts.get(s);return i||(i=new oo(t),this._parts.set(s,i)),i}getActivePartSet(t){const s=this._activePartSets.get(t.activePartSet);return s||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class _o{constructor(t,s,i,r,n,a,o,u,l="",c=!1,g=1){this._bodyPartId=t,this._partType=s,this._partId=i,this._color=r,this._frames=n,this._action=a,this._isColorable=o,this._paletteMapId=u,this._flippedPartType=l,this._isBlendable=c,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(t){if(!this._frames||!this._frames.length)return 0;const s=t%this._frames.length;return this._frames[s]instanceof Vn?this._frames[s].number:s}getFrameDefinition(t){const s=t%this._frames.length;return this._frames&&this._frames.length>s&&this._frames[s]instanceof Vn?this._frames[s]:null}getCacheableKey(t){const s=t%this._frames.length;if(this._frames&&this._frames.length>s&&this._frames[s]instanceof Vn){const i=this._frames[s];return this.partId+":"+i.assetPartDefinition+":"+i.number}return this.partId+":"+s}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}const Rt=class{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(e,t){this._data=new Map,this._colors=new Map,this._gender=t,this.parseFigureString(e)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(e){if(e)for(const t of e.split(".")){const s=t.split("-");if(s.length>0){const i=s[0],r=parseInt(s[1]),n=[];let a=2;for(;a<s.length;)n.push(parseInt(s[a])),a++;n.length||n.push(0),this.savePartSetId(i,r,!1),this.savePartSetColourId(i,n,!1)}}}hasSetType(e){return!!this._data.get(e)}getPartSetId(e){return this.hasSetType(e)?this._data.get(e):-1}getColourIds(e){return this._colors.get(e)?this._colors.get(e):[]}getFigureString(){let e="";const t=[];for(const[i,r]of this._data.entries()){let n=i+"-"+r;const a=this._colors.get(i);if(a)for(const o of a)n=n+("-"+o);t.push(n)}let s=0;for(;s<t.length;)e=e+t[s],s<t.length-1&&(e=e+"."),s++;return e}savePartData(e,t,s,i=!1){this.savePartSetId(e,t,i),this.savePartSetColourId(e,s,i)}savePartSetId(e,t,s=!0){switch(e){case Rt.HD:case Rt.HAIR:case Rt.HAT:case Rt.HEAD_ACCESSORIES:case Rt.EYE_ACCESSORIES:case Rt.FACE_ACCESSORIES:case Rt.SHIRT:case Rt.JACKET:case Rt.CHEST_ACCESSORIES:case Rt.CHEST_PRINTS:case Rt.TROUSERS:case Rt.SHOES:case Rt.TROUSER_ACCESSORIES:t>=0?this._data.set(e,t):this._data.delete(e)}}savePartSetColourId(e,t,s=!0){switch(e){case Rt.HD:case Rt.HAIR:case Rt.HAT:case Rt.HEAD_ACCESSORIES:case Rt.EYE_ACCESSORIES:case Rt.FACE_ACCESSORIES:case Rt.SHIRT:case Rt.JACKET:case Rt.CHEST_ACCESSORIES:case Rt.CHEST_PRINTS:case Rt.TROUSERS:case Rt.SHOES:case Rt.TROUSER_ACCESSORIES:this._colors.set(e,t);return}}getFigureStringWithFace(e){const t=[Rt.HD];let s="";const i=[];for(const n of t){const a=this._colors.get(n);if(a){let o=this._data.get(n);n===Rt.HD&&(o=e);let u=n+"-"+o;if(o>=0){let l=0;for(;l<a.length;)u=u+("-"+a[l]),l++}i.push(u)}}let r=0;for(;r<i.length;)s=s+i[r],r<i.length-1&&(s=s+"."),r++;return s}get gender(){return this._gender}};let wt=Rt;wt.MALE="M";wt.FEMALE="F";wt.UNISEX="U";wt.SCALE="h";wt.STD="std";wt.DEFAULT_FRAME="0";wt.HD="hd";wt.HAIR="hr";wt.HAT="ha";wt.HEAD_ACCESSORIES="he";wt.EYE_ACCESSORIES="ea";wt.FACE_ACCESSORIES="fa";wt.JACKET="cc";wt.SHIRT="ch";wt.CHEST_ACCESSORIES="ca";wt.CHEST_PRINTS="cp";wt.TROUSERS="lg";wt.SHOES="sh";wt.TROUSER_ACCESSORIES="wa";wt.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];class Ow{constructor(t){this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}addValue(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}getMax(){let t=Number.MIN_VALUE,s=0;for(;s<this._maxSize;)this._data[s]>t&&(t=this._data[s]),s++;return t}getMin(){let t=Number.MAX_VALUE,s=0;for(;s<this._maxSize;)this._data[s]<t&&(t=this._data[s]),s++;return t}}class Bt{constructor(t,s){this._location=t,this._direction=s}get location(){return this._location}get direction(){return this._direction}}class ya extends Ie{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(t){}onDispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){!t||!this._object||(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,s){const i=t.concat();for(const r of s)!r||i.indexOf(r)>=0||i.push(r);return i}mouseEvent(t,s){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t){this.dispose(),this._object=null;return}this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class Al{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,s){this._map.has(t)&&this._map.get(t)===s||(this._map.set(t,s),this._updateCounter++)}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const Sl=class extends Ie{constructor(e,t,s){super(),this._id=e,this._instanceId=Sl.OBJECT_COUNTER++,this._type=s,this._model=new Al,this._location=new I,this._direction=new I,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let i=t-1;for(;i>=0;)this._states[i]=0,i--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(e){e&&(e.x===this._location.x&&e.y===this._location.y&&e.z===this._location.z||(this._location.x=e.x,this._location.y=e.y,this._location.z=e.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(e){e&&(e.x===this._direction.x&&e.y===this._direction.y&&e.z===this._direction.z||(this._direction.x=(e.x%360+360)%360,this._direction.y=(e.y%360+360)%360,this._direction.z=(e.z%360+360)%360,this._updateCounter++))}getState(e=0){return e>=0&&e<this._states.length?this._states[e]:-1}setState(e,t=0){return t>=0&&t<this._states.length?(this._states[t]!==e&&(this._states[t]=e,this._updateCounter++),!0):!1}setVisualization(e){this._visualization!==e&&(this._visualization&&this._visualization.dispose(),this._visualization=e,this._visualization&&(this._visualization.object=this))}setLogic(e){if(this._logic===e)return;const t=this._logic;if(t&&(this._logic=null,t.setObject(null)),this._logic=e,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const s=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(s)}}processUpdateMessage(e){if(this._logic)return this._logic.processUpdateMessage(e);this._pendingLogicMessages.push(e)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(e){this._updateCounter=e}get isReady(){return this._isReady}set isReady(e){this._isReady=e}};let Ml=Sl;Ml.OBJECT_COUNTER=0;const Cl=class{constructor(){this._id=Cl.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=he.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=Ss.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Le.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name!==e&&(this._name=e,this._updateCounter++)}get type(){return this._type}set type(e){this._type=e}get spriteType(){return this._spriteType}set spriteType(e){this._spriteType=e}get texture(){return this._texture}set texture(e){this._texture!==e&&(e&&(this._width=e.width,this._height=e.height),this._texture=e,this._updateCounter++)}get container(){return this._container}set container(e){this._container!==e&&(this.texture=Dt.EMPTY,e&&(this._width=e.width,this._height=e.height),this._container=e,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX!==e&&(this._offsetX=e,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY!==e&&(this._offsetY=e,this._updateCounter++)}get flipH(){return this._flipH}set flipH(e){this._flipH!==e&&(this._flipH=e,this._updateCounter++)}get flipV(){return this._flipV}set flipV(e){this._flipV!==e&&(this._flipV=e,this._updateCounter++)}get direction(){return this._direction}set direction(e){this._direction=e}get alpha(){return this._alpha}set alpha(e){e=e&255,this._alpha!==e&&(this._alpha=e,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode!==e&&(this._blendMode=e,this._updateCounter++)}get color(){return this._color}set color(e){e=e&16777215,this._color!==e&&(this._color=e,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth!==e&&(this._relativeDepth=e,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(e){e!==this._varyingDepth&&(this._varyingDepth=e,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(e){this._libraryAssetName=e}get clickHandling(){return this._clickHandling}set clickHandling(e){this._clickHandling=e}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this._updateCounter++)}get tag(){return this._tag}set tag(e){this._tag!==e&&(this._tag=e,this._updateCounter++)}get posture(){return this._posture}set posture(e){this._posture!==e&&(this._posture=e,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(e){this._alphaTolerance!==e&&(this._alphaTolerance=e,this._updateCounter++)}get filters(){return this._filters}set filters(e){this._filters=e,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(e){this._updateContainer=e}};let vo=Cl;vo.SPRITE_COUNTER=0;const Nl=class{constructor(){this._id=Nl.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(e){return!1}update(e,t,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const e=this._sprites[0];e&&e.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(e){return e>=0&&e<this._sprites.length?this._sprites[e]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(e){const t=new vo;return e>=this._sprites.length?this._sprites.push(t):this._sprites.splice(e,0,t),t}createSprites(e){for(;this._sprites.length>e;){const t=this._sprites[this._sprites.length-1];t&&t.dispose(),this._sprites.pop()}for(;this._sprites.length<e;)this._sprites.push(new vo)}get image(){return this.getImage(0,-1)}getImage(e,t){const s=this.getBoundingRectangle();if(s.width*s.height===0)return null;const i=this.totalSprites,r=[];let n=0;for(;n<i;){const u=this.getSprite(n);u&&u.visible&&u.texture&&r.push(u),n++}r.sort((u,l)=>l.relativeDepth-u.relativeDepth);const a=new je;for(n=0;n<r.length;){const u=r[n],l=u.texture;if(l){const c=new Pt(l);c.alpha=u.alpha/255,c.tint=u.color,c.x=u.offsetX,c.y=u.offsetY,c.blendMode=u.blendMode,c.filters=u.filters,u.flipH&&(c.scale.x=-1),u.flipV&&(c.scale.y=-1),a.addChild(c)}n++}const o=Ot.generateTexture(a);return o||null}getBoundingRectangle(){const e=this.totalSprites,t=new fe;let s=0;for(;s<e;){const i=this.getSprite(s);if(i&&i.texture&&i.visible){const r=i.flipH?-i.width+i.offsetX:i.offsetX,n=i.flipV?-i.height+i.offsetY:i.offsetY,a=new Y(r,n);s===0?(t.x=a.x,t.y=a.y,t.width=i.width,t.height=i.height):(a.x<t.x&&(t.x=a.x),a.y<t.y&&(t.y=a.y),a.x+i.width>t.right&&(t.width=a.x+i.width-t.x),a.y+i.height>t.bottom&&(t.height=a.y+i.height-t.y))}s++}return t}get instanceId(){return this._id}get object(){return this._object}set object(e){this._object=e}get asset(){return this._asset}set asset(e){this._asset&&this._asset.removeReference(),this._asset=e,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(e){this._updateObjectCounter=e}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(e){this._updateModelCounter=e}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(e){this._updateSpriteCounter=e}get spriteCount(){return this._sprites.length}};let an=Nl;an.VISUALIZATION_COUNTER=0;class Hf{constructor(t){this._roomObjectVariableAccurateZ=t||"",this._location=new I,this._screenLocation=new I,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,s){if(!t||!s)return null;let i=!1;const r=t.getLocation();if((s.updateId!==this._geometryUpdateId||t.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=t.updateCounter,(s.updateId!==this._geometryUpdateId||r.x!==this._location.x||r.y!==this._location.y||r.z!==this._location.z)&&(this._geometryUpdateId=s.updateId,this._location.assign(r),i=!0)),this._locationChanged=i,this._locationChanged){const n=s.getScreenPosition(r);if(!n)return null;const a=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(a)||a===0){const o=new I(Math.round(r.x),Math.round(r.y),r.z);if(o.x!==r.x||o.y!==r.y){const u=s.getScreenPosition(o);this._screenLocation.assign(n),u&&(this._screenLocation.z=u.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class Vf{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(t){this._sprites.push(t)}getSprite(t){return this._sprites[t]}get sprites(){return this._sprites}needsUpdate(t,s){return t===this._updateId1&&s===this._updateId2?!1:(this._updateId1=t,this._updateId2=s,!0)}setSpriteCount(t){if(t<this._sprites.length){let s=t;for(;s<this._sprites.length;){const i=this._sprites[s];i&&i.dispose(),s++}this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}}class jf{constructor(t){this._location=new Hf(t),this._sprites=new Vf}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(t){this._objectId=t}}const bo=class{constructor(e){this._data=new Map,this._roomObjectVariableAccurateZ=e}dispose(){if(this._data){for(const[e,t]of this._data.entries())t&&(this._data.delete(e),t.dispose());this._data=null}}getObjectCache(e){let t=this._data.get(e);return t||(t=new jf(this._roomObjectVariableAccurateZ),this._data.set(e,t)),t}removeObjectCache(e){const t=this._data.get(e);t&&(this._data.delete(e),t.dispose())}getSortableSpriteList(){const e=[];for(const t of this._data.values()){if(!t)continue;const s=t.sprites&&t.sprites.sprites;if(!(!s||!s.length)){for(const i of s)if(i&&i.sprite.spriteType!==he.ROOM_PLANE&&i.sprite.name!==""){const r=new Au;r.objectId=t.objectId,r.x=i.x,r.y=i.y,r.z=i.z,r.name=i.sprite.name||"",r.flipH=i.sprite.flipH,r.alpha=i.sprite.alpha,r.color=i.sprite.color.toString(),r.blendMode=i.sprite.blendMode.toString(),r.width=i.sprite.width,r.height=i.sprite.height,r.type=i.sprite.type,r.posture=i.sprite.posture;const n=this.isSkewedSprite(i.sprite);n&&(r.skew=i.sprite.direction%4===0?-.5:.5),(n||i.name.indexOf("%image.library.url%")>=0||i.name.indexOf("%group.badge.url%")>=0)&&r.width<=bo.MAX_SIZE_FOR_AVG_COLOR&&r.height<=bo.MAX_SIZE_FOR_AVG_COLOR&&i.sprite.name.indexOf("external_image_wallitem")===0&&(r.frame=!0),e.push(r)}}}return!e||!e.length?null:e}isSkewedSprite(e){return e.type?e.type.indexOf("external_image_wallitem")===0&&e.tag==="THUMBNAIL"||e.type.indexOf("guild_forum")===0&&e.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const e=[];for(const t of this._data.values())for(const s of t.sprites.sprites)s.sprite.spriteType===he.ROOM_PLANE&&e.push(s);return e}};let Dl=bo;Dl.MAX_SIZE_FOR_AVG_COLOR=200;const ws=class{static hex2rgb(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}static hex2rgba(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t[3]=e&255,t}static rgb2hex(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}static rgba2hex(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)+(e[3]|0)}static rgbStringToHex(e){const t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+ws.getHex(t[1])+ws.getHex(t[2])+ws.getHex(t[3])}static getHex(e){return isNaN(e)?"00":ws.HEX_DIGITS[(e-e%16)/16]+ws.HEX_DIGITS[e%16]}static int2rgb(e){e>>>=0;const t=e&255,s=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,s,t,1].join(",")+")"}static rgbToHSL(e){const t=(e>>16&255)/255,s=(e>>8&255)/255,i=(e&255)/255,r=Math.max(t,s,i),n=Math.min(t,s,i),a=r-n;let o=0,u=0,l=0;a==0?o=0:r==t?s>i?o=60*(s-i)/a:o=60*(s-i)/a+360:r==s?o=60*(i-t)/a+120:r==i&&(o=60*(t-s)/a+240),u=.5*(r+n),a==0?l=0:u<=.5?l=a/u*.5:l=a/(1-u)*.5;const c=Math.round(o/360*255),g=Math.round(l*255),f=Math.round(u*255);return(c<<16)+(g<<8)+f}static hslToRGB(e){let t,s,i,r,n;const a=(e>>16&255)/255,o=(e>>8&255)/255,u=(e&255)/255;let l=0,c=0,g=0;o>0?(t=0,s=0,u<.5?t=u*(1+o):t=u+o-u*o,s=2*u-t,i=a+1/3,r=a,n=a-1/3,i<0?i=i+1:i>1&&i--,r<0?r=r+1:r>1&&r--,n<0?n=n+1:n>1&&n--,i*6<1?l=s+(t-s)*6*i:i*2<1?l=t:i*3<2?l=s+(t-s)*6*(2/3-i):l=s,r*6<1?c=s+(t-s)*6*r:r*2<1?c=t:r*3<2?c=s+(t-s)*6*(2/3-r):c=s,n*6<1?g=s+(t-s)*6*n:n*2<1?g=t:n*3<2?g=s+(t-s)*6*(2/3-n):g=s):(l=u,c=u,g=u);const f=Math.round(l*255),R=Math.round(c*255),m=Math.round(g*255);return(f<<16)+(R<<8)+m}static rgb2xyz(e){let t=(e>>16&255)/255,s=(e>>8&255)/255,i=(e>>0&255)/255;return t>.04045?t=Math.pow((t+.055)/1.055,2.4):t=t/12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s=s/12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i=i/12.92,t=t*100,s=s*100,i=i*100,new I(t*.4124+s*.3576+i*.1805,t*.2126+s*.7152+i*.0722,t*.0193+s*.1192+i*.9505)}static xyz2CieLab(e){let t=e.x/95.047,s=e.y/100,i=e.z/108.883;return t>.008856?t=Math.pow(t,1/3):t=7.787*t+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,new I(116*s-16,500*(t-s),200*(s-i))}static rgb2CieLab(e){return ws.xyz2CieLab(ws.rgb2xyz(e))}static colorize(e,t){if(t===4294967295)return e;let s=t>>16&255,i=t>>8&255,r=t&255;return s=(e>>16&255)*s/255,i=(e>>8&255)*i/255,r=(e&255)*r/255,(e&&4278190080)|s<<16|i<<8|r}};let ia=ws;ia.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];class kh{constructor(t){t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let s=0;for(;s<t;)this._freeNumbers.push(s),s++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}freeNumber(t){const s=this._reservedNumbers.indexOf(t);s>=0&&(this._reservedNumbers.splice(s,1),this._freeNumbers.push(t))}}class Yf{static getFlipHBitmapData(t){if(!t)return null;const s=Ot.createRenderTexture(t.width,t.height),i=new ue;return i.scale(-1,1),i.translate(t.width,0),Yt.instance.renderer.render(new Nt(t),{renderTexture:s,clear:!0,transform:i}),s}static getFlipVBitmapData(t){if(!t)return null;const s=new ue;s.scale(1,-1),s.translate(0,t.height);const i=new go;return i.beginTextureFill({texture:t,matrix:s}).drawRect(0,0,t.width,t.height).endFill(),Ot.generateTexture(i)}static getFlipHVBitmapData(t){if(!t)return null;const s=new ue;s.scale(-1,-1),s.translate(t.width,t.height);const i=new go;return i.beginTextureFill({texture:t,matrix:s}).drawRect(0,0,t.width,t.height).endFill(),Ot.generateTexture(i)}}const lt=class{static init(e,t){lt._currentDelta=0,lt._startDelayMs=e,lt._effectDurationMs=t,lt._initializationTimeMs=Z(),lt._state=lt.STATE_START_DELAY}static turnVisualizationOn(){if(lt._state===lt.STATE_NOT_INITIALIZED||lt._state===lt.STATE_OVER)return;const e=Z()-lt._initializationTimeMs;if(e>lt._startDelayMs+lt._effectDurationMs){lt._state=lt.STATE_OVER;return}if(lt._visualizationOn=!0,e<lt._startDelayMs){lt._state=lt.STATE_START_DELAY;return}lt._state=lt.STATE_RUNNING,lt._currentDelta=(e-lt._startDelayMs)/lt._effectDurationMs}static turnVisualizationOff(){lt._visualizationOn=!1}static isVisualizationOn(){return lt._visualizationOn&&lt.isRunning()}static isRunning(){return lt._state===lt.STATE_START_DELAY||lt._state===lt.STATE_RUNNING}static getDelta(e=0,t=1){return Math.min(Math.max(lt._currentDelta,e),t)}static get totalRunningTime(){return lt._startDelayMs+lt._effectDurationMs}};let Xt=lt;Xt.STATE_NOT_INITIALIZED=0;Xt.STATE_START_DELAY=1;Xt.STATE_RUNNING=2;Xt.STATE_OVER=3;Xt._state=lt.STATE_NOT_INITIALIZED;Xt._visualizationOn=!1;Xt._currentDelta=0;Xt._initializationTimeMs=0;Xt._startDelayMs=20*1e3;Xt._effectDurationMs=2e3;const mi=class{constructor(e,t,s,i=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=e,this._x=new I,this._y=new I,this._z=new I,this._directionAxis=new I,this._location=new I,this._direction=new I,this._depth=new I,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new I(s.x,s.y,s.z),this.direction=new I(t.x,t.y,t.z),i!=null?this.setDepthVector(i):this.setDepthVector(t),this._displacements=new Map}static getIntersectionVector(e,t,s,i){const r=I.dotProduct(t,i);if(Math.abs(r)<1e-5)return null;const n=I.dif(e,s),a=-I.dotProduct(i,n)/r;return I.sum(e,I.product(t,a))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(e){e<=1&&(e=1),e=e*Math.sqrt(.5),e!=this._scale&&(this._scale=e,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(e){if(e==null)return;this._loc==null&&(this._loc=new I);const t=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(e),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=t||this._loc.y!=s||this._loc.z!=i)&&this._updateId++}get direction(){return this._direction}set direction(e){let t,s,i,r,n;if(e==null)return;this._dir==null&&(this._dir=new I);const a=this._dir.x,o=this._dir.y,u=this._dir.z;this._dir.assign(e),this._direction.assign(e),(this._dir.x!=a||this._dir.y!=o||this._dir.z!=u)&&this._updateId++;const l=new I(0,1,0),c=new I(0,0,1),g=new I(1,0,0),f=e.x/180*Math.PI,R=e.y/180*Math.PI,m=e.z/180*Math.PI,T=Math.cos(f),O=Math.sin(f),C=I.sum(I.product(l,T),I.product(g,-O)),N=new I(c.x,c.y,c.z),S=I.sum(I.product(l,O),I.product(g,T)),D=Math.cos(R),v=Math.sin(R),b=new I(C.x,C.y,C.z),w=I.sum(I.product(N,D),I.product(S,v)),Q=I.sum(I.product(N,-v),I.product(S,D));m!=0?(t=Math.cos(m),s=Math.sin(m),i=I.sum(I.product(b,t),I.product(w,s)),r=I.sum(I.product(b,-s),I.product(w,t)),n=new I(Q.x,Q.y,Q.z),this._x.assign(i),this._y.assign(r),this._z.assign(n),this._directionAxis.assign(this._z)):(this._x.assign(b),this._y.assign(w),this._z.assign(Q),this._directionAxis.assign(this._z))}set x_scale(e){this._x_scale!=e*this._x_scale_internal&&(this._x_scale=e*this._x_scale_internal,this._updateId++)}set y_scale(e){this._y_scale!=e*this._y_scale_internal&&(this._y_scale=e*this._y_scale_internal,this._updateId++)}set z_scale(e){this._z_scale!=e*this._z_scale_internal&&(this._z_scale=e*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(e,t){let s,i;e==null||t==null||this._displacements!=null&&(s=Math.trunc(Math.round(e.x))+"_"+Math.trunc(Math.round(e.y))+"_"+Math.trunc(Math.round(e.z)),this._displacements.delete(s),i=new I,i.assign(t),this._displacements.set(s,i),this._updateId++)}getDisplacenent(e){let t;return this._displacements!=null?(t=Math.trunc(Math.round(e.x))+"_"+Math.trunc(Math.round(e.y))+"_"+Math.trunc(Math.round(e.z)),this._displacements.get(t)):null}setDepthVector(e){let t,s,i;const r=new I(0,1,0),n=new I(0,0,1),a=new I(1,0,0),o=e.x/180*Math.PI,u=e.y/180*Math.PI,l=e.z/180*Math.PI,c=Math.cos(o),g=Math.sin(o),f=I.sum(I.product(r,c),I.product(a,-g)),R=new I(n.x,n.y,n.z),m=I.sum(I.product(r,g),I.product(a,c)),T=Math.cos(u),O=Math.sin(u),C=new I(f.x,f.y,f.z),N=I.sum(I.product(R,T),I.product(m,O)),S=I.sum(I.product(R,-O),I.product(m,T));l!=0?(t=Math.cos(l),s=Math.sin(l),I.sum(I.product(C,t),I.product(N,s)),I.sum(I.product(C,-s),I.product(N,t)),i=new I(S.x,S.y,S.z),this._depth.assign(i)):this._depth.assign(S),this._updateId++}adjustLocation(e,t){if(e==null||this._z==null)return;const s=I.product(this._z,-t),i=new I(e.x+s.x,e.y+s.y,e.z+s.z);this.location=i}getCoordinatePosition(e){if(e==null)return null;const t=I.scalarProjection(e,this._x),s=I.scalarProjection(e,this._y),i=I.scalarProjection(e,this._z);return new I(t,s,i)}getScreenPosition(e){let t=I.dif(e,this._loc);t.x=t.x*this._x_scale,t.y=t.y*this._y_scale,t.z=t.z*this._z_scale;let s=I.scalarProjection(t,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=I.scalarProjection(t,this._x),r=-I.scalarProjection(t,this._y);i=i*this._scale,r=r*this._scale;const n=this.getDisplacenent(e);return n!=null&&(t=I.dif(e,this._loc),t.add(n),t.x=t.x*this._x_scale,t.y=t.y*this._y_scale,t.z=t.z*this._z_scale,s=I.scalarProjection(t,this._depth)),t.x=i,t.y=r,t.z=s,t}getScreenPoint(e){const t=this.getScreenPosition(e);return t==null?null:new Y(t.x,t.y)}getPlanePosition(e,t,s,i){let r,n;const a=e.x/this._scale,o=-e.y/this._scale,u=I.product(this._x,a);u.add(I.product(this._y,o));const l=new I(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);l.add(u);const c=this._z,g=new I(t.x*this._x_scale,t.y*this._y_scale,t.z*this._z_scale),f=new I(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),R=new I(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),m=I.crossProduct(f,R),T=new I;return T.assign(mi.getIntersectionVector(l,c,g,m)),T!=null?(T.subtract(g),r=I.scalarProjection(T,s)/f.length*s.length,n=I.scalarProjection(T,i)/R.length*i.length,new Y(r,n)):null}performZoom(){this.isZoomedIn()?this.scale=mi.SCALE_ZOOMED_OUT:this.scale=mi.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==mi.SCALE_ZOOMED_IN}performZoomOut(){this.scale=mi.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=mi.SCALE_ZOOMED_IN}};let yi=mi;yi.SCALE_ZOOMED_IN=64;yi.SCALE_ZOOMED_OUT=32;const Fo=class{static makeRoomPreviewerId(e){return(e&65535)+Fo.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(e){return e>=Fo.PREVIEW_ROOM_ID_BASE}};let Q_=Fo;Q_.PREVIEW_ROOM_ID_BASE=2147418112;class qe{static init(t,s){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=s,this._SafeStr_4514=Z(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=Z()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}qe.STATE_NOT_INITIALIZED=0;qe.STATE_START_DELAY=1;qe.STATE_RUNNING=2;qe.STATE_OVER=3;qe._SafeStr_448=0;qe._SafeStr_4512=!1;qe._SafeStr_4513=0;qe._SafeStr_4514=0;qe._SafeStr_4515=2e4;qe._SafeStr_4516=5e3;class We{static init(t,s){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=s,this._SafeStr_4514=Z(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=Z()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}We.STATE_NOT_INITIALIZED=0;We.STATE_START_DELAY=1;We.STATE_RUNNING=2;We.STATE_OVER=3;We._SafeStr_448=0;We._SafeStr_4512=!1;We._SafeStr_4514=0;We._SafeStr_4515=2e4;We._SafeStr_4516=5e3;class zf{static hex2int(t){return parseInt(t,16)}static inkToBlendMode(t){return t=="ADD"||t==33?Ss.ADD:t=="SUBTRACT"?Ss.SUBTRACT:t=="DARKEN"?Ss.DARKEN:Ss.NORMAL}}class ra extends Nt{constructor(t=null){super(t),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(t,s){return this._pairedSpriteId===t&&this._pairedSpriteUpdateCounter===s?!1:(this._pairedSpriteId=t,this._pairedSpriteUpdateCounter=s,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(t){t||(t=Dt.EMPTY),t!==this.texture&&(t===Dt.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=t)}containsPoint(t){return ra.containsPoint(this,t)}static containsPoint(t,s){if(!t||!s||t.alphaTolerance>255||!(t instanceof Nt))return!1;if(t.texture===Dt.EMPTY||t.blendMode!==Ss.NORMAL)return;const i=t.texture,r=i.baseTexture;if(!i||!r||!r.valid)return!1;const n=s.x*t.scale.x,a=s.y*t.scale.y;if(!t.getLocalBounds().contains(n,a)||!r.hitMap&&!ra.generateHitMap(r))return!1;const o=r.hitMap;let u=n+i.frame.x,l=a+i.frame.y;i.trim&&(u-=i.trim.x,l-=i.trim.y),u=Math.round(u)*r.resolution,l=Math.round(l)*r.resolution;const c=u+l*r.realWidth,g=c%32,f=c/32|0;return(o[f]&1<<g)!==0}static generateHitMap(t){if(!t)return!1;const s=new Dt(t),i=new Nt(s),r=Ot.getPixels(i),n=t.width,a=t.height,o=new Uint32Array(Math.ceil(n*a/32)),u=Le.MATCH_OPAQUE_PIXELS;for(let l=0;l<n*a;l++){const c=l%32,g=l/32|0;r[l*4+3]>=u&&(o[g]=o[g]|1<<c)}return t.hitMap=o,i.destroy(),s.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){this._varyingDepth=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}}class Wf{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}const Pl=class{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-Pl.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(e){this._name=e}get sprite(){return this._sprite}set sprite(e){this._sprite=e}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}};let yl=Pl;yl.Z_INFINITY=1e8;class kf{constructor(t,s,i,r,n){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=s,this._container=t,this._geometry=new yi(n,new I(-135,30,0),new I(11,11,5),new I(-135,.5,0)),this._animationFPS=B.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new Y,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new Dl(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(i,r)}setupCanvas(){if(this._master||(this._master=new Pt,this._master.interactiveChildren=!1),!this._display){const t=new je;this._master.addChild(t),this._display=t}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this.cleanSprite(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,s){if(t=t<1?1:t,s=s<1?1:s,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,t,s).endFill():(this._mask=new go().beginFill(16711680).drawRect(0,0,t,s).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const i=this._master.hitArea;i.width=t,i.height=s}else this._master.hitArea=new fe(0,0,t,s);if(this._master.filterArea){const i=this._master.filterArea;i.width=t,i.height=s}else this._master.filterArea=new fe(0,0,t,s)}this._width=t,this._height=s}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t,s=null,i=null,r=!1,n=!1){!this._master||!this._display||this._restrictsScaling&&!r||(s||(s=new Y(this._width/2,this._height/2)),i||(i=s),s=this._display.toLocal(s),n?this._scale*=t:this._scale=t,this.screenOffsetX=i.x-s.x*this._scale,this.screenOffsetY=i.y-s.y*this._scale)}render(t,s=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Os().deltaTime,this._totalTimeRunning===this._renderTimestamp||(t===-1&&(t=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(s=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),s=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),s=!0),this.doMagic();const i=Math.round(this._totalTimeRunning/(60/this._animationFPS));let r=!1;i!==this._lastFrame&&(this._lastFrame=i,r=!0);let n=0;const a=this._container.objects;if(a.size)for(const u of a.values())u&&(n=n+this.renderObject(u,u.instanceId.toString(),t,s,r,n));this._sortableSprites.sort((u,l)=>l.z-u.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let o=0;for(;o<n;){const u=this._sortableSprites[o];u&&u.sprite&&this.renderSprite(o,u),o++}this.cleanSprites(n),(s||r)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,s,i,r,n,a){if(!t)return 0;const o=t.visualization;if(!o)return this.removeFromCache(s),0;const u=this.getCacheItem(s);u.objectId=t.instanceId;const l=u.location,c=u.sprites,g=l.updateLocation(t,this._geometry);if(!g)return this.removeFromCache(s),0;if(n&&o.update(this._geometry,i,!c.isEmpty||r,this._skipObjectUpdate&&this._runningSlow),l.locationChanged&&(r=!0),!c.needsUpdate(o.instanceId,o.updateSpriteCounter)&&!r)return c.spriteCount;let f=g.x,R=g.y,m=g.z;f>0?m=m+f*12e-8:m=m+-f*12e-8,f=f+Math.trunc(this._width/2),R=R+Math.trunc(this._height/2);let T=0;for(const O of o.sprites.values()){if(!O||!O.visible)continue;const C=O.texture,N=C&&C.baseTexture;if(!C||!N)continue;const S=f+O.offsetX+this._screenOffsetX,D=R+O.offsetY+this._screenOffsetY;if(O.flipH){const b=f+-(C.width+-O.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(b,D,C.width,C.height))continue}else if(O.flipV){const b=R+-(C.height+-O.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(S,b,C.width,C.height))continue}else if(!this.isSpriteVisible(S,D,C.width,C.height))continue;let v=c.getSprite(T);v||(v=new yl,c.addSprite(v),this._sortableSprites.push(v),v.name=s),v.sprite=O,(O.spriteType===he.AVATAR||O.spriteType===he.AVATAR_OWN)&&(v.sprite.libraryAssetName="avatar_"+t.id),v.x=S-this._screenOffsetX,v.y=D-this._screenOffsetY,v.z=m+O.relativeDepth+37e-12*a,T++,a++}return c.setSpriteCount(T),this._canvasUpdated=!0,T}getExtendedSprite(t){if(t<0||t>=this._spriteCount)return null;const s=this._display.getChildAt(t);return s||null}getExtendedSpriteIdentifier(t){return t?t.name:""}renderSprite(t,s){if(t>=this._spriteCount)return this.createAndAddSprite(s),!0;if(!s)return!1;const i=s.sprite,r=this.getExtendedSprite(t);if(!i||!r)return!1;if(r.varyingDepth!==i.varyingDepth)return r.varyingDepth&&!i.varyingDepth?(this._display.removeChildAt(t),this._spritePool.push(r),this.renderSprite(t,s)):(this.createAndAddSprite(s,t),!0);if(r.needsUpdate(i.id,i.updateCounter)||Xt.isVisualizationOn()){r.tag=i.tag,r.alphaTolerance=i.alphaTolerance,r.name=s.name,r.varyingDepth=i.varyingDepth,r.clickHandling=i.clickHandling,r.filters=i.filters;const n=i.alpha/255;r.alpha!==n&&(r.alpha=n),r.tint!==i.color&&(r.tint=i.color),r.blendMode!==i.blendMode&&(r.blendMode=i.blendMode),r.texture!==i.texture&&r.setTexture(i.texture),i.updateContainer&&(r.children.length===1&&r.removeChildAt(0),r.addChild(i.container),i.updateContainer=!1),i.flipH?r.scale.x!==-1&&(r.scale.x=-1):r.scale.x!==1&&(r.scale.x=1),i.flipV?r.scale.y!==-1&&(r.scale.y=-1):r.scale.y!==1&&(r.scale.y=1),this.updateEnterRoomEffect(r,i)}return r.x!==s.x&&(r.x=s.x),r.y!==s.y&&(r.y=s.y),r.offsetX=i.offsetX,r.offsetY=i.offsetY,!0}createAndAddSprite(t,s=-1){const i=t.sprite;if(!i)return;let r=null;this._spritePool.length>0&&(r=this._spritePool.pop()),r||(r=new ra),r.children.length&&r.removeChildren(),r.tag=i.tag,r.alphaTolerance=i.alphaTolerance,r.alpha=i.alpha/255,r.tint=i.color,r.x=t.x,r.y=t.y,r.offsetX=i.offsetX,r.offsetY=i.offsetY,r.name=i.name,r.varyingDepth=i.varyingDepth,r.clickHandling=i.clickHandling,r.blendMode=i.blendMode,r.filters=i.filters,r.setTexture(i.texture),i.updateContainer&&(r.addChild(i.container),i.updateContainer=!1),i.flipH&&(r.scale.x=-1),i.flipV&&(r.scale.y=-1),this.updateEnterRoomEffect(r,i),s<0||s>=this._spriteCount?(this._display.addChild(r),this._spriteCount++):this._display.addChildAt(r,s),this._activeSpriteCount++}cleanSprites(t,s=!1){if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let i=this._spriteCount-1;for(;i>=t;)this.cleanSprite(this.getExtendedSprite(i),s),i--}this._activeSpriteCount=t}}updateEnterRoomEffect(t,s){if(!(!Xt.isVisualizationOn()||!s))switch(s.spriteType){case he.AVATAR_OWN:return;case he.ROOM_PLANE:t.alpha=Xt.getDelta(.9);return;case he.AVATAR:t.alpha=Xt.getDelta(.5);return;default:t.alpha=Xt.getDelta(.1)}}cleanSprite(t,s){t&&(s?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,s,i,r){return!!(this._noSpriteVisibilityChecking||(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX,s=(s-this._screenOffsetY)*this._scale+this._screenOffsetY,i=i*this._scale,r=r*this._scale,t<this._width&&t+i>=0&&s<this._height&&s+r>=0&&!this._usesExclusionRectangles))}handleMouseEvent(t,s,i,r,n,a,o){return t=t-this._screenOffsetX,s=s-this._screenOffsetY,this._mouseLocation.x=t/this._scale,this._mouseLocation.y=s/this._scale,this._mouseCheckCount>0&&i==F.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(t/this._scale),Math.trunc(s/this._scale),i,r,n,a,o),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(t,s,i,r=!1,n=!1,a=!1,o=!1){const u=[];let l=!1,c=null,g=this._activeSpriteCount-1;for(;g>=0;){const m=this.getExtendedSprite(g);if(m&&m.containsPoint(new Y(t-m.x,s-m.y))&&!(m.clickHandling&&(i===F.MOUSE_CLICK||i===F.DOUBLE_CLICK))){const T=this.getExtendedSpriteIdentifier(m);if(u.indexOf(T)===-1){const O=m.tag;let C=this._mouseActiveObjects.get(T);C&&C.spriteTag!==O&&(c=this.createMouseEvent(0,0,0,0,F.ROLL_OUT,C.spriteTag,r,n,a,o),this.bufferMouseEvent(c,T)),i===F.MOUSE_MOVE&&(!C||C.spriteTag!==O)?c=this.createMouseEvent(t,s,t-m.x,s-m.y,F.ROLL_OVER,O,r,n,a,o):(c=this.createMouseEvent(t,s,t-m.x,s-m.y,i,O,r,n,a,o),c.spriteOffsetX=m.offsetX,c.spriteOffsetY=m.offsetY),C||(C=new Wf,C.objectId=T,this._mouseActiveObjects.set(T,C)),C.spriteTag=O,(i!==F.MOUSE_MOVE||t!==this._mouseOldX||s!==this._mouseOldY)&&this.bufferMouseEvent(c,T),u.push(T)}l=!0}g--}const f=[];for(const m of this._mouseActiveObjects.keys())m&&f.push(m);let R=0;for(;R<f.length;){const m=f[R];u.indexOf(m)>=0&&(f[R]=null),R++}for(R=0;R<f.length;){const m=f[R];if(m!==null){const T=this._mouseActiveObjects.get(m);T&&this._mouseActiveObjects.delete(m);const O=this.createMouseEvent(0,0,0,0,F.ROLL_OUT,T.spriteTag,r,n,a,o);this.bufferMouseEvent(O,m)}R++}return this.processMouseEvents(),this._mouseOldX=t,this._mouseOldY=s,l}createMouseEvent(t,s,i,r,n,a,o,u,l,c){const g=t-this._width/2,f=s-this._height/2,R=`canvas_${this._id}`;return new of(n,R+"_"+this._eventId,R,a,g,f,i,r,u,o,l,c)}bufferMouseEvent(t,s){!t||!this._eventCache||(this._eventCache.delete(s),this._eventCache.set(s,t))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[t,s]of this._eventCache.entries()){if(!this._eventCache)return;if(!s)continue;const i=this._container.getRoomObject(parseInt(t));if(i)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(s,i,this._geometry);else{const r=i.mouseHandler;r&&r.mouseEvent(s,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,s=this._screenOffsetX,i=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const r=this._display.getBounds(),n=ze.create({width:this._display.width,height:this._display.height});return Yt.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new ue(1,0,0,1,-r.x,-r.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(t,null,null,!0),this._screenOffsetX=s,this._screenOffsetY=i,n}doMagic(){const t=this.geometry;if(this._rotation!==0){let s=this._effectDirection;t.direction=new I(s.x+this._rotation,s.y,s.z),s=t.direction,t.setDepthVector(new I(s.x,s.y,5));const i=new I;i.assign(this._rotationOrigin),i.x=i.x+this._rotationRodLength*Math.cos((s.x+180)/180*3.14159265358979)*Math.cos(s.y/180*3.14159265358979),i.y=i.y+this._rotationRodLength*Math.sin((s.x+180)/180*3.14159265358979)*Math.cos(s.y/180*3.14159265358979),i.z=i.z+this._rotationRodLength*Math.sin(s.y/180*3.14159265358979),t.location=i,this._effectLocation=new I,this._effectLocation.assign(i),this._effectDirection=new I,this._effectDirection.assign(t.direction)}if(We.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!We.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),qe.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const s=this._effectDirection,i=I.sum(s,new I(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));t.direction=i}else this._SafeStr_795=0,t.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const t=this.geometry.direction;this._effectDirection=new I(t.x,t.y,t.z)}}changeRotation(){if(this._SafeStr_4507)return;const t=this.geometry;if(t){if(this._rotation===0){const s=t.location,i=t.directionAxis;this._effectLocation=new I,this._effectLocation.assign(s),this._effectDirection=new I,this._effectDirection.assign(t.direction);const r=yi.getIntersectionVector(s,i,new I(0,0,0),new I(0,0,1));r!==null&&(this._rotationOrigin=new I(r.x,r.y,r.z),this._rotationRodLength=I.dif(r,s).length,this._rotation=1);return}this._rotation=0,t.location=this._effectLocation,t.direction=this._effectDirection,t.setDepthVector(new I(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const t=this.geometry,s=(t.direction.x-90)/180*3.14159265358979;t.location=I.sum(t.location,new I(Math.cos(s)*Math.sqrt(2),Math.sin(s)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const t=this.geometry,s=(t.direction.x+90)/180*3.14159265358979;t.location=I.sum(t.location,new I(Math.cos(s)*Math.sqrt(2),Math.sin(s)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const t=this.geometry,s=t.direction.x/180*3.14159265358979;t.location=I.sum(t.location,new I(Math.cos(s)*Math.sqrt(2),Math.sin(s)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const t=this.geometry,s=(t.direction.x+180)/180*3.14159265358979;t.location=I.sum(t.location,new I(Math.cos(s)*Math.sqrt(2),Math.sin(s)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){t=Math.trunc(t),this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){t=Math.trunc(t),this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(t){this._canvasUpdated=t}}class Kf{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,s]of this._canvases.entries())this._canvases.delete(t),s&&s.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const s=this.getInstanceId(t);this._objects.delete(s);for(const i of this._canvases.values()){if(!i)continue;i.removeFromCache(s.toString())}}render(t,s=!1){if(!(!this._canvases||!this._canvases.size))for(const i of this._canvases.values())i&&i.render(t,s)}update(t,s=!1){if(!(!this._canvases||!this._canvases.size)){this.render(t,s);for(const i of this._canvases.values())i&&i.update()}}getCanvas(t){const s=this._canvases.get(t);return s||null}createCanvas(t,s,i,r){const n=this._canvases.get(t);if(n)return n.initialize(s,i),n.geometry&&(n.geometry.scale=r),n;const a=this.createSpriteCanvas(t,s,i,r);if(a)return this._canvases.set(t,a),a}createSpriteCanvas(t,s,i,r){return new kf(this,t,s,i,r)}removeCanvas(t){const s=this._canvases.get(t);s&&(this._canvases.delete(t),s.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}class Xf{createRenderer(){return new Kf}}class qf extends Ie{constructor(t,s){super(),this._id=t,this._container=s,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new Al}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const s of this._managers.values()){if(!s)continue;const i=s.objects;if(i.length)for(const r of i.getValues())r&&this._renderer.addObject(r)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){const s=this._managers.get(t);return s||null}getManagerOrCreate(t){let s=this.getManager(t);return s||(s=this._container.createRoomObjectManager(t),s?(this._managers.set(t,s),s):null)}getTotalObjectsForManager(t){const s=this.getManager(t);return s?s.totalObjects:0}getRoomObject(t,s){const i=this.getManager(s);if(!i)return null;const r=i.getObject(t);return r||null}getRoomObjectsForCategory(t){const s=this.getManager(t);return s?s.objects.getValues():[]}getRoomObjectByIndex(t,s){const i=this.getManager(s);if(!i)return null;const r=i.getObjectByIndex(t);return r||null}createRoomObject(t,s,i,r){const n=this.getManagerOrCreate(r);if(!n)return null;const a=n.createObject(t,s,i);return a?(this._renderer&&this._renderer.addObject(a),a):null}createRoomObjectAndInitalize(t,s,i){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,s,i):null}removeRoomObject(t,s){const i=this.getManager(s);if(!i)return;const r=i.getObject(t);r&&(r.tearDown(),this._renderer&&this._renderer.removeObject(r),i.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const s=t.objects;if(s.length)for(const i of s.getValues())i&&this._renderer.removeObject(i)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const s=this._updateCategories.indexOf(t);s!==-1&&this._updateCategories.splice(s,1)}update(t,s=!1){for(const i of this._updateCategories){const r=this.getManager(i);if(!r)continue;const n=r.objects;if(n.length)for(const a of n.getValues()){if(!a)continue;const o=a.logic;o&&o.update(t)}}this._renderer&&this._renderer.update(t,s)}hasUninitializedObjects(){for(const t of this._managers.values())if(t){for(const s of t.objects.getValues())if(s&&!s.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}const xo=class{constructor(e,t,s,i,r,n,a){this._layerTags=[],this._primaryColor=e&16777215,this._secondaryColor=t&16777215,this._breed=s,this._tag=i>-1&&i<xo.COLOR_TAGS.length?xo.COLOR_TAGS[i]:"",this._id=r,this._isMaster=n,this._layerTags=a}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};let Ll=xo;Ll.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];const Mt=class{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(e){this._stateEvents=e,this.setFurnitureData();for(const[t,s]of W.getValue("pet.types").entries())this._pets[s]=t}dispose(){}setSessionDataManager(e){this._sessionDataManager=e,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const e=this._sessionDataManager.getAllFurnitureData(this);e&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(e),this._stateEvents.dispatchEvent(new nt(Mt.LOADER_READY)))}processFurnitureData(e){if(e)for(const t of e){if(!t)continue;const s=t.id;let i=t.className;t.hasIndexedColor&&(i=i+"*"+t.colorIndex);const r=t.revision,n=t.adUrl;n&&n.length>0&&this._objectTypeAdUrls.set(i,n);let a=t.className;t.type===Si.FLOOR?(this._activeObjectTypes.set(s,i),this._activeObjectTypeIds.set(i,s),this._activeObjects[a]||(this._activeObjects[a]=1)):t.type===Si.WALL&&(a==="post.it"&&(i="post_it",a="post_it"),a==="post.it.vd"&&(i="post_it_vd",a="post_id_vd"),this._wallItemTypes.set(s,i),this._wallItemTypeIds.set(i,s),this._wallItems[a]||(this._wallItems[a]=1));const o=this._furniRevisions.get(a);r>o&&(this._furniRevisions.delete(a),this._furniRevisions.set(a,r))}}getFurnitureFloorNameForTypeId(e){const t=this._activeObjectTypes.get(e);return this.removeColorIndex(t)}getFurnitureWallNameForTypeId(e,t=null){let s=this._wallItemTypes.get(e);return s==="poster"&&t!==null&&(s=s+t),this.removeColorIndex(s)}getFurnitureFloorColorIndex(e){const t=this._activeObjectTypes.get(e);return t?this.getColorIndexFromName(t):-1}getFurnitureWallColorIndex(e){const t=this._wallItemTypes.get(e);return t?this.getColorIndexFromName(t):-1}getColorIndexFromName(e){if(!e)return-1;const t=e.indexOf("*");return t===-1?0:parseInt(e.substr(t+1))}removeColorIndex(e){if(!e)return null;const t=e.indexOf("*");return t===-1?e:e.substr(0,t)}getRoomObjectAdUrl(e){const t=this._objectTypeAdUrls.get(e);return t||""}getPetColorResult(e,t){const s=this._petColors.get(e);return s?s.get(t):null}getPetColorResultsForTag(e,t){const s=this._petColors.get(e),i=[];if(s)for(const r of s.values())r.tag===t&&i.push(r);return i}getCollection(e){if(!e)return null;const t=this._collections.get(e);if(!t){const s=Pe().getCollection(e);return s?(this._collections.set(e,s),s):null}return t}getGifCollection(e){return e&&this._gifCollections.get(e)||null}getImage(e){if(!e)return null;const t=this._images.get(e);if(!t)return null;const s=new Image;return s.src=t.src,s}addAssetToCollection(e,t,s,i=!0){const r=this.getCollection(e);return r?r.addAsset(t,s,i,0,0,!1,!1):!1}createGifCollection(e,t,s){if(!e||!t||!s)return null;const i=new $E(e,t,s);return this._gifCollections.set(e,i),i}createCollection(e,t){if(!e||!t)return null;const s=new z_(e,t);this._collections.set(s.name,s);const i=this._pets[s.name];if(i!==void 0){const r=s.getPaletteNames(),n=new Map;for(const a of r){const o=s.getPalette(a),u=e.palettes[a],l=o.primaryColor,c=o.secondaryColor,g=u.breed!==void 0?u.breed:0,f=u.colorTag!==void 0?u.colorTag:-1,R=u.master!==void 0?u.master:!1,m=u.tags!==void 0?u.tags:[];n.set(parseInt(a),new Ll(l,c,g,f,a,R,m))}this._petColors.set(i,n)}}getPlaceholderName(e){switch(this.getCategoryForType(e)){case A.FLOOR:return Mt.PLACE_HOLDER;case A.WALL:return Mt.PLACE_HOLDER_WALL;default:return this._pets[e]!==void 0?Mt.PLACE_HOLDER_PET:Mt.PLACE_HOLDER_DEFAULT}}getCategoryForType(e){return e?this._activeObjects[e]!==void 0?A.FLOOR:this._wallItems[e]!==void 0?A.WALL:this._pets[e]!==void 0?A.UNIT:e.indexOf("poster")===0?A.WALL:e==="room"?A.ROOM:e===et.USER||e===et.PET||e===et.BOT||e===et.RENTABLE_BOT?A.UNIT:e===Mt.TILE_CURSOR||e===Mt.SELECTION_ARROW?A.CURSOR:A.MINIMUM:A.MINIMUM}getPetNameForType(e){return W.getValue("pet.types")[e]||null}isLoaderType(e){return e=et.getRealType(e),e!==y.USER}downloadImage(e,t,s,i=null){let r=null,n=[];if(t&&t.indexOf(",")>=0&&(r=t,t=r.split(",")[0]),r?n=this.getAssetUrls(r,s,!0):n=this.getAssetUrls(t,s,!0),n&&n.length){const a=n[0],o=new Image;return o.src=a,o.onload=()=>{o.onerror=null,this._images.set([t,s].join("_"),o),this._iconListener.onRoomContentLoaded(e,[t,s].join("_"),!0)},o.onerror=()=>{o.onload=null,G.error("Failed to download asset",a),this._iconListener.onRoomContentLoaded(e,[t,s].join("_"),!1)},!0}return!1}async downloadAsset(e,t){var i;const s=(i=this.getAssetUrls(e))==null?void 0:i[0];if(!(!s||!s.length)&&!(this._pendingContentTypes.indexOf(e)>=0||this.getOrRemoveEventDispatcher(e))){this._pendingContentTypes.push(e),this._events.set(e,t);try{const r=await fetch(s);let n="application/octet-stream";switch(r.headers.has("Content-Type")&&(n=r.headers.get("Content-Type")),n){case"application/octet-stream":{const a=new Y_(await r.arrayBuffer());await this.processAsset(a.baseTexture,a.jsonFile);const o=this._events.get(e);if(!o)return;o.dispatchEvent(new is(is.RCLE_SUCCESS,e));break}default:throw new Error}}catch{t.dispatchEvent(new is(is.RCLE_FAILURE,e))}}}async processAsset(e,t){const s=t.spritesheet;if(!e||!s||!Object.keys(s).length){this.createCollection(t,null);return}const i=async()=>{const r=new ou(e,s);await r.parse(),this.createCollection(t,r)};e.valid?await i():await new Promise((r,n)=>{e.once("update",async()=>(await i(),r()))})}setAssetAliasName(e,t){this._objectAliases.set(e,t),this._objectOriginalNames.set(t,e)}getAssetAliasName(e){const t=this._objectAliases.get(e);return t||e}getAssetOriginalName(e){const t=this._objectOriginalNames.get(e);return t||e}getAssetUrls(e,t=null,s=!1){switch(e){case Mt.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(Mt.PLACE_HOLDER)];case Mt.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(Mt.PLACE_HOLDER_WALL)];case Mt.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(Mt.PLACE_HOLDER_PET)];case Mt.ROOM:return[this.getAssetUrlWithGenericBase("room")];case Mt.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(Mt.TILE_CURSOR)];case Mt.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(Mt.SELECTION_ARROW)];default:{const i=this.getCategoryForType(e);if(i===A.FLOOR||i===A.WALL){const r=this.getAssetAliasName(e);let n=s?this.getAssetUrlWithFurniIconBase(r):this.getAssetUrlWithFurniBase(e);if(s){const a=t&&t!==""&&this._activeObjectTypeIds.has(r+"*"+t);n=n.replace(/%param%/gi,a?"_"+t:"")}return[n]}return i===A.UNIT?[this.getAssetUrlWithPetBase(e)]:null}}}getAssetIconUrl(e,t){let s=null,i=[];return e&&e.indexOf(",")>=0&&(s=e,e=s.split(",")[0]),s?i=this.getAssetUrls(s,t,!0):i=this.getAssetUrls(e,t,!0),i&&i.length?i[0]:null}getAssetUrlWithGenericBase(e){return W.getValue("generic.asset.url").replace(/%libname%/gi,e)}getAssetUrlWithFurniBase(e){return W.getValue("furni.asset.url").replace(/%libname%/gi,e)}getAssetUrlWithFurniIconBase(e){return W.getValue("furni.asset.icon.url").replace(/%libname%/gi,e)}getAssetUrlWithPetBase(e){return W.getValue("pet.asset.url").replace(/%libname%/gi,e)}setRoomObjectRoomId(e,t){const s=e&&e.model;s&&s.setValue(d.OBJECT_ROOM_ID,t)}getOrRemoveEventDispatcher(e,t=!1){const s=this._events.get(e);return t&&this._events.delete(e),s}setIconListener(e){this._iconListener=e}};let Ae=Mt;Ae.PLACE_HOLDER="place_holder";Ae.PLACE_HOLDER_WALL="place_holder_wall";Ae.PLACE_HOLDER_PET="place_holder_pet";Ae.PLACE_HOLDER_DEFAULT=Mt.PLACE_HOLDER;Ae.ROOM="room";Ae.TILE_CURSOR="tile_cursor";Ae.SELECTION_ARROW="selection_arrow";Ae.LOADER_READY="RCL_LOADER_READY";Ae.MANDATORY_LIBRARIES=[Mt.PLACE_HOLDER,Mt.PLACE_HOLDER_WALL,Mt.PLACE_HOLDER_PET,Mt.ROOM,Mt.TILE_CURSOR,Mt.SELECTION_ARROW];class Qf{constructor(){this._objects=new Gt,this._objectsPerType=new Gt}dispose(){this.removeAllObjects()}getObject(t){const s=this._objects.getValue(t);return s||null}getObjectByIndex(t){const s=this._objects.getWithIndex(t);return s||null}createObject(t,s,i){const r=new Ml(t,s,i);return this.addObject(t,i,r)}addObject(t,s,i){if(this._objects.getValue(t))return i.dispose(),null;this._objects.add(t,i);const r=this.getTypeMap(s);return r&&r.add(t,i),i}removeObject(t){const s=this._objects.remove(t);if(s){const i=this.getTypeMap(s.type);i&&i.remove(s.id),s.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const s=this._objects.getWithIndex(t);s&&s.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const s=this._objectsPerType.getWithIndex(t);s&&s.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t,s=!0){let i=this._objectsPerType.getValue(t);return!i&&s&&(i=new Gt,this._objectsPerType.add(t,i)),i}get objects(){return this._objects}get totalObjects(){return this._objects.length}}const Hs=class extends as{constructor(e,t,s){super(),this._state=Hs.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=e,this._visualizationFactory=t,this._logicFactory=s,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(is.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(is.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(is.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=Hs.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const e=Ae.MANDATORY_LIBRARIES;for(const t of e)t&&this._initialLoadList.indexOf(t)===-1&&(this._contentLoader.downloadAsset(t,this.events),this._initialLoadList.push(t));this._state=Hs.ROOM_MANAGER_INITIALIZING}getRoomInstance(e){const t=this._rooms.get(e);return t||null}createRoomInstance(e){if(this._rooms.get(e))return null;const t=new qf(e,this);if(this._rooms.set(t.id,t),this._updateCategories.length)for(const s of this._updateCategories)t.addUpdateCategory(s);return t}removeRoomInstance(e){const t=this._rooms.get(e);return t?(this._rooms.delete(e),t.dispose(),!0):!1}createRoomObjectAndInitalize(e,t,s,i){const r=this.getRoomInstance(e);if(!r)return null;let n=s,a=s,o=s,u=null,l=!1;if(this._contentLoader.isLoaderType(s)){if(u=this._contentLoader.getCollection(s),!u&&(l=!0,this._contentLoader.downloadAsset(s,this.events),o=this._contentLoader.getPlaceholderName(s),u=this._contentLoader.getCollection(o),!u))return null;n=u.data.visualizationType,a=u.data.logicType}const c=r.createRoomObject(t,1,s,i);if(!c)return null;if(this._visualizationFactory){const g=this._visualizationFactory.getVisualization(n);if(!g)return r.removeRoomObject(t,i),null;g.asset=u;const f=this._visualizationFactory.getVisualizationData(o,n,u&&u.data||null);if(!f||!g.initialize(f))return r.removeRoomObject(t,i),null;c.setVisualization(g)}if(this._logicFactory){const g=this._logicFactory.getLogic(a);c.setLogic(g),g&&g.initialize(u&&u.data||null)}return l||(c.isReady=!0),this._contentLoader.setRoomObjectRoomId(c,e),c}reinitializeRoomObjectsByType(e){if(!e||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const t=this._contentLoader.getCollection(e);if(!t)return;const s=t.data.visualizationType,i=t.data.logicType,r=this._visualizationFactory.getVisualizationData(e,s,t.data);for(const n of this._rooms.values())if(n){for(const[a,o]of n.managers.entries())if(o)for(const u of o.objects.getValues()){if(!u||u.type!==e)continue;const l=this._visualizationFactory.getVisualization(s);if(l)if(l.asset=t,!r||!l.initialize(r))o.removeObject(u.id);else{u.setVisualization(l);const c=this._logicFactory.getLogic(i);u.setLogic(c),c&&c.initialize(t.data),u.isReady=!0,this._listener&&this._listener.objectInitialized(n.id,u.id,a)}else o.removeObject(u.id)}}}addUpdateCategory(e){if(!(this._updateCategories.indexOf(e)>=0)&&(this._updateCategories.push(e),!!this._rooms.size))for(const s of this._rooms.values())s&&s.addUpdateCategory(e)}removeUpdateCategory(e){const t=this._updateCategories.indexOf(e);if(t!==-1&&(this._updateCategories.splice(t,1),!!this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(e)}setContentLoader(e){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=e}processPendingContentTypes(e){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const t=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(t)){this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!1),G.log("Invalid Collection",t);continue}this.reinitializeRoomObjectsByType(t),this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(t)}}removeFromInitialLoad(e){if(!(!e||this._state===Hs.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=Hs.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(e)){const t=this._initialLoadList.indexOf(e);t>=0&&this._initialLoadList.splice(t,1),this._initialLoadList.length||(this._state=Hs.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=Hs.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(e){if(!this._contentLoader)return;const t=e.contentType;this._pendingContentTypes.indexOf(t)>=0||this._pendingContentTypes.push(t)}update(e,t=!1){if(this.processPendingContentTypes(e),!!this._rooms.size)for(const s of this._rooms.values())s&&s.update(e,t)}createRoomObjectManager(e){return new Qf}get rooms(){return this._rooms}get disposed(){return this._disposed}};let xi=Hs;xi.ROOM_MANAGER_ERROR=-1;xi.ROOM_MANAGER_LOADING=0;xi.ROOM_MANAGER_LOADED=1;xi.ROOM_MANAGER_INITIALIZING=2;xi.ROOM_MANAGER_INITIALIZED=3;xi.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;class Jf{constructor(t,s=-1,i=null,r=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=t,this._minLevel=s,this._texture=i,this._colorMatrix=r,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(t){this._texture=t}get colorMatrix(){return this._colorMatrix}set colorMatrix(t){this._colorMatrix=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get minLevel(){return this._minLevel}}class Zf{constructor(){this._effects=new Map,this._events=new Me,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const t=W.getValue("image.library.url")+"Habbo-Stories/",s=W.getValue("camera.available.effects");for(const i of s){if(!i.enabled)continue;const r=new Jf(i.name,i.minLevel);i.colorMatrix.length?r.colorMatrix=i.colorMatrix:(r.texture=Dt.from(t+i.name+".png"),r.blendMode=i.blendMode),this._effects.set(r.name,r)}this.events.dispatchEvent(new po(po.INITIALIZED))}applyEffects(t,s,i){const r=new je,n=new Pt(t);r.addChild(n),i&&n.scale.set(2);for(const a of s){const o=a.effect;if(o)if(o.colorMatrix){const u=new _u;u.matrix=o.colorMatrix,u.alpha=a.alpha,n.filters||(n.filters=[]),n.filters.push(u)}else{const u=new Pt(o.texture);u.alpha=a.alpha,u.blendMode=o.blendMode,r.addChild(u)}}return Ot.generateImage(r)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class Aw{constructor(t,s){this._effect=t,this._alpha=s}get effect(){return this._effect}get alpha(){return this._alpha}}class $f{flush(){return this._canShowInterstitial=!1,!0}parse(t){return t?(this._canShowInterstitial=t.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class tm{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._filteredText=t.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class em{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return t?(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class sm{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(t){return t?(this._isOpen=t.readInt()>0,this._minutesUntilChange=t.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class im{flush(){return this._openHour=0,this._openMinute=0,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class rm{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),this._userThrownOutAtClose=t.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class nm{flush(){return this._minutes=0,!0}parse(t){return t?(this._minutes=t.readInt(),!0):!1}get openMinute(){return this._minutes}}class am{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(t){return t?(this._isInMaintenance=t.readBoolean(),this._minutesUntilMaintenance=t.readInt(),t.bytesAvailable&&(this._duration=t.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class om{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let s=t.readInt();for(;s>0;)this._nameSuggestions.push(t.readString()),s--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class _m{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let s=t.readInt();for(;s>0;)this._nameSuggestions.push(t.readString()),s--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class hm{flush(){return this._figure="",this._gender="",!0}parse(t){return t?(this._figure=t.readString(),this._gender=t.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class um{constructor(t){this._slotId=t.readInt(),this._figureString=t.readString(),this._gender=t.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class lm{flush(){return this._state=0,this._outfits=[],!0}parse(t){if(!t)return!1;this._state=t.readInt();let s=t.readInt();for(;s>0;)this._outfits.push(new um(t)),s--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class J_{constructor(t){if(!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class cm{flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return t?(this._item=new J_(t),this._openInventory=t.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class dm{flush(){return this._items=null,!0}parse(t){this._items=new Map;let s=t.readInt();for(;s>0;){const i=new J_(t);this._items.set(i.id,i),s--}return!0}get items(){return this._items}}class gm{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(t){return t?(this._boughtAsGift=t.readBoolean(),this._item=new J_(t),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class Em{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class fm{constructor(t){this._name=t.readString(),this._id=t.readInt(),this._consequence=t.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class mm{constructor(t){this._topics=[],this._name=t.readString();let s=t.readInt();for(;s>0;)this._topics.push(new fm(t)),s--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class Im{constructor(t){this._tradeLockInfo="",this._machineBanInfo="",this._name=t.readString(),this._sanctionLengthInHours=t.readInt(),this._probationDays=t.readInt(),this._avatarOnly=t.readBoolean(),t.bytesAvailable&&(this._tradeLockInfo=t.readString()),t.bytesAvailable&&(this._machineBanInfo=t.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class Rm{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(t){return t?(this._issueId=t.readInt(),this._accountId=t.readInt(),this._sanctionType=new Im(t),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class Tm{flush(){return this._callForHelpCategories=null,!0}parse(t){if(!t)return!1;this._callForHelpCategories=[];let s=t.readInt();for(;s>0;)this._callForHelpCategories.push(new mm(t)),s--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class pm{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(t){return t?(this._isSanctionNew=t.readBoolean(),this._isSanctionActive=t.readBoolean(),this._sanctionName=t.readString(),this._sanctionLengthHours=t.readInt(),t.readInt(),this._sanctionReason=t.readString(),this._sanctionCreationTime=t.readString(),this._probationHoursLeft=t.readInt(),this._nextSanctionName=t.readString(),this._nextSanctionLengthHours=t.readInt(),t.readInt(),this._hasCustomMute=t.readBoolean(),t.bytesAvailable&&(this._tradeLockExpiryTime=t.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class Om{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._secondsToWait=t.readInt(),this._ok&&t.bytesAvailable&&(this._extraDataId=t.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class Am{flush(){return!0}parse(t){return!!t}}class Sm{flush(){return this._url="",!0}parse(t){return t?(this._url=t.readString(),!0):!1}get url(){return this._url}}class Mm{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._errorReason=t.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class Cm{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(t){return t?(this._creditPrice=t.readInt(),this._ducketPrice=t.readInt(),t.bytesAvailable&&(this._publishDucketPrice=t.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class Nm{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(t){return t?(t.bytesAvailable&&(this._ok=t.readBoolean(),this._renderLimitHit=t.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class Z_{parse(t){if(!t)return!1;this._campaignName=t.readString(),this._campaignImage=t.readString(),this._currentDay=t.readInt(),this._campaignDays=t.readInt(),this._openedDays=[];let s=t.readInt();for(let i=0;i<s;i++)this._openedDays.push(t.readInt());this._missedDays=[],s=t.readInt();for(let i=0;i<s;i++)this._missedDays.push(t.readInt());return!0}clone(){const t=new Z_;return t.campaignDays=this._campaignDays,t.campaignImage=this._campaignImage,t.campaignName=this._campaignName,t.currentDay=this._currentDay,t.missedDays=this._missedDays,t.openedDays=this._openedDays,t}get campaignName(){return this._campaignName}set campaignName(t){this._campaignName=t}get campaignImage(){return this._campaignImage}set campaignImage(t){this._campaignImage=t}get currentDay(){return this._currentDay}set currentDay(t){this._currentDay=t}get campaignDays(){return this._campaignDays}set campaignDays(t){this._campaignDays=t}get openedDays(){return this._openedDays}set openedDays(t){this._openedDays=t}get missedDays(){return this._missedDays}set missedDays(t){this._missedDays=t}}class Dm{flush(){return this._calendarData=null,!0}parse(t){return t?(this._calendarData=new Z_,this._calendarData.parse(t),!0):!1}get calendarData(){return this._calendarData}}class Pm{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(t){return t?(this._doorOpened=t.readBoolean(),this._productName=t.readString(),this._customImage=t.readString(),this._furnitureClassName=t.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class ym{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(t){return t?(this._productType=t.readString(),this._productClassId=t.readInt(),this._totalCoinsForBonus=t.readInt(),this._coinsStillRequiredToBuy=t.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class Lm{flush(){return this._furniCount=0,!0}parse(t){return t?(this._furniCount=t.readInt(),!0):!1}get furniCount(){return this._furniCount}}class Um{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(t){return t?(this._secondsLeft=t.readInt(),this._furniLimit=t.readInt(),this._maxFurniLimit=t.readInt(),t.bytesAvailable?this._secondsLeftWithGrace=t.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class vm{constructor(t){this._maxPurchaseSize=t.readInt(),this._bundleSize=t.readInt(),this._bundleDiscountSize=t.readInt(),this._bonusThreshold=t.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let s=t.readInt();for(;s>0;)this._additionalBonusDiscountThresholdQuantities.push(t.readInt()),s--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class bm{flush(){return this._bundleDiscountRuleset=null,!0}parse(t){return t?(this._bundleDiscountRuleset=new vm(t),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class $_{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let s=t.readInt();for(;s>0;)this._offerIds.push(t.readInt()),s--;let i=t.readInt();for(;i>0;)this._children.push(new $_(t)),i--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class Fm{flush(){return this._root=null,!0}parse(t){return t?(this._root=new $_(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class xm{constructor(t){this._images=[],this._texts=[];let s=t.readInt();for(;s>0;)this._images.push(t.readString()),s--;let i=t.readInt();for(;i>0;)this._texts.push(t.readString()),i--}get images(){return this._images}get texts(){return this._texts}}class Gm{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}const Ul=class{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(e){switch(this._productType=e.readString(),this._productType){case Ul.B:return this._extraParam=e.readString(),this._productCount=1,!0;default:return this._furniClassId=e.readInt(),this._extraParam=e.readString(),this._productCount=e.readInt(),this._uniqueLimitedItem=e.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=e.readInt(),this._uniqueLimitedItemsLeft=e.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}};let _i=Ul;_i.I="i";_i.S="s";_i.E="e";_i.B="b";class La{constructor(t){this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean(),this._products=[];let s=t.readInt();for(;s>0;)this._products.push(new _i(t)),s--;this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const Yn=class{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(e){if(!e)return!1;switch(this._position=e.readInt(),this._itemName=e.readString(),this._itemPromoImage=e.readString(),this._type=e.readInt(),this._type){case Yn.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=e.readString();break;case Yn.ITEM_PRODUCT_OFFER:this._productOfferId=e.readInt();break;case Yn.ITEM_IAP:this._productCode=e.readString();break}const t=e.readInt();return this._expirationTime=t>0?t*1e3+Z():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};let Ua=Yn;Ua.ITEM_CATALOGUE_PAGE=0;Ua.ITEM_PRODUCT_OFFER=1;Ua.ITEM_IAP=2;class Bm{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new xm(t);let s=t.readInt();for(;s>0;)this._offers.push(new La(t)),s--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let i=t.readInt();for(;i>0;)this._frontPageItems.push(new Ua(t)),i--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class wm{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class Hm{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return t?(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class Vm{constructor(t){this._offerId=t.readInt(),this._isVip=t.readBoolean(),this._daysRequired=t.readInt(),this._isSelectable=t.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class jm{flush(){return!0}parse(t){if(!t)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=t.readInt(),this._giftsAvailable=t.readInt();const s=t.readInt();for(let r=0;r<s;r++)this._offers.push(new La(t));const i=t.readInt();for(let r=0;r<i;r++){const n=new Vm(t);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(t){this._giftsAvailable=t}getOfferExtraData(t){return t?this._giftData.get(t):null}get giftData(){return this._giftData}}class Ym{flush(){return this._productCode=null,this._products=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let s=t.readInt();for(;s>0;)this._products.push(new _i(t)),s--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class vl{constructor(t){if(!t)throw new Error("invalid_wrapper");this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class zm extends vl{constructor(t){super(t),this._originalPrice=t.readInt(),this._originalActivityPointPrice=t.readInt(),this._originalActivityPointType=t.readInt(),this._subscriptionDaysLeft=t.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class Wm{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(t){return t?(this._pricePointUrl=t.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=t.readString(),this._lengthInDays=t.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class km{flush(){return!0}parse(t){return!!t}}class Km{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(t){if(!t)return!1;const s=[],i=[],r=[],n=[];this._isEnabled=t.readBoolean(),this._price=t.readInt();let a=t.readInt(),o=0;for(;o<a;)s.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)i.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)r.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)n.push(t.readInt()),o++;return this._giftWrappers=s,this._ribbonTypes=r,this._giftFurnis=n,this._boxTypes=i,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class Xm{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new zm(t),!0):!1}get offer(){return this._offer}}class qm{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._offers.push(new vl(t)),s--;return!0}get offers(){return this._offers}}class Qm{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._isGiftable=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class Jm{flush(){return!0}parse(t){return!!t}}class Zm{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(t){return t?(this._appearsInSeconds=t.readInt(),this._pageId=t.readInt(),this._offerId=t.readInt(),this._productType=t.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class $m{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(t){return t?(this._notEnoughCredits=t.readBoolean(),this._notEnoughActivityPoints=t.readBoolean(),t.bytesAvailable&&(this._activityPointType=t.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class tI{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new La(t),!0):!1}get offer(){return this._offer}}class eI{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class sI{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class iI{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let s=t.readInt();for(;s>0;)this._products.push(new _i(t)),s--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class rI{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new iI(t),!0):!1}get offer(){return this._offer}}class nI{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return t?(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class va{flush(){return!0}parse(t){return t?(this._status=t.readInt(),!0):!1}get status(){return this._status}}va.SAFETY_LOCK_STATUS_LOCKED=0;va.SAFETY_LOCK_STATUS_UNLOCKED=1;class aI{flush(){return this._result=-1,this._validationInfo="",!0}parse(t){return t?(this._result=t.readInt(),this._validationInfo=t.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}class bl{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}bl.EMAIL_STATUS_OK=0;class oI{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._relationshipStatusType=bi.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(t){return t?(this._relationshipStatusType=t.readInt(),this._friendCount=t.readInt(),this._randomFriendId=t.readInt(),this._randomFriendName=t.readString(),this._randomFriendFigure=t.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class _I{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(t){if(!t)return!1;this._userId=t.readInt(),this._relationshipStatusMap=new Gt;const s=t.readInt();for(let i=0;i<s;i++){const r=new oI(t);this._relationshipStatusMap.add(r.relationshipStatusType,r)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class hI{flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let s=t.readInt();for(;s>0;){t.readInt();const i=t.readString();this._badges.push(i),s--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class uI{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class lI{flush(){return this._userInfo=null,!0}parse(t){return!(!t||(this._userInfo=new uI(t),!this._userInfo))}get userInfo(){return this._userInfo}}class cI{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return t?(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class Fl{constructor(t){this._groupId=t.readInt(),this._groupName=t.readString(),this._badgeCode=t.readString(),this._colorA=t.readString(),this._colorB=t.readString(),this._favourite=t.readBoolean(),this._ownerId=t.readInt(),this._hasForum=t.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class dI{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._motto=t.readString(),this._registration=t.readString(),this._achievementPoints=t.readInt(),this._friendsCount=t.readInt(),this._isMyFriend=t.readBoolean(),this._requestSent=t.readBoolean(),this._isOnline=t.readBoolean();const s=t.readInt();for(let i=0;i<s;i++)this._groups.push(new Fl(t));return this._secondsSinceLastVisit=t.readInt(),this._openProfileWindow=t.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class gI{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return t?(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class EI{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(t){if(!t)return!1;this._roomUnitId=t.readInt();let s=t.readInt();for(;s>0;)this._tags.push(t.readString()),s--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class fI{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class mI{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class II{flush(){return this._groupId=-1,!0}parse(t){return t?(this._groupId=t.readInt(),!0):!1}get groupId(){return this._groupId}}class RI{flush(){return this._groupId=-1,this._requester=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._requester=new mr(t),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}class xl{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}xl.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;class TI{flush(){return this._guildId=-1,this._reason=-1,!0}parse(t){return t?(this._guildId=t.readInt(),this._reason=t.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class pI{flush(){return this._groups=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._groups.push(new Fl(t)),s--;return!0}get groups(){return this._groups}}class OI{flush(){return this._badges=new Map,!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=t.readInt(),r=t.readString();this._badges.set(i,r),s--}return!0}get badges(){return this._badges}}class Gl{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}Gl.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;class AI{flush(){return this._ignoredUsers=[],!0}parse(t){if(!t)return!1;this._ignoredUsers=[];let s=t.readInt();for(;s>0;)this._ignoredUsers.push(t.readString()),s--;return!0}get ignoredUsers(){return this._ignoredUsers}}class SI{flush(){return this._result=-1,this._name=null,!0}parse(t){return t?(this._result=t.readInt(),this._name=t.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class MI{flush(){return this._link=null,!0}parse(t){return t?(this._link=t.readString(),!0):!1}get link(){return this._link}}class CI{flush(){return this._credits=null,!0}parse(t){return t?(this._credits=t.readString(),!0):!1}get credits(){return this._credits}}class NI{flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._currencies.set(t.readInt(),t.readInt()),s--;return!0}get currencies(){return this._currencies}}class on{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(t){return t?(this._productName=t.readString(),this._daysToPeriodEnd=t.readInt(),this._memberPeriods=t.readInt(),this._periodsSubscribedAhead=t.readInt(),this._responseType=t.readInt(),this._hasEverBeenMember=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._pastVipDays=t.readInt(),this._minutesUntilExpiration=t.readInt(),t.bytesAvailable&&(this._minutesSinceLastModified=t.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}}on.RESPONSE_TYPE_LOGIN=1;on.RESPONSE_TYPE_PURCHASE=2;on.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3;on.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;class Er{constructor(t){if(this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._scoreAtStartOfLevel=t.readInt(),this._scoreLimit=Math.max(1,t.readInt()),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._currentPoints=t.readInt(),this._finalLevel=t.readBoolean(),this._category=t.readString(),this._subCategory=t.readString(),this._levelCount=t.readInt(),this._displayMethod=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._scoreAtStartOfLevel=t._scoreAtStartOfLevel,this._scoreLimit=t._scoreLimit,this._levelRewardPoints=t._levelRewardPoints,this._levelRewardPointType=t._levelRewardPointType,this._currentPoints=t._currentPoints,this._finalLevel=t._finalLevel,this._category=t.category,this._subCategory=t._subCategory,this._levelCount=t._levelCount,this._displayMethod=t._displayMethod}}Er.DISPLAY_METHOD_OBSOLETE=-1;Er.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0;Er.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1;Er.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;class DI{flush(){return this._achievement=null,!0}parse(t){return t?(this._achievement=new Er(t),!0):!1}get achievement(){return this._achievement}}const Bl=class{constructor(e){this._achievementId=e.readInt(),this._level=e.readInt(),this._badgeId=e.readString(),this._requiredLevel=e.readInt(),this._state=e.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===Bl.STATE_SELECTABLE}get state(){return this._state}};let wl=Bl;wl.STATE_SELECTABLE=0;class PI{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(t){if(!t)return!1;this._achievements=[];let s=t.readInt();for(;s>0;)this._achievements.push(new Er(t)),s--;return this._defaultCategory=t.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class yI{flush(){return this._score=0,!0}parse(t){return t?(this._score=t.readInt(),!0):!1}get score(){return this._score}}class LI{get type(){return this._type}set type(t){this._type=t}get subType(){return this._subType}set subType(t){this._subType=t}get duration(){return this._duration}set duration(t){this._duration=t}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(t){this._inactiveEffectsInInventory=t}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(t){this._secondsLeftIfActive=t}get isPermanent(){return this._permanent}set isPermanent(t){this._permanent=t}}class UI{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._duration=t.readInt(),this._isPermanent=t.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class vI{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._subType=t.readInt(),this._duration=t.readInt(),this._permanent=t.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class bI{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class FI{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class xI{flush(){return this._effects=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=new LI;i.type=t.readInt(),i.subType=t.readInt(),i.duration=t.readInt(),i.inactiveEffectsInInventory=t.readInt(),i.secondsLeftIfActive=t.readInt(),i.isPermanent=t.readBoolean(),this._effects.push(i),s--}return!0}get effects(){return this._effects}}class GI{constructor(t,s){if(!s)throw new Error("invalid_parser");this._badgeId="ACH_"+t+s.readInt(),this._limit=s.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class BI{flush(){return this._data=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=t.readString(),r=t.readInt();let n=0;for(;n<r;)this._data.push(new GI(i,t)),n++;s--}return!0}get data(){return this._data}}class wI{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(t){return t?(this._badgeId=t.readInt(),this._badgeCode=t.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class HI{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(t){if(!t)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new Gt;let s=t.readInt();for(;s>0;){const i=t.readInt(),r=t.readString();this._badgeIds.add(r,i),this._allBadgeCodes.push(r),s--}for(s=t.readInt();s>0;){t.readInt();const i=t.readString();this._activeBadgeCodes.push(i),s--}return!0}getBadgeId(t){return this._badgeIds.getValue(t)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class VI{flush(){return!0}parse(t){return t?(this._requestCode=t.readString(),this._fulfilled=t.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class jI{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._figureSetIds.push(t.readInt()),s--;let i=t.readInt();for(;i>0;)this._boundFurnitureNames.push(t.readString()),i--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class _n{flush(){return this._reason=0,this._parameter="",!0}parse(t){return t?(this._reason=t.readInt(),this._parameter=t.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}}_n.REASON_FULL=1;_n.REASON_CLOSED=2;_n.REASON_QUEUE_ERROR=3;_n.REASON_BANNED=4;class YI{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class zI{flush(){return!0}parse(t){return!!t}}class WI{flush(){return!0}parse(t){return!!t}}class kI{flush(){return this._controllerLevel=Oe.NONE,!0}parse(t){return t?(this._controllerLevel=t.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class KI{flush(){return!0}parse(t){return!!t}}class XI{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class qI{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(t){return t?(this._botId=t.readInt(),this._commandId=t.readInt(),this._data=t.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class QI{flush(){return this._botId=-1,!0}parse(t){return t?(this._botId=t.readInt(),!0):!1}get botId(){return this._botId}}class JI{constructor(t){this._id=t.readInt(),this._data=t.readString()}get id(){return this._id}get data(){return this._data}}class ZI{flush(){return this._botId=-1,this._skillList=[],!0}parse(t){if(!t)return!1;this._botId=t.readInt();let s=t.readInt();for(;s>0;)this._skillList.push(new JI(t)),s--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class $I{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}}class tR{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let s=t.readInt();for(;s>0;)this._bannedUsers.push(new $I(t)),s--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class eR{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(t){this._selected=t}}class sR{flush(){return this._roomId=0,this._data=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._data=new eR(t),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class iR{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class rR{flush(){return this._roomId=0,this._users=new Map,!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let s=t.readInt();for(;s>0;){const i=t.readInt(),r=t.readString();this._users.set(i,r),s--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class nR{flush(){return!0}parse(t){return t?(this._isMuted=t.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class aR{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class Re{constructor(t){if(!t)throw new Error("invalid_wrapper");this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}Re.CHAT_MODE_FREE_FLOW=0;Re.CHAT_MODE_LINE_BY_LINE=1;Re.CHAT_BUBBLE_WIDTH_WIDE=0;Re.CHAT_BUBBLE_WIDTH_NORMAL=1;Re.CHAT_BUBBLE_WIDTH_THIN=2;Re.CHAT_SCROLL_SPEED_FAST=0;Re.CHAT_SCROLL_SPEED_NORMAL=1;Re.CHAT_SCROLL_SPEED_SLOW=2;Re.FLOOD_FILTER_STRICT=0;Re.FLOOD_FILTER_NORMAL=1;Re.FLOOD_FILTER_LOOSE=2;class hn{constructor(t){this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}hn.MODERATION_LEVEL_NONE=0;hn.MODERATION_LEVEL_USER_WITH_RIGHTS=1;hn.MODERATION_LEVEL_ALL=2;const ds=class{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=ds.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=ds.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(e){const t=new ds;return t._roomId=e._roomId,t._name=e._name,t._description=e._description,t._doorMode=e._doorMode,t._categoryId=e._categoryId,t._maximumVisitors=e._maximumVisitors,t._maximumVisitorsLimit=e._maximumVisitorsLimit,t._tags=e._tags,t._tradeMode=e._tradeMode,t._allowPets=e._allowPets,t._allowFoodConsume=e._allowFoodConsume,t._allowWalkThrough=e._allowWalkThrough,t._hideWalls=e._hideWalls,t._wallThickness=e._wallThickness,t._floorThickness=e._floorThickness,t._controllersById=e._controllersById,t._controllerList=e._controllerList,t._highlightedUserId=e._highlightedUserId,t._bannedUsersById=e._bannedUsersById,t._bannedUsersList=e._bannedUsersList,t._roomModerationSettings=e._roomModerationSettings,t._chatSettings=e._chatSettings,t._allowNavigatorDynamicCats=e._allowNavigatorDynamicCats,t}static getDoorModeLocalizationKey(e){switch(e){case ds.DOORMODE_OPEN:return"${navigator.door.mode.open}";case ds.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case ds.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case ds.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case ds.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(e){this._allowFoodConsume=e}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(e){this._allowWalkThrough=e}get hideWalls(){return this._hideWalls}set hideWalls(e){this._hideWalls=e}get wallThickness(){return this._wallThickness}set wallThickness(e){this._wallThickness=e}get floorThickness(){return this._floorThickness}set floorThickness(e){this._floorThickness=e}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get name(){return this._name}set name(e){this._name=e}get description(){return this._description}set description(e){this._description=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get categoryId(){return this._categoryId}set categoryId(e){this._categoryId=e}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(e){this._maximumVisitors=e}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(e){this._maximumVisitorsLimit=e}get tags(){return this._tags}set tags(e){this._tags=e}setFlatController(e,t){this._controllersById.set(e,t),this._controllerList=null,this._highlightedUserId=e}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(e){this._roomModerationSettings=e}get controllersById(){return this._controllersById}set controllersById(e){this._controllersById=e}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const e of this._controllersById.values())this._controllerList.push(e);this._controllerList.sort((e,t)=>e.userName.localeCompare(t.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(e,t){this._bannedUsersById.set(e,t),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const e of this._bannedUsersById.values())this._bannedUsersList.push(e);this._bannedUsersList.sort((e,t)=>e.userName.localeCompare(t.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(e){this._chatSettings=e}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(e){this._allowNavigatorDynamicCats=e}};let xs=ds;xs.DOORMODE_OPEN=0;xs.DOORMODE_CLOSED=1;xs.DOORMODE_PASSWORD=2;xs.DOORMODE_INVISIBLE=3;xs.DOORMODE_NOOBS_ONLY=4;xs.TRADEMODE_NOT_ALLOWED=0;xs.TRADEMODE_WITH_CONTROLLER=1;xs.TRADEMODE_ALLOWED=2;class oR{flush(){return this._roomSettingsData=null,!0}parse(t){if(!t)return!1;this._roomSettingsData=new xs,this._roomSettingsData.roomId=t.readInt(),this._roomSettingsData.name=t.readString(),this._roomSettingsData.description=t.readString(),this._roomSettingsData.doorMode=t.readInt(),this._roomSettingsData.categoryId=t.readInt(),this._roomSettingsData.maximumVisitors=t.readInt(),this._roomSettingsData.maximumVisitorsLimit=t.readInt(),this._roomSettingsData.tags=[];let s=t.readInt();for(;s>0;)this._roomSettingsData.tags.push(t.readString()),s--;return this._roomSettingsData.tradeMode=t.readInt(),this._roomSettingsData.allowPets=t.readInt()===1,this._roomSettingsData.allowFoodConsume=t.readInt()===1,this._roomSettingsData.allowWalkThrough=t.readInt()===1,this._roomSettingsData.hideWalls=t.readInt()===1,this._roomSettingsData.wallThickness=t.readInt(),this._roomSettingsData.floorThickness=t.readInt(),this._roomSettingsData.chatSettings=new Re(t),this._roomSettingsData.allowNavigatorDynamicCats=t.readBoolean(),this._roomSettingsData.roomModerationSettings=new hn(t),!0}get data(){return this._roomSettingsData}}class _R{flush(){return this._roomId=0,this._code=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class hR{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class Te{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}Te.ERROR_ROOM_NOT_FOUND=1;Te.ERROR_NOT_OWNER=2;Te.ERROR_INVALID_DOOR_MODE=3;Te.ERROR_INVALID_USER_LIMIT=4;Te.ERROR_INVALID_PASSWORD=5;Te.ERROR_INVALID_CATEGORY=6;Te.ERROR_INVALID_NAME=7;Te.ERROR_UNACCEPTABLE_NAME=8;Te.ERROR_INVALID_DESCRIPTION=9;Te.ERROR_UNACCEPTABLE_DESCRIPTION=10;Te.ERROR_INVALID_TAG=11;Te.ERROR_NON_USER_CHOOSABLE_TAG=12;Te.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;class uR{flush(){return this._selectionType=0,!0}parse(t){return t?(this._selectionType=t.readInt(),!0):!1}get selectionType(){return this._selectionType}}class lR{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class cR{flush(){return this._chat=null,!0}parse(t){return t?(this._chat=new Re(t),!0):!1}get chat(){return this._chat}}const Ii=class{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),this._ownerId=e.readInt(),this._ownerName=e.readString(),this._doorMode=e.readInt(),this._userCount=e.readInt(),this._maxUserCount=e.readInt(),this._description=e.readString(),this._tradeMode=e.readInt(),this._score=e.readInt(),this._ranking=e.readInt(),this._categoryId=e.readInt(),this.parseTags(e),this.parseBitMask(e),!0):!1}parseTags(e){if(!e)return!1;this._tags=[];let t=e.readInt();for(;t>0;)this._tags.push(e.readString()),t--;return!0}parseBitMask(e){return e?(this._bitMask=e.readInt(),this._bitMask&Ii.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=e.readString()),this._bitMask&Ii.GROUPDATA_BITMASK&&(this._groupId=e.readInt(),this._groupName=e.readString(),this._groupBadge=e.readString()),this._bitMask&Ii.ROOMAD_BITMASK&&(this._adName=e.readString(),this._adDescription=e.readString(),this._adExpiresIn=e.readInt()),this._showOwner=(this._bitMask&Ii.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&Ii.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&Ii.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(e){this._roomName=e}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(e){this._canMute=e}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(e){this._allInRoomMuted=e}};let le=Ii;le.THUMBNAIL_BITMASK=1;le.GROUPDATA_BITMASK=2;le.ROOMAD_BITMASK=4;le.SHOWOWNER_BITMASK=8;le.ALLOW_PETS_BITMASK=16;le.DISPLAY_ROOMAD_BITMASK=32;le.OPEN_STATE=0;le.DOORBELL_STATE=1;le.PASSWORD_STATE=2;le.INVISIBLE_STATE=3;le.NOOB_STATE=4;class dR{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return t?(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class gR{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return t?(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class ER{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._groupId=t.readInt(),this._status=t.readInt(),this._groupName=t.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class fR{constructor(t,s,i){this._id=0,this._state=0,this._id=t,this._state=s,this._data=i}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class mR{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get count(){return this._code}}class IR{flush(){return this._itemId=0,this._value=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._value=t.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class hi{flush(){return this._itemId=0,this._data=null,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=hi.parseObjectData(t),!0):!1}static parseObjectData(t){if(!t)return null;const s=$s.getData(t.readInt());return s?(s.parseWrapper(t),s):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class th{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(t){return t?(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._extra=t.readInt(),this._data=hi.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class RR{flush(){return this._item=null,!0}parse(t){return t?(this._item=new th(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class TR{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let s=t.readInt();for(;s>0;){const i=new th(t);if(!i)continue;const r=this._owners.get(i.userId);r&&(i.username=r),this._items.push(i),s--}return!0}parseOwners(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._owners.set(t.readInt(),t.readString()),s--;return!0}get owners(){return this._owners}get items(){return this._items}}class pR{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class OR{flush(){return this._item=null,!0}parse(t){return t?(this._item=new th(t),!0):!1}get item(){return this._item}}class AR{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(t){return t?(this._isWallItem=t.readBoolean(),this._furniTypeName=t.readString(),this._buyout=t.readBoolean(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class SR{flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._aliases.set(t.readString(),t.readString()),s--;return!0}get aliases(){return this._aliases}}class MR{flush(){return this._furniId=-1,this._height=0,!0}parse(t){return t?(this._furniId=t.readInt(),this._height=t.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class CR{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(t){return t?(this._objectId=t.readInt(),this._guildId=t.readInt(),this._guildName=t.readString(),this._guildHomeRoomId=t.readInt(),this._userIsMember=t.readBoolean(),this._guildHasReadableForum=t.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class NR{flush(){return this._itemId=0,this._data="",!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class DR{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class PR{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class yR{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(t){return this._furniId=t.readInt(),this._start=t.readBoolean(),!0}}class LR{flush(){return this._itemId=0,this._state=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._state=t.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class UR{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class vR{flush(){return!0}parse(t){return t?(this._expiryTime=t.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}class bR{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(t){return t?(this._rented=t.readBoolean(),this._canRentErrorCode=t.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=t.readInt(),this._renterName=t.readString(),this._timeRemaining=t.readInt(),this._price=t.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}}class FR{flush(){return this._itemId=-1,this._location="",!0}parse(t){return t?(this._itemId=t.readInt(),this._location=t.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class xR{constructor(t,s,i,r){this.id=t,this.type=s,this.color=i,this.brightness=r}}class GR{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(t){const s=t.readInt();this._selectedPresetId=t.readInt();for(let i=0;i<s;i++){const r=t.readInt(),n=t.readInt(),a=parseInt(t.readString().substr(1),16),o=t.readInt();this._presets.push(new xR(r,n,a,o))}return!0}getPreset(t){return t<0||t>=this.presetCount?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class BR{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._messageCount=t.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class eh{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null;const s=parseFloat(this._stuffData);if(isNaN(s)||(this._state=Math.trunc(s)),this._location.indexOf(":")===0){this._isOldFormat=!1;let i=this._location.split(" ");if(i.length>=3){let r=i[0],n=i[1];const a=i[2];if(r.length>3&&n.length>2&&(r=r.substr(3),n=n.substr(2),i=r.split(","),i.length>=2)){const o=parseInt(i[0]),u=parseInt(i[1]);if(i=n.split(","),i.length>=2){const l=parseInt(i[0]),c=parseInt(i[1]);this._width=o,this._height=u,this._localX=l,this._localY=c,this._direction=a}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class wR{flush(){return this._item=null,!0}parse(t){return t?(this._item=new eh(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class HR{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let s=t.readInt();for(;s>0;){const i=new eh(t);if(!i)continue;const r=this._owners.get(i.userId);r&&(i.username=r),this._items.push(i),s--}return!0}parseOwners(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._owners.set(t.readInt(),t.readString()),s--;return!0}get owners(){return this._owners}get items(){return this._items}}class VR{flush(){return this._itemId=0,this._userId=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class jR{flush(){return this._item=null,!0}parse(t){return t?(this._item=new eh(t),!0):!1}get item(){return this._item}}class YR{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),this._furniId=t.readInt(),this._requestedByUser=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class zR{parse(t){return this._furniId=t.readInt(),this._commandId=t.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class WR{constructor(t,s,i){this._video=t,this._title=s,this._description=i}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class kR{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(t){this._furniId=t.readInt();const s=t.readInt();this._playlists=[];for(let i=0;i<s;i++)this._playlists.push(new WR(t.readString(),t.readString(),t.readString()));return this._selectedPlaylistId=t.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class KR{flush(){return!0}parse(t){return this._furniId=t.readInt(),this._videoId=t.readString(),this._startAtSeconds=t.readInt(),this._endAtSeconds=t.readInt(),this._state=t.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class XR{flush(){return this._objects=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=t.readInt(),r=hi.parseObjectData(t),n=parseFloat(r.getLegacyString());this._objects.push(new fR(i,n,r)),s--}return!0}get objects(){return this._objects}}class qR{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return!1;const s=t.readInt(),i=t.readInt(),r=t.readInt(),n=t.readInt();let a=t.readInt();for(;a>0;){const g=t.readInt(),f=parseFloat(t.readString()),R=parseFloat(t.readString()),m=new As(g,new I(s,i,f),new I(r,n,R));this._itemsRolling.push(m),a--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const o=t.readInt(),u=t.readInt(),l=parseFloat(t.readString()),c=parseFloat(t.readString());switch(o){case 0:break;case 1:this._unitRolling=new As(u,new I(s,i,l),new I(r,n,c),As.MOVE);break;case 2:this._unitRolling=new As(u,new I(s,i,l),new I(r,n,c),As.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}const Go=class{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(e){if(!e)return!1;const t=e.readBoolean(),s=e.readInt(),i=e.readString();return this.parseExplicitly(i,s,t)}parseModel(e,t,s=!0){return this.parseExplicitly(e,t,s)}parseExplicitly(e,t,s=!0){this._scale=s?32:64,this._wallHeight=t,this._model=e;const i=this._model.split("\r"),r=i.length;let n=0,a=0;for(;a<r;){const o=i[a];o.length>n&&(n=o.length),a++}for(this._heightMap=[],a=0;a<r;){const o=[];let u=0;for(;u<n;)o.push(Go.TILE_BLOCKED),u++;this._heightMap.push(o),a++}for(this._width=n,this._height=r,a=0;a<r;){const o=this._heightMap[a],u=i[a];if(u.length>0){let l=0;for(;l<u.length;){const c=u.charAt(l);let g=Go.TILE_BLOCKED;c!=="x"&&c!=="X"&&(g=parseInt(c,36)),o[l]=g,l++}}a++}return!0}getHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return-110;const s=this._heightMap[t];if(s===void 0)return-110;const i=s[e];return i===void 0?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}};let sh=Go;sh.TILE_BLOCKED=-110;class QR{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return t?(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class ei{static decodeTileHeight(t){return t<0?-1:(t&16383)/256}static decodeIsStackingBlocked(t){return!!(t&16384)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,s){return t<0||t>=this._width||s<0||s>=this._height?-1:ei.decodeTileHeight(this._heights[s*this._width+t])}getStackingBlocked(t,s){return t<0||t>=this._width||s<0||s>=this._height?!0:ei.decodeIsStackingBlocked(this._heights[s*this._width+t])}isRoomTile(t,s){return t<0||t>=this._width||s<0||s>=this._height?!1:ei.decodeIsRoomTile(this._heights[s*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const s=t.readInt();this._height=s/this._width;let i=0;for(;i<s;)this._heights[i]=t.readShort(),i++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class JR{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return ei.decodeTileHeight(this._value)}isStackingBlocked(){return ei.decodeIsStackingBlocked(this._value)}isRoomTile(){return ei.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(t){return t?(this._wrapper=t,this._count=t.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class ZR{flush(){return this._blockedTilesMap=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=t.readInt(),r=t.readInt();this._blockedTilesMap[r]||(this._blockedTilesMap[r]=[]),this._blockedTilesMap[r][i]=!0,s--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class $R{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const s=t.readString(),i=t.readString();switch(s){case"floor":this._floorType=i;break;case"wallpaper":this._wallType=i;break;case"landscape":this._landscapeType=i;break;case"landscapeanim":this._landscapeAnimation=i;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class tT{flush(){return this._name=null,this._roomId=0,!0}parse(t){return t?(this._name=t.readString(),this._roomId=t.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class eT{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let s=t.readInt(),i=t.readInt();return s=s<-2?-2:s>1?1:s,i=i<-2?-2:i>1?1:i,this._thicknessWall=Math.pow(2,s),this._thicknessFloor=Math.pow(2,i),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class Kh{constructor(t){if(!t)throw new Error("invalid_wrapper");this._webId=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._figure=t.readString(),this._owner=t.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class Xh{constructor(t){this._stuffId=t.readInt(),this._classId=t.readInt(),this._productCode=t.readString(),this._userId=t.readInt(),this._userName=t.readString(),this._rarityLevel=t.readInt(),this._hasMutation=t.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class sT{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(t){return t?(this._resultData=new Xh(t),this._otherResultData=new Xh(t),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class iT{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(t){return t?(this._petId=t.readInt(),this._roomIndex=t.readInt(),this._gainedExperience=t.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class rT{flush(){return!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new rh(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class nT{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._maximumLevel=t.readInt(),this._experience=t.readInt(),this._levelExperienceGoal=t.readInt(),this._energy=t.readInt(),this._maximumEnergy=t.readInt(),this._happyness=t.readInt(),this._maximumHappyness=t.readInt(),this._respect=t.readInt(),this._ownerId=t.readInt(),this._age=t.readInt(),this._ownerName=t.readString(),this._rarityLevel=t.readInt(),this._saddle=t.readBoolean(),this._rider=t.readBoolean();let s=t.readInt();for(;s>0;)this._skillThresholds.push(t.readInt()),s--;return this._skillThresholds.sort(),this._publiclyRideable=t.readInt(),this._breedable=t.readBoolean(),this._fullyGrown=t.readBoolean(),this._dead=t.readBoolean(),this._unknownRarity=t.readInt(),this._maximumTimeToLive=t.readInt(),this._remainingTimeToLive=t.readInt(),this._remainingGrowTime=t.readInt(),this._publiclyBreedable=t.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class aT{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._canBreed=t.readBoolean(),this._canHarvest=t.readBoolean(),this._canRevive=t.readBoolean(),this._hasBreedingPermission=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class oT{constructor(t){if(!t)throw new Error("invalid_wrapper");this._chance=t.readInt(),this._breeds=[];let s=t.readInt();for(;s>0;)this._breeds.push(t.readInt()),s--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class _T{flush(){return this._isPlaying=!1,!0}parse(t){return t?(this._isPlaying=t.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class hT{flush(){return!0}parse(t){return!0}}class uT{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class lT{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class ih{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._messageLength=t.readInt(),!0):!1}parseUrls(t){if(!t)return!1;this._urls=[];let s=t.readInt();for(;s>0;)this._urls.push(t.readString()),s--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class cT{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isTyping=t.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class dT{flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._danceId=t.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class gT{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class ET{flush(){return this._unitId=null,this._expression=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._expression=t.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class fT{flush(){return this._unitId=null,this._handId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._handId=t.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class mT{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(t){return t?(this._giverUserId=t.readInt(),this._handItemType=t.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class IT{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class RT{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class TT{flush(){return this._unitId=null,this._value=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._value=t.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}class rr{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}}rr.M="M";rr.F="F";class pT{flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const s=t.readInt();let i=0;for(;i<s;){const r=t.readInt(),n=t.readString(),a=t.readString();let o=t.readString();const u=t.readInt(),l=t.readInt(),c=t.readInt(),g=parseFloat(t.readString()),f=t.readInt(),R=t.readInt(),m=new rr(u);if(m.dir=f,m.name=n,m.custom=a,m.x=l,m.y=c,m.z=g,this._users.push(m),R===1){m.webID=r,m.userType=Ye.USER,m.sex=this.resolveSex(t.readString()),m.groupID=t.readInt(),m.groupStatus=t.readInt(),m.groupName=t.readString();const T=t.readString();T!==""&&(o=this.convertSwimFigure(T,o,m.sex)),m.figure=o,m.activityPoints=t.readInt(),m.isModerator=t.readBoolean()}else if(R===2)m.userType=Ye.PET,m.figure=o,m.webID=r,m.subType=t.readInt().toString(),m.ownerId=t.readInt(),m.ownerName=t.readString(),m.rarityLevel=t.readInt(),m.hasSaddle=t.readBoolean(),m.isRiding=t.readBoolean(),m.canBreed=t.readBoolean(),m.canHarvest=t.readBoolean(),m.canRevive=t.readBoolean(),m.hasBreedingPermission=t.readBoolean(),m.petLevel=t.readInt(),m.petPosture=t.readString();else if(R===3)m.userType=Ye.BOT,m.webID=u*-1,o.indexOf("/")===-1?m.figure=o:m.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",m.sex=rr.M;else if(R===4){m.userType=Ye.RENTABLE_BOT,m.webID=r,m.sex=this.resolveSex(t.readString()),m.figure=o,m.ownerId=t.readInt(),m.ownerName=t.readString();const T=t.readInt();if(T){const O=[];let C=0;for(;C<T;)O.push(t.readShort()),C++;m.botSkills=O}}i++}return!0}resolveSex(t){return t.substr(0,1).toLowerCase()==="f"?rr.F:rr.M}convertSwimFigure(t,s,i){const r=s.split(".");let n=1,a=1,o=1;const u=1e4;let l=0;for(;l<r.length;){const R=r[l].split("-");R.length>2&&R[0]==="hd"&&(n=parseInt(R[2])),l++}const c=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],g=t.split("=");if(g.length>1){const f=g[1].split("/");f[0];const R=f[1];i==="F"?o=10010:o=10011;const m=c.indexOf(R);a=u+m+1}return s+(".bds-10001-"+n+".ss-"+o+"-"+a)}get users(){return this._users}}class OT{flush(){return this._unitId=null,!0}parse(t){return t?(this._unitId=parseInt(t.readString()),!0):!1}get unitId(){return this._unitId}}class AT{constructor(t,s){this._action=t,this._value=s}get action(){return this._action}get value(){return this._value}}class ST{constructor(t,s,i,r,n,a,o,u=0,l=0,c=0,g,f,R){this._id=t,this._x=s,this._y=i,this._z=r,this._height=n,this._headDirection=a,this._direction=o,this._targetX=u,this._targetY=l,this._targetZ=c,this._didMove=g,this._canStandUp=f,this._actions=R||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class MT{flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=this.parseStatus(t);if(!i){s--;continue}this._statuses.push(i),s--}return!0}parseStatus(t){if(!t)return null;const s=t.readInt(),i=t.readInt(),r=t.readInt(),n=parseFloat(t.readString()),a=t.readInt()%8*45,o=t.readInt()%8*45,u=t.readString();let l=0,c=0,g=0,f=0,R=!1,m=!1;if(u){const T=u.split("/"),O=[];for(const C of T){const N=C.split(" ");if(N[0]!==""&&N.length>=2){switch(N[0]){case"mv":{const S=N[1].split(",");S.length>=3&&(l=parseInt(S[0]),c=parseInt(S[1]),g=parseFloat(S[2]),m=!0);break}case"sit":{const S=parseFloat(N[1]);N.length>=3&&(R=N[2]==="1"),f=S;break}case"lay":{const S=parseFloat(N[1]);f=Math.abs(S);break}}O.push(new AT(N[0],N[1]))}}this._statuses.push(new ST(s,i,r,n,f,a,o,l,c,g,m,R,O))}}get statuses(){return this._statuses}}const Bo=class{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(e){return e?(this._itemId=e.readInt(),this._furniType=e.readString(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._stuffData=hi.parseObjectData(e),this._isRecyclable=e.readBoolean(),this._tradable=e.readBoolean(),this._isGroupable=e.readBoolean(),this._sellable=e.readBoolean(),this._secondsToExpiration=e.readInt(),this._expirationTimeStamp=Z(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=e.readBoolean(),this._flatId=e.readInt(),this._isWallItem=this._furniType===Bo.WALL_ITEM,this._furniType===Bo.FLOOR_ITEM&&(this._slotId=e.readString(),this._extra=e.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};let ba=Bo;ba.WALL_ITEM="I";ba.FLOOR_ITEM="S";class CT{flush(){return this._items=[],!0}parse(t){return t?(this._items.push(new ba(t)),!0):!1}get items(){return this._items}}class NT{flush(){return!0}parse(t){return!!t}}class DT{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let s=t.readInt();for(;s>0;){const i=new ba(t);i&&this._fragment.set(i.itemId,i),s--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class PT{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class yT{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class LT{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(t){return t?(this._itemType=t.readString(),this._classId=t.readInt(),this._productCode=t.readString(),this._placedItemId=t.readInt(),this._placedItemType=t.readString(),this._placedInRoom=t.readBoolean(),this._petFigureString=t.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class UT{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const t of this._rarityCategories)t&&t.dispose();return this._rarityCategories=[],!0}parse(t){if(!t)return!1;this._nestId=t.readInt(),this._pet1=new Kh(t),this._pet2=new Kh(t);let s=t.readInt();for(;s>0;)this._rarityCategories.push(new oT(t)),s--;return this._resultPetType=t.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class vT{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(t){return t?(this._breedingNestStuffId=t.readInt(),this._result=t.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class bT{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(t){return this._petId=t.readInt(),this._rarityCategory=t.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class rh{constructor(t){this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let s=0;for(;s<this._customPartCount;)this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+(" "+this.custompartCount);for(const s of this.customParts)t=t+(" "+s);return t}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class Fa{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._figureData=new rh(t),this._level=t.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class FT{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(t){return this._pet=new Fa(t),this._boughtAsGift=t.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}class xa{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(t){return t?(this._state=t.readInt(),this._ownPetId=t.readInt(),this._otherPetId=t.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}xa.STATE_CANCEL=1;xa.STATE_ACCEPT=2;xa.STATE_REQUEST=3;class xT{flush(){return this._fragment=null,!0}parse(t){this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let s=t.readInt();for(this._fragment=new Map;s>0;){const i=new Fa(t);this._fragment.set(i.id,i),s--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class GT{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(t){return this._boughtAsGift=t.readBoolean(),this._pet=new Fa(t),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class BT{flush(){return!0}parse(t){return t?(this._petId=t.readInt(),!0):!1}get petId(){return this._petId}}class wT{constructor(t){this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=hi.parseObjectData(t),this._secondsToExpiration=-1,this._expirationTimeStamp=Z(),this._hasRentPeriodStarted=!1,this._creationDay=t.readInt(),this._creationMonth=t.readInt(),this._creationYear=t.readInt(),this._extra=this.furniType==="S"?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class HT{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return t?(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}class Hl{flush(){return!0}parse(t){return t?(this._userId=t.readInt(),this._reason=t.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}}Hl.ERROR_WHILE_COMMIT=1;class VT{flush(){return!0}parse(t){return!!t}}class jT{flush(){return!0}parse(t){return!!t}}class YT{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!t||(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!this.parseItems(t,this._firstUserItemArray))||(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!this.parseItems(t,this._secondUserItemArray))?!1:(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),!0)}parseItems(t,s){let i=t.readInt();for(;i>0;)s.push(new wT(t)),i--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class zT{flush(){return!0}parse(t){return!!t}}class WT{flush(){return!0}parse(t){return!!t}}class nh{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),this._otherUserName=t.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}}nh.REASON_YOU_ARE_ALREADY_TRADING=7;nh.REASON_OTHER_USER_ALREADY_TRADING=8;class kT{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._userCanTrade=t.readInt()===1,this._otherUserId=t.readInt(),this._otherUserCanTrade=t.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class KT{flush(){return!0}parse(t){return!!t}}class XT{flush(){return!0}parse(t){return!!t}}class qT{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(t){return t?(this._respect=t.readInt(),this._petOwnerId=t.readInt(),this._petData=new Fa(t),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===ht.MONSTERPLANT}}class QT{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(t){return t?(this._petId=t.readInt(),this._userId=t.readInt(),this._supplementType=t.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}class si{}si.WATER=0;si.LIGHT=1;si.REVIVE=2;si.REBREED_FERTILIZER=3;si.SPEED_FERTILIZER=4;class JT{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return t?(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class ZT{constructor(t,s,i){this._hasControllers=!1,this._roomId=t,this._roomName=s,this._hasControllers=i}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class $T{constructor(t){this._currentHcStreak=t.readInt(),this._firstSubscriptionDate=t.readString(),this._kickbackPercentage=t.readDouble(),this._totalCreditsMissed=t.readInt(),this._totalCreditsRewarded=t.readInt(),this._totalCreditsSpent=t.readInt(),this._creditRewardForStreakBonus=t.readInt(),this._creditRewardForMonthlySpent=t.readInt(),this._timeUntilPayday=t.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class tp{flush(){return this._data=null,!0}parse(t){return this._data=new $T(t),!0}get data(){return this._data}}class ep{flush(){return this._looks=new Map,!0}parse(t){if(!t)return!1;t.readInt();let s=t.readInt();for(;s>0;){const i=t.readInt(),r=t.readString(),n=t.readString();this._looks.set(i,[r,n]),s--}return!0}get looks(){return this._looks}}class sp{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class ip{flush(){return this._isVip=!1,this._rooms=[],!0}parse(t){if(!t)return!1;this._isVip=t.readBoolean();let s=t.readInt();for(;s>0;)this._rooms.push(new ZT(t.readInt(),t.readString(),t.readBoolean())),s--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class rp{flush(){return this._pageId=-1,this._data=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._data=new La(t),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class np{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(t){return t?(this._type=t.readInt(),this._breedId=t.readInt(),this._paletteId=t.readInt(),this._sellable=t.readBoolean(),this._rare=t.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class ap{flush(){return this._productCode="",this._palettes=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let s=t.readInt();for(;s>0;)this._palettes.push(new np(t)),s--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class op{constructor(t){this._trackingState=t.readInt(),this._id=t.readInt(),this._identifier=t.readString(),this._productCode=t.readString(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),this._purchaseLimit=t.readInt();const s=t.readInt();this._expirationTime=s>0?s*1e3+Date.now():0,this._title=t.readString(),this._description=t.readString(),this._imageUrl=t.readString(),this._iconImageUrl=t.readString(),this._type=t.readInt(),this._subProductCodes=[];let i=t.readInt();for(;i>0;)this._subProductCodes.push(t.readString()),i--;return this}populate(t){t&&(this._id=t.id,this._identifier=t.identifier,this._type=t.type,this._title=t.title,this._description=t.description,this._imageUrl=t.imageUrl,this._iconImageUrl=t.iconImageUrl,this._productCode=t.productCode,this._purchaseLimit=t.purchaseLimit,this._expirationTime=t.expirationTime,this._priceInCredits=t.priceInCredits,this._priceInActivityPoints=t.priceInActivityPoints,this._activityPointType=t.activityPointType,this._subProductCodes=t.subProductCodes,this._trackingState=t.trackingState)}purchase(t){this._purchaseLimit=this._purchaseLimit-t}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class _p{flush(){return!0}parse(t){return!!t}}class hp{flush(){return this._data=null,!0}parse(t){return t?(this._data=new op(t),!0):!1}get data(){return this._data}}class up{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(t){return t?(this._errorCode=t.readString(),!0):!1}get errorCode(){return this._errorCode}}class lp{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(t){return t?(this._productDescription=t.readString(),this._productName=t.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class cp{flush(){return!0}parse(t){return!!t}}class ui{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(t){this._goalId=t.readInt(),this._goalCode=t.readString(),this._result=t.readInt(),this._requiredFurnis=[];let s=t.readInt();for(;s>0;)this._requiredFurnis.push(t.readString()),s--;for(s=t.readInt();s>0;)this._missingFurnis[t.readString()]="",s--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(t){return!!this._missingFurnis[t]}}ui.SUBMITTED=0;ui.ASK_FOR_SUBMIT=1;ui.ASK_FOR_CONFIRM=2;ui.PREREQUISITES_NOT_MET=3;ui.ROOM_DOOR_NOT_OPEN=4;ui.ROOM_TOO_OLD=5;ui.ASK_FOR_ACCEPT_RULES=6;class Ga{}Ga.ALLOWED=0;Ga.REQUIRED_PERK_MISSING=1;Ga.REQUIRED_BADGE_MISSING=2;class dp{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(t){return this._goalId=t.readInt(),this._goalCode=t.readString(),this._resultCode=t.readInt(),this._votesRemaining=t.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===Ga.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class gp{flush(){return this._schedulingStr=null,this._code=null,!0}parse(t){return this._schedulingStr=t.readString(),this._code=t.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class Ep{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(t){return this._isPartOf=t.readBoolean(),this._targetId=t.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class fp{flush(){return!0}parse(t){return!0}}class mp{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(t){return this._timeStr=t.readString(),this._secondsUntil=t.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class Vl{constructor(t){this._recipeName=t.readString(),this._itemName=t.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class Ip{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(t){if(!t)return!1;const s=t.readInt();for(let r=0;r<s;r++)this._recipes.push(new Vl(t));const i=t.readInt();for(let r=0;r<i;r++)this._ingredients.push(t.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class Rp{constructor(t){this._count=t.readInt(),this._itemName=t.readString()}get count(){return this._count}get itemName(){return this._itemName}}class Tp{constructor(){this._ingredients=[]}parse(t){if(!t)return!1;const s=t.readInt();for(let i=0;i<s;i++)this._ingredients.push(new Rp(t));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class pp{parse(t){return t?(this._count=t.readInt(),this._hasRecipes=t.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class Op{parse(t){return t?(this._success=t.readBoolean(),this._success&&(this._result=new Vl(t)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class Ap{flush(){return!0}parse(t){return!!t}}class Sp{constructor(t){if(!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class Mp{flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._failuers.push(new Sp(t)),s--;return!0}get failures(){return this._failuers}}class Cp{flush(){return this._success=!1,!0}parse(t){return t?(this._success=t.readBoolean(),!0):!1}get success(){return this._success}}class Np{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class jl{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class wo{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class Dp{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let s=t.readInt();for(;s>0;)this._fragment.push(new wo(t)),s--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Pp{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._categories.push(new jl(t)),s--;let i=t.readInt();for(;i>0;){const r=t.readInt();r===-1?this._removedFriendIds.push(t.readInt()):r===0?this._updatedFriends.push(new wo(t)):r===1&&this._addedFriends.push(new wo(t)),i--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class yp{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return t?(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class Yl{constructor(t){if(!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class Lp{flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let s=t.readInt();for(;s>0;)this._requests.push(new Yl(t)),s--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class qh{constructor(t){if(!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._lastOnlineData=t.readString(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class Up{flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._friends.push(new qh(t)),s--;let i=t.readInt();for(;i>0;)this._others.push(new qh(t)),i--;return!0}get friends(){return this._friends}get others(){return this._others}}class vp{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class bp{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return t?(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class Fp{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();let s=t.readInt();for(;s>0;)this._categories.push(new jl(t)),s--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class xp{flush(){return!0}parse(t){return!!t}}class Gp{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class Bp{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class wp{flush(){return this._request=null,!0}parse(t){return t?(this._request=new Yl(t),!0):!1}get request(){return this._request}}class Hp{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let s=t.readInt();for(;s>0;)this._failedRecipients.push(t.readInt()),s--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class Vp{flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class jp{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._freeGamesLeft=t.readInt(),this._gamesPlayedTotal=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}class un{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(t){return t?(this._status=t.readInt(),this._blockLength=t.readInt(),this._gamesPlayed=t.readInt(),this._freeGamesLeft=t.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}un.STATUS_OK=0;un.STATUS_FAILED_REASON_UNKNOWN=1;un.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2;un.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;class Yp{flush(){return this._position=-1,!0}parse(t){return t?(this._position=t.readInt(),!0):!1}get position(){return this._position}}class Gs{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}Gs.KICKED=1;Gs.DUPLICATE_MACHINEID=2;Gs.INVITATION_REQUIRED=3;Gs.NO_SPACE_IN_TEAM=4;Gs.TEAM_NOT_FOUND=5;Gs.USER_HAS_ACTIVE_INSTANCE=6;Gs.USER_HAS_PENDING_INSTANCE_REQUEST=7;Gs.USER_HAS_NO_FREE_GAMES_LEFT=8;class ah{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}ah.NOT_ENOUGH_PLAYERS=1;ah.GAME_HAS_NO_OWNER=2;class zp{flush(){return!0}parse(t){return!!t}}class Wp{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class kp{flush(){return!0}parse(t){return t?(this._stuffCode=t.readString(),this._badgeCode=t.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class Kp{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(t){return t?(this._stuffId=t.readInt(),this._achievementId=t.readInt(),this._requiredLevelBadgeCode=t.readString(),this._userProgress=t.readInt(),this._totalProgress=t.readInt(),this._endTime=t.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class Xp{flush(){return!0}parse(t){if(!t)return!1;this._stuffId=t.readInt();const s=t.readInt();let i=0;for(;i<s;)this._achievements.push(new wl(t)),i++;return this._endTime=t.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class qp{constructor(t,s,i,r){this._gameTypeId=t,this._achievementId=s,this._achievementName=i,this._levels=r}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class Qp{flush(){return!0}parse(t){if(!t)return!1;this._achievements=[];const s=t.readInt();let i=0;for(;i<s;){const r=t.readInt(),n=t.readInt();let a=0;for(;a<n;){const o=t.readInt(),u=t.readString(),l=t.readInt();this._achievements.push(new qp(r,o,u,l)),a++}i++}return!0}get achievements(){return this._achievements}}class Jp{constructor(t,s,i,r,n,a){this._gameId=t,this._gameNameId=s,this._bgColor=i,this._textColor=r,this._assetUrl=n,this._supportUrl=a}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class Zp{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._inviterId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class $p{flush(){return!0}parse(t){if(!t)return!1;this._games=[];const s=t.readInt();for(let i=0;i<s;i++){const r=t.readInt(),n=t.readString(),a=t.readString();let o=parseInt(a,16);o=o|4278190080;const u=t.readString();let l=parseInt(u,16);l=l|4278190080;const c=t.readString(),g=t.readString();this._games.push(new Jp(r,n,o,l,c,g))}return!0}get games(){return this._games}}const Ho=class{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._status=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==Ho.OK}get isInMaintenance(){return this._status==Ho.MAINTENANCE}};let oh=Ho;oh.OK=0;oh.MAINTENANCE=1;class tO{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class zl{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._reason=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}}zl.DUPLICATE_MACHINEID=1;class eO{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class sO{flush(){return!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),this._quality=t.readString(),this._scaleMode=t.readString(),this._frameRate=t.readInt(),this._minMajorVersion=t.readInt(),this._minMinorVersion=t.readInt(),this._params=new Map;const s=t.readInt();let i=0;for(;i<s;)this._params.set(t.readString(),t.readString()),i++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class iO{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class rO{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class nO{flush(){return!0}parse(t){return!!t}}class Ba{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(t){return t?(this._year=t.readInt(),this._week=t.readInt(),this._maxOffset=t.readInt(),this._currentOffset=t.readInt(),this._minutesUntilReset=t.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class aO{constructor(t){this._name=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._rank=t.readInt(),this._score=t.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class oO{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let s=t.readInt();for(;s>0;)this._products.push(new _i(t)),s--;return this._minutesUntilNextWeek=t.readInt(),this._rewardingOn=t.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class _O{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let s=t.readInt();for(;s>0;)this._winners.push(new aO(t)),s--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class hO{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class uO{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._phoneStatusCode=t.readInt(),this._collectionStatusCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class lO{flush(){return this._resultCode=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class cO{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class dO{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const o=t.readInt(),u=t.readString(),l=t.readString();this._bases.set(o,[u,l]),s--}let i=t.readInt();for(;i>0;){const o=t.readInt(),u=t.readString(),l=t.readString();this._symbols.set(o,[u,l]),i--}let r=t.readInt();for(;r>0;){const o=t.readInt(),u=t.readString();this._partColors.set(o,u),r--}let n=t.readInt();for(;n>0;){const o=t.readInt(),u=t.readString();this._colorsA.set(o,u),n--}let a=t.readInt();for(;a>0;){const o=t.readInt(),u=t.readString();this._colorsB.set(o,u),a--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class gO{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(t){if(!t)return!1;this._groupCost=t.readInt();let s=t.readInt();for(;s>0;){const i=t.readInt(),r=t.readString();t.readBoolean(),this._availableRooms.set(i,r),s--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class EO{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(t){return t?(this._userId=t.readInt(),this._furnitureCount=t.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class fO{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(t){return t?(this._id=t.readInt(),t.readBoolean(),this._type=t.readInt(),this._title=t.readString(),this._description=t.readString(),this._badge=t.readString(),this._roomId=t.readInt(),this._roomName=t.readString(),this._membershipType=t.readInt(),this._membersCount=t.readInt(),this._isFavorite=t.readBoolean(),this._createdAt=t.readString(),this._isOwner=t.readBoolean(),this._isAdmin=t.readBoolean(),this._ownerName=t.readString(),this._flag=t.readBoolean(),this._canMembersDecorate=t.readBoolean(),this._pendingRequestsCount=t.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class mO{constructor(t){this.isBase=t,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}class ln{}ln.OWNER=0;ln.ADMIN=1;ln.MEMBER=2;ln.REQUESTED=3;ln.DELETED=4;class IO{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(t){return t?(this._rank=t.readInt(),this._id=t.readInt(),this._name=t.readString(),this._figure=t.readString(),this._joinedAt=t.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class RO{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._groupTitle=t.readString(),this._roomId=t.readInt(),this._badge=t.readString(),this._totalMembersCount=t.readInt();let s=t.readInt();for(;s>0;)this._result.push(new IO(t)),s--;return this._admin=t.readBoolean(),this._pageSize=t.readInt(),this._pageIndex=t.readInt(),this._level=t.readInt(),this._query=t.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class TO{flush(){return this._roomId=0,this._groupId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._groupId=t.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class pO{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(t){if(!t)return!1;t.readInt()===1&&(this._roomId=t.readInt(),this._roomName=t.readString(),t.readBoolean()),t.readBoolean(),this._id=t.readInt(),this._title=t.readString(),this._description=t.readString(),t.readInt(),this._colorA=t.readInt(),this._colorB=t.readInt(),this._state=t.readInt(),this._canMembersDecorate=t.readInt()===0,t.readBoolean(),t.readString();const i=t.readInt();for(let r=0;r<i;r++){const n=new mO(r===0);n.key=t.readInt(),n.color=t.readInt(),n.position=t.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(r,n)}return this._badgeCode=t.readString(),this._membersCount=t.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class OO{flush(){return!0}parse(t){return this._groupId=t.readInt(),!0}get groupId(){return this._groupId}}class Zr{static parse(t){return this.fillFromMessage(new Zr,t)}static fillFromMessage(t,s){return t._groupId=s.readInt(),t._name=s.readString(),t._description=s.readString(),t._icon=s.readString(),t._totalThreads=s.readInt(),t._leaderboardScore=s.readInt(),t._totalMessages=s.readInt(),t._unreadMessages=s.readInt(),t._lastMessageId=s.readInt(),t._lastMessageAuthorId=s.readInt(),t._lastMessageAuthorName=s.readString(),t._lastMessageTimeAsSecondsAgo=s.readInt(),t}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(t){this._totalThreads=t._totalThreads,this._totalMessages=t._totalMessages,this._unreadMessages=t._unreadMessages,this._lastMessageAuthorId=t._lastMessageAuthorId,this._lastMessageAuthorName=t._lastMessageAuthorName,this._lastMessageId=t._lastMessageId,this._lastMessageTimeAsSecondsAgo=t._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(t){this._unreadMessages=this._totalMessages-t,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(t){this._lastMessageAuthorId=t.lastUserId,this._lastMessageAuthorName=t.lastUserName,this._lastMessageId=t.lastMessageId,this._lastMessageTimeAsSecondsAgo=t.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class _h extends Zr{static parse(t){const s=new _h;return Zr.fillFromMessage(s,t),s._readPermissions=t.readInt(),s._postMessagePermissions=t.readInt(),s._postThreadPermissions=t.readInt(),s._moderatePermissions=t.readInt(),s._readPermissionError=t.readString(),s._postMessagePermissionError=t.readString(),s._postThreadPermissionError=t.readString(),s._moderatePermissionError=t.readString(),s._reportPermissionError=t.readString(),s._canChangeSettings=t.readBoolean(),s._isStaff=t.readBoolean(),s}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class AO{flush(){return this._extendedForumData=null,!0}parse(t){return t?(this._extendedForumData=_h.parse(t),!0):!1}get extendedForumData(){return this._extendedForumData}}class SO{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(t){if(!t)return!1;this._listCode=t.readInt(),this._totalAmount=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._forums=[];let s=0;for(;s<this._amount;)this._forums.push(Zr.parse(t)),s++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class cn{static parse(t){const s=new cn;return s._threadId=t.readInt(),s._authorId=t.readInt(),s._authorName=t.readString(),s._header=t.readString(),s._isPinned=t.readBoolean(),s._isLocked=t.readBoolean(),s._creationTimeAsSecondsAgo=t.readInt(),s._totalMessages=t.readInt(),s._unreadMessagesCount=t.readInt(),s._lastMessageId=t.readInt(),s._lastUserId=t.readInt(),s._lastUserName=t.readString(),s._lastCommentTime=t.readInt(),s._state=t.readByte(),s._adminId=t.readInt(),s._adminName=t.readString(),s._adminOperationTimeAsSecondsAgo=t.readInt(),s}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(t){this._adminOperationTimeAsSecondsAgo=t}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(t){this._lastCommentTime=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(t){this._creationTimeAsSecondsAgo=t}get header(){return this._header}set header(t){this._header=t}get lastMessageId(){return this._lastMessageId}set lastMessageId(t){this._lastMessageId=t}get lastUserId(){return this._lastUserId}set lastUserId(t){this._lastUserId=t}get lastUserName(){return this._lastUserName}set lastUserName(t){this._lastUserName=t}get totalMessages(){return this._totalMessages}set totalMessages(t){this._totalMessages=t}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(t){this._unreadMessagesCount=t}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get isPinned(){return this._isPinned}set isPinned(t){this._isPinned=t}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}}class MO{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._threads=[];let s=0;for(;s<this._amount;)this._threads.push(cn.parse(t)),s++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class dn{static parse(t){const s=new dn;return s._messageId=t.readInt(),s._messageIndex=t.readInt(),s._authorId=t.readInt(),s._authorName=t.readString(),s._authorFigure=t.readString(),s._creationTime=t.readInt(),s._messageText=t.readString(),s._state=t.readByte(),s._adminId=t.readInt(),s._adminName=t.readString(),s._adminOperationTimeAsSeccondsAgo=t.readInt(),s._authorPostCount=t.readInt(),s}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(t){this._adminOperationTimeAsSeccondsAgo=t}get messageId(){return this._messageId}set messageId(t){this._messageId=t}get creationTime(){return this._creationTime}set creationTime(t){this._creationTime=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get authorFigure(){return this._authorFigure}set authorFigure(t){this._authorFigure=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get messageIndex(){return this._messageIndex}set messageIndex(t){this._messageIndex=t}set groupID(t){this._groupId=t}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get messageText(){return this._messageText}set messageText(t){this._messageText=t}get authorPostCount(){return this._authorPostCount}set authorPostCount(t){this._authorPostCount=t}}class CO{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=dn.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class NO{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=cn.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class DO{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._threadId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._messages=[];let s=0;for(;s<this._amount;){const i=dn.parse(t);i.groupID=this._groupId,i.threadId=this._threadId,this._messages.push(i),s++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class PO{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class yO{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=dn.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class LO{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=cn.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class UO{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(t){return t?(this._encryptedPublicKey=t.readString(),t.bytesAvailable&&(this._serverClientEncryption=t.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class vO{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=0,t.bytesAvailable&&(this._reason=t.readInt()),!0):!1}get reason(){return this._reason}}class bO{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(t){if(!t)return!1;this._accounts=new Map;let s=t.readInt();for(;s>0;)this._accounts.set(t.readInt(),t.readString()),s--;return!0}get accounts(){return this._accounts}}class FO{flush(){return!0}parse(t){return t?(this._encryptedPrime=t.readString(),this._encryptedGenerator=t.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class xO{flush(){return this._noobnessLevel=0,!0}parse(t){return t?(this._noobnessLevel=t.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class GO{flush(){return!0}parse(t){return t?(this._infoUrl=t.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class BO{flush(){return!0}parse(t){return!0}}class wO{flush(){return this._calls=[],!0}parse(t){this._calls=[];const s=t.readInt();for(let i=0;i<s;i++){const r=t.readString(),n=t.readString(),a=t.readString();this._calls.push({callId:r,timeStamp:n,message:a})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class HO{flush(){return this._message=null,!0}parse(t){return this._message=t.readString(),!0}get message(){return this._message}}class VO{flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return t?(this._resultType=t.readInt(),this._messageText=t.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class jO{flush(){return!0}parse(t){return!0}}class YO{flush(){return this._acceptanceTimeout=-1,!0}parse(t){return this._acceptanceTimeout=t.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class zO{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(t){this._finalStatus=[],this._winningVoteCode=t.readInt(),this._ownVoteCode=t.readInt();const s=t.readInt();for(let i=0;i<s;i++)this._finalStatus.push(t.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class WO{flush(){return!0}parse(t){return this._votingTimeout=t.readInt(),this._chatRecord=t.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}class Gi{flush(){return this._status=null,!0}parse(t){this._status=[];const s=t.readInt();for(let i=0;i<s;i++)this._status.push(t.readInt());return!0}get status(){return this._status}}Gi.AWAITING_VOTE=0;Gi.VOTED_OK=1;Gi.VOTED_BAD=2;Gi.VOTED_VERY_BAD=3;Gi.NO_VOTE=4;Gi.FINDING_NEW_VOTER=5;class kO{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(t){return t?(this._onDuty=t.readBoolean(),this._guidesOnDuty=t.readInt(),this._helpersOnDuty=t.readInt(),this._guardiansOnDuty=t.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class KO{constructor(t,s,i,r,n,a,o){this._type=t,this._secondsAgo=s,this._isGuide=i,this._otherPartyName=r,this._otherPartyFigure=n,this._description=a,this._roomName=o}get type(){return this._type}set type(t){this._type=t}get secondsAgo(){return this._secondsAgo}set secondsAgo(t){this._secondsAgo=t}get isGuide(){return this._isGuide}set isGuide(t){this._isGuide=t}get otherPartyName(){return this._otherPartyName}set otherPartyName(t){this._otherPartyName=t}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(t){this._otherPartyFigure=t}get description(){return this._description}set description(t){this._description=t}get roomName(){return this._roomName}set roomName(t){this._roomName=t}}class gn{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(t){return t?(this._statusCode=t.readInt(),this._pendingTicket=new KO(t.readInt(),t.readInt(),t.readBoolean(),t.readString(),t.readString(),t.readString(),t.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}}gn.GUIDE_REPORTING_STATUS_OK=0;gn.GUIDE_REPORTING_STATUS_PENDING_TICKET=1;gn.GUIDE_REPORTING_STATUS_ABUSIVE=2;gn.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;class XO{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(t){return t?(this._asGuide=t.readBoolean(),this._helpRequestType=t.readInt(),this._helpRequestDescription=t.readString(),this._roleSpecificWaitTime=t.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class qO{flush(){return!0}parse(t){return!!t}}class QO{flush(){return this._endReason=0,!0}parse(t){return t?(this._endReason=t.readInt(),!0):!1}get endReason(){return this._endReason}}class fr{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}fr.ERROR_GENERIC=0;fr.ERROR_GUIDES_REJECT=1;fr.ERROR_NOT_ENOUGH_GUIDES=2;fr.ERROR_NOT_ENOUGH_VOTES=3;fr.ERROR_NO_CHATLOG_FOUND=4;class JO{flush(){return this._roomId=0,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class ZO{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(t){return t?(this._chatMessage=t.readString(),this._senderId=t.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class $O{flush(){return this._isTyping=!1,!0}parse(t){return t?(this._isTyping=t.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class tA{flush(){return this._requesterRoomId=0,!0}parse(t){return t?(this._requesterRoomId=t.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class eA{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(t){return t?(this._requesterUserId=t.readInt(),this._requesterName=t.readString(),this._requesterFigure=t.readString(),this._guideUserId=t.readInt(),this._guideName=t.readString(),this._guideFigure=t.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}class En{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}En.CREATION_RESULT_OK=0;En.CREATION_RESULT_UNABLE_TO_REPORT=1;En.CREATION_RESULT_NO_CHATLOG_FOUND=2;En.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;class wa{flush(){return this._resolution=0,!0}parse(t){return t?(this._resolution=t.readInt(),!0):!1}get resolution(){return this._resolution}}wa.RESOLUTION_GUARDIANS_TOOK_ACTION=0;wa.RESOLUTION_FORWARDED_TO_MODERATORS=1;wa.RESOLUTION_REPORTER_IS_ABUSIVE=2;class sA{flush(){return!0}parse(t){return!!t}}class iA{flush(){return this._closeReason=0,this._messageText="",!0}parse(t){return t?(this._closeReason=t.readInt(),this._messageText=t.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class rA{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const s=t.readInt();this._questionIds=[];for(let i=0;i<s;i++)this._questionIds.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class nA{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const s=t.readInt();this._questionIdsForWrongAnswers=[];for(let i=0;i<s;i++)this._questionIdsForWrongAnswers.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class Ha{constructor(t){this._id=t.readInt(),this._title=t.readString(),this._bodyText=t.readString(),this._buttonText=t.readString(),this._linkType=t.readInt(),this._linkContent=t.readString(),this._imageUrl=t.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}}Ha.LINK_TYPE_URL=0;Ha.LINK_TYPE_INTERNAL=1;Ha.LINK_TYPE_NO_LINK=2;class aA{flush(){return this._articles=[],!0}parse(t){if(!t)return!1;const s=t.readInt();for(let i=0;i<s;i++)this._articles.push(new Ha(t));return!0}get articles(){return this._articles}}class oA{flush(){return!0}parse(t){return t?(this._acknowledged=t.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class _A{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(t){return t?(this._result=t.readInt(),this._newOfferId=t.readInt(),this._newPrice=t.readInt(),this._requestedOfferId=t.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class hA{flush(){return this._offerId=0,this._success=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._success=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class uA{flush(){return this._tokenCount=0,this._result=0,!0}parse(t){return t?(this._result=t.readInt(),this._tokenCount=t.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class lA{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(t){return t?(this._enabled=t.readBoolean(),this._commission=t.readInt(),this._credits=t.readInt(),this._advertisements=t.readInt(),this._minimumPrice=t.readInt(),this._maximumPrice=t.readInt(),this._offerTime=t.readInt(),this._displayTime=t.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class cA{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class dA{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(t){if(!t)return!1;this._averagePrice=t.readInt(),this._currentOfferCount=t.readInt(),this._historyLength=t.readInt();let s=t.readInt();for(;s>0;)this._dayOffsets.push(t.readInt()),this._averagePrices.push(t.readInt()),this._soldAmounts.push(t.readInt()),s--;return this._furniCategoryId=t.readInt(),this._furniTypeId=t.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class Wl{constructor(t,s,i,r,n,a,o,u,l,c=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=s,this._furniType=i,this._extraData=r,this._stuffData=n,this._price=a,this._status=o,this._timeLeftMinutes=u,this._averagePrice=l,this._offerCount=c}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}const Ur=class{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(e){if(!e)return!1;const t=e.readInt();let s=0;for(;s<t;){const i=e.readInt(),r=e.readInt();let n=e.readInt(),a=-1,o="",u=null;n===Ur.FURNITYPE_STUFF?(a=e.readInt(),u=hi.parseObjectData(e)):n===Ur.FURNITYPE_WALL?(a=e.readInt(),o=e.readString()):n==Ur.FAKE_FURNITYPE_UNIQUE&&(a=e.readInt(),u=$s.getData(me.FORMAT_KEY),u.uniqueNumber=e.readInt(),u.uniqueSeries=e.readInt(),n=Ur.FURNITYPE_STUFF);const l=e.readInt(),c=e.readInt(),g=e.readInt(),f=e.readInt(),R=new Wl(i,a,n,o,u,l,r,c,g,f);s<this.MAX_LIST_LENGTH&&this._offers.push(R),s++}return this._totalItemsFound=e.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};let Va=Ur;Va.FURNITYPE_STUFF=1;Va.FURNITYPE_WALL=2;Va.FAKE_FURNITYPE_UNIQUE=3;const kl=class{flush(){return this._offers=[],!0}parse(e){if(!e)return!1;this._offers=[],this._creditsWaiting=e.readInt();const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),r=e.readInt();let n=e.readInt(),a,o,u;n==1?(a=e.readInt(),u=this.getStuffData(e)):n==2?(a=e.readInt(),o=e.readString()):n==3&&(a=e.readInt(),u=$s.getData(me.FORMAT_KEY),u.uniqueNumber=e.readInt(),u.uniqueSeries=e.readInt(),n=1);const l=e.readInt(),c=e.readInt(),g=e.readInt(),f=new Wl(i,a,n,o,u,l,r,c,g);s<kl.MAX_LIST_LENGTH&&this._offers.push(f)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(e){const t=e.readInt(),s=$s.getData(t);return s.parseWrapper(e),s}};let Kl=kl;Kl.MAX_LIST_LENGTH=500;class gA{constructor(t,s,i,r,n){this._timestamp=t,this._habboId=s,this._username=i,this._message=r,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}class os{constructor(t){this._context=new Map,this._chatlog=[],this._recordType=t.readByte();const s=t.readShort();for(let r=0;r<s;r++){const n=t.readString(),a=t.readByte();switch(a){case 0:this._context.set(n,t.readBoolean());break;case 1:this._context.set(n,t.readInt());break;case 2:this._context.set(n,t.readString());break;default:throw new Error("Unknown data type "+a)}}const i=t.readShort();for(let r=0;r<i;r++){const n=t.readString(),a=t.readInt(),o=t.readString(),u=t.readString(),l=t.readBoolean();this._chatlog.push(new gA(n,a,o,u,l))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(t){const s=this._context.get(t);return s||0}}os.TYPE_SIMPLE=0;os.TYPE_ROOM_CHAT=1;os.TYPE_IM_SESSION=2;os.TYPE_DISCUSSION_THREAD=3;os.TYPE_DISCUSSION_MESSAGE=4;os.TYPE_SELFIE=5;os.TYPE_PHOTO=6;class EA{constructor(t){this._issueId=t.readInt(),this._callerUserId=t.readInt(),this._reportedUserId=t.readInt(),this._chatRecordId=t.readInt(),this._chatRecord=new os(t)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class fA{flush(){return this._data=null,!0}parse(t){return t?(this._data=new EA(t),!0):!1}get data(){return this._data}}class mA{flush(){return!0}parse(t){return this._issueId=parseInt(t.readString()),!0}get issueId(){return this._issueId}}class fn{constructor(t,s,i,r,n,a,o,u,l,c,g,f,R,m,T,O){this._disposed=!1,this._issueId=t,this._state=s,this._categoryId=i,this._reportedCategoryId=r,this._issueAgeInMilliseconds=n,this._priority=a,this._groupingId=o,this._reporterUserId=u,this._reporterUserName=l,this._reportedUserId=c,this._reportedUserName=g,this._pickerUserId=f,this._pickerUserName=R,this._message=m,this._chatRecordId=T,this._patterns=O,this._creationTimeInMilliseconds=Z()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const t of this._patterns)t.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(t){const i=(this._issueAgeInMilliseconds+t-this._creationTimeInMilliseconds)/1e3/60,r=i%60,n=i/60,a=(r<10?"0":"")+r;return(n<10?"0":"")+n+":"+a}}fn.STATE_OPEN=1;fn.STATE_PICKED=2;fn.STATE_CLOSED=3;class IA{constructor(t){this._disposed=!1,this._pattern=t.readString(),this._startIndex=t.readInt(),this._endIndex=t.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class Xl{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(t){const s=t.readInt(),i=t.readInt(),r=t.readInt(),n=t.readInt(),a=t.readInt(),o=t.readInt(),u=t.readInt(),l=t.readInt(),c=t.readString(),g=t.readInt(),f=t.readString(),R=t.readInt(),m=t.readString(),T=t.readString(),O=t.readInt(),C=t.readInt(),N=[];for(let S=0;S<C;S++)N.push(new IA(t));return this._issueData=new fn(s,i,r,n,a,o,u,l,c,g,f,R,m,T,O,N),!0}}class RA{flush(){return this._issues=null,!0}parse(t){this._issues=[];const s=t.readInt();for(let i=0;i<s;i++){const r=t.readInt(),n=t.readInt(),a=t.readString(),o=new fn(r,0,0,0,0,0,0,0,null,0,null,n,a,null,0,[]);this._issues.push(o)}return this._retryEnabled=t.readBoolean(),this._retryCount=t.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class TA{flush(){return this._message="",this._url=null,!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class pA{flush(){return this._userId=-1,this._success=!1,!0}parse(t){return this._userId=t.readInt(),this._success=t.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class OA{constructor(t){this._disposed=!1;const s=new Xl;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let i=t.readInt(),r=0;for(;r<i;)s.parse(t)&&this._issues.push(s.issueData),r++;for(i=t.readInt(),r=0;r<i;)this._messageTemplates.push(t.readString()),r++;for(i=t.readInt(),r=0;r<i;)t.readString(),r++;for(this._cfhPermission=t.readBoolean(),this._chatlogsPermission=t.readBoolean(),this._alertPermission=t.readBoolean(),this._kickPermission=t.readBoolean(),this._banPermission=t.readBoolean(),this._roomAlertPermission=t.readBoolean(),this._roomKickPermission=t.readBoolean(),i=t.readInt(),r=0;r<i;)this._roomMessageTemplates.push(t.readString()),r++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class AA{constructor(){this._data=null}flush(){return this._data=null,!0}parse(t){return this._data=new OA(t),!0}get data(){return this._data}}class SA{flush(){return this._message="",this._url="",!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class MA{constructor(t){if(this._tags=[],this._exists=t.readBoolean(),!this.exists)return;this._name=t.readString(),this._desc=t.readString();const s=t.readInt();for(let i=0;i<s;i++)this._tags.push(t.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class CA{constructor(t){this._flatId=t.readInt(),this._userCount=t.readInt(),this._ownerInRoom=t.readBoolean(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._room=new MA(t)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class NA{flush(){return this._data=null,!0}parse(t){return t?(this._data=new CA(t),!0):!1}get data(){return this._data}}class DA{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(t){return this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class PA{constructor(t){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._registrationAgeInMinutes=t.readInt(),this._minutesSinceLastLogin=t.readInt(),this._online=t.readBoolean(),this._cfhCount=t.readInt(),this._abusiveCfhCount=t.readInt(),this._cautionCount=t.readInt(),this._banCount=t.readInt(),this._tradingLockCount=t.readInt(),this._tradingExpiryDate=t.readString(),this._lastPurchaseDate=t.readString(),this._identityId=t.readInt(),this._identityRelatedBanCount=t.readInt(),this._primaryEmailAddress=t.readString(),this._userClassification=t.readString(),t.bytesAvailable&&(this._lastSanctionTime=t.readString(),this._sanctionAgeHours=t.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class yA{flush(){return this._data=null,!0}parse(t){return t?(this._data=new PA(t),!0):!1}get data(){return this._data}}class LA{flush(){return this._data=null,!0}parse(t){return t?(this._data=new os(t),!0):!1}get data(){return this._data}}class UA{constructor(t){this._roomId=t.readInt(),this._roomName=t.readString(),this._enterHour=t.readInt(),this._enterMinute=t.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class vA{constructor(t){this._rooms=[],this._userId=t.readInt(),this._userName=t.readString();const s=t.readInt();let i=0;for(;i<s;)this._rooms.push(new UA(t)),i++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class bA{flush(){return!0}parse(t){return this._data=new vA(t),!0}get data(){return this._data}}class FA{flush(){return this._message="",!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class xA{constructor(t){this._roomChatlogs=[],this._userId=t.readInt(),this._username=t.readString();const s=t.readInt();for(let i=0;i<s;i++)this._roomChatlogs.push(new os(t))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class GA{flush(){return this._data=null,!0}parse(t){return t?(this._data=new xA(t),!0):!1}get data(){return this._data}}class BA{flush(){return!0}parse(t){return!!t}}class wA{flush(){return!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class HA{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(t){return t?(this._boxColor=t.readString(),this._keyColor=t.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class VA{flush(){return!0}parse(t){return!!t}}class jA{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(t){return t?(this._canCreate=t.readBoolean(),this._errorCode=t.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}class hh{flush(){return!0}parse(t){return t?(this._resultCode=t.readInt(),this._roomLimit=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}}hh.CREATION_ALLOWED=0;hh.ROOM_LIMIT_REACHED=1;class YA{constructor(t){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const s=t.readInt();for(let i=0;i<s;i++){const r=t.readInt(),n=t.readInt(),a=t.readInt();this._categoryToCurrentUserCountMap.set(r,n),this._categoryToMaxUserCountMap.set(r,a)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class zA{constructor(t,s=0,i=0){this._goalId=s,this._pageIndex=i,t&&(this._goalId=t.readInt(),this._pageIndex=t.readInt(),this._pageCount=t.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const vr=class{constructor(e){this._index=e.readInt(),this._popupCaption=e.readString(),this._popupDesc=e.readString(),this._showDetails=e.readInt()==1,this._picText=e.readString(),this._picRef=e.readString(),this._folderId=e.readInt(),this._userCount=e.readInt(),this._type=e.readInt(),this._type==vr.TYPE_TAG?this._tag=e.readString():this._type==vr.TYPE_GUEST_ROOM?this._guestRoomData=new le(e):this._open=e.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==vr.TYPE_TAG?0:this.type==vr.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};let ja=vr;ja.TYPE_TAG=1;ja.TYPE_GUEST_ROOM=2;ja.TYPE_FOLDER=4;class WA{constructor(t){this._rooms=[],this._searchType=t.readInt(),this._searchParam=t.readString();const s=t.readInt();for(let r=0;r<s;r++)this._rooms.push(new le(t));t.readBoolean()&&(this._ad=new ja(t))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const t of this._rooms)t.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class ql{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return t?(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class kA{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let s=t.readInt();for(;s>0;)this._rooms.push(new le(t)),s--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class KA{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let s=t.readInt();for(;s>0;)this._results.push(new kA(t)),s--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class XA{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let s=t.readInt();for(;s>0;)this._savedSearches.push(new ql(t)),s--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class qA{constructor(t){this._adId=t.readInt(),this._ownerAvatarId=t.readInt(),this._ownerAvatarName=t.readString(),this._flatId=t.readInt(),this._eventType=t.readInt(),this._eventName=t.readString(),this._eventDescription=t.readString();const s=t.readInt(),i=t.readInt(),r=new Date;let n=r.getTime();const a=s*60*1e3;n=n-a;const o=new Date(n);this._creationTime=o.getDate()+"-"+o.getMonth()+"-"+o.getFullYear()+" "+o.getHours()+":"+o.getMinutes();let u=r.getTime();const l=i*60*1e3;u=u+l,this._expirationDate=new Date(u),this._categoryId=t.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class QA{flush(){return!0}parse(t){return t?(this._data=new YA(t),!0):!1}get data(){return this._data}}class JA{flush(){return!0}parse(t){return t?(this._data=new zA(t),!0):!1}get data(){return this._data}}class ZA{flush(){return!0}parse(t){return t?(this._globalId=t.readString(),this._convertedId=t.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class $A{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class tS{flush(){return!0}parse(t){return t?(this._flatId=t.readInt(),this._added=t.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class eS{flush(){return!0}parse(t){if(!t)return!1;this._favouriteRoomIds=[],this._limit=t.readInt();const s=t.readInt();for(let i=0;i<s;i++)this._favouriteRoomIds.push(t.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class sS{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class iS{flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class rS{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(t){return t?(this._roomEnter=t.readBoolean(),this._data=new le(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isGroupMember=t.readBoolean(),this.data.allInRoomMuted=t.readBoolean(),this._moderation=new hn(t),this.data.canMute=t.readBoolean(),this._chat=new Re(t),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class nS{flush(){return!0}parse(t){return t?(this._data=new WA(t),!0):!1}get data(){return this._data}}class aS{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class oS{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._categories.push(t.readString()),s--;return!0}get categories(){return this._categories}}class _S{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class hS{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return t?(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class uS{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class lS{flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._rooms.push(new uS(t)),s--;return!0}get rooms(){return this._rooms}}class cS{flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._topLevelContexts.push(new XA(t)),s--;return!0}get topLevelContexts(){return this._topLevelContexts}}class dS{flush(){return!0}parse(t){return!!t}}class gS{flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._searches.push(new ql(t)),s--;return!0}get searches(){return this._searches}}class ES{flush(){return this._result=null,!0}parse(t){return t?(this._result=new KA(t),!0):!1}get result(){return this._result}}class fS{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return t?(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class mS{constructor(t){this._tagName=t.readString(),this._userCount=t.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class IS{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._tags=[],!0}parse(t){if(!t)return!1;this._tags=[];const s=t.readInt();let i=0;for(;i<s;)this._tags.push(new mS(t)),i++;return!0}get tags(){return this._tags}}class RS{flush(){return this._data=null,!0}parse(t){return t?(this._data=new IS(t),!0):!1}get data(){return this._data}}class TS{flush(){return!0}parse(t){return!0}}class pS{flush(){return!0}parse(t){return this._data=new qA(t),!0}get data(){return this._data}}class OS{flush(){return this._words=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._words.push(t.readString()),s--;return!0}get words(){return this._words}}class AS{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class SS{flush(){return!0}parse(t){return this._flatId=t.readInt(),this._resultCode=t.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class MS{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._categories.push(new _S(t)),s--;return!0}get categories(){return this._categories}}class CS{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._categories.push(new aS(t)),s--;return!0}get categories(){return this._categories}}class NS{constructor(t){this._badgeCode="",this._removedBadgeCode="",this._type=t.readInt(),this._level=t.readInt(),this._badgeId=t.readInt(),this._badgeCode=t.readString(),this._points=t.readInt(),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._bonusPoints=t.readInt(),this._achievementID=t.readInt(),this._removedBadgeCode=t.readString(),this._category=t.readString(),this._showDialogToUser=t.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class DS{flush(){return this._data=null,!0}parse(t){return t?(this._data=new NS(t),!0):!1}get data(){return this._data}}class PS{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return t?(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class yS{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class LS{flush(){return this._numGifts=0,!0}parse(t){return t?(this._numGifts=t.readInt(),!0):!1}get numGifts(){return this._numGifts}}class US{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(t){return t?(this._messageId=t.readInt(),this._errorCode=t.readInt(),this._timestamp=t.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class vS{flush(){return this._key=null,!0}parse(t){return t?(this._key=t.readString(),!0):!1}get key(){return this._key}}class bS{flush(){return this._message=null,!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class FS{flush(){return this._enabled=!1,!0}parse(t){return t?(this._enabled=t.readBoolean(),!0):!1}get enabled(){return this._enabled}}class xS{flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;)this._messages.push(t.readString()),s--;return!0}get messages(){return this._messages}}class GS{flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let s=t.readInt();for(;s>0;)this._parameters.set(t.readString(),t.readString()),s--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class BS{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(t){return t?(this._petId=t.readInt(),this._petName=t.readString(),this._level=t.readInt(),this._figureData=new rh(t),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class wS{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class HS{flush(){return this._alertMessage=null,!0}parse(t){return t?(this._alertMessage=t.readString(),t.bytesAvailable&&(this._titleMessage=t.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class VS{flush(){return this._items=new Gt,!0}parse(t){if(!t)return!1;let s=t.readInt();for(;s>0;){const i=t.readInt();let r=t.readInt();const n=[];for(;r>0;)n.push(t.readInt()),r--;this._items.add(i,n),s--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class jS{constructor(t,s,i){this._code=t,this._errorMessage=s,this._isAllowed=i}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}class be{}be.USE_GUIDE_TOOL="USE_GUIDE_TOOL";be.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR";be.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS";be.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS";be.CALL_ON_HELPERS="CALL_ON_HELPERS";be.CITIZEN="CITIZEN";be.TRADE="TRADE";be.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA";be.BUILDER_AT_WORK="BUILDER_AT_WORK";be.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA";be.CAMERA="CAMERA";be.MOUSE_ZOOM="MOUSE_ZOOM";class YS{flush(){return this._perks=[],!0}parse(t){if(!t)return!1;this._perks=[];const s=t.readInt();for(let i=0;i<s;i++)this._perks.push(new jS(t.readString(),t.readString(),t.readBoolean()));return!0}isAllowed(t){let s=!1;for(const i of this._perks)if(i.code===t){s=i.isAllowed;break}return s}get perks(){return this._perks}}class zS{flush(){return this._objectId=-1,this._figureData=null,!0}parse(t){return this._objectId=t.readInt(),t.bytesAvailable&&(this._figureData=new pa(t.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class WS{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(t){return this._objectId=t.readInt(),this._nameValidationStatus=t.readInt(),this._nameValidationInfo=t.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class kS{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(t){return this._roomIndex=t.readInt(),this._petId=t.readInt(),this._level=t.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class KS{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(t){return this._currentAge=t.readInt(),this._requiredAge=t.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class XS{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(t){this._petId=t.readInt();let s=t.readInt();for(;s>0;)this._commands.push(t.readInt()),s--;let i=t.readInt();for(;i>0;)this._enabledCommands.push(t.readInt()),i--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class qS{constructor(t,s,i){this._value=t,this._choiceText=s,this._choiceType=i}get value(){return this._value}set value(t){this._value=t}get choiceText(){return this._choiceText}set choiceText(t){this._choiceText=t}get choiceType(){return this._choiceType}set choiceType(t){this._choiceType=t}}class QS{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get questionType(){return this._questionType}set questionType(t){this._questionType=t}get sortOrder(){return this._sortOrder}set sortOrder(t){this._sortOrder=t}get questionText(){return this._questionText}set questionText(t){this._questionText=t}get questionCategory(){return this._questionCategory}set questionCategory(t){this._questionCategory=t}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(t){this._questionAnswerType=t}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(t){this._questionAnswerCount=t}get children(){return this._children}set children(t){this._children=t}get questionChoices(){return this._questionChoices}set questionChoices(t){this._questionChoices=t}}class JS{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(t){this._id=t.readInt(),this._startMessage=t.readString(),this._endMessage=t.readString(),this._numQuestions=t.readInt();for(let s=0;s<this._numQuestions;s++){const i=this.parsePollQuestion(t),r=t.readInt();for(let n=0;n<r;n++)i.children.push(this.parsePollQuestion(t));this._questionArray.push(i)}return this._npsPoll=t.readBoolean(),!0}parsePollQuestion(t){const s=new QS;if(s.questionId=t.readInt(),s.sortOrder=t.readInt(),s.questionType=t.readInt(),s.questionText=t.readString(),s.questionCategory=t.readInt(),s.questionAnswerType=t.readInt(),s.questionAnswerCount=t.readInt(),s.questionType==1||s.questionType==2)for(let i=0;i<s.questionAnswerCount;i++)s.questionChoices.push(new qS(t.readString(),t.readString(),t.readInt()));return s}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class ZS{flush(){throw!0}parse(t){return!0}}class $S{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(t){return this._id=t.readInt(),this._type=t.readString(),this._headline=t.readString(),this._summary=t.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class tM{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(t){this._userId=t.readInt(),this._value=t.readString(),this._answerCounts=new Map;const s=t.readInt();for(let i=0;i<s;i++){const r=t.readString(),n=t.readInt();this._answerCounts.set(r,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class eM{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(t){this._questionId=t.readInt(),this._answerCounts=new Map;const s=t.readInt();for(let i=0;i<s;i++){const r=t.readString(),n=t.readInt();this._answerCounts.set(r,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class sM{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(t){this._pollType=t.readString(),this._pollId=t.readInt(),this._questionId=t.readInt(),this._duration=t.readInt();const s=t.readInt(),i=t.readInt(),r=t.readInt(),n=t.readString();if(this._question={id:s,number:i,type:r,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=t.readInt();const a=t.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=a,this._question.selection_max=a;for(let o=0;o<a;o++)this._question.selection_values.push(t.readString()),this._question.selections.push(t.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class iM{constructor(t){this._rewardUserLimits=[],this._hasGoalExpired=t.readBoolean(),this._personalContributionScore=t.readInt(),this._personalContributionRank=t.readInt(),this._communityTotalScore=t.readInt(),this._communityHighestAchievedLevel=t.readInt(),this._scoreRemainingUntilNextLevel=t.readInt(),this._percentCompletionTowardsNextLevel=t.readInt(),this._goalCode=t.readString(),this._timeRemainingInSeconds=t.readInt();const s=t.readInt();for(let i=0;i<s;i++)this._rewardUserLimits.push(t.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class rM{constructor(t){this._communityGoalId=t.readInt(),this._communityGoalCode=t.readString(),this._userRank=t.readInt(),this._rewardCode=t.readString(),this._badge=t.readBoolean(),this._localizedName=t.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class nM{flush(){return this._prizes=[],!0}parse(t){if(!t)return!1;const s=t.readInt();for(let i=0;i<s;i++)this._prizes.push(new rM(t));return!0}get prizes(){return this._prizes}}class aM{constructor(t){this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._rank=t.readInt(),this._currentScore=t.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class oM{constructor(t){this._hof=[],this._goalCode=t.readString();const s=t.readInt();for(let i=0;i<s;i++)this._hof.push(new aM(t))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class _M{flush(){return this._data=null,!0}parse(t){return t?(this._data=new oM(t),!0):!1}get data(){return this._data}}class hM{flush(){return this._data=null,!0}parse(t){return t?(this._data=new iM(t),!0):!1}get data(){return this._data}}class uM{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(t){return t?(this._state=t.readInt(),this._userCount=t.readInt(),this._userCountGoal=t.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class lM{flush(){return this._imageUri="",!0}parse(t){return t?(this._imageUri=t.readString(),!0):!1}get imageUri(){return this._imageUri}}class cM{flush(){return!0}parse(t){return t?(this._expired=t.readBoolean(),!0):!1}get expired(){return this._expired}}class Bi{constructor(t){this._receiveTime=new Date,this._campaignCode=t.readString(),this._completedQuestsInCampaign=t.readInt(),this._questCountInCampaign=t.readInt(),this._activityPointType=t.readInt(),this._id=t.readInt(),this._accepted=t.readBoolean(),this._type=t.readString(),this._imageVersion=t.readString(),this._rewardCurrencyAmount=t.readInt(),this._localizationCode=t.readString(),this._completedSteps=t.readInt(),this._totalSteps=t.readInt(),this._sortOrder=t.readInt(),this._catalogPageName=t.readString(),this._chainCode=t.readString(),this._easy=t.readBoolean()}static getCampaignLocalizationKeyForCode(t){return"quests."+t}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(t){this._accepted=t}get accepted(){return this._accepted}set id(t){this._id=t}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(t){this._waitPeriodSeconds=t}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const s=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(s/1e3))}getCampaignLocalizationKey(){return Bi.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class dM{flush(){return this._questData=null,!0}parse(t){return t?(this._questData=new Bi(t),this._showDialog=t.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class gM{flush(){return this._quest=null,!0}parse(t){return t?(t.readBoolean()&&(this._quest=new Bi(t),this._easyQuestCount=t.readInt(),this._hardQuestCount=t.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class EM{flush(){return this._quest=null,!0}parse(t){return t?(this._quest=new Bi(t),!0):!1}get quest(){return this._quest}}class fM{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const s=t.readInt();for(let i=0;i<s;i++)this._quests.push(new Bi(t));return this._openWindow=t.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class mM{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const s=t.readInt();for(let i=0;i<s;i++)this._quests.push(new Bi(t));return!0}get quests(){return this._quests}}class IM{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(t){return t?(this._recyclerFinishedStatus=t.readInt(),this._prizeId=t.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class RM{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(t){return t?(this._recyclerStatus=t.readInt(),this._recyclerTimeoutSeconds=t.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class uh{constructor(t){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let s=t.readInt();for(;s>0;)this._stuffIds.push(t.readInt()),s--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),s=t.readInt();s>0;)this._intParams.push(t.readInt()),s--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return this._intParams[t]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class TM extends uh{constructor(t){super(t),this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class pM extends uh{constructor(t){super(t),this._conflictingActions=[],this._triggerConf=t.readInt();let s=t.readInt();for(;s>0;)this._conflictingActions.push(t.readInt()),s--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class OM extends uh{constructor(t){super(t),this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let s=t.readInt();for(;s>0;)this._conflictingTriggers.push(t.readInt()),s--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class AM{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new OM(t),!0):!1}get definition(){return this._definition}}class SM{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new TM(t),!0):!1}get definition(){return this._definition}}class MM{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new pM(t),!0):!1}get definition(){return this._definition}}class CM{flush(){return this._stuffId=0,!0}parse(t){return t?(this._stuffId=t.readInt(),!0):!1}get stuffId(){return this._stuffId}}class NM{flush(){return this._reason=0,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class DM{flush(){return!0}parse(t){return!!t}}class PM{flush(){return this._info=null,!0}parse(t){return t?(this._info=t.readString(),!0):!1}get info(){return this._info}}class yM{flush(){return!0}parse(t){return!!t}}class LM{flush(){return!0}parse(t){return!0}}class UM{constructor(){this._songDisks=new Gt}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(t){this._maxLength=t.readInt();const s=t.readInt();for(let i=0;i<s;i++)this._songDisks.add(t.readInt(),t.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class vM{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(t){return this._currentSongId=t.readInt(),this._currentPosition=t.readInt(),this._nextSongId=t.readInt(),this._nextPosition=t.readInt(),this._syncCount=t.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class bM{flush(){return this._songId=0,this._officialSongId="",!0}parse(t){return this._officialSongId=t.readString(),this._songId=t.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class Ya{constructor(t,s,i,r){this._startPlayHead=0,this._id=t,this._length=s,this._name=i,this._creator=r}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(t){this._startPlayHead=t}}class FM{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(t){this._synchronizationCount=t.readInt();const s=t.readInt();for(let i=0;i<s;i++)this._playlist.push(new Ya(t.readInt(),t.readInt(),t.readString(),t.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class xM{flush(){return this._entry=null,!0}parse(t){return this._entry=new Ya(t.readInt(),t.readInt(),t.readString(),t.readString()),!0}get entry(){return this._entry}}class GM extends Ya{constructor(t,s,i,r,n){super(t,s,i,r),this._data="",this._data=n}get data(){return this._data}}class BM{flush(){return this._songs=[],!0}parse(t){const s=t.readInt();for(let i=0;i<s;i++){const r=t.readInt();t.readString();const n=t.readString(),a=t.readString(),o=t.readInt(),u=t.readString(),l=new GM(r,o,n,u,a);this._songs.push(l)}return!0}get songs(){return this._songs}}class wM{constructor(){this._songDiskInventory=new Gt}flush(){return this._songDiskInventory.reset(),!0}parse(t){const s=t.readInt();for(let i=0;i<s;i++)this._songDiskInventory.add(t.readInt(),t.readInt());return!0}getDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}get songDiskCount(){return this._songDiskInventory.length}}class HM{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(t){if(!t)return!1;let s=0;this._talentTrackName=t.readString(),this._level=t.readInt();const i=t.readInt();for(;s<i;)this._rewardPerks.push(new WM(t)),s++;const r=t.readInt();if(s<r)for(let n=0;n<r;n++){const a=t.readString(),o=t.readInt();this._rewardProducts.push(new Ql(a,o)),s++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class VM{constructor(t,s,i,r,n){this._level=t,this._state=s,this._tasks=i,this._rewardPerks=r,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class jM{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(t){return t?(this._talentTrackName=t.readString(),this._level=t.readInt(),this._maxLevel=t.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class Ql{constructor(t,s){this._productCode=t,this._vipDays=s}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class YM{constructor(t,s,i,r,n,a){this._id=t,this._requiredLevel=s,this._badgeCode=i,this._state=r,this._currentScore=n,this._totalScore=a}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class zM{flush(){return this._type=null,this._levels=null,!0}parse(t){if(!t)return!1;this._type=t.readString(),this._levels=[];const s=t.readInt();for(let i=0;i<s;i++){const r=t.readInt(),n=t.readInt(),a=[],o=t.readInt();for(let f=0;f<o;f++){const R=t.readInt(),m=t.readInt(),T=t.readString(),O=t.readInt(),C=t.readInt(),N=t.readInt();a.push(new YM(R,m,T,O,C,N))}const u=[],l=t.readInt();for(let f=0;f<l;f++)u.push(t.readString());const c=[],g=t.readInt();for(let f=0;f<g;f++){const R=t.readString(),m=t.readInt();c.push(new Ql(R,m))}this._levels.push(new VM(r,n,a,u,c))}return!0}get type(){return this._type}get levels(){return this._levels}}class WM{constructor(t){this._perkId=t.readInt()}get perkId(){return this._perkId}}class kM{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(t){if(!t)return!1;let s,i,r,n=t.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)s=t.readInt(),i=t.readString(),r=t.readString(),this._classifiedUsersNames.set(s,i),this._classifiedUsersClass.set(s,r),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class KM extends E{constructor(t){super(t,$f)}getParser(){return this.parser}}class XM extends E{constructor(t){super(t,tm)}getParser(){return this.parser}}class Jl extends E{constructor(t){super(t,em)}getParser(){return this.parser}}class qM extends E{constructor(t){super(t,sm)}getParser(){return this.parser}}class QM extends E{constructor(t){super(t,im)}getParser(){return this.parser}}class JM extends E{constructor(t){super(t,rm)}getParser(){return this.parser}}class ZM extends E{constructor(t){super(t,nm)}getParser(){return this.parser}}class $M extends E{constructor(t){super(t,am)}getParser(){return this.parser}}class ke extends E{constructor(t){super(t,om)}getParser(){return this.parser}}ke.NAME_OK=0;ke.ERROR_NAME_REQUIRED=1;ke.ERROR_NAME_TOO_SHORT=2;ke.ERROR_NAME_TOO_LONG=3;ke.ERROR_NAME_NOT_VALID=4;ke.ERROR_NAME_IN_USE=5;ke.ERROR_NAME_CHANGE_NOT_ALLOWED=6;ke.ERROR_MERGE_HOTEL_DOWN=7;class tC extends E{constructor(t){super(t,_m)}getParser(){return this.parser}}class Zl extends E{constructor(t){super(t,hm)}getParser(){return this.parser}}class eC extends E{constructor(t){super(t,lm)}getParser(){return this.parser}}class sC extends E{constructor(t){super(t,cm)}getParser(){return this.parser}}class iC extends E{constructor(t){super(t,dm)}getParser(){return this.parser}}class rC extends E{constructor(t){super(t,gm)}getParser(){return this.parser}}class nC extends E{constructor(t){super(t,Em)}getParser(){return this.parser}}class aC extends E{constructor(t){super(t,Rm)}getParser(){return this.parser}}class oC extends E{constructor(t){super(t,Tm)}getParser(){return this.parser}}class _C extends E{constructor(t){super(t,pm)}getParser(){return this.parser}}class hC extends E{constructor(t){super(t,Om)}getParser(){return this.parser}}class uC extends E{constructor(t){super(t,Am)}getParser(){return this.parser}}class lC extends E{constructor(t){super(t,Sm)}getParser(){return this.parser}}class cC extends E{constructor(t){super(t,Mm)}getParser(){return this.parser}}class dC extends E{constructor(t){super(t,Cm)}getParser(){return this.parser}}class gC extends E{constructor(t){super(t,Nm)}getParser(){return this.parser}}class EC extends E{constructor(t){super(t,Dm)}getParser(){return this.parser}}class fC extends E{constructor(t){super(t,Pm)}getParser(){return this.parser}}class mC extends E{constructor(t){super(t,ym)}getParser(){return this.parser}}class IC extends E{constructor(t){super(t,Lm)}getParser(){return this.parser}}class RC extends E{constructor(t){super(t,Um)}getParser(){return this.parser}}class TC extends E{constructor(t){super(t,bm)}getParser(){return this.parser}}class pC extends E{constructor(t){super(t,Gm)}getParser(){return this.parser}}class OC extends E{constructor(t){super(t,Bm)}getParser(){return this.parser}}class AC extends E{constructor(t){super(t,Fm)}getParser(){return this.parser}}class SC extends E{constructor(t){super(t,wm)}getParser(){return this.parser}}class MC extends E{constructor(t){super(t,Hm)}getParser(){return this.parser}}class CC extends E{constructor(t){super(t,jm)}getParser(){return this.parser}}class NC extends E{constructor(t){super(t,Ym)}getParser(){return this.parser}}class DC extends E{constructor(t){super(t,Wm)}getParser(){return this.parser}}class PC extends E{constructor(t){super(t,km)}getParser(){return this.parser}}class yC extends E{constructor(t){super(t,Km)}getParser(){return this.parser}}class LC extends E{constructor(t){super(t,Xm)}getParser(){return this.parser}}class UC extends E{constructor(t){super(t,qm)}getParser(){return this.parser}}class vC extends E{constructor(t){super(t,Qm)}getParser(){return this.parser}}class bC extends E{constructor(t){super(t,Jm)}getParser(){return this.parser}}class FC extends E{constructor(t){super(t,Zm)}getParser(){return this.parser}}class xC extends E{constructor(t){super(t,$m)}getParser(){return this.parser}}class GC extends E{constructor(t){super(t,tI)}getParser(){return this.parser}}class BC extends E{constructor(t){super(t,eI)}getParser(){return this.parser}}class wC extends E{constructor(t){super(t,sI)}getParser(){return this.parser}}class HC extends E{constructor(t){super(t,rI)}getParser(){return this.parser}}class VC extends E{constructor(t){super(t,ip)}getParser(){return this.parser}}class jC extends E{constructor(t){super(t,rp)}getParser(){return this.parser}}class YC extends E{constructor(t){super(t,ap)}getParser(){return this.parser}}class zC extends E{constructor(t){super(t,hp)}getParser(){return this.parser}}class WC extends E{constructor(t){super(t,_p)}getParser(){return this.parser}}class kC extends E{constructor(t){super(t,up)}getParser(){return this.parser}}class KC extends E{constructor(t){super(t,lp)}getParser(){return this.parser}}class $l extends E{constructor(t){super(t,cp)}getParser(){return this.parser}}class XC extends E{constructor(t){super(t,ui)}getParser(){return this.parser}}class qC extends E{constructor(t){super(t,dp)}getParser(){return this.parser}}class QC extends E{constructor(t){super(t,gp)}getParser(){return this.parser}}class JC extends E{constructor(t){super(t,Ep)}getParser(){return this.parser}}class ZC extends E{constructor(t){super(t,fp)}getParser(){return this.parser}}class $C extends E{constructor(t){super(t,mp)}getParser(){return this.parser}}class tN extends E{constructor(t){super(t,Ip)}getParser(){return this.parser}}class eN extends E{constructor(t){super(t,Tp)}getParser(){return this.parser}}class sN extends E{constructor(t){super(t,pp)}getParser(){return this.parser}}class iN extends E{constructor(t){super(t,Op)}getParser(){return this.parser}}class Vo extends E{constructor(t){super(t,Ap)}getParser(){return this.parser}}class rN extends E{constructor(t){super(t,Mp)}getParser(){return this.parser}}class nN extends E{constructor(t){super(t,Cp)}getParser(){return this.parser}}class aN extends E{constructor(t){super(t,Np)}getParser(){return this.parser}}class oN extends E{constructor(t){super(t,Dp)}getParser(){return this.parser}}class _N extends E{constructor(t){super(t,Pp)}getParser(){return this.parser}}class hN extends E{constructor(t){super(t,yp)}getParser(){return this.parser}}class uN extends E{constructor(t){super(t,Lp)}getParser(){return this.parser}}class lN extends E{constructor(t){super(t,Up)}getParser(){return this.parser}}class cN extends E{constructor(t){super(t,vp)}getParser(){return this.parser}}class dN extends E{constructor(t){super(t,bp)}getParser(){return this.parser}}class gN extends E{constructor(t){super(t,Fp)}getParser(){return this.parser}}class EN extends E{constructor(t){super(t,xp)}getParser(){return this.parser}}class fN extends E{constructor(t){super(t,Gp)}getParser(){return this.parser}}class mN extends E{constructor(t){super(t,Bp)}getParser(){return this.parser}}class tc extends E{constructor(t){super(t,wp)}getParser(){return this.parser}}class IN extends E{constructor(t){super(t,Hp)}getParser(){return this.parser}}class RN extends E{constructor(t){super(t,Vp)}getParser(){return this.parser}}class TN extends E{constructor(t){super(t,jp)}getParser(){return this.parser}}class pN extends E{constructor(t){super(t,un)}getParser(){return this.parser}}class ON extends E{constructor(t){super(t,Yp)}getParser(){return this.parser}}class AN extends E{constructor(t){super(t,Gs)}getParser(){return this.parser}}class SN extends E{constructor(t){super(t,ah)}getParser(){return this.parser}}class MN extends E{constructor(t){super(t,zp)}getParser(){return this.parser}}class CN extends E{constructor(t){super(t,Wp)}getParser(){return this.parser}}class NN extends E{constructor(t){super(t,kp)}getParser(){return this.parser}}class DN extends E{constructor(t){super(t,Kp)}getParser(){return this.parser}}class PN extends E{constructor(t){super(t,Xp)}getParser(){return this.parser}}class yN extends E{constructor(t){super(t,Qp)}getParser(){return this.parser}}class LN extends E{constructor(t){super(t,Zp)}getParser(){return this.parser}}class UN extends E{constructor(t){super(t,$p)}getParser(){return this.parser}}class vN extends E{constructor(t){super(t,oh)}getParser(){return this.parser}}class bN extends E{constructor(t){super(t,tO)}getParser(){return this.parser}}class FN extends E{constructor(t){super(t,zl)}getParser(){return this.parser}}class xN extends E{constructor(t){super(t,eO)}getParser(){return this.parser}}class GN extends E{constructor(t){super(t,sO)}getParser(){return this.parser}}class ec extends E{constructor(t){super(t,iO)}getParser(){return this.parser}}class BN extends E{constructor(t){super(t,rO)}getParser(){return this.parser}}class wN extends E{constructor(t){super(t,nO)}getParser(){return this.parser}}class HN extends E{constructor(t){super(t,Ba)}getParser(){return this.parser}}class VN extends E{constructor(t){super(t,Ba)}getParser(){return this.parser}}class jN extends E{constructor(t){super(t,Ba)}getParser(){return this.parser}}class YN extends E{constructor(t){super(t,Ba)}getParser(){return this.parser}}class zN extends E{constructor(t){super(t,oO)}getParser(){return this.parser}}class WN extends E{constructor(t){super(t,_O)}getParser(){return this.parser}}class jo extends E{constructor(t){super(t,hO)}getParser(){return this.parser}}class kN extends E{constructor(t){super(t,uO)}getParser(){return this.parser}}class KN extends E{constructor(t){super(t,lO)}getParser(){return this.parser}}class XN extends E{constructor(t){super(t,cO)}getParser(){return this.parser}}class sc extends E{constructor(t){super(t,dO)}getParser(){return this.parser}}class qN extends E{constructor(t){super(t,gO)}getParser(){return this.parser}}class QN extends E{constructor(t){super(t,EO)}getParser(){return this.parser}}class JN extends E{constructor(t){super(t,fO)}getParser(){return this.parser}}class ZN extends E{constructor(t){super(t,RO)}getParser(){return this.parser}}class $N extends E{constructor(t){super(t,TO)}getParser(){return this.parser}}class tD extends E{constructor(t){super(t,pO)}getParser(){return this.parser}}class eD extends E{constructor(t){super(t,OO)}getParser(){return this.parser}}class sD extends E{constructor(t){super(t,AO)}getParser(){return this.parser}}class iD extends E{constructor(t){super(t,SO)}getParser(){return this.parser}}class rD extends E{constructor(t){super(t,MO)}getParser(){return this.parser}}class nD extends E{constructor(t){super(t,CO)}getParser(){return this.parser}}class aD extends E{constructor(t){super(t,NO)}getParser(){return this.parser}}class oD extends E{constructor(t){super(t,DO)}getParser(){return this.parser}}class _D extends E{constructor(t){super(t,PO)}getParser(){return this.parser}}class hD extends E{constructor(t){super(t,yO)}getParser(){return this.parser}}class uD extends E{constructor(t){super(t,LO)}getParser(){return this.parser}}class lD extends E{constructor(t){super(t,UO)}getParser(){return this.parser}}class q{}q.LOGOUT=0;q.JUST_BANNED=1;q.CONCURRENT_LOGIN=2;q.CONNECTION_LOST_TO_PEER=3;q.AVATAR_IDENTITY_CHANGE=4;q.REMOVE_FURNITURE_TOOL=5;q.STILL_BANNED=10;q.DUAL_LOGIN_BY_USERID=11;q.HOTEL_CLOSED=12;q.DUAL_LOGIN_BY_IP=13;q.PEER_CONNECTION_MISSING=16;q.NO_LOGIN_PERMISSION=17;q.DUPLICATE_CONNECTION=18;q.HOTEL_CLOSING=19;q.INCORRECT_PASSWORD=20;q.INVALID_LOGIN_TICKET=22;q.VERSION_CHECK_URL=23;q.VERSION_CHECK_PROPERTY=24;q.VERSION_CHECK_MACHINE_ID=25;q.NO_MESSENGER_SESSION=26;q.USER_NOT_FOUND=27;q.CRYPTO_NOT_INITIALIZED=28;q.DEV_CRYPTO_NOT_ALLOWED=29;q.DUPLICATE_UUID_DETECTED=100;q.OLD_SESSION_IN_PROXY=101;q.PUBLIC_KEY_NOT_NUMERIC=102;q.PUBLIC_KEY_TOO_SHORT=103;q.SOCKET_READ_GENERIC=104;q.SOCKET_READ_FIRST_BYTE=105;q.SOCKET_READ_LENGTH=106;q.SOCKET_READ_BODY=107;q.SOCKET_READ_POLICY=108;q.SOCKET_IO_EXCEPTION=109;q.SOCKET_WRONG_CRYPTO=110;q.PROXY_RUNTIME_EXCEPTION=111;q.IDLE_CONNECTION=112;q.PONG_TIMEOUT=113;q.IDLE_CONNECTION_NOT_AUTH=114;q.IDLE_CONNECTION_NO_USER_ID=115;q.WRITE_CLOSED_CHANNEL=116;q.SOCKET_WRITE_EXCEPTION_1=117;q.SOCKET_WRITE_EXCEPTION_2=118;q.SOCKET_WRITE_EXCEPTION_3=119;class cD extends E{constructor(t){super(t,vO)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case q.JUST_BANNED:case q.STILL_BANNED:return"banned";case q.CONCURRENT_LOGIN:return"concurrentlogin";case q.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class dD extends E{constructor(t){super(t,bO)}getParser(){return this.parser}}class gD extends E{constructor(t){super(t,FO)}getParser(){return this.parser}}class ic extends E{constructor(t){super(t,xO)}getParser(){return this.parser}}class ED extends E{constructor(t){super(t,GO)}getParser(){return this.parser}}class fD extends E{constructor(t){super(t,BO)}getParser(){return this.parser}}class mD extends E{constructor(t){super(t,wO)}getParser(){return this.parser}}class ID extends E{constructor(t){super(t,HO)}getParser(){return this.parser}}class RD extends E{constructor(t){super(t,VO)}getParser(){return this.parser}}class TD extends E{constructor(t){super(t,jO)}getParser(){return this.parser}}class pD extends E{constructor(t){super(t,YO)}getParser(){return this.parser}}class OD extends E{constructor(t){super(t,zO)}getParser(){return this.parser}}class AD extends E{constructor(t){super(t,WO)}getParser(){return this.parser}}class SD extends E{constructor(t){super(t,Gi)}getParser(){return this.parser}}class MD extends E{constructor(t){super(t,kO)}getParser(){return this.parser}}class CD extends E{constructor(t){super(t,gn)}getParser(){return this.parser}}class ND extends E{constructor(t){super(t,XO)}getParser(){return this.parser}}class DD extends E{constructor(t){super(t,qO)}getParser(){return this.parser}}class rc extends E{constructor(t){super(t,QO)}getParser(){return this.parser}}class nc extends E{constructor(t){super(t,fr)}getParser(){return this.parser}}class PD extends E{constructor(t){super(t,JO)}getParser(){return this.parser}}class yD extends E{constructor(t){super(t,ZO)}getParser(){return this.parser}}class LD extends E{constructor(t){super(t,$O)}getParser(){return this.parser}}class UD extends E{constructor(t){super(t,tA)}getParser(){return this.parser}}class ac extends E{constructor(t){super(t,eA)}getParser(){return this.parser}}class vD extends E{constructor(t){super(t,En)}getParser(){return this.parser}}class bD extends E{constructor(t){super(t,wa)}getParser(){return this.parser}}class FD extends E{constructor(t){super(t,sA)}getParser(){return this.parser}}class xD extends E{constructor(t){super(t,iA)}getParser(){return this.parser}}class GD extends E{constructor(t){super(t,rA)}getParser(){return this.parser}}class BD extends E{constructor(t){super(t,nA)}getParser(){return this.parser}}class h{}h.ACHIEVEMENT_LIST=305;h.AUTHENTICATED=2491;h.AUTHENTICATION=-1;h.AVAILABILITY_STATUS=2033;h.BUILDERS_CLUB_EXPIRED=1452;h.CLUB_OFFERS=2405;h.CATALOG_PAGE=804;h.CATALOG_PAGE_LIST=1032;h.CATALOG_PURCHASE_OK=869;h.CATALOG_PURCHASE_ERROR=1404;h.CATALOG_PURCHASE_NOT_ALLOWED=3770;h.PRODUCT_OFFER=3388;h.LIMITED_SOLD_OUT=377;h.CATALOG_PUBLISHED=1866;h.CFH_RESULT_MESSAGE=3635;h.CLIENT_LATENCY=10;h.CLIENT_PING=3928;h.DESKTOP_CAMPAIGN=1745;h.DESKTOP_NEWS=286;h.DESKTOP_VIEW=122;h.BUNDLE_DISCOUNT_RULESET=2347;h.FIRST_LOGIN_OF_DAY=793;h.FURNITURE_ALIASES=1723;h.FURNITURE_DATA=2547;h.FURNITURE_FLOOR=1778;h.FURNITURE_FLOOR_ADD=1534;h.FURNITURE_FLOOR_REMOVE=2703;h.FURNITURE_FLOOR_UPDATE=3776;h.FURNITURE_ITEMDATA=2202;h.FURNITURE_STATE=2376;h.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293;h.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366;h.GAME_CENTER_ACHIEVEMENTS=2265;h.GAME_CENTER_GAME_LIST=222;h.GAME_CENTER_STATUS=2893;h.GAME_CENTER_IN_ARENA_QUEUE=872;h.GAME_CENTER_STOP_COUNTER=3191;h.GAME_CENTER_USER_LEFT_GAME=3138;h.GAME_CENTER_DIRECTORY_STATUS=2246;h.GAME_CENTER_STARTING_GAME_FAILED=2142;h.GAME_CENTER_JOINING_FAILED=1730;h.GAMESTATUSMESSAGE=3805;h.GAMEACHIEVEMENTS=1689;h.GAMEINVITE=904;h.JOININGQUEUEFAILED=3035;h.JOINEDQUEUEMESSAGE=2260;h.LEFTQUEUE=1477;h.LOAD_GAME_URL=2624;h.LOADGAME=3654;h.UNLOADGAME=1715;h.ACHIEVEMENTRESOLUTIONCOMPLETED=740;h.ACHIEVEMENTRESOLUTIONPROGRESS=3370;h.ACHIEVEMENTRESOLUTIONS=66;h.GENERIC_ALERT=3801;h.MODERATOR_MESSAGE=2030;h.GENERIC_ERROR=1600;h.GIFT_WRAPPER_CONFIG=2234;h.GROUP_BADGES=2402;h.GROUP_CREATE_OPTIONS=2159;h.GROUP_FORUM_DATA=3011;h.GROUP_FORUM_LIST=3001;h.GROUP_FORUM_THREADS=1073;h.GROUP_FORUM_POST=2049;h.GROUP_FORUM_POST_THREAD=1862;h.GROUP_FORUM_THREAD_MESSAGES=509;h.GROUP_FORUM_UNREAD_COUNT=2379;h.GROUP_FORUM_UPDATE_MESSAGE=324;h.GROUP_FORUM_UPDATE_THREAD=2528;h.GROUP_INFO=1702;h.GROUP_LIST=420;h.GROUP_MEMBER=265;h.GROUP_MEMBERS=1200;h.GROUP_MEMBERS_REFRESH=2445;h.GROUP_MEMBER_REMOVE_CONFIRM=1876;h.GROUP_PURCHASED=2808;h.GROUP_SETTINGS=3965;h.GROUP_BADGE_PARTS=2238;h.GROUP_MEMBERSHIP_REQUESTED=1180;h.GROUP_DETAILS_CHANGED=1459;h.GROUP_HABBO_JOIN_FAILED=762;h.GUILD_EDIT_FAILED=3988;h.GUILD_MEMBER_MGMT_FAILED=818;h.ITEM_DIMMER_SETTINGS=2710;h.ITEM_STACK_HELPER=2816;h.ITEM_WALL=1369;h.ITEM_WALL_ADD=2187;h.ITEM_WALL_REMOVE=3208;h.ITEM_WALL_UPDATE=2009;h.MARKETPLACE_CONFIG=1823;h.MESSENGER_ACCEPT_FRIENDS=896;h.MESSENGER_CHAT=1587;h.MESSENGER_FIND_FRIENDS=1210;h.MESSENGER_FOLLOW_FAILED=3048;h.MESSENGER_FRIEND_NOTIFICATION=3082;h.MESSENGER_FRIENDS=3130;h.MESSENGER_INIT=1605;h.MESSENGER_INSTANCE_MESSAGE_ERROR=3359;h.MESSENGER_INVITE=3870;h.MESSENGER_INVITE_ERROR=462;h.MESSENGER_MESSAGE_ERROR=892;h.MESSENGER_MINIMAIL_COUNT=2803;h.MESSENGER_MINIMAIL_NEW=1911;h.MESSENGER_RELATIONSHIPS=2016;h.MESSENGER_REQUEST=2219;h.MESSENGER_REQUEST_ERROR=892;h.MESSENGER_REQUESTS=280;h.MESSENGER_SEARCH=973;h.MESSENGER_UPDATE=2800;h.MODERATION_REPORT_DISABLED=1651;h.MODERATION_TOOL=2696;h.MODERATION_USER_INFO=2866;h.MOTD_MESSAGES=2035;h.NAVIGATOR_CATEGORIES=1562;h.NAVIGATOR_COLLAPSED=1543;h.NAVIGATOR_EVENT_CATEGORIES=3244;h.NAVIGATOR_LIFTED=3104;h.NAVIGATOR_METADATA=3052;h.NAVIGATOR_OPEN_ROOM_CREATOR=2064;h.NAVIGATOR_SEARCH=2690;h.NAVIGATOR_SEARCHES=3984;h.NAVIGATOR_SETTINGS=518;h.THUMBNAIL_UPDATE_RESULT=1927;h.CAN_CREATE_ROOM=378;h.CATEGORIES_WITH_VISITOR_COUNT=1455;h.COMPETITION_ROOMS_DATA=3954;h.CONVERTED_ROOM_ID=1331;h.GUEST_ROOM_SEARCH_RESULT=52;h.NOTIFICATION_LIST=1992;h.NOTIFICATION_SIMPLE_ALERT=5100;h.NOTIFICATION_ELEMENT_POINTER=1787;h.PET_FIGURE_UPDATE=1924;h.PET_INFO=2901;h.PET_TRAINING_PANEL=1164;h.PET_LEVEL_UPDATE=2824;h.PET_SCRATCH_FAILED=1130;h.PET_OPEN_PACKAGE_REQUESTED=2380;h.PET_OPEN_PACKAGE_RESULT=546;h.PET_BREEDING=1746;h.PET_CONFIRM_BREEDING_RESULT=1625;h.PET_GO_TO_BREEDING_NEST_FAILURE=2621;h.PET_NEST_BREEDING_SUCCESS=2527;h.PET_CONFIRM_BREEDING_REQUEST=634;h.PET_BREEDING_RESULT=1553;h.RECYCLER_PRIZES=3164;h.RECYCLER_STATUS=3433;h.RECYCLER_FINISHED=468;h.ROOM_BAN_LIST=1869;h.ROOM_BAN_REMOVE=3429;h.ROOM_CREATED=1304;h.ROOM_DOORBELL=2309;h.ROOM_DOORBELL_ACCEPTED=3783;h.ROOM_DOORBELL_REJECTED=878;h.ROOM_ENTER=758;h.ROOM_ENTER_ERROR=899;h.ROOM_FORWARD=160;h.ROOM_HEIGHT_MAP=2753;h.ROOM_HEIGHT_MAP_UPDATE=558;h.ROOM_INFO=687;h.ROOM_INFO_OWNER=749;h.ROOM_MODEL=1301;h.ROOM_MODEL_BLOCKED_TILES=3990;h.ROOM_MODEL_DOOR=1664;h.ROOM_MODEL_NAME=2031;h.ROOM_MUTED=2533;h.ROOM_MUTE_USER=826;h.ROOM_PAINT=2454;h.ROOM_PROMOTION=2274;h.ROOM_QUEUE_STATUS=2208;h.ROOM_RIGHTS=780;h.ROOM_RIGHTS_CLEAR=2392;h.ROOM_RIGHTS_LIST=1284;h.ROOM_RIGHTS_LIST_ADD=2088;h.ROOM_RIGHTS_LIST_REMOVE=1327;h.ROOM_RIGHTS_OWNER=339;h.ROOM_ROLLING=3207;h.ROOM_SCORE=482;h.ROOM_SETTINGS=1498;h.ROOM_SETTINGS_CHAT=1191;h.ROOM_SETTINGS_SAVE=948;h.ROOM_SETTINGS_SAVE_ERROR=1555;h.ROOM_INFO_UPDATED=3297;h.ROOM_SPECTATOR=1033;h.ROOM_THICKNESS=3547;h.ROOM_GET_FILTER_WORDS=2937;h.ROOM_MESSAGE_NOTIFICATION=1634;h.ROOM_POPULAR_TAGS_RESULT=2012;h.INFO_FEED_ENABLE=3284;h.SECURITY_MACHINE=1488;h.MYSTERY_BOX_KEYS=2833;h.GOTMYSTERYBOXPRIZEMESSAGE=3712;h.CANCELMYSTERYBOXWAITMESSAGE=596;h.SHOWMYSTERYBOXWAITMESSAGE=3201;h.TRADE_ACCEPTED=2568;h.TRADE_CLOSED=1373;h.TRADE_COMPLETED=1001;h.TRADE_CONFIRMATION=2720;h.TRADE_LIST_ITEM=2024;h.TRADE_NOT_OPEN=3128;h.TRADE_OPEN=2505;h.TRADE_OPEN_FAILED=217;h.TRADE_OTHER_NOT_ALLOWED=1254;h.TRADE_YOU_NOT_ALLOWED=3058;h.TRADE_NO_SUCH_ITEM=2873;h.UNIT=374;h.UNIT_CHANGE_NAME=2182;h.UNIT_CHAT=1446;h.UNIT_CHAT_SHOUT=1036;h.UNIT_CHAT_WHISPER=2704;h.UNIT_DANCE=2233;h.UNIT_EFFECT=1167;h.UNIT_EXPRESSION=1631;h.UNIT_HAND_ITEM=1474;h.UNIT_IDLE=1797;h.UNIT_INFO=3920;h.UNIT_NUMBER=2324;h.UNIT_REMOVE=2661;h.UNIT_STATUS=1640;h.UNIT_TYPING=1717;h.UNSEEN_ITEMS=2103;h.USER_ACHIEVEMENT_SCORE=1968;h.USER_BADGES=717;h.USER_BADGES_ADD=2493;h.USER_BADGES_CURRENT=1087;h.USER_BOT_REMOVE=233;h.USER_BOTS=3086;h.USER_CHANGE_NAME=118;h.USER_CLOTHING=1450;h.USER_CREDITS=3475;h.USER_CURRENCY=2018;h.ACTIVITY_POINT_NOTIFICATION=2275;h.USER_EFFECTS=340;h.USER_FAVORITE_ROOM=2524;h.USER_FAVORITE_ROOM_COUNT=151;h.USER_FIGURE=2429;h.USER_FURNITURE=994;h.USER_FURNITURE_ADD=104;h.USER_FURNITURE_POSTIT_PLACED=1501;h.USER_FURNITURE_REFRESH=3151;h.USER_FURNITURE_REMOVE=159;h.USER_HOME_ROOM=2875;h.ROOM_EVENT_CANCEL=3479;h.ROOM_EVENT=1840;h.USER_IGNORED=126;h.USER_IGNORED_RESULT=207;h.USER_INFO=2725;h.USER_OUTFITS=3315;h.USER_PERKS=2586;h.USER_PERMISSIONS=411;h.USER_PET_ADD=2101;h.USER_PET_REMOVE=3253;h.USER_PETS=3522;h.USER_PROFILE=3898;h.USER_RESPECT=2815;h.USER_SANCTION_STATUS=3679;h.USER_SETTINGS=513;h.USER_SUBSCRIPTION=954;h.USER_WARDROBE_PAGE=3315;h.USER_CLASSIFICATION=966;h.GET_USER_TAGS=1255;h.WIRED_ACTION=1434;h.WIRED_CONDITION=1108;h.WIRED_ERROR=156;h.WIRED_OPEN=1830;h.WIRED_REWARD=178;h.WIRED_SAVE=1155;h.WIRED_TRIGGER=383;h.PLAYING_GAME=448;h.FURNITURE_STATE_2=3431;h.REMOVE_BOT_FROM_INVENTORY=233;h.ADD_BOT_TO_INVENTORY=1352;h.ACHIEVEMENT_PROGRESSED=2107;h.MODTOOL_ROOM_INFO=1333;h.MODTOOL_USER_CHATLOG=3377;h.MODTOOL_ROOM_CHATLOG=3434;h.MODTOOL_VISITED_ROOMS_USER=1752;h.MODERATOR_ACTION_RESULT=2335;h.ISSUE_DELETED=3192;h.ISSUE_INFO=3609;h.ISSUE_PICK_FAILED=3150;h.CFH_CHATLOG=607;h.MODERATOR_TOOL_PREFERENCES=1576;h.LOVELOCK_FURNI_START=3753;h.LOVELOCK_FURNI_FRIEND_COMFIRMED=382;h.LOVELOCK_FURNI_FINISHED=770;h.GIFT_RECEIVER_NOT_FOUND=1517;h.GIFT_OPENED=56;h.FLOOD_CONTROL=566;h.REMAINING_MUTE=826;h.USER_EFFECT_LIST=340;h.USER_EFFECT_LIST_ADD=2867;h.USER_EFFECT_LIST_REMOVE=2228;h.USER_EFFECT_ACTIVATE=1959;h.AVATAR_EFFECT_SELECTED=3473;h.CLUB_GIFT_INFO=619;h.REDEEM_VOUCHER_ERROR=714;h.REDEEM_VOUCHER_OK=3336;h.IN_CLIENT_LINK=2023;h.BOT_COMMAND_CONFIGURATION=1618;h.BOT_SKILL_LIST_UPDATE=69;h.BOT_FORCE_OPEN_CONTEXT_MENU=296;h.HAND_ITEM_RECEIVED=354;h.PET_PLACING_ERROR=2913;h.BOT_ERROR=639;h.MARKETPLACE_SELL_ITEM=54;h.MARKETPLACE_ITEM_STATS=725;h.MARKETPLACE_OWN_ITEMS=3884;h.MARKETPLACE_CANCEL_SALE=3264;h.MARKETPLACE_ITEM_POSTED=1359;h.MARKETPLACE_ITEMS_SEARCHED=680;h.MARKETPLACE_AFTER_ORDER_STATUS=2032;h.CATALOG_RECEIVE_PET_BREEDS=3331;h.CATALOG_APPROVE_NAME_RESULT=1503;h.OBJECTS_DATA_UPDATE=1453;h.PET_EXPERIENCE=2156;h.COMMUNITY_GOAL_VOTE_EVENT=1435;h.PROMO_ARTICLES=286;h.COMMUNITY_GOAL_EARNED_PRIZES=3319;h.COMMUNITY_GOAL_PROGRESS=2525;h.CONCURRENT_USERS_GOAL_PROGRESS=2737;h.QUEST_DAILY=1878;h.QUEST_CANCELLED=3027;h.QUEST_COMPLETED=949;h.COMMUNITY_GOAL_HALL_OF_FAME=3005;h.EPIC_POPUP=3945;h.SEASONAL_QUESTS=1122;h.QUESTS=3625;h.QUEST=230;h.BONUS_RARE_INFO=1533;h.CRAFTABLE_PRODUCTS=1e3;h.CRAFTING_RECIPE=2774;h.CRAFTING_RECIPES_AVAILABLE=2124;h.CRAFTING_RESULT=618;h.CAMERA_PUBLISH_STATUS=2057;h.CAMERA_PURCHASE_OK=2783;h.CAMERA_STORAGE_URL=3696;h.COMPETITION_STATUS=133;h.INIT_CAMERA=3878;h.THUMBNAIL_STATUS=3595;h.ACHIEVEMENT_NOTIFICATION=806;h.CLUB_GIFT_NOTIFICATION=2188;h.INTERSTITIAL_MESSAGE=1808;h.ROOM_AD_ERROR=1759;h.AVAILABILITY_TIME=600;h.HOTEL_CLOSED_AND_OPENS=3728;h.HOTEL_CLOSES_AND_OPENS_AT=2771;h.HOTEL_WILL_CLOSE_MINUTES=1050;h.HOTEL_MAINTENANCE=1350;h.JUKEBOX_PLAYLIST_FULL=105;h.JUKEBOX_SONG_DISKS=34;h.NOW_PLAYING=469;h.OFFICIAL_SONG_ID=1381;h.PLAYLIST=1748;h.PLAYLIST_SONG_ADDED=1140;h.TRAX_SONG_INFO=3365;h.USER_SONG_DISKS_INVENTORY=2602;h.CHECK_USER_NAME=563;h.CFH_SANCTION=2782;h.CFH_TOPICS=325;h.CFH_SANCTION_STATUS=2221;h.CAMPAIGN_CALENDAR_DATA=2531;h.CAMPAIGN_CALENDAR_DOOR_OPENED=2551;h.BUILDERS_CLUB_FURNI_COUNT=3828;h.BUILDERS_CLUB_SUBSCRIPTION=1452;h.CATALOG_PAGE_EXPIRATION=2668;h.CATALOG_EARLIEST_EXPIRY=2515;h.CLUB_GIFT_SELECTED=659;h.TARGET_OFFER_NOT_FOUND=1237;h.TARGET_OFFER=119;h.DIRECT_SMS_CLUB_BUY=195;h.ROOM_AD_PURCHASE=2468;h.NOT_ENOUGH_BALANCE=3914;h.LIMITED_OFFER_APPEARING_NEXT=44;h.IS_OFFER_GIFTABLE=761;h.CLUB_EXTENDED_OFFER=3964;h.SEASONAL_CALENDAR_OFFER=1889;h.COMPETITION_ENTRY_SUBMIT=1177;h.COMPETITION_VOTING_INFO=3506;h.COMPETITION_TIMING_CODE=1745;h.COMPETITION_USER_PART_OF=3841;h.COMPETITION_NO_OWNED_ROOMS=2064;h.COMPETITION_SECONDS_UNTIL=3926;h.BADGE_POINT_LIMITS=2501;h.BADGE_REQUEST_FULFILLED=2998;h.HELPER_TALENT_TRACK=3406;h.TALENT_TRACK_LEVEL=1203;h.TALENT_TRACK_LEVEL_UP=638;h.USER_BANNED=1683;h.BOT_RECEIVED=3684;h.PET_LEVEL_NOTIFICATION=859;h.PET_RECEIVED=1111;h.MODERATION_CAUTION=1890;h.YOUTUBE_CONTROL_VIDEO=1554;h.YOUTUBE_DISPLAY_PLAYLISTS=1112;h.YOUTUBE_DISPLAY_VIDEO=1411;h.CFH_DISABLED_NOTIFY=1651;h.QUESTION=2665;h.POLL_CONTENTS=2997;h.POLL_ERROR=662;h.POLL_OFFER=3785;h.QUESTION_ANSWERED=2589;h.QUESTION_FINISHED=1066;h.CFH_PENDING_CALLS=1121;h.GUIDE_ON_DUTY_STATUS=1548;h.GUIDE_SESSION_ATTACHED=1591;h.GUIDE_SESSION_DETACHED=138;h.GUIDE_SESSION_ENDED=1456;h.GUIDE_SESSION_ERROR=673;h.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219;h.GUIDE_SESSION_MESSAGE=841;h.GUIDE_SESSION_PARTNER_IS_TYPING=1016;h.GUIDE_SESSION_REQUESTER_ROOM=1847;h.GUIDE_SESSION_STARTED=3209;h.GUIDE_TICKET_CREATION_RESULT=3285;h.GUIDE_TICKET_RESOLUTION=2674;h.GUIDE_REPORTING_STATUS=3463;h.HOTEL_MERGE_NAME_CHANGE=1663;h.ISSUE_CLOSE_NOTIFICATION=934;h.QUIZ_DATA=2927;h.QUIZ_RESULTS=2772;h.CFH_PENDING_CALLS_DELETED=77;h.CFH_REPLY=3796;h.CHAT_REVIEW_SESSION_DETACHED=30;h.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735;h.CHAT_REVIEW_SESSION_RESULTS=3276;h.CHAT_REVIEW_SESSION_STARTED=143;h.CHAT_REVIEW_SESSION_VOTING_STATUS=1829;h.SCR_SEND_KICKBACK_INFO=3277;h.PET_STATUS=1907;h.GROUP_DEACTIVATE=3129;h.PET_RESPECTED=2788;h.PET_SUPPLEMENT=3441;h.NOOBNESS_LEVEL=3738;h.DISCONNECT_REASON=4e3;h.CAN_CREATE_ROOM_EVENT=2599;h.FAVORITE_GROUP_UDPATE=3403;h.NO_SUCH_FLAT=84;h.ROOM_SETTINGS_ERROR=2897;h.SHOW_ENFORCE_ROOM_CATEGORY=3896;h.CUSTOM_USER_NOTIFICATION=909;h.NEW_USER_EXPERIENCE_GIFT_OFFER=3575;h.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639;h.CONNECTION_ERROR=1004;h.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243;h.PHONE_COLLECTION_STATE=2890;h.PHONE_TRY_NUMBER_RESULT=800;h.PHONE_TRY_VERIFICATION_CODE_RESULT=91;h.EXTENDED_PROFILE_CHANGED=876;h.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293;h.WELCOME_GIFT_STATUS=2707;h.HANDSHAKE_INIT_DIFFIE=1347;h.HANDSHAKE_COMPLETE_DIFFIE=3885;h.RENTABLE_SPACE_RENT_OK=2046;h.RENTABLE_SPACE_STATUS=3559;h.RENTABLE_SPACE_RENT_FAILED=1868;h.EMAIL_STATUS=612;h.CHANGE_EMAIL_RESULT=1815;h.WEEKLY_GAME_REWARD=2641;h.WEEKLY_GAME_REWARD_WINNERS=3097;h.WEEKLY_COMPETITIVE_LEADERBOARD=3512;h.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560;h.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270;h.WEEKLY_GAME2_LEADERBOARD=2196;h.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35;h.HANDSHAKE_IDENTITY_ACCOUNT=3523;class wD extends E{constructor(t){super(t,DI)}getParser(){return this.parser}}class HD extends E{constructor(t){super(t,PI)}getParser(){return this.parser}}class VD extends E{constructor(t){super(t,yI)}getParser(){return this.parser}}class jD extends E{constructor(t){super(t,UI)}getParser(){return this.parser}}class YD extends E{constructor(t){super(t,vI)}getParser(){return this.parser}}class zD extends E{constructor(t){super(t,bI)}getParser(){return this.parser}}class WD extends E{constructor(t){super(t,FI)}getParser(){return this.parser}}class kD extends E{constructor(t){super(t,xI)}getParser(){return this.parser}}class oc extends E{constructor(t){super(t,BI)}getParser(){return this.parser}}class KD extends E{constructor(t){super(t,wI)}getParser(){return this.parser}}class XD extends E{constructor(t){super(t,HI)}getParser(){return this.parser}}class qD extends E{constructor(t){super(t,VI)}getParser(){return this.parser}}class QD extends E{constructor(t){super(t,jI)}getParser(){return this.parser}}class JD extends E{constructor(t){super(t,CT)}getParser(){return this.parser}}class ZD extends E{constructor(t){super(t,DT)}getParser(){return this.parser}}class $D extends E{constructor(t){super(t,NT)}getParser(){return this.parser}}class tP extends E{constructor(t){super(t,PT)}getParser(){return this.parser}}class eP extends E{constructor(t){super(t,yT)}getParser(){return this.parser}}class _c extends E{constructor(t){super(t,LT)}getParser(){return this.parser}}class sP extends E{constructor(t){super(t,UT)}getParser(){return this.parser}}class iP extends E{constructor(t){super(t,vT)}getParser(){return this.parser}}class rP extends E{constructor(t){super(t,bT)}getParser(){return this.parser}}class nP extends E{constructor(t){super(t,FT)}getParser(){return this.parser}}class aP extends E{constructor(t){super(t,xT)}getParser(){return this.parser}}class oP extends E{constructor(t){super(t,GT)}getParser(){return this.parser}}class _P extends E{constructor(t){super(t,BT)}getParser(){return this.parser}}class hP extends E{constructor(t){super(t,HT)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class uP extends E{constructor(t){super(t,Hl)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class lP extends E{constructor(t){super(t,VT)}getParser(){return this.parser}}class cP extends E{constructor(t){super(t,jT)}getParser(){return this.parser}}class dP extends E{constructor(t){super(t,YT)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class gP extends E{constructor(t){super(t,zT)}getParser(){return this.parser}}class EP extends E{constructor(t){super(t,WT)}getParser(){return this.parser}}class fP extends E{constructor(t){super(t,kT)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class mP extends E{constructor(t){super(t,nh)}getParser(){return this.parser}}class IP extends E{constructor(t){super(t,KT)}getParser(){return this.parser}}class RP extends E{constructor(t){super(t,XT)}getParser(){return this.parser}}class TP extends E{constructor(t){super(t,aA)}getParser(){return this.parser}}class pP extends E{constructor(t){super(t,oA)}getParser(){return this.parser}}class OP extends E{constructor(t){super(t,_A)}getParser(){return this.parser}}class AP extends E{constructor(t){super(t,hA)}getParser(){return this.parser}}class SP extends E{constructor(t){super(t,uA)}getParser(){return this.parser}}class MP extends E{constructor(t){super(t,lA)}getParser(){return this.parser}}class CP extends E{constructor(t){super(t,dA)}getParser(){return this.parser}}class NP extends E{constructor(t){super(t,cA)}getParser(){return this.parser}}class DP extends E{constructor(t){super(t,Va)}getParser(){return this.parser}}class PP extends E{constructor(t){super(t,Kl)}getParser(){return this.parser}}class yP extends E{constructor(t){super(t,fA)}getParser(){return this.parser}}class LP extends E{constructor(t){super(t,mA)}getParser(){return this.parser}}class UP extends E{constructor(t){super(t,Xl)}getParser(){return this.parser}}class vP extends E{constructor(t){super(t,RA)}getParser(){return this.parser}}class bP extends E{constructor(t){super(t,pA)}getParser(){return this.parser}}class FP extends E{constructor(t){super(t,TA)}getParser(){return this.parser}}class xP extends E{constructor(t){super(t,AA)}getParser(){return this.parser}}class GP extends E{constructor(t){super(t,SA)}getParser(){return this.parser}}class BP extends E{constructor(t){super(t,NA)}getParser(){return this.parser}}class wP extends E{constructor(t){super(t,DA)}getParser(){return this.parser}}class HP extends E{constructor(t){super(t,yA)}getParser(){return this.parser}}class VP extends E{constructor(t){super(t,LA)}getParser(){return this.parser}}class jP extends E{constructor(t){super(t,bA)}getParser(){return this.parser}}class YP extends E{constructor(t){super(t,FA)}getParser(){return this.parser}}class zP extends E{constructor(t){super(t,GA)}getParser(){return this.parser}}class WP extends E{constructor(t){super(t,BA)}getParser(){return this.parser}}class kP extends E{constructor(t){super(t,wA)}getParser(){return this.parser}}class hc extends E{constructor(t){super(t,HA)}getParser(){return this.parser}}class KP extends E{constructor(t){super(t,VA)}getParser(){return this.parser}}class XP extends E{constructor(t){super(t,hh)}getParser(){return this.parser}}class qP extends E{constructor(t){super(t,jA)}getParser(){return this.parser}}class QP extends E{constructor(t){super(t,QA)}getParser(){return this.parser}}class JP extends E{constructor(t){super(t,JA)}getParser(){return this.parser}}class ZP extends E{constructor(t){super(t,ZA)}getParser(){return this.parser}}class uc extends E{constructor(t){super(t,$A)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class $P extends E{constructor(t){super(t,tS)}getParser(){return this.parser}}class ty extends E{constructor(t){super(t,eS)}getParser(){return this.parser}}class Yo extends E{constructor(t){super(t,sS)}getParser(){return this.parser}}class ey extends E{constructor(t){super(t,iS)}getParser(){return this.parser}}class zo extends E{constructor(t){super(t,rS)}getParser(){return this.parser}}class sy extends E{constructor(t){super(t,nS)}getParser(){return this.parser}}class iy extends E{constructor(t){super(t,oS)}getParser(){return this.parser}}class ry extends E{constructor(t){super(t,hS)}getParser(){return this.parser}}class ny extends E{constructor(t){super(t,lS)}getParser(){return this.parser}}class ay extends E{constructor(t){super(t,cS)}getParser(){return this.parser}}class oy extends E{constructor(t){super(t,dS)}getParser(){return this.parser}}class _y extends E{constructor(t){super(t,gS)}getParser(){return this.parser}}class hy extends E{constructor(t){super(t,ES)}getParser(){return this.parser}}class uy extends E{constructor(t){super(t,fS)}getParser(){return this.parser}}class ly extends E{constructor(t){super(t,RS)}getParser(){return this.parser}}class cy extends E{constructor(t){super(t,TS)}getParser(){return this.parser}}class dy extends E{constructor(t){super(t,pS)}getParser(){return this.parser}}class gy extends E{constructor(t){super(t,OS)}getParser(){return this.parser}}class Ey extends E{constructor(t){super(t,AS)}getParser(){return this.parser}}class fy extends E{constructor(t){super(t,SS)}getParser(){return this.parser}}class my extends E{constructor(t){super(t,MS)}getParser(){return this.parser}}class Iy extends E{constructor(t){super(t,CS)}getParser(){return this.parser}}class Ry extends E{constructor(t){super(t,DS)}getParser(){return this.parser}}class Ty extends E{constructor(t){super(t,PS)}getParser(){return this.parser}}class lc extends E{constructor(t){super(t,yS)}getParser(){return this.parser}}class py extends E{constructor(t){super(t,LS)}getParser(){return this.parser}}class Oy extends E{constructor(t){super(t,US)}getParser(){return this.parser}}class Ay extends E{constructor(t){super(t,vS)}getParser(){return this.parser}}class Sy extends E{constructor(t){super(t,bS)}getParser(){return this.parser}}class My extends E{constructor(t){super(t,FS)}getParser(){return this.parser}}class Cy extends E{constructor(t){super(t,xS)}getParser(){return this.parser}}class Ny extends E{constructor(t){super(t,GS)}getParser(){return this.parser}}class Dy extends E{constructor(t){super(t,BS)}getParser(){return this.parser}}class cc extends E{constructor(t){super(t,wS)}getParser(){return this.parser}}class Py extends E{constructor(t){super(t,HS)}getParser(){return this.parser}}class yy extends E{constructor(t){super(t,VS)}getParser(){return this.parser}}class Ly{constructor(t){this._itemName=t.readString(),this._extraInfo=t.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class Uy{constructor(t){this._thumbnailUrl=t.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const s=t.readInt();let i=0;for(;i<s;)this._productOfferList.push(new Ly(t)),i++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class vy{flush(){return!0}parse(t){if(!t)return!1;const s=t.readInt();this._giftOptions=[];let i=0;for(;i<s;)this._giftOptions.push(new xy(t)),i++;return!0}get giftOptions(){return this._giftOptions}}class by{flush(){return!0}parse(t){return!!t}}class Fy extends E{constructor(t){super(t,vy)}getParser(){return this.parser}}class xy{constructor(t){this._dayIndex=t.readInt(),this._stepIndex=t.readInt(),this._options=[];const s=t.readInt();let i=0;for(;i<s;)this._options.push(new Uy(t)),i++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class Gy extends E{constructor(t){super(t,by)}getParser(){return this.parser}}class By extends E{constructor(t){super(t,YS)}getParser(){return this.parser}}class wy extends E{constructor(t){super(t,xa)}getParser(){return this.parser}}class dc extends E{constructor(t){super(t,zS)}getParser(){return this.parser}}class gc extends E{constructor(t){super(t,WS)}getParser(){return this.parser}}class Ec extends E{constructor(t){super(t,kS)}getParser(){return this.parser}}class fc extends E{constructor(t){super(t,KS)}getParser(){return this.parser}}class Hy extends E{constructor(t){super(t,XS)}getParser(){return this.parser}}class mc extends E{constructor(t){super(t,JS)}getParser(){return this.parser}}class Ic extends E{constructor(t){super(t,ZS)}getParser(){return this.parser}}class Rc extends E{constructor(t){super(t,$S)}getParser(){return this.parser}}class Tc extends E{constructor(t){super(t,tM)}getParser(){return this.parser}}class pc extends E{constructor(t){super(t,sM)}getParser(){return this.parser}}class Oc extends E{constructor(t){super(t,eM)}getParser(){return this.parser}}class Vy extends E{constructor(t){super(t,nM)}getParser(){return this.parser}}class jy extends E{constructor(t){super(t,_M)}getParser(){return this.parser}}class Yy extends E{constructor(t){super(t,hM)}getParser(){return this.parser}}class zy extends E{constructor(t){super(t,uM)}getParser(){return this.parser}}class Wy extends E{constructor(t){super(t,lM)}getParser(){return this.parser}}class ky extends E{constructor(t){super(t,cM)}getParser(){return this.parser}}class Ky extends E{constructor(t){super(t,dM)}getParser(){return this.parser}}class Xy extends E{constructor(t){super(t,gM)}getParser(){return this.parser}}class qy extends E{constructor(t){super(t,EM)}getParser(){return this.parser}}class Qy extends E{constructor(t){super(t,fM)}getParser(){return this.parser}}class Jy extends E{constructor(t){super(t,mM)}getParser(){return this.parser}}class lh extends E{constructor(t){super(t,IM)}getParser(){return this.parser}}lh.FINISHED_OK=1;lh.FINISHED_FAIL=2;class za extends E{constructor(t){super(t,RM)}getParser(){return this.parser}}za.SYSTEM_STATUS_ENABLED=1;za.SYSTEM_STATUS_DISABLED=2;za.SYSTEM_STATUS_TIMEOUT=3;class Wo extends E{constructor(t){super(t,YI)}getParser(){return this.parser}}class ko extends E{constructor(t){super(t,zI)}getParser(){return this.parser}}class Ko extends E{constructor(t){super(t,kI)}getParser(){return this.parser}}class Xo extends E{constructor(t){super(t,WI)}getParser(){return this.parser}}class Zy extends E{constructor(t){super(t,_n)}getParser(){return this.parser}}class qo extends E{constructor(t){super(t,KI)}getParser(){return this.parser}}class $y extends E{constructor(t){super(t,XI)}getParser(){return this.parser}}class tL extends E{constructor(t){super(t,qI)}getParser(){return this.parser}}class eL extends E{constructor(t){super(t,QI)}getParser(){return this.parser}}class sL extends E{constructor(t){super(t,ZI)}getParser(){return this.parser}}class iL extends E{constructor(t){super(t,cR)}getParser(){return this.parser}}class rL extends E{constructor(t){super(t,dR)}getParser(){return this.parser}}class nL extends E{constructor(t){super(t,gR)}getParser(){return this.parser}}class Ac extends E{constructor(t){super(t,ER)}getParser(){return this.parser}}class Qo extends E{constructor(t){super(t,XR)}getParser(){return this.parser}}class Jo extends E{constructor(t){super(t,qR)}getParser(){return this.parser}}class aL extends E{constructor(t){super(t,mR)}getParser(){return this.parser}}class Zo extends E{constructor(t){super(t,IR)}getParser(){return this.parser}}class $o extends E{constructor(t){super(t,RR)}getParser(){return this.parser}}class t_ extends E{constructor(t){super(t,TR)}getParser(){return this.parser}}class e_ extends E{constructor(t){super(t,pR)}getParser(){return this.parser}}class s_ extends E{constructor(t){super(t,OR)}getParser(){return this.parser}}class oL extends E{constructor(t){super(t,AR)}getParser(){return this.parser}}class i_ extends E{constructor(t){super(t,SR)}getParser(){return this.parser}}class r_ extends E{constructor(t){super(t,hi)}getParser(){return this.parser}}class _L extends E{constructor(t){super(t,MR)}getParser(){return this.parser}}class hL extends E{constructor(t){super(t,CR)}getParser(){return this.parser}}class n_ extends E{constructor(t){super(t,NR)}getParser(){return this.parser}}class uL extends E{constructor(t){super(t,DR)}getParser(){return this.parser}}class lL extends E{constructor(t){super(t,PR)}getParser(){return this.parser}}class cL extends E{constructor(t){super(t,yR)}getParser(){return this.parser}}class a_ extends E{constructor(t){super(t,LR)}getParser(){return this.parser}}class dL extends E{constructor(t){super(t,UR)}getParser(){return this.parser}}class gL extends E{constructor(t){super(t,vR)}getParser(){return this.parser}}class EL extends E{constructor(t){super(t,bR)}getParser(){return this.parser}}class fL extends E{constructor(t){super(t,FR)}getParser(){return this.parser}}class Sc extends E{constructor(t){super(t,GR)}getParser(){return this.parser}}class mL extends E{constructor(t){super(t,BR)}getParser(){return this.parser}}class o_ extends E{constructor(t){super(t,wR)}getParser(){return this.parser}}class __ extends E{constructor(t){super(t,HR)}getParser(){return this.parser}}class h_ extends E{constructor(t){super(t,VR)}getParser(){return this.parser}}class u_ extends E{constructor(t){super(t,jR)}getParser(){return this.parser}}class IL extends E{constructor(t){super(t,YR)}getParser(){return this.parser}}class RL extends E{constructor(t){super(t,zR)}getParser(){return this.parser}}class TL extends E{constructor(t){super(t,kR)}getParser(){return this.parser}}class pL extends E{constructor(t){super(t,KR)}getParser(){return this.parser}}class l_ extends E{constructor(t){super(t,sh)}getParser(){return this.parser}}class c_ extends E{constructor(t){super(t,QR)}getParser(){return this.parser}}class d_ extends E{constructor(t){super(t,ei)}getParser(){return this.parser}}class g_ extends E{constructor(t){super(t,JR)}getParser(){return this.parser}}class OL extends E{constructor(t){super(t,ZR)}getParser(){return this.parser}}class E_ extends E{constructor(t){super(t,$R)}getParser(){return this.parser}}class lr extends E{constructor(t){super(t,tT)}getParser(){return this.parser}}class f_ extends E{constructor(t){super(t,eT)}getParser(){return this.parser}}class Mc extends E{constructor(t){super(t,sT)}getParser(){return this.parser}}class Cc extends E{constructor(t){super(t,iT)}getParser(){return this.parser}}class na extends E{constructor(t){super(t,rT)}getParser(){return this.parser}}class Nc extends E{constructor(t){super(t,nT)}getParser(){return this.parser}}class Dc extends E{constructor(t){super(t,aT)}getParser(){return this.parser}}class Pc extends E{constructor(t){super(t,_T)}getParser(){return this.parser}}class yc extends E{constructor(t){super(t,hT)}getParser(){return this.parser}}class Lc extends E{constructor(t){super(t,uT)}getParser(){return this.parser}}class Uc extends E{constructor(t){super(t,lT)}getParser(){return this.parser}}class ch extends E{constructor(t){super(t,ih)}getParser(){return this.parser}}class aa extends E{constructor(t){super(t,ih)}getParser(){return this.parser}}class oa extends E{constructor(t){super(t,ih)}getParser(){return this.parser}}class m_ extends E{constructor(t){super(t,cT)}getParser(){return this.parser}}class _a extends E{constructor(t){super(t,dT)}getParser(){return this.parser}}class I_ extends E{constructor(t){super(t,gT)}getParser(){return this.parser}}class ha extends E{constructor(t){super(t,pT)}getParser(){return this.parser}}class R_ extends E{constructor(t){super(t,ET)}getParser(){return this.parser}}class T_ extends E{constructor(t){super(t,fT)}getParser(){return this.parser}}class vc extends E{constructor(t){super(t,mT)}getParser(){return this.parser}}class p_ extends E{constructor(t){super(t,IT)}getParser(){return this.parser}}class ua extends E{constructor(t){super(t,RT)}getParser(){return this.parser}}class O_ extends E{constructor(t){super(t,TT)}getParser(){return this.parser}}class la extends E{constructor(t){super(t,OT)}getParser(){return this.parser}}class A_ extends E{constructor(t){super(t,MT)}getParser(){return this.parser}}class AL extends E{constructor(t){super(t,AM)}getParser(){return this.parser}}class SL extends E{constructor(t){super(t,SM)}getParser(){return this.parser}}class ML extends E{constructor(t){super(t,MM)}getParser(){return this.parser}}class CL extends E{constructor(t){super(t,CM)}getParser(){return this.parser}}class dh extends E{constructor(t){super(t,NM)}getParser(){return this.parser}}dh.PRODUCT_DONATED_CODE=6;dh.BADGE_DONATED_CODE=7;class NL extends E{constructor(t){super(t,DM)}getParser(){return this.parser}}class DL extends E{constructor(t){super(t,PM)}getParser(){return this.parser}}class PL extends E{constructor(t){super(t,tR)}getParser(){return this.parser}}class yL extends E{constructor(t){super(t,sR)}getParser(){return this.parser}}class LL extends E{constructor(t){super(t,iR)}getParser(){return this.parser}}class UL extends E{constructor(t){super(t,rR)}getParser(){return this.parser}}class vL extends E{constructor(t){super(t,nR)}getParser(){return this.parser}}class bL extends E{constructor(t){super(t,aR)}getParser(){return this.parser}}class FL extends E{constructor(t){super(t,oR)}getParser(){return this.parser}}class xL extends E{constructor(t){super(t,_R)}getParser(){return this.parser}}class GL extends E{constructor(t){super(t,hR)}getParser(){return this.parser}}class BL extends E{constructor(t){super(t,Te)}getParser(){return this.parser}}class wL extends E{constructor(t){super(t,uR)}getParser(){return this.parser}}class HL extends E{constructor(t){super(t,lR)}getParser(){return this.parser}}class bc extends E{constructor(t){super(t,yM)}getParser(){return this.parser}}class Fc extends E{constructor(t){super(t,LM)}getParser(){return this.parser}}class xc extends E{constructor(t){super(t,UM)}getParser(){return this.parser}}class Gc extends E{constructor(t){super(t,vM)}getParser(){return this.parser}}class VL extends E{constructor(t){super(t,bM)}getParser(){return this.parser}}class jL extends E{constructor(t){super(t,FM)}getParser(){return this.parser}}class YL extends E{constructor(t){super(t,xM)}getParser(){return this.parser}}class Bc extends E{constructor(t){super(t,BM)}getParser(){return this.parser}}class wc extends E{constructor(t){super(t,wM)}getParser(){return this.parser}}class zL extends E{constructor(t){super(t,HM)}getParser(){return this.parser}}class WL extends E{constructor(t){super(t,jM)}getParser(){return this.parser}}class kL extends E{constructor(t){super(t,zM)}getParser(){return this.parser}}class Hc extends E{constructor(t){super(t,nI)}getParser(){return this.parser}}class Vc extends E{constructor(t){super(t,va)}getParser(){return this.parser}}class KL extends E{constructor(t){super(t,aI)}getParser(){return this.parser}}class XL extends E{constructor(t){super(t,bl)}getParser(){return this.parser}}class qL extends E{constructor(t){super(t,_I)}getParser(){return this.parser}}class jc extends E{constructor(t){super(t,hI)}getParser(){return this.parser}}class ca extends E{constructor(t){super(t,lI)}getParser(){return this.parser}}class gh extends E{constructor(t){super(t,cI)}getParser(){return this.parser}}class QL extends E{constructor(t){super(t,dI)}getParser(){return this.parser}}class JL extends E{constructor(t){super(t,gI)}getParser(){return this.parser}}class Yc extends E{constructor(t){super(t,EI)}getParser(){return this.parser}}class zc extends E{constructor(t){super(t,fI)}getParser(){return this.parser}}class ZL extends E{constructor(t){super(t,mI)}getParser(){return this.parser}}class $L extends E{constructor(t){super(t,II)}getParser(){return this.parser}}class tU extends E{constructor(t){super(t,RI)}getParser(){return this.parser}}class eU extends E{constructor(t){super(t,xl)}getParser(){return this.parser}}class sU extends E{constructor(t){super(t,TI)}getParser(){return this.parser}}class iU extends E{constructor(t){super(t,pI)}getParser(){return this.parser}}class Wc extends E{constructor(t){super(t,OI)}getParser(){return this.parser}}class rU extends E{constructor(t){super(t,Gl)}getParser(){return this.parser}}class kc extends E{constructor(t){super(t,AI)}getParser(){return this.parser}}class Eh extends E{constructor(t){super(t,SI)}getParser(){return this.parser}}class Kc extends E{constructor(t){super(t,MI)}getParser(){return this.parser}}class nU extends E{constructor(t){super(t,CI)}getParser(){return this.parser}}class aU extends E{constructor(t){super(t,NI)}getParser(){return this.parser}}class oU extends E{constructor(t){super(t,on)}getParser(){return this.parser}}const zi=class{constructor(e){this._type=e.readInt(),this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._memberSince=e.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==zi.TYPE_ADMIN}get owner(){return this._type==zi.TYPE_OWNER}get pending(){return this._type==zi.TYPE_PENDING}get member(){return this._type!=zi.TYPE_MEMBER}get blocked(){return this._type==zi.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};let mr=zi;mr.TYPE_OWNER=0;mr.TYPE_ADMIN=1;mr.TYPE_PENDING=2;mr.TYPE_MEMBER=3;mr.TYPE_BLOCKED=4;class Xc extends E{constructor(t){super(t,qT)}getParser(){return this.parser}}class qc extends E{constructor(t){super(t,QT)}getParser(){return this.parser}}class Qc extends E{constructor(t){super(t,JT)}getParser(){return this.parser}}class _U extends E{constructor(t){super(t,tp)}getParser(){return this.parser}}class hU extends E{constructor(t){super(t,ep)}getParser(){return this.parser}}class uU extends E{constructor(t){super(t,sp)}getParser(){return this.parser}}class lU extends E{constructor(t){super(t,kM)}getParser(){return this.parser}}class cU{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class dU{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class gU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class EU{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class fU{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class mU{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IU{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class RU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class da{constructor(t="",s="",i="",r=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(t){const s=Ot.generateImageUrl(t);if(!s)return;const i=s.split(",")[1],r=Uint8Array.from(atob(i),n=>n.charCodeAt(0));this._data.push(r.byteLength,r.buffer)}assignBase64(t){const s=t.split(",")[1],i=Uint8Array.from(atob(s),r=>r.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}}class S_ extends da{constructor(t="",s="",i="",r=-1,n=-1){super(t,s,i,r,n)}}class OU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AU{constructor(t,s){this._data=[t,s]}dispose(){this._data=null}getMessageArray(){return this._data}}class SU{constructor(t,s){this._data=[t,s]}dispose(){this._data=null}getMessageArray(){return this._data}}class MU{constructor(t,s,i,r,n,a){this._data=[t,s,i,r,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class CU{constructor(t,s,i,r){this._data=[t,s,i,r]}dispose(){this._data=null}getMessageArray(){return this._data}}class NU{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class DU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PU{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class yU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LU{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class UU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class FU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class xU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class GU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class wU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class HU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class VU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class jU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class YU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class WU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class kU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class KU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class XU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class QU{constructor(t,s,i,r,n,a,o,u,l){this._data=[t,s,i,r,n,a,o,u,l]}getMessageArray(){return this._data}dispose(){}}class JU{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class ZU{constructor(t,s,i,r,n,a,o){this._data=[t,s,i,r,n,a,o]}getMessageArray(){return this._data}dispose(){}}class $U{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class tv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ev{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class iv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rv{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class nv{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class av{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class ov{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _v{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mn{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}mn.CONFIRM_LEVEL_NOT_ACCEPTED=0;mn.CONFIRM_LEVEL_NOT_SUBMITTED=1;mn.CONFIRM_LEVEL_NOT_CONFIRMED=2;mn.CONFIRM_LEVEL_COMMIT=3;class dv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gv{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Ev{constructor(t,s){this._data=[t,s.length].concat(s)}getMessageArray(){return this._data}dispose(){}}class fv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Iv{constructor(t,s){this._data=[t,s.length].concat(s)}getMessageArray(){return this._data}dispose(){}}class Rv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Tv{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class pv{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Ov{constructor(t,...s){this._data=[t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class Av{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Sv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Mv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Nv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Dv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Pv{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class yv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Lv{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Uv{constructor(t,s){this._data=[s.length,...s,t]}getMessageArray(){return this._data}dispose(){}}class vv{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class bv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Fv{constructor(t=!0){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class xv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Gv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Bv{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class wv{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Hv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Vv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class jv{constructor(t,s){this._data=[t,s]}dispose(){this._data=null}getMessageArray(){return this._data}}class Yv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class zv{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Wv{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class kv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Jc{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Kv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Xv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class qv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Qv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Jv{constructor(t,s,i,r,n,a){this._data=[t,s,i,r,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class Zv{constructor(t,s,i,r,n,a){this._data=[t,s,i,r,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class $v{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class tb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Zc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}Zc.NO_ISSUE_ID=-1;class eb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $c{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}$c.NO_ISSUE_ID=-1;class sb{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class ib{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nb{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class ab{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class ob{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _b{constructor(t,s,i,r,n,a){this._data=[t,s,i,r,n,a.length,...a]}getMessageArray(){return this._data}dispose(){}}class hb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ub{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class lb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class db{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class gb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Eb{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class fb{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class mb{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Ib{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Rb{constructor(t,s){this._data=[t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class Tb{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class pb{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Ob{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Ab{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Sb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Mb{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Cb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nb{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class Db{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Pb{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class yb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Lb{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class Ub{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class vb{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class bb{constructor(...t){this._data=[t.length],t.forEach(s=>{this._data.push(s.k),this._data.push(s._arg_2),this._data.push(s._arg_3)})}getMessageArray(){return this._data}dispose(){}}class Fb{constructor(t,s,i,r,n){this._data=[t,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class xb{constructor(t,s,i,r){this._data=[t,s,r,i]}getMessageArray(){return this._data}dispose(){}}class Gb{constructor(t,s,i){if(this._type=t,s.length===i.length){this._data=[];for(let r=0;r<s.length;r++)this._data.push(s[r]),this._data.push(i[r])}}getMessageArray(){return this._data}dispose(){}}class td{constructor(t,s,i,r){this._data=[`NITRO-${Pa.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",Ca.HTML5,W_.BROWSER]}getMessageArray(){return this._data}dispose(){}}class Bb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ed{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Hb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sd{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class id{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Vb{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class jb{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Yb{constructor(t,s,i,r,n){this._data=[t,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class zb{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class Wb{constructor(t,s,i,r){this._data=[t,s,i,r.length/2,...r]}getMessageArray(){return this._data}dispose(){}}class kb{constructor(t,s,i,r,n){this._data=[t,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class Kb{constructor(t,s,i,r,n){this._data=[t,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class Xb{constructor(t,s,i,r,n){this._data=[t,s,i,r,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class qb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Qb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Jb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zb{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class $b{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class t0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class e0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class s0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class i0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class r0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class n0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class a0{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class o0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class h0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class u0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class l0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class c0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class d0{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class g0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class E0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class f0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class m0{constructor(t,s){this._data=[t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class I0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class R0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class T0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class p0{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class O0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class A0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class S0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class M0{constructor(){this._badges=[]}getMessageArray(){const t=[];for(let s=1;s<=this._badges.length;s++)t.push(s),t.push(this._badges[s-1]);return t}dispose(){}addActivatedBadge(t){this._badges.push(t)}}class Qh{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class N0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class D0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class P0{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class Jh{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class y0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class L0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class U0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class F0{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class x0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class G0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class B0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class w0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class H0{constructor(t,...s){this._data=[t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class V0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Y0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class z0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class W0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class k0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class K0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class X0{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){this._data=null}}class q0{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){this._data=null}}class Q0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class J0{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Z0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class $0{constructor(t,s,i){this._data=[t,s.length,...s,i]}getMessageArray(){return this._data}dispose(){}}class Wa{constructor(t,s){this._data=[s,t.length,...t]}getMessageArray(){return this._data}dispose(){}}Wa.RESOLUTION_USELESS=1;Wa.RESOLUTION_ABUSIVE=2;Wa.RESOLUTION_RESOLVED=3;const rd=class{constructor(e,t,s,i,r,n=-1){this._data=[e,t,s,i,r],n!=rd.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}};let li=rd;li.NO_ISSUE_ID=-1;class tF{constructor(t,s,i,r=-1){this._data=[t,s,i],r!=li.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class eF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rF{constructor(t,s=0){this._data=[s,t]}getMessageArray(){return this._data}dispose(){}}class nF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class oF{constructor(t,s,i,r=-1){this._data=[t,s,i],r!=li.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class _F{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class In{constructor(t,s,i){this._data=[],this._data.push(t),this._data.push(s),this._data.push(i)}getMessageArray(){return this._data}dispose(){}}In.ACTION_ALERT=0;In.ACTION_KICK=1;In.ACTION_MESSAGE=3;In.ACTION_MESSAGE_AND_SOFT_KICK=4;class hF{constructor(t,s,i,r=-1){this._data=[t,s,i],r!=li.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class uF{constructor(t,s,i,r=-1){this._data=[],this._data.push(t),this._data.push(s),this._data.push(""),this._data.push(""),this._data.push(i),r!=li.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class lF{constructor(t,s,i,r=-1){this._data=[t,s,i],r!=li.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class cF{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class dF{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class gF{constructor(t,s,i,r,n=-1){this._data=[t,s,i,r],n!=li.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class EF{constructor(t,s,i,r){this._data=[t.length,...t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class fF{constructor(t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class mF{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class IF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pF{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class OF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class AF{constructor(t,s,i,r,n,a){this._data=[t,s,i,r,n,a]}getMessageArray(){return this._data}dispose(){}}class SF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MF{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class CF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yF{constructor(t,s,i){this._data=[t,s?1:0,i?1:0]}getMessageArray(){return this._data}dispose(){}}class LF{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class GF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class VF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class YF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zF{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class WF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XF{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class qF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QF{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class JF{constructor(t,s,i,r,n,a){this._data=[t,s,i,r,n,a]}getMessageArray(){return this._data}dispose(){}}class ZF{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class $F{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ex{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class sx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ix{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class rx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ax{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ox{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class _x{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ux{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class lx{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class cx{constructor(...t){this._data=[t.length*3],t.forEach(s=>{this._data.push(s.dayIndex),this._data.push(s.stepIndex),this._data.push(s.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class nd{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _{}_.ACHIEVEMENT_LIST=219;_.AUTHENTICATION=-1;_.BOT_CONFIGURATION=1986;_.BOT_PICKUP=3323;_.BOT_PLACE=1592;_.BOT_SKILL_SAVE=2624;_.GET_CLUB_OFFERS=3285;_.GET_CLUB_GIFT_INFO=487;_.GET_CATALOG_INDEX=1195;_.GET_CATALOG_PAGE=412;_.CATALOG_PURCHASE=3492;_.CATALOG_PURCHASE_GIFT=1411;_.GET_PRODUCT_OFFER=2594;_.CLIENT_LATENCY=295;_.CLIENT_LATENCY_MEASURE=96;_.CLIENT_POLICY=26979;_.CLIENT_PONG=2596;_.CLIENT_TOOLBAR_TOGGLE=2313;_.CLIENT_VARIABLES=1053;_.GET_CURRENT_TIMING_CODE=2912;_.DESKTOP_NEWS=1827;_.DESKTOP_VIEW=105;_.GET_BUNDLE_DISCOUNT_RULESET=223;_.EVENT_TRACKER=3457;_.FIND_NEW_FRIENDS=516;_.FURNITURE_ALIASES=3898;_.FURNITURE_FLOOR_UPDATE=248;_.FURNITURE_MULTISTATE=99;_.FURNITURE_PICKUP=3456;_.FURNITURE_PLACE=1258;_.FURNITURE_POSTIT_PLACE=2248;_.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283;_.FURNITURE_RANDOMSTATE=3617;_.FURNITURE_WALL_MULTISTATE=210;_.FURNITURE_WALL_UPDATE=168;_.GAMES_INIT=2914;_.GAMES_LIST=741;_.ACCEPTGAMEINVITE=3802;_.GAMEUNLOADEDMESSAGE=3207;_.GETGAMEACHIEVEMENTSMESSAGE=2399;_.GETGAMESTATUSMESSAGE=3171;_.GETUSERGAMEACHIEVEMENTSMESSAGE=389;_.JOINQUEUEMESSAGE=1458;_.LEAVEQUEUEMESSAGE=2384;_.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144;_.GETWEEKLYGAMEREWARDWINNERS=1054;_.GAME2GETACCOUNTGAMESTATUSMESSAGE=11;_.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259;_.GAME2EXITGAMEMESSAGE=1445;_.GAME2GAMECHATMESSAGE=2502;_.GAME2LOADSTAGEREADYMESSAGE=2415;_.GAME2PLAYAGAINMESSAGE=3196;_.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598;_.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232;_.GAME2GETWEEKLYLEADERBOARD=2565;_.GET_GIFT_WRAPPING_CONFIG=418;_.GROUP_ADMIN_ADD=2894;_.GROUP_ADMIN_REMOVE=722;_.GROUP_CREATE_OPTIONS=798;_.GROUP_FAVORITE=3549;_.GET_FORUM_STATS=3149;_.GET_FORUM_THREADS=873;_.GET_FORUMS_LIST=436;_.GET_FORUM_MESSAGES=232;_.GET_FORUM_THREAD=3900;_.GET_UNREAD_FORUMS_COUNT=2908;_.FORUM_MODERATE_MESSAGE=286;_.FORUM_MODERATE_THREAD=1397;_.FORUM_POST_MESSAGE=3529;_.UPDATE_FORUM_READ_MARKER=1855;_.UPDATE_FORUM_SETTINGS=2214;_.FORUM_UPDATE_THREAD=3045;_.GROUP_INFO=2991;_.GROUP_DELETE=1134;_.GROUP_MEMBER_REMOVE_CONFIRM=3593;_.GROUP_MEMBER_REMOVE=593;_.GROUP_MEMBERS=312;_.GROUP_MEMBERSHIPS=367;_.GROUP_REQUEST=998;_.GROUP_REQUEST_ACCEPT=3386;_.GROUP_REQUEST_DECLINE=1894;_.GROUP_SETTINGS=1004;_.GROUP_PARTS=813;_.GROUP_BUY=230;_.GROUP_SAVE_INFORMATION=3137;_.GROUP_SAVE_BADGE=1991;_.GROUP_SAVE_COLORS=1764;_.GROUP_SAVE_PREFERENCES=3435;_.GROUP_BADGES=21;_.GROUP_UNBLOCK_MEMBER=2864;_.GET_BADGE_POINTS_LIMITS=1371;_.REQUESTABADGE=3077;_.GETISBADGEREQUESTFULFILLED=1364;_.ITEM_CLOTHING_REDEEM=3374;_.ITEM_COLOR_WHEEL_CLICK=2144;_.ITEM_DICE_CLICK=1990;_.ITEM_DICE_CLOSE=1533;_.ITEM_DIMMER_SAVE=1648;_.ITEM_DIMMER_SETTINGS=2813;_.ITEM_DIMMER_TOGGLE=2296;_.ITEM_EXCHANGE_REDEEM=3115;_.ITEM_PAINT=711;_.SET_OBJECT_DATA=3608;_.ITEM_STACK_HELPER=3839;_.ITEM_WALL_CLICK=210;_.ITEM_WALL_UPDATE=168;_.MARKETPLACE_CONFIG=2597;_.ACCEPT_FRIEND=137;_.MESSENGER_CHAT=3567;_.DECLINE_FRIEND=2890;_.FOLLOW_FRIEND=3997;_.MESSENGER_FRIENDS=1523;_.MESSENGER_INIT=2781;_.MESSENGER_RELATIONSHIPS=2138;_.SET_RELATIONSHIP_STATUS=3768;_.REMOVE_FRIEND=1689;_.REQUEST_FRIEND=3157;_.GET_FRIEND_REQUESTS=2448;_.SEND_ROOM_INVITE=1276;_.HABBO_SEARCH=1210;_.FRIEND_LIST_UPDATE=1419;_.MOD_TOOL_USER_INFO=3295;_.GET_USER_FLAT_CATS=3027;_.NAVIGATOR_INIT=2110;_.NAVIGATOR_SEARCH=249;_.NAVIGATOR_SEARCH_CLOSE=1834;_.NAVIGATOR_SEARCH_OPEN=637;_.NAVIGATOR_SEARCH_SAVE=2226;_.GET_USER_EVENT_CATS=1782;_.NAVIGATOR_SETTINGS_SAVE=3159;_.NAVIGATOR_CATEGORY_LIST_MODE=1202;_.NAVIGATOR_DELETE_SAVED_SEARCH=1954;_.PET_INFO=2934;_.PET_PICKUP=1581;_.PET_PLACE=2647;_.PET_RESPECT=3202;_.PET_RIDE=1036;_.PET_MOVE=3449;_.PET_OPEN_PACKAGE=3698;_.PET_SELECTED=549;_.PETS_BREED=1638;_.PET_CANCEL_BREEDING=2713;_.PET_CONFIRM_BREEDING=3382;_.GET_PET_TRAINING_PANEL=2161;_.RECYCLER_PRIZES=398;_.RECYCLER_STATUS=1342;_.RECYCLER_ITEMS=2771;_.RELEASE_VERSION=4e3;_.CALL_FOR_HELP=1691;_.ROOM_AMBASSADOR_ALERT=2996;_.ROOM_BAN_GIVE=1477;_.ROOM_BAN_LIST=2267;_.ROOM_BAN_REMOVE=992;_.ROOM_CREATE=2752;_.ROOM_DELETE=532;_.ROOM_DOORBELL=1644;_.ROOM_ENTER=2312;_.ROOM_FAVORITE=3817;_.ROOM_FAVORITE_REMOVE=309;_.CAN_CREATE_ROOM=2128;_.CANCEL_ROOM_EVENT=2725;_.EDIT_ROOM_EVENT=3991;_.COMPETITION_ROOM_SEARCH=433;_.FORWARD_TO_RANDOM_PROMOTED_ROOM=10;_.FORWARD_TO_SOME_ROOM=1703;_.GET_CATEGORIES_WITH_USER_COUNT=3782;_.GET_GUEST_ROOM=2230;_.GET_OFFICIAL_ROOMS=1229;_.GET_POPULAR_ROOM_TAGS=826;_.GUILD_BASE_SEARCH=2930;_.MY_FAVOURITE_ROOMS_SEARCH=2578;_.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002;_.MY_FRIENDS_ROOM_SEARCH=2266;_.MY_GUILD_BASES_SEARCH=39;_.MY_RECOMMENDED_ROOMS=2537;_.MY_ROOM_HISTORY_SEARCH=2264;_.MY_ROOM_RIGHTS_SEARCH=272;_.MY_ROOMS_SEARCH=2277;_.POPULAR_ROOMS_SEARCH=2758;_.ROOM_AD_EVENT_TAB_CLICKED=2412;_.ROOM_AD_EVENT_TAB_VIEWED=2668;_.ROOM_AD_SEARCH=2809;_.ROOM_TEXT_SEARCH=3943;_.ROOMS_WHERE_MY_FRIENDS_ARE=1786;_.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939;_.SET_ROOM_SESSION_TAGS=3305;_.UPDATE_ROOM_THUMBNAIL=2468;_.ROOM_KICK=1320;_.ROOM_LIKE=3582;_.ROOM_MODEL=2300;_.GET_OCCUPIED_TILES=1687;_.GET_ROOM_ENTRY_TILE=3559;_.ROOM_MODEL_SAVE=875;_.ROOM_MUTE=3637;_.ROOM_MUTE_USER=3485;_.ROOM_RIGHTS_GIVE=808;_.ROOM_RIGHTS_LIST=3385;_.ROOM_RIGHTS_REMOVE=2064;_.ROOM_RIGHTS_REMOVE_ALL=2683;_.ROOM_RIGHTS_REMOVE_OWN=3182;_.ROOM_SETTINGS=3129;_.ROOM_SETTINGS_SAVE=1969;_.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265;_.ROOM_STAFF_PICK=1918;_.ROOM_FILTER_WORDS=1911;_.ROOM_FILTER_WORDS_MODIFY=3001;_.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012;_.MYSTERYBOX_OPEN_TROPHY=3074;_.SECURITY_MACHINE=2490;_.SECURITY_TICKET=2419;_.TRADE=1481;_.TRADE_ACCEPT=3863;_.TRADE_CANCEL=2341;_.TRADE_CLOSE=2551;_.TRADE_CONFIRM=2760;_.TRADE_ITEM=3107;_.TRADE_ITEM_REMOVE=3845;_.TRADE_ITEMS=1263;_.TRADE_UNACCEPT=1444;_.UNIT_ACTION=2456;_.UNIT_CHAT=1314;_.UNIT_CHAT_SHOUT=2085;_.UNIT_CHAT_WHISPER=1543;_.UNIT_DANCE=2080;_.UNIT_DROP_HAND_ITEM=2814;_.UNIT_GIVE_HANDITEM=2941;_.UNIT_LOOK=3301;_.UNIT_POSTURE=2235;_.UNIT_SIGN=1975;_.UNIT_TYPING=1597;_.UNIT_TYPING_STOP=1474;_.UNIT_WALK=3320;_.USER_BADGES=2769;_.USER_BADGES_CURRENT=2091;_.USER_BADGES_CURRENT_UPDATE=644;_.USER_BOTS=3848;_.USER_CURRENCY=273;_.USER_EFFECT_ACTIVATE=2959;_.USER_EFFECT_ENABLE=1752;_.USER_FIGURE=2730;_.USER_FURNITURE=3150;_.REQUESTFURNIINVENTORYWHENNOTINROOM=3500;_.USER_HOME_ROOM=1740;_.USER_INFO=357;_.USER_MOTTO=2228;_.USER_IGNORED=3878;_.USER_PETS=3095;_.USER_PROFILE=3265;_.USER_PROFILE_BY_NAME=2249;_.USER_RESPECT=2694;_.GET_SOUND_SETTINGS=2388;_.USER_SETTINGS_CAMERA=1461;_.USER_SETTINGS_CHAT_STYLE=1030;_.USER_SETTINGS_INVITES=1086;_.USER_SETTINGS_OLD_CHAT=1262;_.USER_SETTINGS_VOLUME=1367;_.USER_SUBSCRIPTION=3166;_.GET_WARDROBE=2742;_.SAVE_WARDROBE_OUTFIT=800;_.USER_TAGS=17;_.PEER_USERS_CLASSIFICATION=1160;_.USER_CLASSIFICATION=2285;_.VISIT_USER=2970;_.WIRED_ACTION_SAVE=2281;_.WIRED_APPLY_SNAPSHOT=3373;_.WIRED_CONDITION_SAVE=3203;_.WIRED_OPEN=768;_.WIRED_TRIGGER_SAVE=1520;_.GET_ITEM_DATA=3964;_.ONE_WAY_DOOR_CLICK=2765;_.REMOVE_WALL_ITEM=3336;_.SET_ITEM_DATA=3666;_.CATALOG_REDEEM_VOUCHER=339;_.ROOM_TONER_APPLY=2880;_.FRIEND_FURNI_CONFIRM_LOCK=3775;_.MANNEQUIN_SAVE_NAME=2850;_.MANNEQUIN_SAVE_LOOK=2209;_.PRESENT_OPEN_PRESENT=3558;_.CATALOG_SELECT_VIP_GIFT=2276;_.USER_IGNORE_ID=3314;_.USER_IGNORE=1117;_.USER_UNIGNORE=2061;_.MODTOOL_REQUEST_ROOM_INFO=707;_.MODTOOL_CHANGE_ROOM_SETTINGS=3260;_.MODTOOL_REQUEST_USER_CHATLOG=1391;_.MODTOOL_REQUEST_ROOM_CHATLOG=2587;_.MODTOOL_SANCTION_ALERT=229;_.MODTOOL_SANCTION_BAN=2766;_.MODTOOL_SANCTION_KICK=2582;_.MODTOOL_SANCTION_TRADELOCK=3742;_.MODTOOL_ALERTEVENT=1840;_.MODTOOL_SANCTION_MUTE=1945;_.MODTOOL_REQUEST_USER_ROOMS=3526;_.MODTOOL_ROOM_ALERT=3842;_.MODTOOL_PREFERENCES=31;_.CLOSE_ISSUE_DEFAULT_ACTION=2717;_.CLOSE_ISSUES=2067;_.DEFAULT_SANCTION=1681;_.GET_CFH_CHATLOG=211;_.MODTOOL_SANCTION=1392;_.PICK_ISSUES=15;_.RELEASE_ISSUES=1572;_.CONVERT_GLOBAL_ROOM_ID=314;_.REQUEST_SELL_ITEM=848;_.REQUEST_MARKETPLACE_ITEM_STATS=3288;_.MARKETPLACE_SELL_ITEM=3447;_.MARKETPLACE_REQUEST_OWN_ITEMS=2105;_.MARKETPLACE_TAKE_BACK_ITEM=434;_.MARKETPLACE_REDEEM_CREDITS=2650;_.MARKETPLACE_REQUEST_OFFERS=2407;_.MARKETPLACE_BUY_OFFER=1603;_.MARKETPLACE_BUY_TOKENS=1866;_.CATALOG_REQUESET_PET_BREEDS=1756;_.APPROVE_NAME=2109;_.UNIT_GIVE_HANDITEM_PET=2768;_.PET_MOUNT=1036;_.PET_SUPPLEMENT=749;_.FURNITURE_GROUP_INFO=2651;_.ACHIEVEMENT_RESOLUTION_OPEN=359;_.USE_PET_PRODUCT=1328;_.REMOVE_PET_SADDLE=186;_.TOGGLE_PET_RIDING=1472;_.TOGGLE_PET_BREEDING=3379;_.UNSEEN_RESET_CATEGORY=3493;_.UNSEEN_RESET_ITEMS=2343;_.COMMUNITY_GOAL_VOTE_COMPOSER=3536;_.GET_PROMO_ARTICLES=1827;_.ACCEPT_QUEST=3604;_.ACTIVATE_QUEST=793;_.CANCEL_QUEST=3133;_.FRIEND_REQUEST_QUEST_COMPLETE=1148;_.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688;_.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167;_.GET_COMMUNITY_GOAL_PROGRESS=1145;_.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343;_.GET_CONCURRENT_USERS_REWARD=3872;_.GET_DAILY_QUEST=2486;_.GET_QUESTS=3333;_.GET_SEASONAL_QUESTS_ONLY=1190;_.OPEN_QUEST_TRACKER=2750;_.REDEEM_COMMUNITY_GOAL_PRIZE=90;_.REJECT_QUEST=2397;_.START_CAMPAIGN=1697;_.GET_BONUS_RARE_INFO=957;_.CRAFT=3591;_.CRAFT_SECRET=1251;_.GET_CRAFTABLE_PRODUCTS=633;_.GET_CRAFTING_RECIPE=1173;_.GET_CRAFTING_RECIPES_AVAILABLE=3086;_.PHOTO_COMPETITION=3959;_.PUBLISH_PHOTO=2068;_.PURCHASE_PHOTO=2408;_.RENDER_ROOM=3226;_.RENDER_ROOM_THUMBNAIL=1982;_.REQUEST_CAMERA_CONFIGURATION=796;_.ADD_JUKEBOX_DISK=753;_.GET_JUKEBOX_PLAYLIST=1435;_.GET_NOW_PLAYING=1325;_.GET_OFFICIAL_SONG_ID=3189;_.GET_SONG_INFO=3082;_.GET_SOUND_MACHINE_PLAYLIST=3498;_.GET_USER_SONG_DISKS=2304;_.REMOVE_JUKEBOX_DISK=3050;_.INTERSTITIAL_SHOWN=1109;_.GET_INTERSTITIAL=2519;_.CHANGE_USERNAME=2977;_.CHECK_USERNAME=3950;_.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889;_.OPEN_CAMPAIGN_CALENDAR_DOOR=2257;_.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051;_.BUILDERS_CLUB_PLACE_WALL_ITEM=462;_.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529;_.GET_CATALOG_PAGE_EXPIRATION=742;_.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135;_.GET_DIRECT_CLUB_BUY_AVAILABLE=801;_.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603;_.GET_HABBO_CLUB_EXTEND_OFFER=2462;_.GET_IS_OFFER_GIFTABLE=1347;_.GET_LIMITED_OFFER_APPEARING_NEXT=410;_.GET_NEXT_TARGETED_OFFER=596;_.GET_ROOM_AD_PURCHASE_INFO=1075;_.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257;_.GET_TARGETED_OFFER=2487;_.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150;_.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735;_.PURCHASE_ROOM_AD=777;_.PURCHASE_TARGETED_OFFER=1826;_.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407;_.ROOM_AD_PURCHASE_INITIATED=2283;_.SET_TARGETTED_OFFER_STATE=2041;_.SHOP_TARGETED_OFFER_VIEWED=3483;_.HELPER_TALENT_TRACK=196;_.TALENT_TRACK_GET_LEVEL=2127;_.FORWARD_TO_A_COMPETITION_ROOM=172;_.FORWARD_TO_A_SUBMITTABLE_ROOM=1450;_.FORWARD_TO_RANDOM_COMPETITION_ROOM=865;_.GET_IS_USER_PART_OF_COMPETITION=2077;_.GET_SECONDS_UNTIL=271;_.ROOM_COMPETITION_INIT=1334;_.SUBMIT_ROOM_TO_COMPETITION=2595;_.VOTE_FOR_ROOM=143;_.GET_GIFT=2436;_.RESET_PHONE_NUMBER_STATE=2741;_.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379;_.TRY_PHONE_NUMBER=790;_.VERIFY_CODE=2721;_.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005;_.GET_YOUTUBE_DISPLAY_STATUS=336;_.SET_YOUTUBE_DISPLAY_PLAYLIST=2069;_.GO_TO_FLAT=685;_.CHANGE_QUEUE=3093;_.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412;_.CALL_FOR_HELP_FROM_FORUM_THREAD=534;_.CALL_FOR_HELP_FROM_IM=2950;_.CALL_FOR_HELP_FROM_PHOTO=2492;_.CALL_FOR_HELP_FROM_SELFIE=2755;_.CHAT_REVIEW_GUIDE_DECIDES=3365;_.CHAT_REVIEW_GUIDE_DETACHED=2501;_.CHAT_REVIEW_GUIDE_VOTE=3961;_.CHAT_REVIEW_SESSION_CREATE=3060;_.DELETE_PENDING_CALLS_FOR_HELP=3605;_.GET_CFH_STATUS=2746;_.GET_FAQ_CATEGORY=3445;_.GET_FAQ_TEXT=1849;_.GET_GUIDE_REPORTING_STATUS=3786;_.GET_PENDING_CALLS_FOR_HELP=3267;_.GET_QUIZ_QUESTIONS=1296;_.GUIDE_SESSION_CREATE=3338;_.GUIDE_SESSION_FEEDBACK=477;_.GUIDE_SESSION_GET_REQUESTER_ROOM=1052;_.GUIDE_SESSION_GUIDE_DECIDES=1424;_.GUIDE_SESSION_INVITE_REQUESTER=234;_.GUIDE_SESSION_IS_TYPING=519;_.GUIDE_SESSION_MESSAGE=3899;_.GUIDE_SESSION_ON_DUTY_UPDATE=1922;_.GUIDE_SESSION_REPORT=3969;_.GUIDE_SESSION_REQUESTER_CANCELS=291;_.GUIDE_SESSION_RESOLVED=887;_.POST_QUIZ_ANSWERS=3720;_.SEARCH_FAQS=2031;_.POLL_ANSWER=3505;_.POLL_REJECT=1773;_.POLL_START=109;_.DISCONNECT=2445;_.SCR_GET_KICKBACK_INFO=869;_.COMPOST_PLANT=3835;_.HARVEST_PET=1521;_.SET_CLOTHING_CHANGE_DATA=924;_.GROUP_UNFAVORITE=1820;_.NEW_USER_EXPERIENCE_GET_GIFTS=1822;_.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299;_.HANDSHAKE_INIT_DIFFIE=3110;_.HANDSHAKE_COMPLETE_DIFFIE=773;_.WELCOME_OPEN_GIFT=2638;_.WELCOME_GIFT_CHANGE_EMAIL=66;_.EMAIL_GET_STATUS=2557;_.EMAIL_CHANGE=3965;_.APPROVE_ALL_MEMBERSHIP_REQUESTS=882;_.RENTABLE_SPACE_CANCEL_RENT=1667;_.RENTABLE_SPACE_RENT=2946;_.RENTABLE_SPACE_STATUS=872;_.TRACKING_PERFORMANCE_LOG=3230;_.TRACKING_LAG_WARNING_REPORT=3847;_.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736;_.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115;_.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071;_.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518;class ad{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M_{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class od{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dx{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class _d{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ud{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ld{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class dd{constructor(t,s,i){this._data=[t,s,i.length,...i]}getMessageArray(){return this._data}dispose(){}}class gd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ed{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ex{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ix{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Rx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class px{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ox{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ax{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Sx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Mx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Nx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Dx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Px{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Lx{constructor(...t){this._data=[t.length],t.forEach(s=>{this._data.push(s.itemId)})}getMessageArray(){return this._data}dispose(){}}class fd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class md{constructor(t,s=null){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Ux{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Id{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Rd{constructor(t,s=0,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class vx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Td{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Od{constructor(t,s,i=0){this._data=[t,i,s]}getMessageArray(){return this._data}dispose(){}}class Ad{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class bx{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Fx{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class xx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wx{constructor(t,s,i,r,n,a,o,u,l,c,g,f,R,m,T,O,C,N,S,D,v,b,w,Q){this._data=[],this._data.push(t,s,i,r,n,a,o),this._data.push(l.length,...l),this._data.push(c,g,f,R,m,T,O,C,N,S,D,v,b,w,Q)}getMessageArray(){return this._data}dispose(){}}class Sd{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Md{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Hx{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Cd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nd extends Cd{constructor(t){super(t)}}class Dd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Pd extends Cd{constructor(t){super(t)}}class C_{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class yd{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Ld{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ud{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vd{constructor(t,s,i=""){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class bd{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Fd{constructor(t,s){this._data=[t,s.size*2];for(const[i,r]of s.entries())this._data.push(i,r)}getMessageArray(){return this._data}dispose(){}}class Vx{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class xd{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Gd{constructor(t,s,i,r,n){this._data=[t,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class Bd{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jx{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class Yx{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class N_{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class wd{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Hd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Vd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class jd{constructor(t,s,i,r,n,a){this._itemId=t,this._category=s,this._wallLocation=i,this._x=r,this._y=n,this._direction=a}getMessageArray(){switch(this._category){case A.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case A.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class zx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Yd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Wx{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class zd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fh{constructor(t,s=0){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Kd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Kx{constructor(t,s=-100){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class qd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Xx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qx{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Qx{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Qd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Jx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Jd{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $x{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class t1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class e1{constructor(t,s,i,r){this._data=[t,s,i,r]}getMessageArray(){return this._data}dispose(){}}class Zd{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class s1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class i1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class r1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class n1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class D_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class a1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class o1{constructor(t,s,i,r,n,a,o){this._data=[t,s,i,r,n,a,o]}getMessageArray(){return this._data}dispose(){}}class _1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $d{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mh{constructor(t,s=0){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class eg{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class h1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sg{constructor(t,s,i){this._data=[t+" "+s,i]}getMessageArray(){return this._data}dispose(){}}class ig{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class rg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ng{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ag{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class u1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class l1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class c1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class og{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class _g{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ug{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class ka{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}ka.STATE_START=0;ka.STATE_CANCEL=1;ka.STATE_ACCEPT=2;class d1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class g1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class E1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class f1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class m1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class I1{constructor(t,s,i,r,n,a){this._data=[t,s.length,...s,i,r.length,...r,n,a]}getMessageArray(){return this._data}dispose(){}}class R1{constructor(t,s,i,r,n){this._data=[t,s.length,...s,i,r.length,...r,n]}getMessageArray(){return this._data}dispose(){}}class T1{constructor(t,s,i,r,n){this._data=[t,s.length,...s,i,r.length,...r,n]}getMessageArray(){return this._data}dispose(){}}class p1{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class O1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class lg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class A1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dg{constructor(...t){this._data=[t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class S1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class M1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class N1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class D1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class P1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class y1{constructor(t,s,i,r,n,a,o,u,l,c,g){this._data=[t,s,i,r,n,a,o,u,l,c,g]}getMessageArray(){return this._data}dispose(){}}class L1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class U1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class b1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Eg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ig{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Rg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class F1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class pg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class x1{constructor(t,s=!0){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class G1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class B1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Og{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class w1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class H1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class V1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Y1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class z1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class W1{constructor(t,s,i){this._data=[t,s,i]}getMessageArray(){return this._data}dispose(){}}class k1{constructor(t,s){this._data=[t,s]}getMessageArray(){return this._data}dispose(){}}class Ag{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class K1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Sg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Mg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class X1 extends as{constructor(t){super(),this._communication=t,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const t=this._communication.connection;t&&(t.addEventListener(jt.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.addEventListener(jt.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.addEventListener(jt.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new $l(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new bc(this.onAuthenticatedEvent.bind(this)))}onDispose(){const t=this._communication.connection;t&&(t.removeEventListener(jt.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.removeEventListener(jt.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.removeEventListener(jt.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(t){const s=this._communication.connection;s&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Jt.CONNECTION_ESTABLISHED,s),W.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(s),s.send(new td(null,null,null,null)),this.tryAuthentication(s))}onConnectionClosedEvent(t){const s=this._communication.connection;s&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Jt.CONNECTION_CLOSED,s))}onConnectionErrorEvent(t){const s=this._communication.connection;s&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Jt.CONNECTION_ERROR,s))}tryAuthentication(t){if(!t||!this.getSSO()){this.getSSO()||G.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(Jt.CONNECTION_HANDSHAKE_FAILED,t);return}t.send(new id(this.getSSO(),Z()))}onClientPingEvent(t){!t||!t.connection||this.sendPong(t.connection)}onAuthenticatedEvent(t){!t||!t.connection||(this.completeHandshake(t.connection),this.dispatchCommunicationDemoEvent(Jt.CONNECTION_AUTHENTICATED,t.connection),t.connection.send(new ed))}startHandshake(t){this.dispatchCommunicationDemoEvent(Jt.CONNECTION_HANDSHAKING,t),this._handShaking=!0}completeHandshake(t){this.dispatchCommunicationDemoEvent(Jt.CONNECTION_HANDSHAKED,t),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,W.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(t=null){t=t||this._communication.connection||null,t&&t.send(new sd)}dispatchCommunicationDemoEvent(t,s){B.instance.events.dispatchEvent(new Jt(t,s))}getSSO(){return W.getValue("sso.ticket",null)}}class q1{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(h.INTERSTITIAL_MESSAGE,KM),this._events.set(h.ROOM_AD_ERROR,XM),this._events.set(h.AVAILABILITY_STATUS,Jl),this._events.set(h.AVAILABILITY_TIME,qM),this._events.set(h.HOTEL_CLOSED_AND_OPENS,QM),this._events.set(h.HOTEL_CLOSES_AND_OPENS_AT,JM),this._events.set(h.HOTEL_WILL_CLOSE_MINUTES,ZM),this._events.set(h.HOTEL_MAINTENANCE,$M),this._events.set(h.USER_CHANGE_NAME,ke),this._events.set(h.CHECK_USER_NAME,tC),this._events.set(h.USER_FIGURE,Zl),this._events.set(h.USER_OUTFITS,eC),this._events.set(h.ADD_BOT_TO_INVENTORY,sC),this._events.set(h.USER_BOTS,iC),this._events.set(h.BOT_RECEIVED,rC),this._events.set(h.REMOVE_BOT_FROM_INVENTORY,nC),this._events.set(h.CFH_SANCTION,aC),this._events.set(h.CFH_TOPICS,oC),this._events.set(h.CFH_SANCTION_STATUS,_C),this._events.set(h.CAMERA_PUBLISH_STATUS,hC),this._events.set(h.CAMERA_PURCHASE_OK,uC),this._events.set(h.CAMERA_STORAGE_URL,lC),this._events.set(h.COMPETITION_STATUS,cC),this._events.set(h.INIT_CAMERA,dC),this._events.set(h.THUMBNAIL_STATUS,gC),this._events.set(h.CAMPAIGN_CALENDAR_DATA,EC),this._events.set(h.CAMPAIGN_CALENDAR_DOOR_OPENED,fC),this._events.set(h.BONUS_RARE_INFO,mC),this._events.set(h.BUILDERS_CLUB_FURNI_COUNT,IC),this._events.set(h.BUILDERS_CLUB_SUBSCRIPTION,RC),this._events.set(h.BUNDLE_DISCOUNT_RULESET,TC),this._events.set(h.CATALOG_PAGE_EXPIRATION,pC),this._events.set(h.CATALOG_PAGE,OC),this._events.set(h.CATALOG_PAGE_LIST,AC),this._events.set(h.CATALOG_EARLIEST_EXPIRY,SC),this._events.set(h.CATALOG_PUBLISHED,MC),this._events.set(h.CLUB_GIFT_INFO,CC),this._events.set(h.CLUB_GIFT_SELECTED,NC),this._events.set(h.DIRECT_SMS_CLUB_BUY,DC),this._events.set(h.GIFT_RECEIVER_NOT_FOUND,PC),this._events.set(h.GIFT_WRAPPER_CONFIG,yC),this._events.set(h.CLUB_EXTENDED_OFFER,LC),this._events.set(h.CLUB_OFFERS,UC),this._events.set(h.IS_OFFER_GIFTABLE,vC),this._events.set(h.LIMITED_SOLD_OUT,bC),this._events.set(h.LIMITED_OFFER_APPEARING_NEXT,FC),this._events.set(h.NOT_ENOUGH_BALANCE,xC),this._events.set(h.PRODUCT_OFFER,GC),this._events.set(h.CATALOG_PURCHASE_ERROR,BC),this._events.set(h.CATALOG_PURCHASE_NOT_ALLOWED,wC),this._events.set(h.CATALOG_PURCHASE_OK,HC),this._events.set(h.ROOM_AD_PURCHASE,VC),this._events.set(h.SEASONAL_CALENDAR_OFFER,jC),this._events.set(h.CATALOG_RECEIVE_PET_BREEDS,YC),this._events.set(h.TARGET_OFFER,zC),this._events.set(h.TARGET_OFFER_NOT_FOUND,WC),this._events.set(h.REDEEM_VOUCHER_ERROR,kC),this._events.set(h.REDEEM_VOUCHER_OK,KC),this._events.set(h.CLIENT_PING,$l),this._events.set(h.COMPETITION_ENTRY_SUBMIT,XC),this._events.set(h.COMPETITION_VOTING_INFO,qC),this._events.set(h.COMPETITION_TIMING_CODE,QC),this._events.set(h.COMPETITION_USER_PART_OF,JC),this._events.set(h.COMPETITION_NO_OWNED_ROOMS,ZC),this._events.set(h.COMPETITION_SECONDS_UNTIL,$C),this._events.set(h.CRAFTABLE_PRODUCTS,tN),this._events.set(h.CRAFTING_RECIPE,eN),this._events.set(h.CRAFTING_RECIPES_AVAILABLE,sN),this._events.set(h.CRAFTING_RESULT,iN),this._events.set(h.DESKTOP_VIEW,Vo),this._events.set(h.MESSENGER_ACCEPT_FRIENDS,rN),this._events.set(h.MESSENGER_FIND_FRIENDS,nN),this._events.set(h.MESSENGER_FOLLOW_FAILED,aN),this._events.set(h.MESSENGER_FRIENDS,oN),this._events.set(h.MESSENGER_UPDATE,_N),this._events.set(h.MESSENGER_FRIEND_NOTIFICATION,hN),this._events.set(h.MESSENGER_REQUESTS,uN),this._events.set(h.MESSENGER_SEARCH,lN),this._events.set(h.MESSENGER_INSTANCE_MESSAGE_ERROR,cN),this._events.set(h.MESSENGER_MESSAGE_ERROR,dN),this._events.set(h.MESSENGER_INIT,gN),this._events.set(h.MESSENGER_MINIMAIL_NEW,EN),this._events.set(h.MESSENGER_MINIMAIL_COUNT,fN),this._events.set(h.MESSENGER_CHAT,mN),this._events.set(h.MESSENGER_REQUEST,tc),this._events.set(h.MESSENGER_INVITE_ERROR,IN),this._events.set(h.MESSENGER_INVITE,RN),this._events.set(h.ACHIEVEMENTRESOLUTIONCOMPLETED,NN),this._events.set(h.ACHIEVEMENTRESOLUTIONPROGRESS,DN),this._events.set(h.ACHIEVEMENTRESOLUTIONS,PN),this._events.set(h.LOAD_GAME_URL,ec),this._events.set(h.LOADGAME,GN),this._events.set(h.UNLOADGAME,BN),this._events.set(h.GAME_CENTER_GAME_LIST,UN),this._events.set(h.GAMESTATUSMESSAGE,vN),this._events.set(h.GAME_CENTER_ACHIEVEMENTS,wN),this._events.set(h.GAME_CENTER_STATUS,TN),this._events.set(h.GAME_CENTER_IN_ARENA_QUEUE,ON),this._events.set(h.GAME_CENTER_STOP_COUNTER,MN),this._events.set(h.GAME_CENTER_USER_LEFT_GAME,CN),this._events.set(h.GAME_CENTER_DIRECTORY_STATUS,pN),this._events.set(h.GAME_CENTER_STARTING_GAME_FAILED,SN),this._events.set(h.GAME_CENTER_JOINING_FAILED,AN),this._events.set(h.GAMEACHIEVEMENTS,yN),this._events.set(h.GAMEINVITE,LN),this._events.set(h.JOINEDQUEUEMESSAGE,bN),this._events.set(h.JOININGQUEUEFAILED,FN),this._events.set(h.LEFTQUEUE,xN),this._events.set(h.WEEKLY_GAME_REWARD,zN),this._events.set(h.WEEKLY_GAME_REWARD_WINNERS,WN),this._events.set(h.WEEKLY_COMPETITIVE_LEADERBOARD,YN),this._events.set(h.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,jN),this._events.set(h.WEEKLY_GAME2_FRIENDS_LEADERBOARD,HN),this._events.set(h.WEEKLY_GAME2_LEADERBOARD,VN),this._events.set(h.GROUP_INFO,JN),this._events.set(h.GROUP_MEMBER_REMOVE_CONFIRM,QN),this._events.set(h.GROUP_MEMBERS,ZN),this._events.set(h.GROUP_CREATE_OPTIONS,qN),this._events.set(h.GROUP_BADGE_PARTS,sc),this._events.set(h.GROUP_SETTINGS,tD),this._events.set(h.GROUP_PURCHASED,$N),this._events.set(h.GROUP_BADGES,Wc),this._events.set(h.GROUP_DEACTIVATE,eD),this._events.set(h.GROUP_MEMBERSHIP_REQUESTED,tU),this._events.set(h.GROUP_DETAILS_CHANGED,$L),this._events.set(h.GROUP_HABBO_JOIN_FAILED,rU),this._events.set(h.GROUP_FORUM_DATA,sD),this._events.set(h.GROUP_FORUM_LIST,iD),this._events.set(h.GROUP_FORUM_THREADS,rD),this._events.set(h.GROUP_FORUM_POST,nD),this._events.set(h.GROUP_FORUM_POST_THREAD,aD),this._events.set(h.GROUP_FORUM_THREAD_MESSAGES,oD),this._events.set(h.GROUP_FORUM_UNREAD_COUNT,_D),this._events.set(h.GROUP_FORUM_UPDATE_MESSAGE,hD),this._events.set(h.GROUP_FORUM_UPDATE_THREAD,uD),this._events.set(h.CFH_DISABLED_NOTIFY,ED),this._events.set(h.CFH_PENDING_CALLS_DELETED,fD),this._events.set(h.CFH_PENDING_CALLS,mD),this._events.set(h.CFH_REPLY,ID),this._events.set(h.CFH_RESULT_MESSAGE,RD),this._events.set(h.GUIDE_ON_DUTY_STATUS,MD),this._events.set(h.GUIDE_SESSION_ATTACHED,ND),this._events.set(h.GUIDE_SESSION_DETACHED,DD),this._events.set(h.GUIDE_SESSION_ENDED,rc),this._events.set(h.GUIDE_SESSION_ERROR,nc),this._events.set(h.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,PD),this._events.set(h.GUIDE_SESSION_MESSAGE,yD),this._events.set(h.GUIDE_SESSION_PARTNER_IS_TYPING,LD),this._events.set(h.GUIDE_SESSION_REQUESTER_ROOM,UD),this._events.set(h.GUIDE_SESSION_STARTED,ac),this._events.set(h.GUIDE_TICKET_CREATION_RESULT,vD),this._events.set(h.GUIDE_TICKET_RESOLUTION,bD),this._events.set(h.GUIDE_REPORTING_STATUS,CD),this._events.set(h.HOTEL_MERGE_NAME_CHANGE,FD),this._events.set(h.ISSUE_CLOSE_NOTIFICATION,xD),this._events.set(h.QUIZ_DATA,GD),this._events.set(h.QUIZ_RESULTS,BD),this._events.set(h.CHAT_REVIEW_SESSION_DETACHED,TD),this._events.set(h.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,pD),this._events.set(h.CHAT_REVIEW_SESSION_RESULTS,OD),this._events.set(h.CHAT_REVIEW_SESSION_STARTED,AD),this._events.set(h.CHAT_REVIEW_SESSION_VOTING_STATUS,SD),this._events.set(h.ACHIEVEMENT_PROGRESSED,wD),this._events.set(h.ACHIEVEMENT_LIST,HD),this._events.set(h.USER_ACHIEVEMENT_SCORE,VD),this._events.set(h.USER_EFFECT_ACTIVATE,jD),this._events.set(h.USER_EFFECT_LIST_ADD,YD),this._events.set(h.USER_EFFECT_LIST_REMOVE,zD),this._events.set(h.USER_EFFECT_LIST,kD),this._events.set(h.AVATAR_EFFECT_SELECTED,WD),this._events.set(h.USER_BADGES,XD),this._events.set(h.USER_BADGES_ADD,KD),this._events.set(h.BADGE_POINT_LIMITS,oc),this._events.set(h.BADGE_REQUEST_FULFILLED,qD),this._events.set(h.USER_CLOTHING,QD),this._events.set(h.USER_FURNITURE_ADD,JD),this._events.set(h.USER_FURNITURE,ZD),this._events.set(h.USER_FURNITURE_REFRESH,$D),this._events.set(h.USER_FURNITURE_REMOVE,tP),this._events.set(h.USER_FURNITURE_POSTIT_PLACED,eP),this._events.set(h.USER_PETS,aP),this._events.set(h.USER_PET_REMOVE,_P),this._events.set(h.USER_PET_ADD,nP),this._events.set(h.PET_RECEIVED,oP),this._events.set(h.PET_PLACING_ERROR,cc),this._events.set(h.YOUTUBE_CONTROL_VIDEO,RL),this._events.set(h.YOUTUBE_DISPLAY_PLAYLISTS,TL),this._events.set(h.YOUTUBE_DISPLAY_VIDEO,pL),this._events.set(h.TRADE_ACCEPTED,hP),this._events.set(h.TRADE_CLOSED,uP),this._events.set(h.TRADE_COMPLETED,lP),this._events.set(h.TRADE_CONFIRMATION,cP),this._events.set(h.TRADE_LIST_ITEM,dP),this._events.set(h.TRADE_NOT_OPEN,EP),this._events.set(h.TRADE_OPEN_FAILED,mP),this._events.set(h.TRADE_OPEN,fP),this._events.set(h.TRADE_OTHER_NOT_ALLOWED,IP),this._events.set(h.TRADE_YOU_NOT_ALLOWED,RP),this._events.set(h.TRADE_NO_SUCH_ITEM,gP),this._events.set(h.COMMUNITY_GOAL_VOTE_EVENT,pP),this._events.set(h.PROMO_ARTICLES,TP),this._events.set(h.MARKETPLACE_AFTER_ORDER_STATUS,OP),this._events.set(h.MARKETPLACE_CANCEL_SALE,AP),this._events.set(h.MARKETPLACE_SELL_ITEM,SP),this._events.set(h.MARKETPLACE_CONFIG,MP),this._events.set(h.MARKETPLACE_ITEM_STATS,CP),this._events.set(h.MARKETPLACE_ITEM_POSTED,NP),this._events.set(h.MARKETPLACE_ITEMS_SEARCHED,DP),this._events.set(h.MARKETPLACE_OWN_ITEMS,PP),this._events.set(h.USER_BANNED,YP),this._events.set(h.MODERATION_CAUTION,FP),this._events.set(h.MODTOOL_ROOM_INFO,BP),this._events.set(h.MODTOOL_USER_CHATLOG,zP),this._events.set(h.MODTOOL_ROOM_CHATLOG,VP),this._events.set(h.MODERATION_USER_INFO,HP),this._events.set(h.MODERATION_TOOL,xP),this._events.set(h.MODTOOL_VISITED_ROOMS_USER,jP),this._events.set(h.CFH_CHATLOG,yP),this._events.set(h.ISSUE_DELETED,LP),this._events.set(h.ISSUE_INFO,UP),this._events.set(h.ISSUE_PICK_FAILED,vP),this._events.set(h.MODERATOR_ACTION_RESULT,bP),this._events.set(h.MODERATOR_MESSAGE,GP),this._events.set(h.MODERATOR_TOOL_PREFERENCES,wP),this._events.set(h.MYSTERY_BOX_KEYS,hc),this._events.set(h.GOTMYSTERYBOXPRIZEMESSAGE,kP),this._events.set(h.CANCELMYSTERYBOXWAITMESSAGE,WP),this._events.set(h.SHOWMYSTERYBOXWAITMESSAGE,KP),this._events.set(h.CAN_CREATE_ROOM,XP),this._events.set(h.CAN_CREATE_ROOM_EVENT,qP),this._events.set(h.CATEGORIES_WITH_VISITOR_COUNT,QP),this._events.set(h.COMPETITION_ROOMS_DATA,JP),this._events.set(h.CONVERTED_ROOM_ID,ZP),this._events.set(h.ROOM_DOORBELL,uc),this._events.set(h.USER_FAVORITE_ROOM,$P),this._events.set(h.USER_FAVORITE_ROOM_COUNT,ty),this._events.set(h.ROOM_DOORBELL_REJECTED,Yo),this._events.set(h.ROOM_CREATED,ey),this._events.set(h.ROOM_INFO,zo),this._events.set(h.GUEST_ROOM_SEARCH_RESULT,sy),this._events.set(h.USER_HOME_ROOM,ry),this._events.set(h.ROOM_EVENT_CANCEL,cy),this._events.set(h.ROOM_EVENT,dy),this._events.set(h.ROOM_INFO_UPDATED,Ey),this._events.set(h.THUMBNAIL_UPDATE_RESULT,fy),this._events.set(h.NAVIGATOR_EVENT_CATEGORIES,my),this._events.set(h.NAVIGATOR_CATEGORIES,Iy),this._events.set(h.NAVIGATOR_COLLAPSED,iy),this._events.set(h.NAVIGATOR_LIFTED,ny),this._events.set(h.NAVIGATOR_METADATA,ay),this._events.set(h.NAVIGATOR_OPEN_ROOM_CREATOR,oy),this._events.set(h.NAVIGATOR_SEARCHES,_y),this._events.set(h.NAVIGATOR_SEARCH,hy),this._events.set(h.NAVIGATOR_SETTINGS,uy),this._events.set(h.GENERIC_ALERT,Sy),this._events.set(h.MOTD_MESSAGES,Cy),this._events.set(h.NOTIFICATION_LIST,Ny),this._events.set(h.UNSEEN_ITEMS,yy),this._events.set(h.ACHIEVEMENT_NOTIFICATION,Ry),this._events.set(h.INFO_FEED_ENABLE,My),this._events.set(h.CLUB_GIFT_NOTIFICATION,py),this._events.set(h.ACTIVITY_POINT_NOTIFICATION,Ty),this._events.set(h.BOT_ERROR,lc),this._events.set(h.PET_LEVEL_NOTIFICATION,Dy),this._events.set(h.NOTIFICATION_SIMPLE_ALERT,Py),this._events.set(h.NOTIFICATION_ELEMENT_POINTER,Ay),this._events.set(h.USER_PERKS,By),this._events.set(h.PET_TRAINING_PANEL,Hy),this._events.set(h.PET_LEVEL_UPDATE,Ec),this._events.set(h.PET_SCRATCH_FAILED,fc),this._events.set(h.PET_OPEN_PACKAGE_REQUESTED,dc),this._events.set(h.PET_OPEN_PACKAGE_RESULT,gc),this._events.set(h.PET_BREEDING_RESULT,Mc),this._events.set(h.QUESTION,pc),this._events.set(h.POLL_CONTENTS,mc),this._events.set(h.POLL_ERROR,Ic),this._events.set(h.POLL_OFFER,Rc),this._events.set(h.QUESTION_ANSWERED,Tc),this._events.set(h.QUESTION_FINISHED,Oc),this._events.set(h.COMMUNITY_GOAL_EARNED_PRIZES,Vy),this._events.set(h.COMMUNITY_GOAL_PROGRESS,Yy),this._events.set(h.CONCURRENT_USERS_GOAL_PROGRESS,zy),this._events.set(h.QUEST_DAILY,Xy),this._events.set(h.QUEST_CANCELLED,ky),this._events.set(h.QUEST_COMPLETED,Ky),this._events.set(h.COMMUNITY_GOAL_HALL_OF_FAME,jy),this._events.set(h.EPIC_POPUP,Wy),this._events.set(h.SEASONAL_QUESTS,Jy),this._events.set(h.QUESTS,Qy),this._events.set(h.QUEST,qy),this._events.set(h.ROOM_ENTER_ERROR,Zy),this._events.set(h.ROOM_ENTER,qo),this._events.set(h.ROOM_FORWARD,$y),this._events.set(h.ROOM_DOORBELL_ACCEPTED,Wo),this._events.set(h.ROOM_RIGHTS_CLEAR,ko),this._events.set(h.ROOM_RIGHTS_OWNER,Xo),this._events.set(h.ROOM_RIGHTS,Ko),this._events.set(h.BOT_COMMAND_CONFIGURATION,tL),this._events.set(h.BOT_SKILL_LIST_UPDATE,sL),this._events.set(h.BOT_FORCE_OPEN_CONTEXT_MENU,eL),this._events.set(h.ROOM_SETTINGS_CHAT,iL),this._events.set(h.ROOM_INFO_OWNER,rL),this._events.set(h.ROOM_SCORE,nL),this._events.set(h.ROOM_ROLLING,Jo),this._events.set(h.FURNITURE_FLOOR_ADD,$o),this._events.set(h.FURNITURE_FLOOR,t_),this._events.set(h.FURNITURE_FLOOR_REMOVE,e_),this._events.set(h.FURNITURE_FLOOR_UPDATE,s_),this._events.set(h.ITEM_WALL_ADD,o_),this._events.set(h.ITEM_WALL,__),this._events.set(h.ITEM_WALL_REMOVE,h_),this._events.set(h.ITEM_WALL_UPDATE,u_),this._events.set(h.FURNITURE_ALIASES,i_),this._events.set(h.FURNITURE_DATA,r_),this._events.set(h.FURNITURE_ITEMDATA,n_),this._events.set(h.ITEM_STACK_HELPER,_L),this._events.set(h.FURNITURE_STATE,a_),this._events.set(h.ITEM_DIMMER_SETTINGS,Sc),this._events.set(h.FURNITURE_STATE_2,Zo),this._events.set(h.LOVELOCK_FURNI_FINISHED,uL),this._events.set(h.LOVELOCK_FURNI_FRIEND_COMFIRMED,lL),this._events.set(h.LOVELOCK_FURNI_START,cL),this._events.set(h.OBJECTS_DATA_UPDATE,Qo),this._events.set(h.FURNITURE_GROUP_CONTEXT_MENU_INFO,hL),this._events.set(h.FURNITURE_POSTIT_STICKY_POLE_OPEN,fL),this._events.set(h.ROOM_SPECTATOR,yc),this._events.set(h.CUSTOM_USER_NOTIFICATION,aL),this._events.set(h.ROOM_MESSAGE_NOTIFICATION,mL),this._events.set(h.ROOM_POPULAR_TAGS_RESULT,ly),this._events.set(h.ROOM_RIGHTS_LIST,UL),this._events.set(h.ROOM_RIGHTS_LIST_ADD,yL),this._events.set(h.ROOM_RIGHTS_LIST_REMOVE,LL),this._events.set(h.ROOM_BAN_LIST,PL),this._events.set(h.ROOM_SETTINGS_SAVE_ERROR,BL),this._events.set(h.ROOM_SETTINGS,FL),this._events.set(h.ROOM_SETTINGS_SAVE,GL),this._events.set(h.ROOM_SETTINGS_ERROR,xL),this._events.set(h.SHOW_ENFORCE_ROOM_CATEGORY,wL),this._events.set(h.ROOM_BAN_REMOVE,HL),this._events.set(h.ROOM_MUTED,vL),this._events.set(h.NO_SUCH_FLAT,bL),this._events.set(h.FAVORITE_GROUP_UDPATE,Ac),this._events.set(h.ROOM_MODEL_DOOR,c_),this._events.set(h.ROOM_HEIGHT_MAP,d_),this._events.set(h.ROOM_HEIGHT_MAP_UPDATE,g_),this._events.set(h.ROOM_MODEL,l_),this._events.set(h.ROOM_MODEL_NAME,lr),this._events.set(h.ROOM_PAINT,E_),this._events.set(h.ROOM_THICKNESS,f_),this._events.set(h.ROOM_GET_FILTER_WORDS,gy),this._events.set(h.ROOM_MODEL_BLOCKED_TILES,OL),this._events.set(h.PET_FIGURE_UPDATE,na),this._events.set(h.PET_INFO,Nc),this._events.set(h.PET_STATUS,Dc),this._events.set(h.PET_EXPERIENCE,Cc),this._events.set(h.PLAYING_GAME,Pc),this._events.set(h.UNIT_DANCE,_a),this._events.set(h.UNIT_EFFECT,I_),this._events.set(h.UNIT,ha),this._events.set(h.UNIT_EXPRESSION,R_),this._events.set(h.UNIT_HAND_ITEM,T_),this._events.set(h.UNIT_IDLE,p_),this._events.set(h.UNIT_INFO,ua),this._events.set(h.UNIT_NUMBER,O_),this._events.set(h.UNIT_REMOVE,la),this._events.set(h.UNIT_STATUS,A_),this._events.set(h.HAND_ITEM_RECEIVED,vc),this._events.set(h.FLOOD_CONTROL,Lc),this._events.set(h.REMAINING_MUTE,Uc),this._events.set(h.UNIT_CHAT,ch),this._events.set(h.UNIT_CHAT_SHOUT,aa),this._events.set(h.UNIT_CHAT_WHISPER,oa),this._events.set(h.UNIT_TYPING,m_),this._events.set(h.WIRED_ACTION,AL),this._events.set(h.WIRED_CONDITION,SL),this._events.set(h.WIRED_TRIGGER,ML),this._events.set(h.WIRED_OPEN,CL),this._events.set(h.WIRED_REWARD,dh),this._events.set(h.WIRED_SAVE,NL),this._events.set(h.WIRED_ERROR,DL),this._events.set(h.AUTHENTICATED,bc),this._events.set(h.JUKEBOX_PLAYLIST_FULL,Fc),this._events.set(h.JUKEBOX_SONG_DISKS,xc),this._events.set(h.NOW_PLAYING,Gc),this._events.set(h.OFFICIAL_SONG_ID,VL),this._events.set(h.PLAYLIST,jL),this._events.set(h.PLAYLIST_SONG_ADDED,YL),this._events.set(h.TRAX_SONG_INFO,Bc),this._events.set(h.USER_SONG_DISKS_INVENTORY,wc),this._events.set(h.HELPER_TALENT_TRACK,kL),this._events.set(h.TALENT_TRACK_LEVEL,WL),this._events.set(h.TALENT_TRACK_LEVEL_UP,zL),this._events.set(h.IN_CLIENT_LINK,Kc),this._events.set(h.USER_IGNORED,kc),this._events.set(h.USER_IGNORED_RESULT,Eh),this._events.set(h.USER_RESPECT,Qc),this._events.set(h.USER_PERMISSIONS,Hc),this._events.set(h.USER_BADGES_CURRENT,jc),this._events.set(h.USER_INFO,ca),this._events.set(h.UNIT_CHANGE_NAME,gh),this._events.set(h.USER_SETTINGS,JL),this._events.set(h.USER_PROFILE,QL),this._events.set(h.MESSENGER_RELATIONSHIPS,qL),this._events.set(h.GIFT_OPENED,_c),this._events.set(h.USER_CREDITS,nU),this._events.set(h.USER_CURRENCY,aU),this._events.set(h.USER_SUBSCRIPTION,oU),this._events.set(h.USER_WARDROBE_PAGE,hU),this._events.set(h.USER_CLASSIFICATION,lU),this._events.set(h.GET_USER_TAGS,Yc),this._events.set(h.SCR_SEND_KICKBACK_INFO,_U),this._events.set(h.PET_RESPECTED,Xc),this._events.set(h.PET_SUPPLEMENT,qc),this._events.set(h.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,Vc),this._events.set(h.GENERIC_ERROR,jo),this._events.set(h.GROUP_LIST,iU),this._events.set(h.CATALOG_APPROVE_NAME_RESULT,KL),this._events.set(h.CONNECTION_ERROR,Oy),this._events.set(h.GUILD_EDIT_FAILED,eU),this._events.set(h.GUILD_MEMBER_MGMT_FAILED,sU),this._events.set(h.EXTENDED_PROFILE_CHANGED,ZL),this._events.set(h.NOOBNESS_LEVEL,ic),this._events.set(h.DISCONNECT_REASON,cD),this._events.set(h.HANDSHAKE_INIT_DIFFIE,gD),this._events.set(h.HANDSHAKE_COMPLETE_DIFFIE,lD),this._events.set(h.HANDSHAKE_IDENTITY_ACCOUNT,dD),this._events.set(h.NEW_USER_EXPERIENCE_GIFT_OFFER,Fy),this._events.set(h.NEW_USER_EXPERIENCE_NOT_COMPLETE,Gy),this._events.set(h.PHONE_COLLECTION_STATE,kN),this._events.set(h.PHONE_TRY_NUMBER_RESULT,KN),this._events.set(h.PHONE_TRY_VERIFICATION_CODE_RESULT,XN),this._events.set(h.WELCOME_GIFT_CHANGE_EMAIL_RESULT,uU),this._events.set(h.WELCOME_GIFT_STATUS,IL),this._events.set(h.RENTABLE_SPACE_RENT_OK,gL),this._events.set(h.RENTABLE_SPACE_STATUS,EL),this._events.set(h.RENTABLE_SPACE_RENT_FAILED,dL),this._events.set(h.RECYCLER_STATUS,za),this._events.set(h.RECYCLER_FINISHED,lh),this._events.set(h.EMAIL_STATUS,zc),this._events.set(h.CHANGE_EMAIL_RESULT,XL),this._events.set(h.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,oL)}registerComposers(){this._composers.set(_.AUTHENTICATION,Gb),this._composers.set(_.INTERSTITIAL_SHOWN,dU),this._composers.set(_.GET_INTERSTITIAL,cU),this._composers.set(_.GET_WARDROBE,mU),this._composers.set(_.SAVE_WARDROBE_OUTFIT,IU),this._composers.set(_.CHANGE_USERNAME,EU),this._composers.set(_.CHECK_USERNAME,fU),this._composers.set(_.REQUEST_CAMERA_CONFIGURATION,OU),this._composers.set(_.RENDER_ROOM,da),this._composers.set(_.RENDER_ROOM_THUMBNAIL,S_),this._composers.set(_.PURCHASE_PHOTO,pU),this._composers.set(_.PUBLISH_PHOTO,TU),this._composers.set(_.PHOTO_COMPETITION,RU),this._composers.set(_.OPEN_CAMPAIGN_CALENDAR_DOOR,SU),this._composers.set(_.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,AU),this._composers.set(_.BUILDERS_CLUB_PLACE_ROOM_ITEM,MU),this._composers.set(_.BUILDERS_CLUB_PLACE_WALL_ITEM,CU),this._composers.set(_.BUILDERS_CLUB_QUERY_FURNI_COUNT,NU),this._composers.set(_.GET_CATALOG_INDEX,yU),this._composers.set(_.GET_CATALOG_PAGE,LU),this._composers.set(_.CATALOG_PURCHASE,JU),this._composers.set(_.CATALOG_PURCHASE_GIFT,QU),this._composers.set(_.GET_PRODUCT_OFFER,YU),this._composers.set(_.GET_CLUB_OFFERS,FU),this._composers.set(_.GET_CLUB_GIFT_INFO,bU),this._composers.set(_.CATALOG_REDEEM_VOUCHER,ev),this._composers.set(_.GROUP_MEMBERSHIPS,U1),this._composers.set(_.GET_GIFT_WRAPPING_CONFIG,GU),this._composers.set(_.CATALOG_SELECT_VIP_GIFT,iv),this._composers.set(_.CATALOG_REQUESET_PET_BREEDS,kU),this._composers.set(_.GET_BONUS_RARE_INFO,DU),this._composers.set(_.GET_BUNDLE_DISCOUNT_RULESET,PU),this._composers.set(_.GET_CATALOG_PAGE_EXPIRATION,UU),this._composers.set(_.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,vU),this._composers.set(_.GET_DIRECT_CLUB_BUY_AVAILABLE,xU),this._composers.set(_.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,BU),this._composers.set(_.GET_HABBO_CLUB_EXTEND_OFFER,wU),this._composers.set(_.GET_IS_OFFER_GIFTABLE,HU),this._composers.set(_.GET_LIMITED_OFFER_APPEARING_NEXT,VU),this._composers.set(_.GET_NEXT_TARGETED_OFFER,jU),this._composers.set(_.GET_ROOM_AD_PURCHASE_INFO,zU),this._composers.set(_.GET_SEASONAL_CALENDAR_DAILY_OFFER,WU),this._composers.set(_.GET_TARGETED_OFFER,KU),this._composers.set(_.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,XU),this._composers.set(_.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,qU),this._composers.set(_.PURCHASE_ROOM_AD,ZU),this._composers.set(_.PURCHASE_TARGETED_OFFER,$U),this._composers.set(_.PURCHASE_VIP_MEMBERSHIP_EXTENSION,tv),this._composers.set(_.ROOM_AD_PURCHASE_INITIATED,sv),this._composers.set(_.SET_TARGETTED_OFFER_STATE,rv),this._composers.set(_.SHOP_TARGETED_OFFER_VIEWED,nv),this._composers.set(_.FORWARD_TO_A_COMPETITION_ROOM,av),this._composers.set(_.FORWARD_TO_A_SUBMITTABLE_ROOM,ov),this._composers.set(_.FORWARD_TO_RANDOM_COMPETITION_ROOM,_v),this._composers.set(_.GET_CURRENT_TIMING_CODE,hv),this._composers.set(_.GET_IS_USER_PART_OF_COMPETITION,uv),this._composers.set(_.GET_SECONDS_UNTIL,lv),this._composers.set(_.ROOM_COMPETITION_INIT,cv),this._composers.set(_.SUBMIT_ROOM_TO_COMPETITION,mn),this._composers.set(_.VOTE_FOR_ROOM,dv),this._composers.set(_.CRAFT,gv),this._composers.set(_.CRAFT_SECRET,Ev),this._composers.set(_.GET_CRAFTABLE_PRODUCTS,mv),this._composers.set(_.GET_CRAFTING_RECIPE,fv),this._composers.set(_.GET_CRAFTING_RECIPES_AVAILABLE,Iv),this._composers.set(_.FRIEND_FURNI_CONFIRM_LOCK,Tv),this._composers.set(_.ACCEPT_FRIEND,pv),this._composers.set(_.DECLINE_FRIEND,Ov),this._composers.set(_.FIND_NEW_FRIENDS,Av),this._composers.set(_.FOLLOW_FRIEND,Sv),this._composers.set(_.FRIEND_LIST_UPDATE,Mv),this._composers.set(_.GET_FRIEND_REQUESTS,Cv),this._composers.set(_.HABBO_SEARCH,Nv),this._composers.set(_.MESSENGER_INIT,Dv),this._composers.set(_.REMOVE_FRIEND,Pv),this._composers.set(_.REQUEST_FRIEND,yv),this._composers.set(_.MESSENGER_CHAT,Lv),this._composers.set(_.SEND_ROOM_INVITE,Uv),this._composers.set(_.SET_RELATIONSHIP_STATUS,vv),this._composers.set(_.VISIT_USER,bv),this._composers.set(_.ACHIEVEMENT_RESOLUTION_OPEN,Jc),this._composers.set(_.ACCEPTGAMEINVITE,jv),this._composers.set(_.GAMEUNLOADEDMESSAGE,Yv),this._composers.set(_.GETGAMEACHIEVEMENTSMESSAGE,zv),this._composers.set(_.GAMES_LIST,Wv),this._composers.set(_.GETGAMESTATUSMESSAGE,kv),this._composers.set(_.GETUSERGAMEACHIEVEMENTSMESSAGE,Kv),this._composers.set(_.JOINQUEUEMESSAGE,Xv),this._composers.set(_.LEAVEQUEUEMESSAGE,qv),this._composers.set(_.RESETRESOLUTIONACHIEVEMENTMESSAGE,Qv),this._composers.set(_.GAMES_INIT,$v),this._composers.set(_.GETWEEKLYGAMEREWARDWINNERS,tb),this._composers.set(_.GAME2GETACCOUNTGAMESTATUSMESSAGE,Hv),this._composers.set(_.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,wv),this._composers.set(_.GAME2EXITGAMEMESSAGE,Fv),this._composers.set(_.GAME2GAMECHATMESSAGE,xv),this._composers.set(_.GAME2LOADSTAGEREADYMESSAGE,Gv),this._composers.set(_.GAME2PLAYAGAINMESSAGE,Bv),this._composers.set(_.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,Vv),this._composers.set(_.GAME2GETWEEKLYFRIENDSLEADERBOARD,Jv),this._composers.set(_.GAME2GETWEEKLYLEADERBOARD,Zv),this._composers.set(_.GET_GIFT,Zc),this._composers.set(_.RESET_PHONE_NUMBER_STATE,eb),this._composers.set(_.SET_PHONE_NUMBER_VERIFICATION_STATUS,$c),this._composers.set(_.TRY_PHONE_NUMBER,sb),this._composers.set(_.VERIFY_CODE,ib),this._composers.set(_.GET_FORUM_STATS,Cb),this._composers.set(_.GET_FORUMS_LIST,Mb),this._composers.set(_.GET_FORUM_MESSAGES,Nb),this._composers.set(_.GET_FORUM_THREAD,Db),this._composers.set(_.GET_FORUM_THREADS,Pb),this._composers.set(_.GET_UNREAD_FORUMS_COUNT,yb),this._composers.set(_.FORUM_MODERATE_MESSAGE,Lb),this._composers.set(_.FORUM_MODERATE_THREAD,Ub),this._composers.set(_.FORUM_POST_MESSAGE,vb),this._composers.set(_.UPDATE_FORUM_READ_MARKER,bb),this._composers.set(_.UPDATE_FORUM_SETTINGS,Fb),this._composers.set(_.FORUM_UPDATE_THREAD,xb),this._composers.set(_.CLIENT_PONG,sd),this._composers.set(_.RELEASE_VERSION,td),this._composers.set(_.SECURITY_TICKET,id),this._composers.set(_.USER_INFO,ed),this._composers.set(_.DISCONNECT,wb),this._composers.set(_.SECURITY_MACHINE,Vb),this._composers.set(_.CLIENT_VARIABLES,jb),this._composers.set(_.HANDSHAKE_INIT_DIFFIE,Hb),this._composers.set(_.HANDSHAKE_COMPLETE_DIFFIE,Bb),this._composers.set(_.CALL_FOR_HELP_FROM_FORUM_MESSAGE,Yb),this._composers.set(_.CALL_FOR_HELP_FROM_FORUM_THREAD,zb),this._composers.set(_.CALL_FOR_HELP_FROM_IM,Wb),this._composers.set(_.CALL_FOR_HELP_FROM_PHOTO,kb),this._composers.set(_.CALL_FOR_HELP_FROM_SELFIE,Kb),this._composers.set(_.CALL_FOR_HELP,Xb),this._composers.set(_.CHAT_REVIEW_GUIDE_DECIDES,qb),this._composers.set(_.CHAT_REVIEW_GUIDE_DETACHED,Qb),this._composers.set(_.CHAT_REVIEW_GUIDE_VOTE,Jb),this._composers.set(_.CHAT_REVIEW_SESSION_CREATE,Zb),this._composers.set(_.DELETE_PENDING_CALLS_FOR_HELP,$b),this._composers.set(_.GET_CFH_STATUS,t0),this._composers.set(_.GET_FAQ_CATEGORY,e0),this._composers.set(_.GET_FAQ_TEXT,s0),this._composers.set(_.GET_GUIDE_REPORTING_STATUS,i0),this._composers.set(_.GET_PENDING_CALLS_FOR_HELP,r0),this._composers.set(_.GET_QUIZ_QUESTIONS,n0),this._composers.set(_.GUIDE_SESSION_CREATE,a0),this._composers.set(_.GUIDE_SESSION_FEEDBACK,o0),this._composers.set(_.GUIDE_SESSION_GET_REQUESTER_ROOM,_0),this._composers.set(_.GUIDE_SESSION_GUIDE_DECIDES,h0),this._composers.set(_.GUIDE_SESSION_INVITE_REQUESTER,u0),this._composers.set(_.GUIDE_SESSION_IS_TYPING,l0),this._composers.set(_.GUIDE_SESSION_MESSAGE,c0),this._composers.set(_.GUIDE_SESSION_ON_DUTY_UPDATE,d0),this._composers.set(_.GUIDE_SESSION_REPORT,g0),this._composers.set(_.GUIDE_SESSION_REQUESTER_CANCELS,E0),this._composers.set(_.GUIDE_SESSION_RESOLVED,f0),this._composers.set(_.POST_QUIZ_ANSWERS,m0),this._composers.set(_.SEARCH_FAQS,I0),this._composers.set(_.DESKTOP_VIEW,Rv),this._composers.set(_.GROUP_INFO,db),this._composers.set(_.GROUP_REQUEST,gb),this._composers.set(_.GROUP_MEMBER_REMOVE_CONFIRM,ub),this._composers.set(_.GROUP_MEMBER_REMOVE,Ib),this._composers.set(_.GROUP_MEMBERS,Eb),this._composers.set(_.GROUP_ADMIN_ADD,nb),this._composers.set(_.GROUP_ADMIN_REMOVE,ab),this._composers.set(_.GROUP_REQUEST_ACCEPT,fb),this._composers.set(_.GROUP_REQUEST_DECLINE,mb),this._composers.set(_.GROUP_DELETE,lb),this._composers.set(_.GROUP_CREATE_OPTIONS,hb),this._composers.set(_.GROUP_PARTS,ob),this._composers.set(_.GROUP_BUY,_b),this._composers.set(_.GROUP_SETTINGS,Ab),this._composers.set(_.GROUP_SAVE_BADGE,Rb),this._composers.set(_.GROUP_SAVE_COLORS,Tb),this._composers.set(_.GROUP_SAVE_INFORMATION,pb),this._composers.set(_.GROUP_SAVE_PREFERENCES,Ob),this._composers.set(_.GROUP_FAVORITE,cb),this._composers.set(_.GROUP_UNFAVORITE,Sb),this._composers.set(_.GROUP_BADGES,Og),this._composers.set(_.APPROVE_ALL_MEMBERSHIP_REQUESTS,rb),this._composers.set(_.GROUP_UNBLOCK_MEMBER,k1),this._composers.set(_.ROOM_FAVORITE,IF),this._composers.set(_.CAN_CREATE_ROOM,TF),this._composers.set(_.CANCEL_ROOM_EVENT,RF),this._composers.set(_.CONVERT_GLOBAL_ROOM_ID,OF),this._composers.set(_.COMPETITION_ROOM_SEARCH,pF),this._composers.set(_.ROOM_CREATE,AF),this._composers.set(_.GET_USER_FLAT_CATS,bF),this._composers.set(_.GET_USER_EVENT_CATS,vF),this._composers.set(_.ROOM_FAVORITE_REMOVE,SF),this._composers.set(_.EDIT_ROOM_EVENT,MF),this._composers.set(_.FORWARD_TO_RANDOM_PROMOTED_ROOM,CF),this._composers.set(_.FORWARD_TO_SOME_ROOM,NF),this._composers.set(_.GET_CATEGORIES_WITH_USER_COUNT,DF),this._composers.set(_.GET_GUEST_ROOM,yF),this._composers.set(_.GET_OFFICIAL_ROOMS,LF),this._composers.set(_.GET_POPULAR_ROOM_TAGS,UF),this._composers.set(_.GUILD_BASE_SEARCH,FF),this._composers.set(_.MY_FAVOURITE_ROOMS_SEARCH,xF),this._composers.set(_.MY_FREQUENT_ROOM_HISTORY_SEARCH,GF),this._composers.set(_.MY_FRIENDS_ROOM_SEARCH,BF),this._composers.set(_.MY_GUILD_BASES_SEARCH,wF),this._composers.set(_.MY_RECOMMENDED_ROOMS,HF),this._composers.set(_.MY_ROOM_HISTORY_SEARCH,VF),this._composers.set(_.MY_ROOM_RIGHTS_SEARCH,jF),this._composers.set(_.MY_ROOMS_SEARCH,YF),this._composers.set(_.POPULAR_ROOMS_SEARCH,ZF),this._composers.set(_.ROOM_LIKE,$F),this._composers.set(_.ROOM_RIGHTS_REMOVE_OWN,tx),this._composers.set(_.ROOM_AD_EVENT_TAB_CLICKED,ex),this._composers.set(_.ROOM_AD_EVENT_TAB_VIEWED,sx),this._composers.set(_.ROOM_AD_SEARCH,ix),this._composers.set(_.ROOM_TEXT_SEARCH,ax),this._composers.set(_.ROOMS_WHERE_MY_FRIENDS_ARE,rx),this._composers.set(_.ROOMS_WITH_HIGHEST_SCORE_SEARCH,nx),this._composers.set(_.SET_ROOM_SESSION_TAGS,ox),this._composers.set(_.ROOM_STAFF_PICK,_x),this._composers.set(_.ROOM_FILTER_WORDS,PF),this._composers.set(_.ROOM_FILTER_WORDS_MODIFY,ux),this._composers.set(_.USER_HOME_ROOM,hx),this._composers.set(_.UPDATE_ROOM_THUMBNAIL,lx),this._composers.set(_.NAVIGATOR_INIT,kF),this._composers.set(_.NAVIGATOR_SEARCH_CLOSE,KF),this._composers.set(_.NAVIGATOR_SEARCH,XF),this._composers.set(_.NAVIGATOR_SEARCH_OPEN,qF),this._composers.set(_.NAVIGATOR_SEARCH_SAVE,QF),this._composers.set(_.NAVIGATOR_SETTINGS_SAVE,JF),this._composers.set(_.NAVIGATOR_CATEGORY_LIST_MODE,zF),this._composers.set(_.NAVIGATOR_DELETE_SAVED_SEARCH,WF),this._composers.set(_.POLL_ANSWER,dd),this._composers.set(_.POLL_REJECT,gd),this._composers.set(_.POLL_START,Ed),this._composers.set(_.USER_EFFECT_ACTIVATE,R0),this._composers.set(_.USER_EFFECT_ENABLE,T0),this._composers.set(_.USER_BADGES,S0),this._composers.set(_.USER_BADGES_CURRENT_UPDATE,M0),this._composers.set(_.GET_BADGE_POINTS_LIMITS,p0),this._composers.set(_.REQUESTABADGE,A0),this._composers.set(_.GETISBADGEREQUESTFULFILLED,O0),this._composers.set(_.USER_BOTS,Qh),this._composers.set(_.USER_FURNITURE,C0),this._composers.set(_.REQUESTFURNIINVENTORYWHENNOTINROOM,N0),this._composers.set(_.USER_PETS,Jh),this._composers.set(_.TRADE_ACCEPT,y0),this._composers.set(_.TRADE_CANCEL,L0),this._composers.set(_.TRADE_CLOSE,U0),this._composers.set(_.TRADE_CONFIRM,v0),this._composers.set(_.TRADE_ITEM,b0),this._composers.set(_.TRADE_ITEMS,F0),this._composers.set(_.TRADE_ITEM_REMOVE,x0),this._composers.set(_.TRADE,G0),this._composers.set(_.TRADE_UNACCEPT,B0),this._composers.set(_.UNSEEN_RESET_CATEGORY,w0),this._composers.set(_.UNSEEN_RESET_ITEMS,H0),this._composers.set(_.ACHIEVEMENT_LIST,gU),this._composers.set(_.PET_MOUNT,M_),this._composers.set(_.PET_RESPECT,od),this._composers.set(_.PET_SUPPLEMENT,dx),this._composers.set(_.REMOVE_PET_SADDLE,_d),this._composers.set(_.PET_INFO,hd),this._composers.set(_.TOGGLE_PET_BREEDING,ud),this._composers.set(_.TOGGLE_PET_RIDING,ld),this._composers.set(_.USE_PET_PRODUCT,cd),this._composers.set(_.GET_PET_TRAINING_PANEL,ad),this._composers.set(_.PET_OPEN_PACKAGE,Qd),this._composers.set(_.PET_SELECTED,d1),this._composers.set(_.PETS_BREED,ka),this._composers.set(_.PET_CANCEL_BREEDING,D0),this._composers.set(_.PET_CONFIRM_BREEDING,P0),this._composers.set(_.ROOM_ENTER,md),this._composers.set(_.ROOM_DOORBELL,fd),this._composers.set(_.GO_TO_FLAT,tg),this._composers.set(_.CHANGE_QUEUE,$d),this._composers.set(_.ROOM_AMBASSADOR_ALERT,Id),this._composers.set(_.ROOM_BAN_GIVE,Rd),this._composers.set(_.ROOM_BAN_REMOVE,bx),this._composers.set(_.ROOM_RIGHTS_GIVE,Td),this._composers.set(_.ROOM_KICK,pd),this._composers.set(_.ROOM_MUTE_USER,Od),this._composers.set(_.ROOM_RIGHTS_REMOVE,Ad),this._composers.set(_.ROOM_RIGHTS_REMOVE_ALL,Ux),this._composers.set(_.ROOM_DELETE,vx),this._composers.set(_.ROOM_SETTINGS,Gx),this._composers.set(_.ROOM_SETTINGS_SAVE,wx),this._composers.set(_.ROOM_RIGHTS_LIST,Bx),this._composers.set(_.ROOM_BAN_LIST,xx),this._composers.set(_.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,p1),this._composers.set(_.BOT_CONFIGURATION,Fx),this._composers.set(_.GET_ITEM_DATA,Dd),this._composers.set(_.REMOVE_WALL_ITEM,Ud),this._composers.set(_.BOT_PLACE,Sd),this._composers.set(_.BOT_PICKUP,Md),this._composers.set(_.BOT_SKILL_SAVE,Hx),this._composers.set(_.PET_PLACE,yd),this._composers.set(_.PET_MOVE,C_),this._composers.set(_.PET_PICKUP,Ld),this._composers.set(_.SET_ITEM_DATA,bd),this._composers.set(_.SET_OBJECT_DATA,Fd),this._composers.set(_.COMPOST_PLANT,Nd),this._composers.set(_.HARVEST_PET,Pd),this._composers.set(_.SET_CLOTHING_CHANGE_DATA,vd),this._composers.set(_.FURNITURE_ALIASES,wd),this._composers.set(_.FURNITURE_GROUP_INFO,Hd),this._composers.set(_.FURNITURE_PICKUP,Vd),this._composers.set(_.FURNITURE_PLACE,jd),this._composers.set(_.ITEM_PAINT,zx),this._composers.set(_.FURNITURE_POSTIT_PLACE,Yd),this._composers.set(_.FURNITURE_POSTIT_SAVE_STICKY_POLE,Vx),this._composers.set(_.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,s1),this._composers.set(_.GET_YOUTUBE_DISPLAY_STATUS,i1),this._composers.set(_.SET_YOUTUBE_DISPLAY_PLAYLIST,r1),this._composers.set(_.FURNITURE_FLOOR_UPDATE,N_),this._composers.set(_.FURNITURE_WALL_UPDATE,Zd),this._composers.set(_.ITEM_DIMMER_SETTINGS,xd),this._composers.set(_.ITEM_DIMMER_SAVE,Gd),this._composers.set(_.ITEM_DIMMER_TOGGLE,Bd),this._composers.set(_.ROOM_TONER_APPLY,e1),this._composers.set(_.ITEM_COLOR_WHEEL_CLICK,zd),this._composers.set(_.ITEM_DICE_CLICK,Wd),this._composers.set(_.ITEM_DICE_CLOSE,kd),this._composers.set(_.FURNITURE_MULTISTATE,fh),this._composers.set(_.FURNITURE_RANDOMSTATE,Xd),this._composers.set(_.ITEM_STACK_HELPER,Kx),this._composers.set(_.FURNITURE_WALL_MULTISTATE,qd),this._composers.set(_.ONE_WAY_DOOR_CLICK,Kd),this._composers.set(_.ITEM_EXCHANGE_REDEEM,kx),this._composers.set(_.ITEM_CLOTHING_REDEEM,_1),this._composers.set(_.ROOM_MODEL,D_),this._composers.set(_.GET_OCCUPIED_TILES,n1),this._composers.set(_.GET_ROOM_ENTRY_TILE,a1),this._composers.set(_.ROOM_MODEL_SAVE,o1),this._composers.set(_.UNIT_ACTION,ng),this._composers.set(_.UNIT_DANCE,ag),this._composers.set(_.UNIT_DROP_HAND_ITEM,u1),this._composers.set(_.UNIT_GIVE_HANDITEM,l1),this._composers.set(_.UNIT_GIVE_HANDITEM_PET,c1),this._composers.set(_.UNIT_LOOK,og),this._composers.set(_.UNIT_SIGN,hg),this._composers.set(_.UNIT_POSTURE,_g),this._composers.set(_.UNIT_WALK,ug),this._composers.set(_.UNIT_CHAT,mh),this._composers.set(_.UNIT_CHAT_SHOUT,eg),this._composers.set(_.USER_SETTINGS_CHAT_STYLE,h1),this._composers.set(_.UNIT_CHAT_WHISPER,sg),this._composers.set(_.UNIT_TYPING,ig),this._composers.set(_.UNIT_TYPING_STOP,rg),this._composers.set(_.WIRED_APPLY_SNAPSHOT,E1),this._composers.set(_.WIRED_OPEN,f1),this._composers.set(_.WIRED_ACTION_SAVE,I1),this._composers.set(_.WIRED_CONDITION_SAVE,R1),this._composers.set(_.WIRED_TRIGGER_SAVE,T1),this._composers.set(_.ROOM_MUTE,m1),this._composers.set(_.APPROVE_NAME,L1),this._composers.set(_.USER_RESPECT,Ag),this._composers.set(_.SCR_GET_KICKBACK_INFO,V1),this._composers.set(_.PEER_USERS_CLASSIFICATION,Sg),this._composers.set(_.USER_CLASSIFICATION,Mg),this._composers.set(_.USER_IGNORED,Eg),this._composers.set(_.USER_IGNORE,mg),this._composers.set(_.USER_IGNORE_ID,Ig),this._composers.set(_.USER_UNIGNORE,Rg),this._composers.set(_.USER_BADGES_CURRENT,Tg),this._composers.set(_.USER_FIGURE,F1),this._composers.set(_.USER_MOTTO,pg),this._composers.set(_.USER_PROFILE,x1),this._composers.set(_.USER_PROFILE_BY_NAME,b1),this._composers.set(_.USER_TAGS,fg),this._composers.set(_.MESSENGER_RELATIONSHIPS,G1),this._composers.set(_.MANNEQUIN_SAVE_NAME,qx),this._composers.set(_.MANNEQUIN_SAVE_LOOK,Xx),this._composers.set(_.PRESENT_OPEN_PRESENT,Jd),this._composers.set(_.MARKETPLACE_CONFIG,K0),this._composers.set(_.MARKETPLACE_SELL_ITEM,J0),this._composers.set(_.MARKETPLACE_REQUEST_OWN_ITEMS,Q0),this._composers.set(_.MARKETPLACE_TAKE_BACK_ITEM,W0),this._composers.set(_.MARKETPLACE_REQUEST_OFFERS,q0),this._composers.set(_.MARKETPLACE_BUY_OFFER,Y0),this._composers.set(_.MARKETPLACE_REDEEM_CREDITS,Z0),this._composers.set(_.MARKETPLACE_BUY_TOKENS,z0),this._composers.set(_.REQUEST_SELL_ITEM,k0),this._composers.set(_.REQUEST_MARKETPLACE_ITEM_STATS,X0),this._composers.set(_.USER_BOTS,Qh),this._composers.set(_.USER_PETS,Jh),this._composers.set(_.USER_CURRENCY,w1),this._composers.set(_.USER_SUBSCRIPTION,H1),this._composers.set(_.MODTOOL_REQUEST_ROOM_INFO,sF),this._composers.set(_.MODTOOL_CHANGE_ROOM_SETTINGS,_F),this._composers.set(_.MODTOOL_REQUEST_USER_CHATLOG,aF),this._composers.set(_.MODTOOL_REQUEST_ROOM_CHATLOG,rF),this._composers.set(_.MOD_TOOL_USER_INFO,iF),this._composers.set(_.MODTOOL_SANCTION_ALERT,oF),this._composers.set(_.MODTOOL_SANCTION_BAN,li),this._composers.set(_.MODTOOL_SANCTION_KICK,hF),this._composers.set(_.MODTOOL_SANCTION_TRADELOCK,gF),this._composers.set(_.MODTOOL_ALERTEVENT,uF),this._composers.set(_.MODTOOL_SANCTION_MUTE,lF),this._composers.set(_.MODTOOL_REQUEST_USER_ROOMS,nF),this._composers.set(_.MODTOOL_ROOM_ALERT,In),this._composers.set(_.CLOSE_ISSUE_DEFAULT_ACTION,$0),this._composers.set(_.CLOSE_ISSUES,Wa),this._composers.set(_.DEFAULT_SANCTION,tF),this._composers.set(_.GET_CFH_CHATLOG,eF),this._composers.set(_.MODTOOL_PREFERENCES,cF),this._composers.set(_.MODTOOL_SANCTION,dF),this._composers.set(_.PICK_ISSUES,EF),this._composers.set(_.RELEASE_ISSUES,fF),this._composers.set(_.MYSTERYBOXWAITINGCANCELEDMESSAGE,mF),this._composers.set(_.MYSTERYBOX_OPEN_TROPHY,Qx),this._composers.set(_.USER_SETTINGS_CAMERA,j1),this._composers.set(_.USER_SETTINGS_OLD_CHAT,Y1),this._composers.set(_.USER_SETTINGS_INVITES,z1),this._composers.set(_.USER_SETTINGS_VOLUME,W1),this._composers.set(_.COMMUNITY_GOAL_VOTE_COMPOSER,j0),this._composers.set(_.GET_PROMO_ARTICLES,V0),this._composers.set(_.ACCEPT_QUEST,gx),this._composers.set(_.ACTIVATE_QUEST,Ex),this._composers.set(_.CANCEL_QUEST,fx),this._composers.set(_.FRIEND_REQUEST_QUEST_COMPLETE,mx),this._composers.set(_.GET_COMMUNITY_GOAL_EARNED_PRIZES,Ix),this._composers.set(_.GET_COMMUNITY_GOAL_HALL_OF_FAME,Rx),this._composers.set(_.GET_COMMUNITY_GOAL_PROGRESS,Tx),this._composers.set(_.GET_CONCURRENT_USERS_GOAL_PROGRESS,px),this._composers.set(_.GET_CONCURRENT_USERS_REWARD,Ox),this._composers.set(_.GET_DAILY_QUEST,Ax),this._composers.set(_.GET_QUESTS,Sx),this._composers.set(_.GET_SEASONAL_QUESTS_ONLY,Mx),this._composers.set(_.OPEN_QUEST_TRACKER,Cx),this._composers.set(_.REDEEM_COMMUNITY_GOAL_PRIZE,Nx),this._composers.set(_.REJECT_QUEST,Dx),this._composers.set(_.START_CAMPAIGN,Px),this._composers.set(_.GET_SOUND_SETTINGS,M1),this._composers.set(_.ADD_JUKEBOX_DISK,O1),this._composers.set(_.GET_JUKEBOX_PLAYLIST,lg),this._composers.set(_.GET_NOW_PLAYING,cg),this._composers.set(_.GET_OFFICIAL_SONG_ID,A1),this._composers.set(_.GET_SONG_INFO,dg),this._composers.set(_.GET_SOUND_MACHINE_PLAYLIST,S1),this._composers.set(_.GET_USER_SONG_DISKS,gg),this._composers.set(_.REMOVE_JUKEBOX_DISK,C1),this._composers.set(_.HELPER_TALENT_TRACK,D1),this._composers.set(_.TALENT_TRACK_GET_LEVEL,N1),this._composers.set(_.NEW_USER_EXPERIENCE_GET_GIFTS,cx),this._composers.set(_.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,nd),this._composers.set(_.WELCOME_OPEN_GIFT,Jx),this._composers.set(_.WELCOME_GIFT_CHANGE_EMAIL,K1),this._composers.set(_.EMAIL_GET_STATUS,B1),this._composers.set(_.EMAIL_CHANGE,v1),this._composers.set(_.RENTABLE_SPACE_CANCEL_RENT,Zx),this._composers.set(_.RENTABLE_SPACE_RENT,$x),this._composers.set(_.RENTABLE_SPACE_STATUS,t1),this._composers.set(_.RECYCLER_STATUS,yx),this._composers.set(_.RECYCLER_ITEMS,Lx),this._composers.set(_.TRACKING_PERFORMANCE_LOG,y1),this._composers.set(_.TRACKING_LAG_WARNING_REPORT,P1),this._composers.set(_.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,g1),this._composers.set(_.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,Yx),this._composers.set(_.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,jx),this._composers.set(_.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,Wx)}get events(){return this._events}get composers(){return this._composers}}class Q1 extends as{constructor(t){super(),this._communication=t,this._connection=null,this._messages=new q1,this._demo=new X1(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(B.instance.events.addEventListener(Jt.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(jt.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(jt.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(jt.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(W.getValue("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(jt.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(jt.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(jt.CONNECTION_ERROR,this.onConnectionErrorEvent)),B.instance.events.removeEventListener(Jt.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(t){G.log("Connection Initialized")}onConnectionClosedEvent(t){G.log("Connection Closed")}onConnectionErrorEvent(t){G.log("Connection Error")}onConnectionAuthenticatedEvent(t){G.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(t){G.log("Initializing Connection",t)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get demo(){return this._demo}get connection(){return this._connection}}const zn=class{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",e=>{if(typeof e.data=="string"&&e.data.startsWith(zn.MESSAGE_KEY)){const{method:t,params:s}=JSON.parse(e.data.substr(zn.MESSAGE_KEY.length)),i=window[t];if(!i)return;i(...s);return}})),!0}static call(e,...t){if(window.top!==window&&window.top.postMessage(zn.MESSAGE_KEY+JSON.stringify({method:e,params:t}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[e];return typeof s<"u"?s(...t):void 0}static callGame(e,...t){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:e,params:t}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[e];return typeof s<"u"?s(...t):void 0}static addCallback(e,t){window[e]=t}};let st=zn;st.MESSAGE_KEY="Nitro_LegacyExternalInterface";st._isListeningForPostMessages=!1;class J1{constructor(t){t.addMessageEvent(new ec(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(t){if(!t)return;const s=t.getParser();s&&st.callGame("showGame",s.url)}}class ho{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const s=this._badgeId.substr(t+1,this._badgeId.length);s&&s!==""&&(this._level=Number.parseInt(s))}isNumber(t){const s=t.charCodeAt(0);return s>=48&&s<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class Z1 extends as{constructor(t){super(),this._communication=t,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new oc(this.onBadgePointLimitsEvent.bind(this)));let t=W.getValue("external.texts.url");Array.isArray(t)||(t=[W.getValue("external.texts.url")]);for(let s=0;s<t.length;s++)t[s]=W.interpolate(t[s]);this._pendingUrls=t,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new er(er.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(t){fetch(t).then(s=>s.json()).then(s=>this.onLocalizationLoaded(s,t)).catch(s=>this.onLocalizationFailed(s))}onLocalizationLoaded(t,s){if(!t)return;if(!this.parseLocalization(t))throw new Error(`Invalid json data for file ${s}`);const i=this._pendingUrls.indexOf(s);i>=0&&this._pendingUrls.splice(i,1),this.loadNextLocalization()}onLocalizationFailed(t){this.events&&this.events.dispatchEvent(new er(er.FAILED))}parseLocalization(t){if(!t)return!1;for(const s in t)this._definitions.set(s,t[s]);return!0}onBadgePointLimitsEvent(t){const s=t.getParser();for(const i of s.data)this.setBadgePointLimit(i.badgeId,i.limit)}getBadgePointLimit(t){return this._badgePointLimits.get(t)||-1}setBadgePointLimit(t,s){this._badgePointLimits.set(t,s)}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getPreviousLevelBadgeId(t){const s=new ho(t);return s.level--,s.getBadgeId}hasValue(t){return this._definitions.has(t)}getValue(t,s=!0){if(!t||!t.length)return null;const i=t.match(/\$\{.[^}]*\}/g);if(i&&i.length)for(const n of i)t=t.replace(n,this.getValue(n.slice(2,-1),s));let r=this._definitions.get(t)||null;if(!r&&(r=W.definitions.get(t),r))return r;if(r&&s){const n=this._parameters.get(t);if(n)for(const[a,o]of n)r=r.replace("%"+a+"%",o)}return r||t}getValueWithParameter(t,s,i){const r=this.getValue(t,!1),n=r.replace("%"+s+"%",i);if(r.startsWith("%{")){const a=new RegExp("%{"+s.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),o=r.match(a);if(!o)return n;let u=-1;switch(Number.parseInt(i)){case 0:u=1;break;case 1:u=2;break;default:case 2:u=3;break}if(u==-1||typeof o[u]>"u")return n;const c=o[u];if(c)return c.replace("%%",i)}return n}getValueWithParameters(t,s,i){let r=this.getValue(t,!1);if(s)for(let n=0;n<s.length;n++){const a=s[n],o=i[n];if(o!==void 0&&(r=r.replace("%"+a+"%",o),r.startsWith("%{"))){const u=new RegExp("%{"+a.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=r.match(u);if(!l)continue;const c=parseInt(o);let g=-1;switch(c){case 0:g=1;break;case 1:g=2;break;case 2:default:g=3;break}if(g===-1||typeof l[g]>"u")continue;const f=l[g];f&&(r=f.replace("%%",o))}}return r}setValue(t,s){this._definitions.set(t,s)}registerParameter(t,s,i){if(!t||t.length===0||!s||s.length===0)return;let r=this._parameters.get(t);r||(r=new Map,this._parameters.set(t,r)),r.set(s,i)}getBadgeName(t){const s=new ho(t),i=["badge_name_"+t,"badge_name_"+s.base];let r=this.fixBadLocalization(this.getExistingKey(i));return r=r.replace("%roman%",this.getRomanNumeral(s.level)),r}getBadgeDesc(t){const s=new ho(t),i=["badge_desc_"+t,"badge_desc_"+s.base];let r=this.fixBadLocalization(this.getExistingKey(i));const n=this.getBadgePointLimit(t);return n>-1&&(r=r.replace("%limit%",n.toString())),r=r.replace("%roman%",this.getRomanNumeral(s.level)),r}getExistingKey(t){for(const s of t){const i=this.getValue(s);if(i!=s)return i}return""}fixBadLocalization(t){return t.replace("${","$").replace("{","$").replace("}","$")}}UE.add(vE,bE,FE,xE,GE,BE,wE);class Zh{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?Ot.generateImage(this.data):null}}class ae extends Bt{constructor(t){super(null,null),this._type=t}get type(){return this._type}}ae.IMAGE_LOADED="ROAUM_IMAGE_LOADED";ae.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";class Ft extends Bt{constructor(){super(null,null)}}class Cg extends Ft{constructor(t,s){super(),this._itemType=t,this._itemName=s}get itemType(){return this._itemType}get itemName(){return this._itemName}}class Ih extends Ft{constructor(t=0){super(),this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class Ng extends Ft{constructor(t=0){super(),this._danceStyle=t}get danceStyle(){return this._danceStyle}}class Dg extends Ft{constructor(t,s=0){super(),this._effect=t,this._delayMilliseconds=s}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class Pg extends Ft{constructor(t){super(),this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class yg extends Ft{constructor(t=0){super(),this._expressionType=t}get expressionType(){return this._expressionType}}class ga extends Ft{constructor(t,s=null,i=null,r=!1){super(),this._figure=t,this._gender=s,this._subType=i,this._isRiding=r}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class Lg extends Ft{constructor(t=0){super(),this._level=t}get level(){return this._level}}class Ug extends Ft{constructor(t=0){super(),this._gesture=t}get gesture(){return this._gesture}}class $1 extends Ft{constructor(t){super(),this._guideStatus=t}get guideStatus(){return this._guideStatus}}class vg extends Ft{constructor(t=!1){super(),this._isMuted=t}get isMuted(){return this._isMuted}}class bg extends Ft{}class Fg extends Ft{constructor(t){super(),this._gesture=t}get gesture(){return this._gesture}}class xg extends Ft{constructor(t){super(),this._value=t}get value(){return this._value}}class Gg extends Ft{constructor(t){super(),this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class Rh extends Ft{constructor(t,s=""){super(),this._postureType=t,this._parameter=s}get postureType(){return this._postureType}get parameter(){return this._parameter}}class Ea extends Ft{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class Bg extends Ft{constructor(t=0){super(),this._signType=t}get signType(){return this._signType}}class Th extends Ft{constructor(t=!1){super(),this._isSleeping=t}get isSleeping(){return this._isSleeping}}class wg extends Ft{constructor(t=!1){super(),this._isTyping=t}get isTyping(){return this._isTyping}}class ii extends Bt{constructor(t,s,i,r=!1){super(t,i),this._targetLocation=s,this._isSlide=r}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class fa extends ii{constructor(t,s,i,r,n,a){super(t,s,i),this._headDirection=r,this._canStandUp=n,this._baseY=a}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class Hg extends Ft{constructor(t){super(),this._itemType=t}get itemType(){return this._itemType}}class Et extends Bt{constructor(t,s,i=null){super(null,null),this._state=t,this._data=s,this._extra=i}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}class cr extends Bt{constructor(t,s){super(null,null),this._badgeId=t,this._assetName=s}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}cr.BADGE_LOADED="ROGBUM_BADGE_LOADED";class Vg extends Bt{constructor(t,s,i){super(t,s),this._height=i}get height(){return this._height}}class ph extends Bt{constructor(t){super(null,null),this._data=t}get data(){return this._data}}class jg extends Bt{constructor(t,s){super(null,null),this._numberKey=t,this._numberValue=s}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}class ma extends Bt{constructor(t,s,i,r){super(null,null),this._type=t,this._color=s,this._light=i,this._backgroundOnly=r}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}ma.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";class Ns extends Bt{constructor(t,s,i=0,r=0,n=0,a=0){super(null,null),this._type=t,this._id=s,this._x=i,this._y=r,this._width=n,this._height=a}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}Ns.ADD="ORPFHUM_ADD";Ns.REMOVE="ORPFHUM_REMOVE";const Yg=class extends Bt{constructor(e){super(null,null),this._type=Yg.UPDATE_MAP,this._mapData=e}get type(){return this._type}get mapData(){return this._mapData}};let Oh=Yg;Oh.UPDATE_MAP="RORMUM_UPDATE_MAP";class Wt extends Bt{constructor(t,s,i=null,r=null,n="window"){super(null,null),this._type=t,this._maskId=s,this._maskType=i,this._maskLocation=r?new I(r.x,r.y,r.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}Wt.ADD_MASK="RORMUM_ADD_MASK";Wt.REMOVE_MASK="RORMUM_ADD_MASK";Wt.DOOR="door";Wt.WINDOW="window";Wt.HOLE="hole";class Ds extends Bt{constructor(t,s){super(null,null),this._type=t,this._value=s}get type(){return this._type}get value(){return this._value}}Ds.WALL_THICKNESS="RORPPUM_WALL_THICKNESS";Ds.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";class Ps extends Bt{constructor(t,s){super(null,null),this._type=t,this._visible=s}get type(){return this._type}get visible(){return this._visible}}Ps.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY";Ps.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";class zt extends Bt{constructor(t,s){super(null,null),this._type=t,this._value=s}get type(){return this._type}get value(){return this._value}}zt.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE";zt.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE";zt.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";class $r extends Ft{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class Wi extends Bt{constructor(t,s,i,r,n=!1){super(t,null),this._height=s,this._visible=i,this._sourceEventId=r,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}class ys extends Bt{constructor(t){super(null,null),this._type=t}get type(){return this._type}}ys.ENABLED="ROVUM_ENABLED";ys.DISABLED="ROVUM_DISABLED";const P_=class extends ya{constructor(){super(),this._liftAmount=0,this._location=new I,this._locationDelta=new I,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=P_.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,super.onDispose()}update(e){super.update(e);const t=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(t?this._liftAmount!==t.z&&(this._liftAmount=t.z,s.setValue(d.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,s.setValue(d.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||t){const i=P_.TEMP_VECTOR;let r=this.time-this._changeTime;r===this._updateInterval>>1&&r++,r>this._updateInterval&&(r=this._updateInterval),this._locationDelta.length>0?(i.assign(this._locationDelta),i.multiply(r/this._updateInterval),i.add(this._location)):i.assign(this._location),t&&i.add(t),this.object.setLocation(i),r===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(e){super.setObject(e),e&&this._location.assign(e.getLocation())}processUpdateMessage(e){if(e&&(super.processUpdateMessage(e),e.location&&this._location.assign(e.location),e instanceof ii))return this.processMoveMessage(e)}processMoveMessage(e){!e||!this.object||!e.location||(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(e.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(e){e<=0&&(e=1),this._updateInterval=e}};let ri=P_;ri.DEFAULT_UPDATE_INTERVAL=500;ri.TEMP_VECTOR=new I;const ne=class extends ri{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=Z()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const e=[V.CLICK,V.DOUBLE_CLICK,se.POSITION_CHANGED,V.MOUSE_ENTER,V.MOUSE_LEAVE,L.MOUSE_BUTTON,L.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),e)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new se(se.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(e){if(super.update(e),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new I),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new se(se.POSITION_CHANGED,this.object)))}const t=this.object&&this.object.model;t&&this.updateModel(this.time,t)}updateModel(e,t){this._talkingEndTimestamp>0&&(e>this._talkingEndTimestamp?(t.setValue(d.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=e+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&e>this._talkingPauseStartTimestamp?(t.setValue(d.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&e>this._talkingPauseEndTimestamp&&(t.setValue(d.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&e>this._animationEndTimestamp&&(t.setValue(d.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&e>this._gestureEndTimestamp&&(t.setValue(d.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&e>this._signEndTimestamp&&(t.setValue(d.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&e>this._carryObjectEndTimestamp&&(t.setValue(d.FIGURE_CARRY_OBJECT,0),t.setValue(d.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&e-this._carryObjectStartTimestamp>5e3&&((e-this._carryObjectStartTimestamp)%1e4<1e3?t.setValue(d.FIGURE_USE_OBJECT,1):t.setValue(d.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&e>this._blinkingStartTimestamp&&(t.setValue(d.FIGURE_BLINK,1),this._blinkingStartTimestamp=e+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=e+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&e>this._blinkingEndTimestamp&&(t.setValue(d.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&e>this._effectChangeTimeStamp&&(t.setValue(d.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&e>this._numberValueEndTimestamp&&(t.setValue(d.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const t=this.object&&this.object.model;if(t){if(e instanceof Rh){t.setValue(d.FIGURE_POSTURE,e.postureType),t.setValue(d.FIGURE_POSTURE_PARAMETER,e.parameter);return}if(e instanceof Ih){t.setValue(d.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+e.numberOfWords*1e3;return}if(e instanceof wg){t.setValue(d.FIGURE_IS_TYPING,e.isTyping?1:0);return}if(e instanceof vg){t.setValue(d.FIGURE_IS_MUTED,e.isMuted?1:0);return}if(e instanceof Gg){t.setValue(d.FIGURE_IS_PLAYING_GAME,e.isPlayingGame?1:0);return}if(e instanceof fa){t.setValue(d.HEAD_DIRECTION,e.headDirection),t.setValue(d.FIGURE_CAN_STAND_UP,e.canStandUp),t.setValue(d.FIGURE_VERTICAL_OFFSET,e.baseY);return}if(e instanceof Ug){t.setValue(d.FIGURE_GESTURE,e.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(e instanceof yg){t.setValue(d.FIGURE_EXPRESSION,e.expressionType),this._animationEndTimestamp=P.getExpressionTimeout(t.getValue(d.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(e instanceof Ng){t.setValue(d.FIGURE_DANCE,e.danceStyle);return}if(e instanceof Th){t.setValue(d.FIGURE_SLEEP,e.isSleeping?1:0),e.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(e instanceof xg){t.setValue(d.FIGURE_NUMBER_VALUE,e.value),this._numberValueEndTimestamp=this.time+3e3;return}if(e instanceof Dg){this.updateAvatarEffect(e.effect,e.delayMilliseconds,t);return}if(e instanceof Cg){t.setValue(d.FIGURE_CARRY_OBJECT,e.itemType),t.setValue(d.FIGURE_USE_OBJECT,0),e.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,e.itemType<ne.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=e.itemType<=ne.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(e instanceof Hg){t.setValue(d.FIGURE_USE_OBJECT,e.itemType);return}if(e instanceof Bg){t.setValue(d.FIGURE_SIGN,e.signType),this._signEndTimestamp=this.time+5e3;return}if(e instanceof Lg){t.setValue(d.FIGURE_FLAT_CONTROL,e.level);return}if(e instanceof ga){t.setValue(d.FIGURE,e.figure),t.setValue(d.GENDER,e.gender);return}if(e instanceof Ea){this._selected=e.selected,this._reportedLocation=null;return}if(e instanceof bg){t.setValue(d.OWN_USER,1);return}}}updateAvatarEffect(e,t,s){if(e===ne.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=Z()+ne.EFFECT_SPLASH_LENGTH,this._newEffect=ne.EFFECT_TYPE_SWIM;else if(e===ne.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=Z()+ne.EFFECT_SPLASH_LENGTH,this._newEffect=ne.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(d.FIGURE_EFFECT)===ne.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=Z()+ne.EFFECT_SPLASH_LENGTH,this._newEffect=e,e=ne.EFFECT_TYPE_SPLASH;else if(s.getValue(d.FIGURE_EFFECT)===ne.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=Z()+ne.EFFECT_SPLASH_LENGTH,this._newEffect=e,e=ne.EFFECT_TYPE_SPLASH_DARK;else if(t===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=Z()+t,this._newEffect=e;return}s.setValue(d.FIGURE_EFFECT,e)}mouseEvent(e,t){let s=null;switch(e.type){case F.MOUSE_CLICK:s=V.CLICK;break;case F.DOUBLE_CLICK:s=V.DOUBLE_CLICK;break;case F.ROLL_OVER:s=V.MOUSE_ENTER,this.object.model&&this.object.model.setValue(d.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new L(L.MOUSE_BUTTON,this.object));break;case F.ROLL_OUT:s=V.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(d.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new L(L.MOUSE_ARROW,this.object));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new V(s,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};let ci=ne;ci.MAX_HAND_ID=999999999;ci.MAX_HAND_USE_ID=999;ci.EFFECT_TYPE_SPLASH=28;ci.EFFECT_SPLASH_LENGTH=500;ci.EFFECT_TYPE_SWIM=29;ci.EFFECT_TYPE_SPLASH_DARK=184;ci.EFFECT_TYPE_SWIM_DARK=185;const xe=class extends ri{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new I,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,xe.BOUNCING_STEPS===-1&&(xe.BOUNCING_STEPS=W.getValue("furni.rotation.bounce.steps",8)),xe.BOUNCING_Z===-1&&(xe.BOUNCING_Z=W.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const e=[rt.STATE_CHANGE,V.CLICK,V.MOUSE_DOWN,V.MOUSE_DOWN_LONG,It.ROOM_AD_TOOLTIP_SHOW,It.ROOM_AD_TOOLTIP_HIDE,It.ROOM_AD_FURNI_DOUBLE_CLICK,It.ROOM_AD_FURNI_CLICK];return this.widget&&e.push(p.OPEN_WIDGET,p.CLOSE_WIDGET),this.contextMenu&&e.push(p.OPEN_FURNI_CONTEXT_MENU,p.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(!e)return;const t=this.object&&this.object.model;if(t){if(e.logic){if(e.logic.model){const s=e.logic.model.dimensions;s&&(this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const i=e.logic.model.directions;if(i&&i.length){for(const r of i)this._directions.push(r);this._directions.sort((r,n)=>r-n)}}if(e.logic.customVars){const s=e.logic.customVars.variables;s&&s.length&&t.setValue(d.FURNITURE_CUSTOM_VARIABLES,s)}}t.setValue(d.FURNITURE_SIZE_X,this._sizeX),t.setValue(d.FURNITURE_SIZE_Y,this._sizeY),t.setValue(d.FURNITURE_SIZE_Z,this._sizeZ),t.setValue(d.FURNITURE_CENTER_X,this._centerX),t.setValue(d.FURNITURE_CENTER_Y,this._centerY),t.setValue(d.FURNITURE_CENTER_Z,this._centerZ),t.setValue(d.FURNITURE_ALLOWED_DIRECTIONS,this._directions),t.setValue(d.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(e){super.setObject(e),e&&e.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(e){return e.getValue(d.FURNITURE_AD_URL)}handleAdClick(e,t,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new It(It.ROOM_AD_FURNI_CLICK,this.object))}update(e){super.update(e),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>xe.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(e){if(e instanceof Et){this.processDataUpdateMessage(e);return}if(e instanceof Vg){this.processObjectHeightUpdateMessage(e);return}if(e instanceof ph){this.processItemDataUpdateMessage(e);return}if(this._mouseOver=!1,e.location&&e.direction){if(!(e instanceof ii)){const t=this.object.getDirection(),s=this.object.getLocation();t.x!==e.direction.x&&this._directionInitialized&&s.x===e.location.x&&s.y===e.location.y&&s.z===e.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new Bt(e.location,e.direction),e=null)}this._directionInitialized=!0}if(e instanceof $r&&this.contextMenu&&this.eventDispatcher&&this.object){const t=e.selected?p.OPEN_FURNI_CONTEXT_MENU:p.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new p(t,this.object))}super.processUpdateMessage(e)}processDataUpdateMessage(e){e&&(this.object.setState(e.state,0),e.data&&e.data.writeRoomObjectModel(this.object.model),e.extra!==null&&this.object.model.setValue(d.FURNITURE_EXTRAS,e.extra.toString()),this.object.model.setValue(d.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(e){e&&this.object.model.setValue(d.FURNITURE_SIZE_Z,e.height)}processItemDataUpdateMessage(e){e&&this.object.model.setValue(d.FURNITURE_ITEMDATA,e.data)}mouseEvent(e,t){const s=this.getAdClickUrl(this.object.model);switch(e.type){case F.MOUSE_MOVE:if(this.eventDispatcher){const i=new V(V.MOUSE_MOVE,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}return;case F.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new It(It.ROOM_AD_TOOLTIP_SHOW,this.object));const i=new V(V.MOUSE_ENTER,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!0}return;case F.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new It(It.ROOM_AD_TOOLTIP_HIDE,this.object));const i=new V(V.MOUSE_LEAVE,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!1}return;case F.DOUBLE_CLICK:this.useObject();return;case F.MOUSE_CLICK:if(this.eventDispatcher){const i=new V(V.CLICK,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i),s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new It(It.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case F.MOUSE_DOWN:if(this.eventDispatcher){const i=new V(V.MOUSE_DOWN,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);this.eventDispatcher.dispatchEvent(i)}return;case F.MOUSE_DOWN_LONG:if(this.eventDispatcher){const i=new V(V.MOUSE_DOWN_LONG,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);this.eventDispatcher.dispatchEvent(i)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=xe.BOUNCING_STEPS/2?this._locationOffset.z=xe.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=xe.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=xe.BOUNCING_Z*(xe.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const e=this.getAdClickUrl(this.object.model);e&&e.length&&this.eventDispatcher.dispatchEvent(new It(It.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,e)),this.widget&&this.eventDispatcher.dispatchEvent(new p(p.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new rt(rt.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new p(p.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new p(p.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}};let ut=xe;ut.BOUNCING_STEPS=-1;ut.BOUNCING_Z=-1;class zg extends ut{getEventTypes(){const t=[p.BADGE_DISPLAY_ENGRAVING,rs.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object){if(t instanceof Et){const s=t.data;s instanceof ur&&this.updateBadge(s.getValue(1));return}if(t instanceof cr){t.assetName!=="loading_icon"&&(this.object.model.setValue(d.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(d.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(Z()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){t!==""&&this.eventDispatcher&&(this.object.model.setValue(d.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new rs(rs.LOAD_BADGE,this.object,t,!1)))}}const Ri=class extends zg{getEventTypes(){const e=[p.ACHIEVEMENT_RESOLUTION_OPEN,p.ACHIEVEMENT_RESOLUTION_ENGRAVING,p.ACHIEVEMENT_RESOLUTION_FAILED,rs.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof cr&&e.assetName!=="loading_icon"&&this.object.model.setValue(d.FURNITURE_BADGE_VISIBLE_IN_STATE,Ri.BADGE_VISIBLE_IN_STATE),e instanceof $r){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new p(p.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let e=null;switch(this.object.getState(0)){case Ri.STATE_RESOLUTION_NOT_STARTED:case Ri.STATE_RESOLUTION_IN_PROGRESS:e=new p(p.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case Ri.STATE_RESOLUTION_ACHIEVED:e=new p(p.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case Ri.STATE_RESOLUTION_FAILED:e=new p(p.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}e&&this.eventDispatcher.dispatchEvent(e)}updateBadge(e){e!==Ri.ACH_NOT_SET&&super.updateBadge(e)}};let wi=Ri;wi.STATE_RESOLUTION_NOT_STARTED=0;wi.STATE_RESOLUTION_IN_PROGRESS=1;wi.STATE_RESOLUTION_ACHIEVED=2;wi.STATE_RESOLUTION_FAILED=3;wi.ACH_NOT_SET="ach_0";wi.BADGE_VISIBLE_IN_STATE=2;class tG extends ut{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(Qr.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(Qr.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const s=this.object.getLocation(),i=t.targetLocation;if(!i)return;let r=this.object.model.getValue(d.FURNITURE_SIZE_X),n=this.object.model.getValue(d.FURNITURE_SIZE_Y);const a=(Math.floor(this.object.getDirection().x)+45)%360/90;(a===1||a===3)&&([r,n]=[n,r]),i.x>=s.x&&i.x<s.x+r&&i.y>=s.y&&i.y<s.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class eG extends ut{getEventTypes(){const t=[p.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);const s=this.object.model.getValue(d.FURNITURE_DATA);this.updateClothingData(s)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Et&&t.data&&this.updateClothingData(t.data.getLegacyString())}updateClothingData(t){if(!t||!t.length)return;const[s,i]=t.split(",");s&&s.length&&this.object.model.setValue(d.FURNITURE_CLOTHING_BOY,s),i&&i.length&&this.object.model.setValue(d.FURNITURE_CLOTHING_GIRL,i)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.CLOTHING_CHANGE,this.object))}}class sG extends ut{getEventTypes(){const t=[rt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,s){if(!t||!s||!this.object)return;let i=null;switch(t.type){case F.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":i=new rt(rt.STATE_CHANGE,this.object,1);break;case"reset":i=new rt(rt.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}break}super.mouseEvent(t,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new rt(rt.STATE_CHANGE,this.object,1))}}class iG extends ut{processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(kt.INFOSTAND_EXTRA_PARAM,kt.CRACKABLE_FURNI)}}class rG extends ut{get widget(){return j.CRAFTING}}class nG extends ut{getEventTypes(){const t=[p.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let s=0;t.logic&&t.logic.credits&&t.logic.credits!==""&&t.logic.credits.length>0&&(s=parseInt(t.logic.credits)),this.object.model.setValue(d.FURNITURE_CREDIT_VALUE,s)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new p(p.CREDITFURNI,this.object)),super.useObject())}}class Ut extends ut{getEventTypes(){const t=[L.MOUSE_BUTTON,L.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,s){if(!(!t||!s||!this.object)){switch(t.type){case F.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new L(L.MOUSE_BUTTON,this.object));break;case F.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new L(L.MOUSE_ARROW,this.object));break}super.mouseEvent(t,s)}}}class aG extends Ut{constructor(){super(...arguments),this._state=1}getEventTypes(){const t=[Ms.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Et&&(this._state!==-1&&t.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=t.state)}dispatchSoundEvent(t){const s=Math.pow(2,t-1.2);this.eventDispatcher.dispatchEvent(new Ms(Ms.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",s))}}class oG extends Ut{getEventTypes(){const t=[p.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(d.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new p(p.STACK_HEIGHT,this.object)),super.useObject())}}class _G extends ut{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[L.DICE_ACTIVATE,L.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,s){if(!t||!s||!this.object)return;let i=null;switch(t.type){case F.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(i=new L(L.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(i=new L(L.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):t.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?i=new L(L.DICE_ACTIVATE,this.object):t.spriteTag==="deactivate"&&(i=new L(L.DICE_OFF,this.object)),i&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(i);return}super.mouseEvent(t,s)}}class hG extends ut{getEventTypes(){const t=[p.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.ECOTRONBOX,this.object))}}class uG extends ut{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[p.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(d.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,s){!t||!s||(t.type===F.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,s))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.INERNAL_LINK,this.object))}}class lG extends ut{getEventTypes(){const t=[p.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.link&&t.logic.action.link!==""&&t.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(d.FURNITURE_INTERNAL_LINK,t.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(d.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new p(p.ROOM_LINK,this.object))}}class cG extends ut{getEventTypes(){const t=[p.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return Zt.EFFECT_BOX}}class dG extends Ut{getEventTypes(){const t=[p.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(super.initialize(t),!!t&&this.object&&this.object.model){let s="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(s=t.logic.maskType),this.object.model.setValue(d.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(d.FURNITURE_PLANE_MASK_TYPE,s)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new p(p.EXTERNAL_IMAGE,this.object)),super.useObject())}}class gG extends ut{getEventTypes(){const t=[rt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(d.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}mouseEvent(t,s){if(!t||!s||!this.object)return;let i=null;switch(t.type){case F.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":i=new rt(rt.STATE_CHANGE,this.object,1);break;case"reset":i=new rt(rt.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}break}super.mouseEvent(t,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new rt(rt.STATE_CHANGE,this.object,0))}}const br=class extends Ut{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const e=[$t.ADD_HOLE,$t.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._currentState===br.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new $t($t.REMOVE_HOLE,this.object)),super.onDispose()}update(e){super.update(e),this.handleAutomaticStateUpdate()}processUpdateMessage(e){if(super.processUpdateMessage(e),!this.object)return;e instanceof Et&&this.handleStateUpdate(this.object.getState(0));const t=this.object.getLocation();this._currentLocation?(t.x!==this._currentLocation.x||t.y!==this._currentLocation.y)&&this._currentState===br.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new $t($t.ADD_HOLE,this.object)):this._currentLocation=new I,this._currentLocation.assign(t)}handleStateUpdate(e){e!==this._currentState&&(this.eventDispatcher&&(e===br.STATE_HOLE?this.eventDispatcher.dispatchEvent(new $t($t.ADD_HOLE,this.object)):this._currentState===br.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new $t($t.REMOVE_HOLE,this.object))),this._currentState=e)}handleAutomaticStateUpdate(){if(!this.object)return;const e=this.object.model;if(!e)return;const t=e.getValue(d.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(t)||this.handleStateUpdate(t%2)}};let Wg=br;Wg.STATE_HOLE=0;const y_=class extends Ut{constructor(){super(...arguments),this._state=-1}initialize(e){super.initialize(e),this.object&&this.object.model.setValue(d.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(e){if(e instanceof Et){const t=e.data;t?this._state=t.state:this._state=e.state}super.processUpdateMessage(e)}getEventTypes(){const e=[p.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||(this._state===y_.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new p(p.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===y_.STATE_UNLOCKED?Zt.FRIEND_FURNITURE:Zt.DUMMY}};let Rn=y_;Rn.STATE_UNINITIALIZED=-1;Rn.STATE_UNLOCKED=0;Rn.STATE_LOCKED=1;const Fr=class extends Ut{getEventTypes(){const e=[rs.LOAD_BADGE,p.GUILD_FURNI_CONTEXT_MENU,p.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Et){const t=e.data;t instanceof ur&&(this.updateGroupId(t.getValue(Fr.GROUPID_KEY)),this.updateBadge(t.getValue(Fr.BADGE_KEY)),this.updateColors(t.getValue(Fr.COLOR1_KEY),t.getValue(Fr.COLOR2_KEY)))}else e instanceof cr?e.assetName!=="loading_icon"&&(this.object.model.setValue(d.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,e.assetName),this.update(Z())):e instanceof $r&&(e.selected||this.eventDispatcher.dispatchEvent(new p(p.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(e){this.object.model.setValue(d.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(e))}updateBadge(e){this.eventDispatcher.dispatchEvent(new rs(rs.LOAD_BADGE,this.object,e,!0))}updateColors(e,t){this.object.model.setValue(d.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(e,16)),this.object.model.setValue(d.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(t,16))}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case F.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(e,t)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new p(p.GUILD_FURNI_CONTEXT_MENU,this.object))}};let Ir=Fr;Ir.GROUPID_KEY=1;Ir.BADGE_KEY=2;Ir.COLOR1_KEY=3;Ir.COLOR2_KEY=4;class EG extends Ir{getEventTypes(){const t=[p.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}updateGroupId(t){super.updateGroupId(t),this.object.model.setValue(d.FURNITURE_INTERNAL_LINK,`groupforum/${t}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new p(p.INERNAL_LINK,this.object)),super.useObject())}}class fG extends ut{getEventTypes(){const t=[L.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.USE_HABBOWHEEL,this.object))}}const kg=class extends ut{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[p.HIGH_SCORE_DISPLAY,p.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new p(p.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(e){super.processUpdateMessage(e),this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&e instanceof Et&&(e.state===kg.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new p(p.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new p(p.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=e.state)}};let Kg=kg;Kg.SHOW_WIDGET_IN_STATE=1;class mG extends ut{getEventTypes(){const t=[rt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,s){if(!t||!s||!this.object)return;let i=null;switch(t.type){case F.DOUBLE_CLICK:switch(t.spriteTag){case"off":i=new rt(rt.STATE_CHANGE,this.object,3);break}break;case F.MOUSE_CLICK:switch(t.spriteTag){case"inc":i=new rt(rt.STATE_CHANGE,this.object,2);break;case"dec":i=new rt(rt.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&i){this.eventDispatcher.dispatchEvent(i);return}super.mouseEvent(t,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new rt(rt.STATE_CHANGE,this.object,3))}}class IG extends Rn{get engravingDialogType(){return Fi.HABBOWEEN}}class RG extends Ut{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const s=new me;s.setString(this._nextState.toString()),super.processUpdateMessage(new Et(this._nextState,s,this._nextStateExtra))}super.update(t)}processUpdateMessage(t){if(t instanceof Et){this.processUpdate(t);return}super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const s=~~(t.state/1e3),i=~~(t.state%1e3);if(i)this._nextState=s,this._nextStateExtra=t.extra,this._nextStateTimestamp=this.time+i;else{this._nextStateTimestamp=0;const r=new me;r.setString(s.toString()),super.processUpdateMessage(new Et(s,r,t.extra))}}}class TG extends ut{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[p.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&(this.object.model.setValue(d.FURNITURE_INTERNAL_LINK,t.logic.action.link),t.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(d.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,s){!t||!s||(t.type===F.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(t,s))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.INERNAL_LINK,this.object))}}class pG extends Ut{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[L.JUKEBOX_START,L.JUKEBOX_MACHINE_STOP,L.JUKEBOX_DISPOSE,L.JUKEBOX_INIT,p.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(kt.INFOSTAND_EXTRA_PARAM,kt.JUKEBOX),t instanceof Et)){const s=this.object.getState(0);s!==this._currentState&&(this._currentState=s,s===1?this.requestPlayList():s===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new L(L.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new L(L.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new p(p.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new rt(rt.STATE_CHANGE,this.object,-1)))}}class OG extends Rn{get engravingDialogType(){return Fi.LOVE_LOCK}}const Wn=class extends ut{getEventTypes(){const e=[p.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Et&&(e.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const e=new ni;e.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(d.FURNITURE_MANNEQUIN_GENDER,e.getValue(Wn.GENDER)),this.object.model.setValue(d.FURNITURE_MANNEQUIN_FIGURE,e.getValue(Wn.FIGURE)),this.object.model.setValue(d.FURNITURE_MANNEQUIN_NAME,e.getValue(Wn.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.MANNEQUIN,this.object))}};let Ka=Wn;Ka.GENDER="GENDER";Ka.FIGURE="FIGURE";Ka.OUTFIT_NAME="OUTFIT_NAME";class AG extends Ut{getEventTypes(){const t=[p.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return Zt.MONSTERPLANT_SEED}}class SG extends Ut{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(d.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class MG extends Ut{getEventTypes(){const t=[p.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return Zt.MYSTERY_BOX}}class CG extends Ut{getEventTypes(){const t=[p.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return Zt.MYSTERY_TROPHY}}class NG extends ut{getEventTypes(){const t=[L.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.ENTER_ONEWAYDOOR,this.object))}}class DG extends ut{getEventTypes(){const t=[p.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(kt.INFOSTAND_EXTRA_PARAM,kt.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.PET_PRODUCT_MENU,this.object))}}class PG extends ut{getEventTypes(){const t=[p.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.PLACEHOLDER,this.object))}}class yG extends ut{initialize(t){super.initialize(t),t.logic&&t.logic.planetSystems&&this.object.model.setValue(d.FURNITURE_PLANETSYSTEM_DATA,t.logic.planetSystems)}}const ki=class extends ut{getEventTypes(){const e=[p.PRESENT];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.particleSystems&&e.logic.particleSystems.length&&this.object.model.setValue(d.FURNITURE_FIREWORKS_DATA,e.logic.particleSystems)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Et&&(e.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),e instanceof jg&&e.numberKey===d.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(d.FURNITURE_DISABLE_PICKING_ANIMATION,e.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const e=new ni;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(ki.MESSAGE),s=this.object.model.getValue(d.FURNITURE_DATA);!t&&typeof s=="string"?this.object.model.setValue(d.FURNITURE_DATA,s.substr(1)):this.object.model.setValue(d.FURNITURE_DATA,e.getValue(ki.MESSAGE)),this.writeToModel(d.FURNITURE_TYPE_ID,e.getValue(ki.PRODUCT_CODE)),this.writeToModel(d.FURNITURE_PURCHASER_NAME,e.getValue(ki.PURCHASER_NAME)),this.writeToModel(d.FURNITURE_PURCHASER_FIGURE,e.getValue(ki.PURCHASER_FIGURE))}writeToModel(e,t){t&&this.object.model.setValue(e,t)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case F.ROLL_OVER:this.eventDispatcher.dispatchEvent(new L(L.MOUSE_BUTTON,this.object));break;case F.ROLL_OUT:this.eventDispatcher.dispatchEvent(new L(L.MOUSE_ARROW,this.object));break}super.mouseEvent(e,t)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.PRESENT,this.object))}};let Rr=ki;Rr.MESSAGE="MESSAGE";Rr.PRODUCT_CODE="PRODUCT_CODE";Rr.EXTRA_PARAM="EXTRA_PARAM";Rr.PURCHASER_NAME="PURCHASER_NAME";Rr.PURCHASER_FIGURE="PURCHASER_FIGURE";class LG extends Ut{getEventTypes(){const t=[p.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return Zt.PURCHASABLE_CLOTHING}}const xr=class extends Ut{constructor(){super(),this.updateInterval=ri.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new I}processUpdateMessage(e){if(!e)return;const t=e instanceof ii;if(this.object&&!t&&e.location){const s=this.object.getLocation(),i=I.dif(e.location,s);if(i&&Math.abs(i.x)<2&&Math.abs(i.y)<2){let r=s;(Math.abs(i.x)>1||Math.abs(i.y)>1)&&(r=I.sum(s,I.product(i,.5))),super.processUpdateMessage(new ii(r,e.location,e.direction));return}}if(e.location&&!t&&super.processUpdateMessage(new ii(e.location,e.location,e.direction)),e instanceof Et){e.state>0?this.updateInterval=ri.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(e.state):this.updateInterval=1,this.handleDataUpdate(e);return}t&&e.isSlide&&(this.updateInterval=ri.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(e)}getUpdateIntervalValue(e){return e/xr.MAX_ANIMATION_COUNT}getAnimationValue(e){return e%xr.MAX_ANIMATION_COUNT}handleDataUpdate(e){const t=this.getAnimationValue(e.state);if(t!==e.state){const s=new me;s.setString(t.toString()),e=new Et(t,s,e.extra)}super.processUpdateMessage(e)}update(e){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(e),I.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==xr.ANIMATION_NOT_MOVING&&this.object.setState(xr.ANIMATION_NOT_MOVING,0))}};let Xa=xr;Xa.ANIMATION_NOT_MOVING=0;Xa.ANIMATION_MOVING=1;Xa.MAX_ANIMATION_COUNT=10;class UG extends ut{getEventTypes(){const t=[rt.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new rt(rt.STATE_RANDOM,this.object))}}class vG extends Ut{get contextMenu(){return Zt.RANDOM_TELEPORT}}class bG extends ut{getEventTypes(){const t=[ye.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),t)}update(t){if(super.update(t),this.object&&this.object.model){this.object.model.getValue(d.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new ye(ye.RODRE_CURRENT_USER_ID,this.object));const s=this.object.model.getValue(d.FURNITURE_DATA).getValue("renterId"),i=this.object.model.getValue(d.SESSION_CURRENT_USER_ID);s?parseInt(s)===i?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return j.RENTABLESPACE}}class FG extends Ut{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[p.BACKGROUND_COLOR,qs.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new qs(qs.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Et&&(t.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new qr;t.initializeFromRoomObjectModel(this.object.model);const s=t.getValue(0),i=t.getValue(1),r=t.getValue(2),n=t.getValue(3);s>-1&&i>-1&&r>-1&&n>-1&&(this.object.model.setValue(d.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,i),this.object.model.setValue(d.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,r),this.object.model.setValue(d.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(s,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new qs(qs.ROOM_BACKGROUND_COLOR,this.object,s===1,i,r,n)),this._roomColorUpdated=!0)}mouseEvent(t,s){if(!(!t||!s||!this.object)){switch(t.type){case F.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new p(p.BACKGROUND_COLOR,this.object));return}super.mouseEvent(t,s)}}}const Ne=class extends ut{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const e=[It.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this._disableFurnitureSelection&&this.object.model.setValue(d.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Et&&this.processAdDataUpdateMessage(e),e instanceof ae&&this.processAdUpdate(e)}processAdDataUpdateMessage(e){if(!e)return;const t=new ni;t.initializeFromRoomObjectModel(this.object.model);const s=parseInt(t.getValue(Ne.STATE));!isNaN(s)&&this.object.getState(0)!==s&&this.object.setState(s,0);const i=t.getValue(Ne.IMAGEURL_KEY),r=this.object.model.getValue(d.FURNITURE_BRANDING_IMAGE_URL);(!r||r!==i)&&(this.object.model.setValue(d.FURNITURE_BRANDING_IMAGE_URL,i),this.object.model.setValue(d.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const n=t.getValue(Ne.CLICKURL_KEY);if(n){const c=this.object.model.getValue(d.FURNITURE_BRANDING_URL);(!c||c!==n)&&this.object.model&&this.object.model.setValue(d.FURNITURE_BRANDING_URL,n)}const a=parseInt(t.getValue(Ne.OFFSETX_KEY)),o=parseInt(t.getValue(Ne.OFFSETY_KEY)),u=parseInt(t.getValue(Ne.OFFSETZ_KEY));isNaN(a)||this.object.model.setValue(d.FURNITURE_BRANDING_OFFSET_X,a),isNaN(o)||this.object.model.setValue(d.FURNITURE_BRANDING_OFFSET_Y,o),isNaN(u)||this.object.model.setValue(d.FURNITURE_BRANDING_OFFSET_Z,u);let l=Ne.IMAGEURL_KEY+"="+(i!==null?i:"")+"	";this._hasClickUrl&&(l=l+(Ne.CLICKURL_KEY+"="+(n!==null?n:"")+"	")),l=l+(Ne.OFFSETX_KEY+"="+a+"	"),l=l+(Ne.OFFSETY_KEY+"="+o+"	"),l=l+(Ne.OFFSETZ_KEY+"="+u+"	"),this.object.model.setValue(kt.INFOSTAND_EXTRA_PARAM,kt.BRANDING_OPTIONS+l)}processAdUpdate(e){if(!(!e||!this.object))switch(e.type){case ae.IMAGE_LOADED:this.object.model.setValue(d.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case ae.IMAGE_LOADING_FAILED:this.object.model.setValue(d.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(e,t){!e||!t||e.type===F.MOUSE_MOVE||e.type===F.DOUBLE_CLICK||super.mouseEvent(e,t)}async downloadBackground(){const e=this.object&&this.object.model;if(!e)return;const t=e.getValue(d.FURNITURE_BRANDING_IMAGE_URL),s=e.getValue(d.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!t||t===""||s===1))if(t.endsWith(".gif"))this.object.model.setValue(d.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(t).then(i=>i.arrayBuffer()).then(i=>HE(i)).then(i=>{const r=i.lsd.width,n=i.lsd.height,a=r*n,o=VE(i,!1),u=[],l=[];let c=new Uint8Array(a*4);for(let g=0;g<o.length;g++){g>0&&(c=c.slice(0));const f=o[g].pixels,R=o[g].colorTable,m=o[g].transparentIndex,T=o[g].dims;for(let C=0;C<T.height;C++)for(let N=0;N<T.width;N++){const S=f[C*T.width+N],D=(C+T.top)*r+(N+T.left);if(m!==S){const v=R[S];c[4*D]=v[0],c[4*D+1]=v[1],c[4*D+2]=v[2],c[4*D+3]=255}}const O=Oa.fromBuffer(c,r,n);u.push(new Dt(O)),l.push(o[g].delay)}B.instance.roomEngine.roomContentLoader.createGifCollection(t,u,l),this.processUpdateMessage(new ae(ae.IMAGE_LOADED))}).catch(i=>{this.processUpdateMessage(new ae(ae.IMAGE_LOADING_FAILED))});else{const i=Pe();if(!i)return;if(!i.getTexture(t)){await i.downloadAsset(t)?this.processUpdateMessage(new ae(ae.IMAGE_LOADED)):this.processUpdateMessage(new ae(ae.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new ae(ae.IMAGE_LOADED))}}};let di=Ne;di.STATE="state";di.IMAGEURL_KEY="imageUrl";di.CLICKURL_KEY="clickUrl";di.OFFSETX_KEY="offsetX";di.OFFSETY_KEY="offsetY";di.OFFSETZ_KEY="offsetZ";class xG extends di{getAdClickUrl(t){return null}}class GG extends di{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(d.FURNITURE_BRANDING_URL)}handleAdClick(t,s,i){if(i.indexOf("http")===0){Ui.openWebPage(i);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new It(It.ROOM_AD_FURNI_CLICK,this.object,"",i))}}class BG extends ut{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[p.DIMMER,p.WIDGET_REMOVE_DIMMER,_r.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new _r(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new p(p.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){if(t instanceof Et){if(t.data){const s=t.data.getLegacyString();this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(s),super.processUpdateMessage(new Et(this.getStateFromDimmerData(s),t.data))}return}super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const s=t.split(",");return s.length>=5?parseInt(s[0])-1:0}processDimmerData(t){if(!t)return;const s=t.split(",");if(s.length>=5){const i=this.getStateFromDimmerData(t),r=parseInt(s[1]),n=parseInt(s[2]),a=s[3];let o=parseInt(a.substr(1),16),u=parseInt(s[4]);i||(o=16777215,u=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new _r(this.object,i,r,n,o,u)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.DIMMER,this.object))}update(t){super.update(t)}}const Gr=class extends ut{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(e){if(e instanceof Et)return this.updateScore(e.state);super.processUpdateMessage(e)}updateScore(e){this._score=e;const t=this.object.getState(0);if(this._score!==t){let s=this._score-t;s<0&&(s=-s),s*Gr.UPDATE_INTERVAL>Gr.MAX_UPDATE_TIME?this._scoreIncreaser=Gr.MAX_UPDATE_TIME/s:this._scoreIncreaser=Gr.UPDATE_INTERVAL,this._scoreTimer=Z()}}update(e){super.update(e);const t=this.object.getState(0);if(t!==this._score&&e>=this._scoreTimer+this._scoreIncreaser){const s=e-this._scoreTimer;let i=s/this._scoreIncreaser,r=1;this._score<t&&(r=-1),i>r*(this._score-t)&&(i=r*(this._score-t)),this.object.setState(t+r*i,0),this._scoreTimer=e-(s-i*this._scoreIncreaser)}}};let Ah=Gr;Ah.UPDATE_INTERVAL=50;Ah.MAX_UPDATE_TIME=3e3;class wG extends ut{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1){const s=this.object.model.getValue(d.FURNITURE_EXTRAS),i=parseInt(s);this.object.model.setValue(kt.INFOSTAND_EXTRA_PARAM,kt.SONGDISK+i)}}}const Vs=class extends Ut{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const e=[yt.ROOM_OBJECT_INITIALIZED,yt.ROOM_OBJECT_DISPOSED,yt.PLAY_SAMPLE,yt.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.soundSample&&(this._sampleId=e.logic.soundSample.id,this._noPitch=e.logic.soundSample.noPitch),this.object.model.setValue(d.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==Vs.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new yt(yt.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Et&&this.updateSoundBlockMessage(e)}updateSoundBlockMessage(e){if(!e)return;const t=this.object&&this.object.model,s=this.object&&this.object.location;!t||!s||(this._state===Vs.STATE_UNINITIALIZED&&t.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new yt(yt.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==Vs.STATE_UNINITIALIZED&&t.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new yt(yt.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==Vs.STATE_UNINITIALIZED&&e.state!==this._state&&this.playSoundAt(s.z),this._state=e.state)}playSoundAt(e){if(!this.object)return;const t=this.getPitchForHeight(e);this.object.model.setValue(d.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,t),this.eventDispatcher.dispatchEvent(new yt(yt.PLAY_SAMPLE,this.object,this._sampleId,t))}getPitchForHeight(e){if(this._noPitch)return 1;let t=e*2;return t>Vs.HIGHEST_SEMITONE&&(t=Math.min(0,Vs.LOWEST_SEMITONE+(t-Vs.HIGHEST_SEMITONE-1))),Math.pow(2,t/12)}};let qa=Vs;qa.HIGHEST_SEMITONE=12;qa.LOWEST_SEMITONE=-12;qa.STATE_UNINITIALIZED=-1;class HG extends Ut{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[L.SOUND_MACHINE_START,L.SOUND_MACHINE_STOP,L.SOUND_MACHINE_DISPOSE,L.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(d.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(kt.INFOSTAND_EXTRA_PARAM,kt.JUKEBOX),t instanceof Et)){const s=this.object.getState(0);s!==this._currentState&&(this._currentState=s,s===1?this.requestPlayList():s===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new L(L.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new L(L.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.SOUND_MACHINE_DISPOSE,this.object))}}const Xg=class extends ut{getEventTypes(){const e=[p.STICKIE,L.STICKIE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this.updateColor(),this.object&&this.object.model.setValue(d.FURNITURE_IS_STICKIE,"")}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof ph&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new p(p.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const e=this.object.model.getValue(d.FURNITURE_DATA);let t=Xg.STICKIE_COLORS.indexOf(e);t<0&&(t=3),this.object.model.setValue(d.FURNITURE_COLOR,t+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new L(L.STICKIE,this.object))}};let qg=Xg;qg.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];class VG extends ut{getEventTypes(){const t=[p.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.TROPHY,this.object))}}const Br=class extends Ut{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Et){const t=e.data;if(!t)return;this.updateTotal(t.result)}}updateTotal(e){if(this._total=e,!this._lastUpdate){this.object.model.setValue(d.FURNITURE_VOTE_COUNTER_COUNT,e),this._lastUpdate=Z();return}if(this._total!==this.currentTotal){const t=Math.abs(this._total-this.currentTotal);t*Br.UPDATE_INTERVAL>Br.MAX_UPDATE_TIME?this._interval=Br.MAX_UPDATE_TIME/t:this._interval=Br.UPDATE_INTERVAL,this._lastUpdate=Z()}}update(e){if(super.update(e),this.object&&this.currentTotal!==this._total&&e>=this._lastUpdate+this._interval){const t=e-this._lastUpdate;let s=t/this._interval,i=1;this._total<this.currentTotal&&(i=-1),s>i*(this._total-this.currentTotal)&&(s=i*(this._total-this.currentTotal)),this.object.model.setValue(d.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+i*s),this._lastUpdate=e-(t-s*this._interval)}}get currentTotal(){return this.object.model.getValue(d.FURNITURE_VOTE_COUNTER_COUNT)}};let Sh=Br;Sh.UPDATE_INTERVAL=33;Sh.MAX_UPDATE_TIME=1e3;class jG extends Ut{processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object&&t instanceof Et){const s=t.data;s instanceof ta&&this.object.model.setValue(d.FURNITURE_VOTE_MAJORITY_RESULT,s.result)}}}class YG extends Ut{mouseEvent(t,s){!t||!s||(t.type===F.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new rt(rt.STATE_CHANGE,this.object)),super.mouseEvent(t,s))}}class zG extends Ut{initialize(t){super.initialize(t);let s="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(s=t.logic.maskType),this.object.model.setValue(d.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(d.FURNITURE_PLANE_MASK_TYPE,s)}}class WG extends ut{getEventTypes(){const t=[p.YOUTUBE,ye.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),t)}update(t){super.update(t),this.object.model.getValue(d.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new ye(ye.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new p(p.YOUTUBE,this.object))}}class kG extends ri{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[V.CLICK,se.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const s=this.object&&this.object.model;if(s){if(t.logic&&t.logic.model){const i=t.logic.model.directions;if(i&&i.length){for(const r of i)this._directions.push(r);this._directions.sort()}}s.setValue(d.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new se(se.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new I),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new se(se.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,s){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(s.setValue(d.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(s.setValue(d.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(s.setValue(d.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const s=this.object&&this.object.model;if(s){if(t instanceof fa){s.setValue(d.HEAD_DIRECTION,t.headDirection);return}if(t instanceof ga){const i=new pa(t.figure);s.setValue(d.FIGURE,t.figure),s.setValue(d.RACE,t.subType),s.setValue(d.PET_PALETTE_INDEX,i.paletteId),s.setValue(d.PET_COLOR,i.color),s.setValue(d.PET_TYPE,i.typeId),s.setValue(d.PET_CUSTOM_LAYER_IDS,i.customLayerIds),s.setValue(d.PET_CUSTOM_PARTS_IDS,i.customPartIds),s.setValue(d.PET_CUSTOM_PALETTE_IDS,i.customPaletteIds),s.setValue(d.PET_IS_RIDING,t.isRiding?1:0);return}if(t instanceof Rh){s.setValue(d.FIGURE_POSTURE,t.postureType);return}if(t instanceof Ih){s.setValue(d.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof Th){s.setValue(d.FIGURE_SLEEP,t.isSleeping?1:0);return}if(t instanceof Fg){s.setValue(d.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof Ea){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof Pg){s.setValue(d.FIGURE_EXPERIENCE_TIMESTAMP,this.time),s.setValue(d.FIGURE_GAINED_EXPERIENCE,t.gainedExperience);return}}}mouseEvent(t,s){let i=null;switch(t.type){case F.MOUSE_CLICK:i=V.CLICK;break;case F.DOUBLE_CLICK:break;case F.MOUSE_DOWN:{this.object.model.getValue(d.PET_TYPE)===ht.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new V(V.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown));break}}i&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new V(i,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class Qg{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}class Li{constructor(t,s,i){this.type=t,this.loc=s,this.category=i}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new I),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}}Li.WINDOW="window";Li.HOLE="hole";class KG{constructor(){this._masks=[]}get masks(){return this._masks}}class Jg{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const s of t.masks){if(!s)continue;const i=s.locations.length?s.locations[0]:null;i&&this._masks.set(s.id,new Li(s.type,i,s.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,s,i,r){const n=new Li(s,i,r);this._masks.delete(t),this._masks.set(t,n)}removeMask(t){const s=this._masks.get(t);return s?(this._masks.delete(t),s.dispose(),!0):!1}getXML(){const t=new KG;for(const[s,i]of this._masks.entries()){if(!i)continue;const r=this.getMaskType(i),n=this.getMaskCategory(i),a=this.getMaskLocation(i);if(r&&n&&a){const o={id:s,type:r,category:n,locations:[{x:a.x,y:a.y,z:a.z}]};t.masks.push(o)}}return t}getMaskLocation(t){return t?t.loc:null}getMaskType(t){return t?t.type:null}getMaskCategory(t){return t?t.category:null}get masks(){return this._masks}}class XG{constructor(t,s,i,r){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=s,this._leftSideLength=i,this._rightSideLength=r}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class pt{constructor(t,s,i,r,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let a,o,u,l,c,g,f,R;if(this._secondaryNormals=[],this._masks=[],this._loc=new I,this._loc.assign(s),this._leftSide=new I,this._leftSide.assign(i),this._rightSide=new I,this._rightSide.assign(r),this._type=t,i!=null&&r!=null&&(this._normal=I.crossProduct(i,r),a=0,o=0,u=0,l=0,c=0,this.normal.x!=0||this.normal.y!=0?(l=this.normal.x,c=this.normal.y,a=360+Math.atan2(c,l)/Math.PI*180,a>=360&&(a=a-360),l=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),c=this.normal.z,o=360+Math.atan2(c,l)/Math.PI*180,o>=360&&(o=o-360)):this.normal.z<0?o=90:o=270,this._normalDirection=new I(a,o,u)),n!=null&&n.length>0)for(g=0;g<n.length;)f=n[g],f!=null&&f.length>0&&(R=new I,R.assign(f),R.multiply(1/R.length),this._secondaryNormals.push(R)),g++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(t){if(t<0||t>=this.secondaryNormalCount)return null;const s=new I;return s.assign(this._secondaryNormals[t]),s}addMask(t,s,i,r){const n=new XG(t,s,i,r);this._masks.push(n)}getMask(t){return t<0||t>=this.maskCount?null:this._masks[t]}getMaskLeftSideLoc(t){const s=this.getMask(t);return s!=null?s.leftSideLoc:-1}getMaskRightSideLoc(t){const s=this.getMask(t);return s!=null?s.rightSideLoc:-1}getMaskLeftSideLength(t){const s=this.getMask(t);return s!=null?s.leftSideLength:-1}getMaskRightSideLength(t){const s=this.getMask(t);return s!=null?s.rightSideLength:-1}}pt.PLANE_UNDEFINED=0;pt.PLANE_FLOOR=1;pt.PLANE_WALL=2;pt.PLANE_LANDSCAPE=3;pt.PLANE_BILLBOARD=4;class qG{constructor(t,s,i,r){this._x=t,this._y=s,this._width=i,this._height=r}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}const L_=class{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(e,t,s,i,r){(this._addDuplicates||this.checkIsNotDuplicate(e,t,s,i,r))&&(this._corners.push(e),this._directions.push(t),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(r),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(e,t,s,i,r){let n=0;for(;n<this._count;){if(this._corners[n].x==e.x&&this._corners[n].y==e.y&&this._directions[n]==t&&this._lengths[n]==s&&this._borders[n]==i&&this._leftTurns[n]==r)return!1;n++}return!0}get count(){return this._count}getCorner(e){return this._corners[e]}getEndPoint(e){return this.calculateWallEndPoints(),this._endPoints[e]}getLength(e){return this._lengths[e]}getDirection(e){return this._directions[e]}getBorder(e){return this._borders[e]}getHideWall(e){return this._hideWalls[e]}getLeftTurn(e){return this._leftTurns[e]}getManuallyLeftCut(e){return this._manuallyLeftCut[e]}getManuallyRightCut(e){return this._manuallyRightCut[e]}setHideWall(e,t){this._hideWalls[e]=t}setLength(e,t){t<this._lengths[e]&&(this._lengths[e]=t,this._manuallyRightCut[e]=!0)}moveCorner(e,t){let s;if(t>0&&t<this._lengths[e]){const i=this._corners[e];s=L_.WALL_DIRECTION_VECTORS[this.getDirection(e)],this._corners[e]=new Y(i.x+t*s.x,i.y+t*s.y),this._lengths[e]=this._lengths[e]-t,this._manuallyLeftCut[e]=!0}}calculateWallEndPoints(){let e,t,s,i,r;if(this._endPoints.length!=this.count)for(this._endPoints=[],e=0;e<this.count;)t=this.getCorner(e),s=new Y(t.x,t.y),i=L_.WALL_DIRECTION_VECTORS[this.getDirection(e)],r=this.getLength(e),s.x=s.x+i.x*r,s.y=s.y+i.y*r,this._endPoints.push(s),e++}};let $e=L_;$e.WALL_DIRECTION_VECTORS=[new I(1,0,0),new I(0,1,0),new I(-1,0,0),new I(0,-1,0)];$e.WALL_NORMAL_VECTORS=[new I(0,1,0),new I(-1,0,0),new I(0,-1,0),new I(1,0,0)];const dt=class{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(e){const t=e.length;if(!t)return 0;let s=0,i=0;for(;i<t;){const r=e[i];let n=0;for(;n<r.length;){const a=r[n];a>s&&(s=a),n++}i++}return s}static findEntranceTile(e){if(!e)return null;const t=e.length;if(!t)return null;const s=[];let i=0;for(;i<t;){const r=e[i];if(!r||!r.length)return null;let n=0;for(;n<r.length;){if(r[n]>=0){s.push(n);break}n++}s.length<i+1&&s.push(r.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new Y(Math.trunc(s[i]|0),i);i++}return null}static expandFloorTiles(e){let t,s,i,r,n,a,o,u,l,c,g,f;const R=e.length,m=e[0].length,T=[];for(s=0;s<R*4;)T[s]=[],s++;let O=0;for(s=0;s<R;){for(n=0,t=0;t<m;){if(a=e[s][t],a<0||a<=255)for(r=0;r<4;){for(i=0;i<4;)T[O+r]===void 0&&(T[O+r]=[]),T[O+r][n+i]=a<0?a:a*4,i++;r++}else{for(o=(a&255)*4,u=o+(a>>11&1)*3,l=o+(a>>10&1)*3,c=o+(a>>9&1)*3,g=o+(a>>8&1)*3,i=0;i<3;)f=i+1,T[O][n+i]=(u*(3-i)+l*i)/3,T[O+3][n+f]=(c*(3-f)+g*f)/3,T[O+f][n]=(u*(3-f)+c*f)/3,T[O+i][n+3]=(l*(3-i)+g*i)/3,i++;T[O+1][n+1]=u>o?o+2:o+1,T[O+1][n+2]=l>o?o+2:o+1,T[O+2][n+1]=c>o?o+2:o+1,T[O+2][n+2]=g>o?o+2:o+1}n=n+4,t++}O=O+4,s++}return T}static addTileTypes(e){let t,s,i,r,n,a,o,u,l,c,g,f,R;const m=e.length-1,T=e[0].length-1;for(s=1;s<m;){for(t=1;t<T;)i=e[s][t],i<0||(r=e[s-1][t-1]&255,n=e[s-1][t]&255,a=e[s-1][t+1]&255,o=e[s][t-1]&255,u=e[s][t+1]&255,l=e[s+1][t-1]&255,c=e[s+1][t]&255,g=e[s+1][t+1]&255,f=i+1,R=(r==f||n==f||o==f?8:0)|(a==f||n==f||u==f?4:0)|(l==f||c==f||o==f?2:0)|(g==f||c==f||u==f?1:0),R==15&&(R=0),e[s][t]=i|R<<8),t++;s++}}static unpadHeightMap(e){e.shift(),e.pop();for(const t of e)t.shift(),t.pop()}static padHeightMap(e){const t=[],s=[];for(const i of e)i.push(dt.TILE_BLOCKED),i.unshift(dt.TILE_BLOCKED);for(const i of e[0])t.push(dt.TILE_BLOCKED),s.push(dt.TILE_BLOCKED);e.push(s),e.unshift(t)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(e){e<0&&(e=0),this._wallHeight=e}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(e){e<0&&(e=0),this._wallThicknessMultiplier=e}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(e){e<0&&(e=0),this._floorThicknessMultiplier=e}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(e,t){e<0&&(e=0),t<0&&(t=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<t;){const i=[],r=[],n=[];let a=0;for(;a<e;)i[a]=dt.TILE_BLOCKED,r[a]=dt.TILE_BLOCKED,n[a]=!1,a++;this._tileMatrix.push(i),this._tileMatrixOriginal.push(r),this._floorHoleMatrix.push(n),s++}return this._width=e,this._height=t,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(e,t,s){let i,r,n,a,o;if(e>=0&&e<this._width&&t>=0&&t<this._height){if(i=this._tileMatrix[t],i[e]=s,s>=0)e<this._minX&&(this._minX=e),e>this._maxX&&(this._maxX=e),t<this._minY&&(this._minY=t),t>this._maxY&&(this._maxY=t);else{if(e==this._minX||e==this._maxX){for(r=!1,n=this._minY;n<this._maxY;){if(this.getTileHeightInternal(e,n)>=0){r=!0;break}n++}r||(e==this._minX&&this._minX++,e==this._maxX&&this._maxX--)}if(t==this._minY||t==this._maxY){for(a=!1,o=this._minX;o<this._maxX;){if(this.getTileHeight(o,t)>=0){a=!0;break}o++}a||(t==this._minY&&this._minY++,t==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return dt.TILE_BLOCKED;const s=this._tileMatrix[t];return s[e]===void 0?0:Math.abs(s[e])}getTileHeightOriginal(e,t){return e<0||e>=this._width||t<0||t>=this._height?dt.TILE_BLOCKED:this._floorHoleMatrix[t][e]?dt.TILE_HOLE:this._tileMatrixOriginal[t][e]}getTileHeightInternal(e,t){return e<0||e>=this._width||t<0||t>=this._height?dt.TILE_BLOCKED:this._tileMatrix[t][e]}initializeFromTileData(e=-1){let t,s;for(this._fixedWallHeight=e,s=0;s<this._height;){for(t=0;t<this._width;)this._tileMatrixOriginal[s]===void 0&&(this._tileMatrixOriginal[s]=[]),this._tileMatrixOriginal[s][t]=this._tileMatrix[s][t],t++;s++}const i=dt.findEntranceTile(this._tileMatrix);for(s=0;s<this._height;){for(t=0;t<this._width;)this._floorHoleMatrix[s]===void 0&&(this._floorHoleMatrix[s]=[]),this._floorHoleMatrix[s][t]&&this.setTileHeight(t,s,dt.TILE_HOLE),t++;s++}return this.initialize(i)}initialize(e){let t=0;e!=null&&(t=this.getTileHeight(e.x,e.y),this.setTileHeight(e.x,e.y,dt.TILE_BLOCKED)),this._floorHeight=dt.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const r of this._tileMatrix)s.push(r.concat());dt.padHeightMap(s),dt.addTileTypes(s),dt.unpadHeightMap(s);const i=dt.expandFloorTiles(s);return this.extractPlanes(i),e!=null&&(this.setTileHeight(e.x,e.y,t),this.addFloor(new I(e.x+.5,e.y+.5,t),new I(-1,0,0),new I(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(e,t){let s,i,r,n,a;const o=new $e,u=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let l=0,c=new Y(e.x,e.y),g=0;for(;g++<1e3;){if(s=!1,i=!1,r=l,(c.x<this.minX||c.x>this.maxX||c.y<this.minY||c.y>this.maxY)&&(s=!0),n=u[l](c,t),n==null)return null;if(a=Math.abs(n.x-c.x)+Math.abs(n.y-c.y),c.x==n.x||c.y==n.y?(l=(l-1+u.length)%u.length,a=a+1,i=!0):(l=(l+1)%u.length,a--),o.addWall(c,r,a,s,i),n.x==e.x&&n.y==e.y&&(n.x!=c.x||n.y!=c.y))break;c=n}return o.count==0?null:o}hidePeninsulaWallChains(e){let t,s,i,r,n=0;const a=e.count;for(;n<a;){const o=n;for(t=n,s=0,i=!1;!e.getBorder(n)&&n<a;)e.getLeftTurn(n)?s++:s>0&&s--,s>1&&(i=!0),t=n,n++;if(i)for(r=o;r<=t;)e.setHideWall(r,!0),r++;n++}}updateWallsNextToHoles(e){let t,s,i,r,n,a,o;const u=e.count;let l=0;for(;l<u;){if(!e.getHideWall(l)){for(t=e.getCorner(l),s=e.getDirection(l),i=e.getLength(l),r=$e.WALL_DIRECTION_VECTORS[s],n=$e.WALL_NORMAL_VECTORS[s],a=0,o=0;o<i;){if(this.getTileHeightInternal(t.x+o*r.x-n.x,t.y+o*r.y-n.y)==dt.TILE_HOLE){if(o>0&&a==0){e.setLength(l,o);break}a++}else if(a>0){e.moveCorner(l,a);break}o++}a==i&&e.setHideWall(l,!0)}l++}}resolveOriginalWallIndex(e,t,s){let i,r,n,a,o,u;const l=Math.min(e.y,t.y),c=Math.max(e.y,t.y),g=Math.min(e.x,t.x),f=Math.max(e.x,t.x),R=s.count;let m=0;for(;m<R;){if(i=s.getCorner(m),r=s.getEndPoint(m),e.x==t.x){if(i.x==e.x&&r.x==e.x&&(n=Math.min(i.y,r.y),a=Math.max(i.y,r.y),n<=l&&c<=a))return m}else if(e.y==t.y&&i.y==e.y&&r.y==e.y&&(o=Math.min(i.x,r.x),u=Math.max(i.x,r.x),o<=g&&f<=u))return m;m++}return-1}hideOriginallyHiddenWalls(e,t){let s,i,r,n,a;const o=e.count;let u=0;for(;u<o;)e.getHideWall(u)||(s=e.getCorner(u),i=new Y(s.x,s.y),r=$e.WALL_DIRECTION_VECTORS[e.getDirection(u)],n=e.getLength(u),i.x=i.x+r.x*n,i.y=i.y+r.y*n,a=this.resolveOriginalWallIndex(s,i,t),a>=0?t.getHideWall(a)&&e.setHideWall(u,!0):e.setHideWall(u,!0)),u++}checkWallHiding(e,t){this.hidePeninsulaWallChains(t),this.updateWallsNextToHoles(e),this.hideOriginallyHiddenWalls(e,t)}addWalls(e,t){const s=e.count,i=t.count;let r=0;for(;r<s;){if(!e.getHideWall(r)){const n=e.getCorner(r),a=e.getDirection(r),o=e.getLength(r),u=$e.WALL_DIRECTION_VECTORS[a],l=$e.WALL_NORMAL_VECTORS[a];let c=-1,g=0;for(;g<o;){const X=this.getTileHeightInternal(n.x+g*u.x+l.x,n.y+g*u.y+l.y);X>=0&&(X<c||c<0)&&(c=X),g++}const f=c;let R=new I(n.x,n.y,f);R=I.sum(R,I.product(l,.5)),R=I.sum(R,I.product(u,-.5));const m=this.wallHeight+Math.min(dt.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-c,T=I.product(u,-o),O=new I(0,0,m);R=I.dif(R,T);const C=this.resolveOriginalWallIndex(n,e.getEndPoint(r),t);let N=0,S=0;C>=0?(N=t.getDirection((C+1)%i),S=t.getDirection((C-1+i)%i)):(N=e.getDirection((r+1)%s),S=e.getDirection((r-1+s)%s));let D=null;(N-a+4)%4==3?D=$e.WALL_NORMAL_VECTORS[N]:(a-S+4)%4==3&&(D=$e.WALL_NORMAL_VECTORS[S]);const v=e.getLeftTurn(r),b=e.getLeftTurn((r-1+s)%s),w=e.getHideWall((r+1)%s),Q=e.getManuallyLeftCut(r),$=e.getManuallyRightCut(r);this.addWall(R,T,O,D,!b||Q,!v||$,!w)}r++}}createWallPlanes(){const e=this._tileMatrix;if(e==null)return!1;let t,s,i;const r=e.length;let n=0;if(r==0)return!1;for(t=0;t<r;){if(i=e[t],i==null||i.length==0)return!1;n>0?n=Math.min(n,i.length):n=i.length,t++}const a=Math.min(dt.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:dt.getFloorHeight(e)),o=this.minX;let u=this.minY;for(u=this.minY;u<=this.maxY;){if(this.getTileHeightInternal(o,u)>dt.TILE_HOLE){u--;break}u++}if(u>this.maxY)return!1;const l=new Y(o,u),c=this.generateWallData(l,!0),g=this.generateWallData(l,!1);for(c!=null&&(c.count,g.count,this.checkWallHiding(c,g),this.addWalls(c,g)),s=0;s<this.tileMapHeight;){for(t=0;t<this.tileMapWidth;)this.getTileHeightInternal(t,s)<0&&this.setTileHeight(t,s,-(a+this.wallHeight)),t++;s++}return!0}extractTopWall(e,t){if(e==null)return null;let s=1,i=dt.TILE_HOLE;for(t||(i=dt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x+s,e.y)>i)return new Y(e.x+s-1,e.y);if(this.getTileHeightInternal(e.x+s,e.y+1)<=i)return new Y(e.x+s,e.y+1);s++}return null}extractRightWall(e,t){if(e==null)return null;let s=1,i=dt.TILE_HOLE;for(t||(i=dt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x,e.y+s)>i)return new Y(e.x,e.y+(s-1));if(this.getTileHeightInternal(e.x-1,e.y+s)<=i)return new Y(e.x-1,e.y+s);s++}return null}extractBottomWall(e,t){if(e==null)return null;let s=1,i=dt.TILE_HOLE;for(t||(i=dt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x-s,e.y)>i)return new Y(e.x-(s-1),e.y);if(this.getTileHeightInternal(e.x-s,e.y-1)<=i)return new Y(e.x-s,e.y-1);s++}return null}extractLeftWall(e,t){if(e==null)return null;let s=1,i=dt.TILE_HOLE;for(t||(i=dt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x,e.y-s)>i)return new Y(e.x,e.y-(s-1));if(this.getTileHeightInternal(e.x+1,e.y-s)<=i)return new Y(e.x+1,e.y-s);s++}return null}addWall(e,t,s,i,r,n,a){this.addPlane(pt.PLANE_WALL,e,t,s,[i]),this.addPlane(pt.PLANE_LANDSCAPE,e,t,s,[i]);const o=dt.WALL_THICKNESS*this._wallThicknessMultiplier,u=dt.FLOOR_THICKNESS*this._floorThicknessMultiplier,l=I.crossProduct(t,s),c=I.product(l,1/l.length*-o);if(this.addPlane(pt.PLANE_WALL,I.sum(e,s),t,c,[l,i]),r&&this.addPlane(pt.PLANE_WALL,I.sum(I.sum(e,t),s),I.product(s,-(s.length+u)/s.length),c,[l,i]),n&&(this.addPlane(pt.PLANE_WALL,I.sum(e,I.product(s,-u/s.length)),I.product(s,(s.length+u)/s.length),c,[l,i]),a)){const g=I.product(t,o/t.length);this.addPlane(pt.PLANE_WALL,I.sum(I.sum(e,s),I.product(g,-1)),g,c,[l,t,i])}}addFloor(e,t,s,i,r,n,a){let o,u,l;this.addPlane(pt.PLANE_FLOOR,e,t,s)!=null&&(o=dt.FLOOR_THICKNESS*this._floorThicknessMultiplier,u=new I(0,0,o),l=I.dif(e,u),n&&this.addPlane(pt.PLANE_FLOOR,l,t,u),a&&this.addPlane(pt.PLANE_FLOOR,I.sum(l,I.sum(t,s)),I.product(t,-1),u),i&&this.addPlane(pt.PLANE_FLOOR,I.sum(l,s),I.product(s,-1),u),r&&this.addPlane(pt.PLANE_FLOOR,I.sum(l,t),s,u))}initializeFromMapData(e){if(!e)return!1;this.reset(),this.resetFloorHoles();const t=e.width,s=e.height,i=e.wallHeight,r=e.fixedWallsHeight;if(this.initializeTileMap(t,s),e.tileMap){let n=0;for(;n<e.tileMap.length;){const a=e.tileMap[n];if(a){let o=0;for(;o<a.length;){const u=a[o];u&&this.setTileHeight(o,n,u.height),o++}}n++}}if(e.holeMap&&e.holeMap.length){let n=0;for(;n<e.holeMap.length;){const a=e.holeMap[n];a&&(this.addFloorHole(a.id,a.x,a.y,a.width,a.height),n++)}this.initializeHoleMap()}return this.wallHeight=i,this.restrictsDragging=e.restrictsDragging,this.restrictsScaling=e.restrictsScaling,this.restrictedScale=e.restrictedScale,this.initializeFromTileData(r),!0}addPlane(e,t,s,i,r=null){if(s.length==0||i.length==0)return null;const n=new pt(e,t,s,i,r);return this._planes.push(n),n}getMapData(){const e=new Qg;e.width=this._width,e.height=this._height,e.wallHeight=this._wallHeight,e.fixedWallsHeight=this._fixedWallHeight,e.dimensions.minX=this.minX,e.dimensions.maxX=this.maxX,e.dimensions.minY=this.minY,e.dimensions.maxY=this.maxY,e.restrictsDragging=this.restrictsDragging,e.restrictsScaling=this.restrictsScaling,e.restrictedScale=this.restrictedScale;let t=0;for(;t<this._height;){const s=[],i=this._tileMatrixOriginal[t];let r=0;for(;r<this._width;){const n=i[r];s.push({height:n}),r++}e.tileMap.push(s),t++}for(const[s,i]of this._floorHoles.entries())i&&e.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return e}getPlaneLocation(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.loc:null}getPlaneNormal(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.normal:null}getPlaneLeftSide(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.leftSide:null}getPlaneRightSide(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.rightSide:null}getPlaneNormalDirection(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.normalDirection:null}getPlaneSecondaryNormals(e){let t,s;if(e<0||e>=this.planeCount)return null;const i=this._planes[e];if(i!=null){for(t=[],s=0;s<i.secondaryNormalCount;)t.push(i.getSecondaryNormal(s)),s++;return t}return null}getPlaneType(e){if(e<0||e>=this.planeCount)return pt.PLANE_UNDEFINED;const t=this._planes[e];return t?t.type:pt.PLANE_UNDEFINED}getPlaneMaskCount(e){if(e<0||e>=this.planeCount)return 0;const t=this._planes[e];return t?t.maskCount:0}getPlaneMaskLeftSideLoc(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskLeftSideLoc(t):-1}getPlaneMaskRightSideLoc(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskRightSideLoc(t):-1}getPlaneMaskLeftSideLength(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskLeftSideLength(t):-1}getPlaneMaskRightSideLength(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskRightSideLength(t):-1}addFloorHole(e,t,s,i,r){this.removeFloorHole(e),this._floorHoles.set(e,new qG(t,s,i,r))}removeFloorHole(e){this._floorHoles.delete(e)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let e,t,s,i,r,n,a,o;for(t=0;t<this._height;){for(s=this._floorHoleMatrix[t],e=0;e<this._width;)s[e]=!1,e++;t++}for(const u of this._floorHoles.values())if(i=u,i!=null)for(r=i.x,n=i.x+i.width-1,a=i.y,o=i.y+i.height-1,r=r<0?0:r,n=n>=this._width?this._width-1:n,a=a<0?0:a,o=o>=this._height?this._height-1:o,t=a;t<=o;){for(s=this._floorHoleMatrix[t],e=r;e<=n;)s[e]=!0,e++;t++}}extractPlanes(e){let t,s,i,r,n,a,o,u,l,c,g,f,R,m,T;const O=e.length,C=e[0].length,N=[];let S=0;for(;S<O;)N[S]=[],S++;let D=0;for(;D<O;){for(t=0;t<C;){if(s=e[D][t],!(s<0||N[D][t])){for(n=t==0||e[D][t-1]!=s,a=D==0||e[D-1][t]!=s,i=t+1;i<C&&!(e[D][i]!=s||N[D][i]||D>0&&e[D-1][i]==s==a);)i++;for(o=i==C||e[D][i]!=s,g=!1,r=D+1;r<O&&!g;){for(u=e[r][t]!=s,g=u||t>0&&e[r][t-1]==s==n||i<C&&e[r][i]==s==o,l=t;l<i;){if(e[r][l]==s==u){g=!0,i=l;break}l++}if(g)break;r++}for(u=u||r==O,o=i==C||e[D][i]!=s,c=D;c<r;){for(l=t;l<i;)N[c][l]=!0,l++;c++}f=t/4-.5,R=D/4-.5,m=(i-t)/4,T=(r-D)/4,this.addFloor(new I(f+m,R+T,s/4),new I(-m,0,0),new I(0,-T,0),o,n,u,a)}t++}D++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(e){this._restrictsDragging=e}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get restrictedScale(){return this._restrictedScale}set restrictedScale(e){this._restrictedScale=e}};let Lt=dt;Lt.FLOOR_THICKNESS=.25;Lt.WALL_THICKNESS=.25;Lt.MAX_WALL_ADDITIONAL_HEIGHT=20;Lt.TILE_BLOCKED=-110;Lt.TILE_HOLE=-100;class QG extends ya{constructor(){super(),this._planeParser=new Lt,this._planeBitmapMaskParser=new Jg,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const t=[V.MOUSE_MOVE,V.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){!t||!this.object||t instanceof Qg&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(d.ROOM_MAP_DATA,t),this.object.model.setValue(d.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(d.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(d.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(d.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=W.getValue("room.color.skip.transition")===!0)}update(t){if(super.update(t),this.updateBackgroundColor(t),this._needsMapUpdate){if(this._lastHoleUpdate&&t-this._lastHoleUpdate<5)return;const s=this.object&&this.object.model;if(s){const i=this._planeParser.getMapData();s.setValue(d.ROOM_MAP_DATA,i),s.setValue(d.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(i)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(t){if(!this.object||!this._colorChangedTime)return;let s=this._color,i=this._light;if(t-this._colorChangedTime>=this._colorTransitionLength)s=this._targetColor,i=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,a=this._originalColor>>8&255,o=this._originalColor&255;const u=this._targetColor>>16&255,l=this._targetColor>>8&255,c=this._targetColor&255,g=(t-this._colorChangedTime)/this._colorTransitionLength;n=n+(u-n)*g,a=a+(l-a)*g,o=o+(c-o)*g,s=(n<<16)+(a<<8)+o,i=this._originalLight+(this._targetLight-this._originalLight)*g,this._color=s,this._light=i}let r=ia.rgbToHSL(s);r=(r&16776960)+i,s=ia.hslToRGB(r),this.object.model&&this.object.model.setValue(d.ROOM_BACKGROUND_COLOR,s)}processUpdateMessage(t){if(!t||!this.object)return;const s=this.object.model;if(s){if(t instanceof zt){this.onObjectRoomUpdateMessage(t,s);return}if(t instanceof Wt){this.onObjectRoomMaskUpdateMessage(t,s);return}if(t instanceof Ps){this.onObjectRoomPlaneVisibilityUpdateMessage(t,s);return}if(t instanceof Ds){this.onObjectRoomPlanePropertyUpdateMessage(t,s);return}if(t instanceof Ns){this.onObjectRoomFloorHoleUpdateMessage(t,s);return}if(t instanceof ma){this.onObjectRoomColorUpdateMessage(t,s);return}t instanceof Oh&&this.onObjectRoomMapUpdateMessage(t)}}onObjectRoomUpdateMessage(t,s){switch(t.type){case zt.ROOM_FLOOR_UPDATE:s.setValue(d.ROOM_FLOOR_TYPE,t.value);return;case zt.ROOM_WALL_UPDATE:s.setValue(d.ROOM_WALL_TYPE,t.value);return;case zt.ROOM_LANDSCAPE_UPDATE:s.setValue(d.ROOM_LANDSCAPE_TYPE,t.value);return}}onObjectRoomMaskUpdateMessage(t,s){let i=null,r=!1;switch(t.type){case Wt.ADD_MASK:i=Li.WINDOW,t.maskCategory===Wt.HOLE&&(i=Li.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,i),r=!0;break;case Wt.REMOVE_MASK:r=this._planeBitmapMaskParser.removeMask(t.maskId);break}r&&s.setValue(d.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(t,s){let i=0;switch(t.visible&&(i=1),t.type){case Ps.FLOOR_VISIBILITY:s.setValue(d.ROOM_FLOOR_VISIBILITY,i);return;case Ps.WALL_VISIBILITY:s.setValue(d.ROOM_WALL_VISIBILITY,i),s.setValue(d.ROOM_LANDSCAPE_VISIBILITY,i);return}}onObjectRoomPlanePropertyUpdateMessage(t,s){switch(t.type){case Ds.FLOOR_THICKNESS:s.setValue(d.ROOM_FLOOR_THICKNESS,t.value);return;case Ds.WALL_THICKNESS:s.setValue(d.ROOM_WALL_THICKNESS,t.value);return}}onObjectRoomFloorHoleUpdateMessage(t,s){switch(t.type){case Ns.ADD:this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),this._needsMapUpdate=!0;return;case Ns.REMOVE:this._planeParser.removeFloorHole(t.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(t,s){!t||!s||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=t.color,this._targetLight=t.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,s.setValue(d.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}onObjectRoomMapUpdateMessage(t){!t||!t.mapData||(this.object.model.setValue(d.ROOM_MAP_DATA,t.mapData),this.object.model.setValue(d.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(t.mapData))}mouseEvent(t,s){if(!t||!s||!this.object||!this.object.model)return;const i=t.spriteTag;let r=0;if(i&&i.indexOf("@")>=0&&(r=parseInt(i.substr(i.indexOf("@")+1))),r<1||r>this._planeParser.planeCount){t.type===F.ROLL_OUT&&this.object.model.setValue(d.ROOM_SELECTED_PLANE,0);return}r--;let n=null;const a=this._planeParser.getPlaneLocation(r),o=this._planeParser.getPlaneLeftSide(r),u=this._planeParser.getPlaneRightSide(r),l=this._planeParser.getPlaneNormalDirection(r),c=this._planeParser.getPlaneType(r);if(a==null||o==null||u==null||l==null)return;const g=o.length,f=u.length;if(g==0||f==0)return;const R=t.screenX,m=t.screenY,T=new Y(R,m);if(n=s.getPlanePosition(T,a,o,u),!n){this.object.model.setValue(d.ROOM_SELECTED_PLANE,0);return}const O=I.product(o,n.x/g);O.add(I.product(u,n.y/f)),O.add(a);const C=O.x,N=O.y,S=O.z;if(n.x>=0&&n.x<g&&n.y>=0&&n.y<f)this.object.model.setValue(d.ROOM_SELECTED_X,C),this.object.model.setValue(d.ROOM_SELECTED_Y,N),this.object.model.setValue(d.ROOM_SELECTED_Z,S),this.object.model.setValue(d.ROOM_SELECTED_PLANE,r+1);else{this.object.model.setValue(d.ROOM_SELECTED_PLANE,0);return}let D=null;switch(t.type===F.MOUSE_MOVE||t.type===F.ROLL_OVER?D=V.MOUSE_MOVE:t.type===F.MOUSE_CLICK&&(D=V.CLICK),t.type){case F.MOUSE_MOVE:case F.ROLL_OVER:case F.MOUSE_CLICK:{let v=null;if(c===pt.PLANE_FLOOR)v=new us(D,this.object,t.eventId,C,N,S,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(c===pt.PLANE_WALL||c===pt.PLANE_LANDSCAPE){let b=90;l&&(b=l.x+90,b>360&&(b-=360));const w=o.length*n.x/g,Q=u.length*n.y/f;v=new Yi(D,this.object,t.eventId,a,o,u,w,Q,b,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(v);return}}}}class JG extends ya{initialize(t){this.object&&(this.object.model.setValue(d.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof ys&&this.object)switch(t.type){case ys.ENABLED:this.object.setState(0,0);return;case ys.DISABLED:this.object.setState(1,0);return}}}const Ki=class extends ya{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(e){this.object&&(this.object.model.setValue(d.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(Ki.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(e){e instanceof Wi&&(this._lastEventId&&this._lastEventId===e.sourceEventId||(e.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(e),this.object&&(this._isHidden?this.object.setState(Ki.CURSOR_HIDDEN_STATE,0):e.visible?(this.object.model.setValue(d.TILE_CURSOR_HEIGHT,e.height),this.object.setState(e.height>.8?Ki.CURSOR_HEIGHT_STATE:Ki.CURSOR_VISIBLE_STATE)):this.object.setState(Ki.CURSOR_HIDDEN_STATE,0)),this._lastEventId=e.sourceEventId))}};let Qa=Ki;Qa.CURSOR_VISIBLE_STATE=0;Qa.CURSOR_HIDDEN_STATE=1;Qa.CURSOR_HEIGHT_STATE=6;class Zg{constructor(t,s,i){this._id=t,this._type=s,this._visualization=i}dispose(){this._visualization=null}update(t,s){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const js=class extends Zg{constructor(e,t,s){super(e,t,s),this._asset=null,this._startTime=Z(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(e,t){if(!e)return;this._scale=t;let s=64,i=0;if(t<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?i=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=6:i=-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?i=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=22:i=-30,this._offsetY=-70),this.visualization.posture===P.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===P.POSTURE_LAY&&(this._offsetY+=s),this._asset){e.texture=this._asset,e.offsetX=i,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0;const r=this._delta;this.animate(e),this._delta=r}}animate(e){if(!e)return!1;if(this._asset&&(e.texture=this._asset),this._state===js.STATE_DELAY)return Z()-this._startTime<js.DELAY_BEFORE_ANIMATION?!1:(this._state=js.STATE_FADE_IN,e.alpha=0,e.visible=!0,this._delta=0,!0);if(this._state===js.STATE_FADE_IN)return this._delta+=.1,e.offsetY=this._offsetY,e.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(e.alpha=255,this._delta=0,this._state=js.STATE_FLOAT),!0;if(this._state===js.STATE_FLOAT){const t=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return e.offsetY=this._offsetY+(this._delta<1?t:1)*s,e.alpha=(1-t)*255,e.alpha<=0&&(e.visible=!1,this._state=js.STATE_COMPLETE),!0}return!1}};let Tr=js;Tr.DELAY_BEFORE_ANIMATION=300;Tr.STATE_DELAY=0;Tr.STATE_FADE_IN=1;Tr.STATE_FLOAT=2;Tr.STATE_COMPLETE=3;class pr{static getExpressionAddition(t,s,i){switch(s){case this.BLOW:return new Tr(t,this.BLOW,i);default:return new Zg(t,s,i)}}}pr.WAVE=1;pr.BLOW=2;pr.LAUGH=3;pr.CRY=4;pr.IDLE=5;const Ge=class{constructor(e,t){this._id=e,this._visualization=t,this._asset=null,this._startTime=Z(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(e){let t="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(t="right"),"avatar_addition_user_idle_"+t+"_"+e+(this._scale<48?"_small":"")}update(e,t){if(!e)return;this._scale=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===Ge.STATE_FRAME_A?1:2));let s=64,i=0;t<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=10:i=-16,this._offsetY=-38,s=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=22:i=-30,this._offsetY=-70),this._visualization.posture===P.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===P.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(e.texture=this._asset,e.offsetX=i,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0)}animate(e){if(!e)return!1;const t=Z();return this._state===Ge.STATE_DELAY&&t-this._startTime>=Ge.DELAY_BEFORE_ANIMATION&&(this._state=Ge.STATE_FRAME_A,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===Ge.STATE_FRAME_A&&t-this._startTime>=Ge.DELAY_PER_FRAME&&(this._state=Ge.STATE_FRAME_B,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===Ge.STATE_FRAME_B&&t-this._startTime>=Ge.DELAY_PER_FRAME&&(this._state=Ge.STATE_FRAME_A,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(e.texture=this._asset,e.alpha=255,e.visible=!0):e.visible=!1,!1}get id(){return this._id}};let Or=Ge;Or.DELAY_BEFORE_ANIMATION=2e3;Or.DELAY_PER_FRAME=2e3;Or.STATE_DELAY=0;Or.STATE_FRAME_A=1;Or.STATE_FRAME_B=2;const wr=class{constructor(e){this._id=e,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(e,t){if(e){if(!this._asset){const s=new Nt(Dt.WHITE);s.alpha=0,s.width=wr.WIDTH,s.height=wr.HEIGHT,this._asset=Ot.generateTexture(s)}e.visible=!0,e.texture=this._asset,e.offsetX=wr.OFFSET_X,e.offsetY=wr.OFFSET_Y,e.alphaTolerance=Le.MATCH_ALL_PIXELS}}animate(e){return!1}get id(){return this._id}};let Tn=wr;Tn.WIDTH=46;Tn.HEIGHT=60;Tn.OFFSET_X=-23;Tn.OFFSET_Y=-48;class ZG{constructor(t,s,i){this._id=t,this._visualization=s,this._asset=null,this._relativeDepth=0,this._status=i}dispose(){this._visualization=null,this._asset=null}update(t,s){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let i=64,r=0,n=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===He.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),s<48?(r=-19,n=-80,i=32):(r=-19,n=-120),this._visualization.posture===P.POSTURE_SIT?n+=i/2:this._visualization.posture===P.POSTURE_LAY&&(n+=s),this._asset&&(t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class $G{constructor(t,s){this._id=t,this._visualization=s,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(t,s){if(!t)return;let i=64,r=0,n=0;s<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),i=32,r=-12,n=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),r=-15,n=-110),this._visualization.posture===P.POSTURE_SIT?n+=i/2:this._visualization.posture===P.POSTURE_LAY&&(n+=s),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.02):t.visible=!1}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}}class tB{constructor(t,s,i){this._id=t,this._visualization=i,this._asset=null,this._scale=0,this._number=s,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,s){if(!t)return;this._scale=s;let i=64,r=0,n=0;this._number>0?(s<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),i=32,r=-6,n=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),r=-8,n=-105),this._visualization.posture===P.POSTURE_SIT?n+=i/2:this._visualization.posture===P.POSTURE_LAY&&(n+=s),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let s=t.alpha,i=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?t.offsetY-=2:t.offsetY-=4;else{let r=4;this._scale<48&&(r=8),this._numberValueMoveCounter%r||(t.offsetY--,i=!0)}}return this._numberValueFadeDirection>0?(s<255&&(s+=32),s>=255&&(s=255,this._numberValueFadeDirection=0),t.alpha=s,!0):this._numberValueFadeDirection<0?(s>=0&&(s-=32),s<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,s=0,t.visible=!1),t.alpha=s,!0):i}get id(){return this._id}}class eB{constructor(t,s){this._id=t,this._visualization=s,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,s){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let i=64,r=0,n=0;s<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),r=3,n=-42,i=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),r=14,n=-83),this._visualization.posture===P.POSTURE_SIT?n+=i/2:this._visualization.posture===P.POSTURE_LAY&&(n+=s),this._asset&&(t.texture=this._asset,t.offsetX=r,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class Ia extends Ie{constructor(){super()}initialize(t){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(t,s,i=null,r=null,n=null){let a=null;return s>48?a=this._avatarRenderer.createAvatarImage(t,ss.LARGE,i,r,n):a=this._avatarRenderer.createAvatarImage(t,ss.SMALL,i,r,n),a}getAvatarRendererAsset(t){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(t):null}get avatarManager(){return this._avatarRenderer}set avatarManager(t){this._avatarRenderer=t}get layerCount(){return 0}}const z=class extends an{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new Gt,this._cachedAvatarEffects=new Gt,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(e){return e instanceof Ia?(this._data=e,this.createSprites(z.INITIAL_RESERVED_SPRITES),super.initialize(e),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(e,t,s,i){if(!this.object||!e||!this._data||t<this._lastUpdate+z.UPDATE_TIME_INCREASER)return;this._lastUpdate+=z.UPDATE_TIME_INCREASER,this._lastUpdate+z.UPDATE_TIME_INCREASER<t&&(this._lastUpdate=t-z.UPDATE_TIME_INCREASER);const r=this.object.model,n=e.scale,a=this._effect;let o=!1,u=!1,l=!1,c=!1;const g=this.updateModel(r,n);if(g||n!==this._scale||!this._avatarImage){if(n!==this._scale&&(o=!0,this.updateScale(n)),a!==this._effect&&(u=!0),o||!this._avatarImage||u){if(this._avatarImage=this.createAvatarImage(n,this._effect),!this._avatarImage)return;l=!0;const m=this.getSprite(z.AVATAR_LAYER_ID);m&&this._avatarImage&&this._avatarImage.isPlaceholder()?m.alpha=150:m&&(m.alpha=255)}if(!this._avatarImage)return;if(u&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(n),c=this.updateObject(this.object,e,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let m=this._extraSpritesStartIndex;for(const T of this._additions.values())T.update(this.getSprite(m++),n)}this._scale=n}else c=this.updateObject(this.object,e,s);if(this._additions){let m=this._extraSpritesStartIndex;for(const T of this._additions.values())T.animate(this.getSprite(m++))&&this.updateSpriteCounter++}const f=c||g||o,R=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(f&&(this._forcedAnimFrames=z.ANIMATION_FRAME_UPDATE_INTERVAL),f||R){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||o||g||l)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=z.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let m=this._avatarImage.getCanvasOffsets();(!m||m.length<3)&&(m=z.DEFAULT_CANVAS_OFFSETS);const T=this.getSprite(z.SPRITE_INDEX_AVATAR);if(T){const S=this.object.model.getValue(d.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(d.FIGURE_HIGHLIGHT)===1,D=this._avatarImage.getImage(ee.FULL,S);D&&(T.texture=D,S||(T.filters=[])),T.texture&&(T.offsetX=-1*n/2+m[0]-(T.texture.width-n)/2,T.offsetY=-T.texture.height+n/4+m[1]+this._postureOffset),this._isLaying?this._layInside?T.relativeDepth=-.5:T.relativeDepth=z.AVATAR_SPRITE_LAYING_DEPTH+m[2]:T.relativeDepth=z.AVATAR_SPRITE_DEFAULT_DEPTH+m[2],this._ownUser?(T.relativeDepth-=z.AVATAR_OWN_DEPTH_ADJUST,T.spriteType=he.AVATAR_OWN):T.spriteType=he.AVATAR}const O=this.getAddition(z.TYPING_BUBBLE_ID);O&&(this._isLaying?O.relativeDepth=z.AVATAR_SPRITE_LAYING_DEPTH-.01+m[2]:O.relativeDepth=z.AVATAR_SPRITE_DEFAULT_DEPTH-.01+m[2]),this._isAnimating=this._avatarImage.isAnimating();let C=z.INITIAL_RESERVED_SPRITES;const N=this._avatarImage.getDirection();for(const S of this._avatarImage.getSprites())if(S.id===z.AVATAR){const D=this.getSprite(z.SPRITE_INDEX_AVATAR);if(D){const v=this._avatarImage.getLayerData(S);let b=S.getDirectionOffsetX(N),w=S.getDirectionOffsetY(N);v&&(b+=v.dx,w+=v.dy),n<48&&(b/=2,w/=2),this._canStandUp||(D.offsetX+=b,D.offsetY+=w)}}else{const D=this.getSprite(C);if(D){D.alphaTolerance=Le.MATCH_NOTHING,D.visible=!0;const v=this._avatarImage.getLayerData(S);let b=0,w=S.getDirectionOffsetX(N),Q=S.getDirectionOffsetY(N);const $=S.getDirectionOffsetZ(N);let X=0;S.hasDirections&&(X=N),v&&(b=v.animationFrame,w+=v.dx,Q+=v.dy,X+=v.dd),n<48&&(w/=2,Q/=2),X<0?X+=8:X>7&&(X-=8);const Ct=this._avatarImage.getScale()+"_"+S.member+"_"+X+"_"+b,Ht=this._avatarImage.getAsset(Ct);if(!Ht)continue;D.texture=Ht.texture,D.offsetX=Ht.offsetX-n/2+w,D.offsetY=Ht.offsetY+Q,D.flipH=Ht.flipH,S.hasStaticY?D.offsetY+=this._verticalOffset*n/(2*z.BASE_Y_SCALE):D.offsetY+=this._postureOffset,this._isLaying?D.relativeDepth=z.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*$:D.relativeDepth=z.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*$,S.ink===33?D.blendMode=Ss.ADD:D.blendMode=Ss.NORMAL}C++}}}createAvatarImage(e,t){let s=null,i="avatarImage"+e.toString();if(t?(i+="-"+t,s=this._cachedAvatarEffects.getValue(i)):s=this._cachedAvatars.getValue(i),!s&&(s=this._data.createAvatarImage(this._figure,e,this._gender,this,this),s))if(!t)this._cachedAvatars.add(i,s);else{if(this._cachedAvatarEffects.length>=z.MAX_EFFECT_CACHE){const r=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));r&&r.dispose()}this._cachedAvatarEffects.add(i,s)}return s}updateObject(e,t,s,i=!1){if(!i&&this.updateObjectCounter===e.updateCounter&&this._geometryUpdateCounter===t.updateId)return!1;let r=e.getDirection().x-t.direction.x,n=this._headDirection-t.direction.x;return this._posture==="float"&&(n=r),r=(r%360+360)%360,n=(n%360+360)%360,this._posture==="sit"&&this._canStandUp&&(r-=r%90-45,n-=n%90-45),(r!==this._angle||i)&&(s=!0,this._angle=r,r=r-(135-22.5),r=(r+360)%360,this._avatarImage.setDirectionAngle(ee.FULL,r)),(n!==this._headAngle||i)&&(s=!0,this._headAngle=n,this._headAngle!==this._angle&&(n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(ee.HEAD,n))),this._geometryUpdateCounter=t.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(e,t){if(!e||this.updateModelCounter===e.updateCounter)return!1;let s=!1;const i=e.getValue(d.FIGURE_TALK)>0;i!==this._talk&&(this._talk=i,s=!0);const r=e.getValue(d.FIGURE_EXPRESSION);r!==this._expression&&(this._expression=r,s=!0);const n=e.getValue(d.FIGURE_SLEEP)>0;n!==this._sleep&&(this._sleep=n,s=!0);const a=e.getValue(d.FIGURE_BLINK)>0;a!==this._blink&&(this._blink=a,s=!0);const o=e.getValue(d.FIGURE_GESTURE)||0;o!==this._gesture&&(this._gesture=o,s=!0);const u=e.getValue(d.FIGURE_POSTURE);u!==this._posture&&(this._posture=u,s=!0);const l=e.getValue(d.FIGURE_POSTURE_PARAMETER);l!==this._postureParameter&&(this._postureParameter=l,s=!0);const c=e.getValue(d.FIGURE_CAN_STAND_UP);c!==this._canStandUp&&(this._canStandUp=c,s=!0);const g=e.getValue(d.FIGURE_VERTICAL_OFFSET)*z.BASE_Y_SCALE;g!==this._verticalOffset&&(this._verticalOffset=g,s=!0);const f=e.getValue(d.FIGURE_DANCE)||0;f!==this._dance&&(this._dance=f,s=!0);const R=e.getValue(d.FIGURE_EFFECT)||0;R!==this._effect&&(this._effect=R,s=!0);const m=e.getValue(d.FIGURE_CARRY_OBJECT)||0;m!==this._carryObject&&(this._carryObject=m,s=!0);const T=e.getValue(d.FIGURE_USE_OBJECT)||0;T!==this._useObject&&(this._useObject=T,s=!0);const O=e.getValue(d.HEAD_DIRECTION);O!==this._headDirection&&(this._headDirection=O,s=!0),this._carryObject>0&&T>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):this._useObject!==0&&(this._useObject=0,s=!0);let C=this.getAddition(z.FLOATING_IDLE_Z_ID);this._sleep?(C||(C=this.addAddition(new Or(z.FLOATING_IDLE_Z_ID,this))),s=!0):C&&this.removeAddition(z.FLOATING_IDLE_Z_ID);const N=e.getValue(d.FIGURE_IS_MUTED)>0;let S=this.getAddition(z.MUTED_BUBBLE_ID);if(N)S||(S=this.addAddition(new $G(z.MUTED_BUBBLE_ID,this))),s=!0;else{S&&(this.removeAddition(z.MUTED_BUBBLE_ID),s=!0);const pe=e.getValue(d.FIGURE_IS_TYPING)>0;let hs=this.getAddition(z.TYPING_BUBBLE_ID);pe?(hs||(hs=this.addAddition(new eB(z.TYPING_BUBBLE_ID,this))),s=!0):hs&&(this.removeAddition(z.TYPING_BUBBLE_ID),s=!0)}const D=e.getValue(d.FIGURE_GUIDE_STATUS)||0;D!==He.NONE?(this.removeAddition(z.GUIDE_BUBBLE_ID),this.addAddition(new ZG(z.GUIDE_BUBBLE_ID,this,D)),s=!0):this.getAddition(z.GUIDE_BUBBLE_ID)&&(this.removeAddition(z.GUIDE_BUBBLE_ID),s=!0);const v=e.getValue(d.FIGURE_IS_PLAYING_GAME)>0;let b=this.getAddition(z.GAME_CLICK_TARGET_ID);v?(b||(b=this.addAddition(new Tn(z.GAME_CLICK_TARGET_ID))),s=!0):b&&this.removeAddition(z.GAME_CLICK_TARGET_ID);const w=e.getValue(d.FIGURE_NUMBER_VALUE);let Q=this.getAddition(z.NUMBER_BUBBLE_ID);w>0?(Q||(Q=this.addAddition(new tB(z.NUMBER_BUBBLE_ID,w,this))),s=!0):Q&&this.removeAddition(z.NUMBER_BUBBLE_ID);let $=this.getAddition(z.EXPRESSION_ID);this._expression>0?$||($=pr.getExpressionAddition(z.EXPRESSION_ID,this._expression,this),$&&this.addAddition($)):$&&this.removeAddition(z.EXPRESSION_ID),this.updateScale(t);const X=e.getValue(d.GENDER);X!==this._gender&&(this._gender=X,s=!0),this.updateFigure(e.getValue(d.FIGURE))&&(s=!0);let Ct=e.getValue(d.FIGURE_SIGN);Ct===null&&(Ct=-1),this._sign!==Ct&&(this._sign=Ct,s=!0);const Ht=e.getValue(d.FIGURE_HIGHLIGHT_ENABLE)>0;if(Ht!==this._highlightEnabled&&(this._highlightEnabled=Ht,s=!0),this._highlightEnabled){const pe=e.getValue(d.FIGURE_HIGHLIGHT)>0;pe!==this._highlight&&(this._highlight=pe,s=!0)}const re=e.getValue(d.OWN_USER)>0;return re!==this._ownUser&&(this._ownUser=re,s=!0),this.updateModelCounter=e.updateCounter,s}setDirection(e){this._direction!==e&&(this._direction=e,this._needsUpdate=!0)}updateScale(e){e<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=e/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(e){if(!e)return;if(e.initActionAppends(),e.appendAction(P.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(P.GESTURE,P.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(P.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(P.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(P.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(P.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(P.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(P.SLEEP),this._expression>0){const s=P.getExpression(this._expression);if(s!=="")switch(s){case P.DANCE:this._avatarImage.appendAction(P.DANCE,2);break;default:this._avatarImage.appendAction(s);break}}this._effect>0&&this._avatarImage.appendAction(P.EFFECT,this._effect),e.endActionAppends(),this._isAnimating=e.isAnimating();let t=z.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==z.AVATAR&&t++;if(t!==this.totalSprites&&this.createSprites(t),this._extraSpritesStartIndex=t,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(e){return this._figure===e?!1:(this._figure=e,this.clearAvatar(),!0)}resetFigure(e){this.clearAvatar()}resetEffect(e){this.clearAvatar()}clearAvatar(){for(const t of this._cachedAvatars.getValues())t&&t.dispose();for(const t of this._cachedAvatarEffects.getValues())t&&t.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const e=this.getSprite(z.AVATAR_LAYER_ID);e&&(e.texture=Dt.EMPTY,e.alpha=255)}getAddition(e){if(!this._additions)return null;const t=this._additions.get(e);return t||null}addAddition(e){if(!this.getAddition(e.id))return this._additions.set(e.id,e),e}removeAddition(e){const t=this.getAddition(e);t&&(this._additions.delete(t.id),t.dispose())}updateShadow(e){this._shadow=null;const t=this.getSprite(z.SHADOW_LAYER_ID);if(!t)return;let s=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===z.SNOWBOARDING_EFFECT&&(s=!1),s){if(t.visible=!0,!this._shadow||e!==this._scale){let i=0,r=0;e<48?(t.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(t.libraryAssetName),i=-8,r=this._canStandUp?6:-3):(t.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(t.libraryAssetName),i=-17,r=this._canStandUp?10:-7),this._shadow?(t.texture=this._shadow.texture,t.offsetX=i,t.offsetY=r,t.alpha=50,t.relativeDepth=1):t.visible=!1}}else this._shadow=null,t.visible=!1}getAvatarRenderAsset(e){return this._data?this._data.getAvatarRendererAsset(e):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};let vt=z;vt.AVATAR="avatar";vt.FLOATING_IDLE_Z_ID=1;vt.TYPING_BUBBLE_ID=2;vt.EXPRESSION_ID=3;vt.NUMBER_BUBBLE_ID=4;vt.GAME_CLICK_TARGET_ID=5;vt.MUTED_BUBBLE_ID=6;vt.GUIDE_BUBBLE_ID=7;vt.OWN_USER_ID=4;vt.UPDATE_TIME_INCREASER=41;vt.AVATAR_LAYER_ID=0;vt.SHADOW_LAYER_ID=1;vt.SNOWBOARDING_EFFECT=97;vt.INITIAL_RESERVED_SPRITES=2;vt.ANIMATION_FRAME_UPDATE_INTERVAL=2;vt.DEFAULT_CANVAS_OFFSETS=[0,0,0];vt.MAX_EFFECT_CACHE=2;vt.SPRITE_INDEX_AVATAR=0;vt.BASE_Y_SCALE=1e3;vt.AVATAR_SPRITE_DEFAULT_DEPTH=-.01;vt.AVATAR_OWN_DEPTH_ADJUST=.001;vt.AVATAR_SPRITE_LAYING_DEPTH=-.409;const gs=class{static allocate(e,t,s,i,r,n,a=-1,o=0){const u=gs.POOL.length?gs.POOL.pop():new gs;return i<1&&(i=1),r<0&&(r=gs.FRAME_REPEAT_FOREVER),u._id=e,u._x=t||0,u._y=s||0,u._repeats=i,u._frameRepeats=r,u._remainingFrameRepeats=r,u._isLastFrame=n,u._isRecycled=!1,a>=0?(u._activeSequence=a,u._activeSequenceOffset=o):(u._activeSequence=-1,u._activeSequenceOffset=0),u}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?gs.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(e){e<0&&(e=0),this._frameRepeats>0&&e>this._frameRepeats&&(e=this._frameRepeats),this._remainingFrameRepeats=e}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,gs.POOL.length<gs.POOL_SIZE_LIMIT&&gs.POOL.push(this))}};let ns=gs;ns.FRAME_REPEAT_FOREVER=-1;ns.SEQUENCE_NOT_DEFINED=-1;ns.POOL_SIZE_LIMIT=3e3;ns.POOL=[];class $g{constructor(t,s,i,r,n,a){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=s,this._y=i,this._randomX=r,this._randomY=n,this._repeats=a}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class sB extends $g{constructor(t,s,i,r,n,a,o){super(t,s,i,r,n,o),this._directionalOffsets=a}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class iB{constructor(t,s){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=s,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,s=-1,i=1;for(;t>=0;)this._frameIndexes[t]===s?i++:(s=this._frameIndexes[t],i=1),this._frameRepeats[t]=i,t--}addFrame(t,s,i,r,n,a){let o=1;if(this._frames.length>0){const l=this._frames[this._frames.length-1];l.id===t&&!l.hasDirectionalOffsets()&&l.x===s&&l.y===i&&l.randomX===r&&r===0&&l.randomY===n&&n===0&&(o+=l.repeats,this._frames.pop())}const u=a?new sB(t,s,i,r,n,a,o):new $g(t,s,i,r,n,o);this._frames.push(u),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length),t===this._frameIndexes.length&&t--),t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class rB{constructor(t,s,i){this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=s<1?1:s,this._isRandom=i}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,s){const i=new iB(t,s);return this._frameSequences.push(i),i}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,s){if(this._frameCount<1)return null;if(s=s/this._frameRepeat,!this._isRandom){const n=Math.floor(s/this._frameCount);s=Math.floor(s%this._frameCount);let a=!1,o=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(s=this._frameCount-1,a=!0);let u=0,l=0;for(;l<this._frameSequences.length;){if(o=this._frameSequences[l],o){if(s<u+o.frameCount)break;u+=o.frameCount}l++}return this.getFrameFromSpecificSequence(t,o,l,s-u,a)}const i=Math.trunc(this._frameSequences.length*Math.random()),r=this._frameSequences[i];return r.frameCount<1?null:this.getFrameFromSpecificSequence(t,r,i,0,!1)}getFrameFromSequence(t,s,i,r){if(s<0||s>=this._frameSequences.length)return null;const n=this._frameSequences[s];return n?i>=n.frameCount?this.getFrame(t,r):this.getFrameFromSpecificSequence(t,n,s,i,!1):null}getFrameFromSpecificSequence(t,s,i,r,n){if(!s)return null;const a=s.getFrameIndex(r),o=s.getFrame(a);if(!o)return null;let u=o.getX(t),l=o.getY(t);const c=o.randomX,g=o.randomY;let f=o.repeats,R=!1;c&&(u=Math.trunc(u+c*Math.random())),g&&(l=Math.trunc(l+g*Math.random())),f>1&&(f=s.getRepeats(a));let m=this._frameRepeat*f;return n&&(m=ns.FRAME_REPEAT_FOREVER),!this._isRandom&&!s.isRandom&&i===this._frameSequences.length-1&&r===s.frameCount-1&&(R=!0),ns.allocate(o.id,u,l,f,m,R,i,r)}}class tE{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,s){const i=this._offsetX.get(t);return i??s}getYOffset(t,s){const i=this._offsetY.get(t);return i??s}setDirection(t,s,i){this._offsetX.set(t,s),this._offsetY.set(t,i)}}const Xi=class{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(e){return Xi.TRANSITION_TO_ANIMATION_OFFSET+e}static getTransitionFromAnimationId(e){return Xi.TRANSITION_FROM_ANIMATION_OFFSET+e}static isTransitionToAnimation(e){return e>=Xi.TRANSITION_TO_ANIMATION_OFFSET&&e<Xi.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(e){return e>=Xi.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const e of this._layers.values())e&&e.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(e){this._immediateChanges=e}isImmediateChange(e){return!(!this._immediateChanges||this._immediateChanges.indexOf(e)===-1)}getStartFrame(e){return this._randomStart?Math.random()*this._frameCount:0}initialize(e){if(e.randomStart&&(this._randomStart=!0),e.layers)for(const t in e.layers){const s=e.layers[t];if(!s)return!1;const i=parseInt(t),r=s.loopCount!==void 0?s.loopCount:1,n=s.frameRepeat!==void 0?s.frameRepeat:1,a=s.random!==void 0&&s.random!==0;if(!this.addLayer(i,r,n,a,s))return!1}return!0}addLayer(e,t,s,i,r){const n=new rB(t,s,i);if(r.frameSequences)for(const o in r.frameSequences){const u=r.frameSequences[o];if(!u)continue;const l=u.loopCount!==void 0?u.loopCount:1,c=u.random!==void 0&&u.random!==0,g=n.addFrameSequence(l,c);if(u.frames)for(const f in u.frames){const R=u.frames[f];if(!R)return n.dispose(),!1;g.addFrame(R.id,R.x||0,R.y||0,R.randomX||0,R.randomY||0,this.readDirectionalOffsets(R))}g.initialize()}n.calculateLength(),this._layers.set(e,n);const a=n.frameCount;return a>this._frameCount&&(this._frameCount=a),!0}readDirectionalOffsets(e){let t=null;if(e&&e.offsets)for(const s in e.offsets){const i=e.offsets[s];i&&(t||(t=new tE),t.setDirection(i.direction,i.x,i.y))}return t}getFrame(e,t,s){const i=this._layers.get(t);return i?i.getFrame(e,s):null}getFrameFromSequence(e,t,s,i,r){const n=this._layers.get(t);return n?n.getFrameFromSequence(e,s,i,r):null}};let xt=Xi;xt.TRANSITION_TO_ANIMATION_OFFSET=1e6;xt.TRANSITION_FROM_ANIMATION_OFFSET=2e6;xt.DEFAULT_FRAME_NUMBER=0;const U_=class{constructor(e){this._colors=[],this.createColors(e)}createColors(e){if(e)for(let t=0;t<e;t++)this._colors.push(U_.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(e){const t=this._colors[e];return t||U_.DEFAULT_COLOR}setColorLayer(e,t){this._colors[e]&&(this._colors[e]=t)}};let dr=U_;dr.DEFAULT_COLOR=16777215;const Ys=class{constructor(){this._tag=Ys.DEFAULT_TAG,this._ink=Ys.DEFAULT_INK,this._alpha=Ys.DEFAULT_ALPHA,this._ignoreMouse=Ys.DEFAULT_IGNORE_MOUSE,this._xOffset=Ys.DEFAULT_XOFFSET,this._yOffset=Ys.DEFAULT_YOFFSET,this._zOffset=Ys.DEFAULT_ZOFFSET}setFromLayer(e){e&&(this._tag=e.tag,this._ink=e.ink,this._alpha=e.alpha,this._ignoreMouse=e.ignoreMouse,this._xOffset=e.xOffset,this._yOffset=e.yOffset,this._zOffset=e.zOffset)}get tag(){return this._tag}set tag(e){this._tag=e}get ink(){return this._ink}set ink(e){this._ink=e}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(e){this._ignoreMouse=e}get xOffset(){return this._xOffset}set xOffset(e){this._xOffset=e}get yOffset(){return this._yOffset}set yOffset(e){this._yOffset=e}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset=e}};let tt=Ys;tt.DEFAULT_COUNT=0;tt.DEFAULT_DIRECTION=0;tt.DEFAULT_TAG="";tt.DEFAULT_INK=Ss.NORMAL;tt.DEFAULT_ALPHA=255;tt.DEFAULT_IGNORE_MOUSE=!1;tt.DEFAULT_XOFFSET=0;tt.DEFAULT_YOFFSET=0;tt.DEFAULT_ZOFFSET=0;class Mi{constructor(t){this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let s=0;s<t;s++)this._layers.push(new tt)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const s=this.layerCount;if(s===t.layerCount)for(let i=0;i<s;i++){const r=this.getLayer(i),n=t.getLayer(i);r&&r.setFromLayer(n)}}getLayer(t){const s=this._layers[t];return s||null}getLayerTag(t){const s=this.getLayer(t);return s?s.tag:tt.DEFAULT_TAG}setLayerTag(t,s){const i=this.getLayer(t);i&&(i.tag=s)}getLayerInk(t){const s=this.getLayer(t);return s?s.ink:tt.DEFAULT_INK}setLayerInk(t,s){const i=this.getLayer(t);i&&(isNaN(s)||(i.ink=s))}getLayerAlpha(t){const s=this.getLayer(t);return s?s.alpha:tt.DEFAULT_ALPHA}setLayerAlpha(t,s){const i=this.getLayer(t);i&&(isNaN(s)||(i.alpha=s))}getLayerIgnoreMouse(t){const s=this.getLayer(t);return s?s.ignoreMouse:tt.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,s){const i=this.getLayer(t);i&&(i.ignoreMouse=s||!1)}getLayerXOffset(t){const s=this.getLayer(t);return s?s.xOffset:tt.DEFAULT_XOFFSET}setLayerXOffset(t,s){const i=this.getLayer(t);i&&(isNaN(s)||(i.xOffset=s))}getLayerYOffset(t){const s=this.getLayer(t);return s?s.yOffset:tt.DEFAULT_YOFFSET}setLayerYOffset(t,s){const i=this.getLayer(t);i&&(isNaN(s)||(i.yOffset=s))}getLayerZOffset(t){const s=this.getLayer(t);return s?s.zOffset:tt.DEFAULT_ZOFFSET}setLayerZOffset(t,s){const i=this.getLayer(t);i&&(isNaN(s)||(i.zOffset=s))}get layerCount(){return this._layers.length}}Mi.USE_DEFAULT_DIRECTION=-1;const v_=class{constructor(e,t){this._layerCount=e<0?0:e>v_.MAX_LAYERS?v_.MAX_LAYERS:e,this._angle=t<1?1:t>360?360:t,this._defaultDirection=new Mi(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const e of this._directions.values())e&&e.dispose();for(const e of this._colors)e&&e.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(e){return e?this.setDirectionLayers(this._defaultDirection,e):!1}processDirections(e){if(!e)return!1;for(const t in e){const s=e[t];if(!s)continue;const i=parseInt(t);if(this._directions.get(i))return!1;const r=new Mi(this._layerCount);r.setFromDirection(this._defaultDirection),this.setDirectionLayers(r,s.layers),this._directions.set(i,r),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(e){if(!e)return!1;for(const t in e){const s=e[t];if(!s)continue;const i=parseInt(t);if(this._colors[i])return!1;const r=new dr(this._layerCount);for(const n in s.layers){const a=s.layers[n];if(!a)continue;const o=parseInt(n),u=a.color;r.setColorLayer(o,u)}this._colors[i]=r}return!0}setDirectionLayers(e,t){if(!e||!t)return!1;for(const s in t){const i=t[s];if(!i)continue;const r=parseInt(s);if(r<0||r>=this._layerCount)return!1;i.ink!==void 0&&e.setLayerInk(r,zf.inkToBlendMode(i.ink)),i.tag!==void 0&&e.setLayerTag(r,i.tag),i.alpha!==void 0&&e.setLayerAlpha(r,i.alpha),i.ignoreMouse!==void 0&&e.setLayerIgnoreMouse(r,i.ignoreMouse),i.x!==void 0&&e.setLayerXOffset(r,i.x),i.y!==void 0&&e.setLayerYOffset(r,i.y),i.z!==void 0&&e.setLayerZOffset(r,i.z/-1e3)}return!0}getValidDirection(e){if(this._directions.get(e))return e;e=(e%360+360)%360;let s=-1,i=-1;for(const r of this._directions.keys()){let n=(r*this._angle-e+360)%360;n>180&&(n=360-n),(n<s||s<0)&&(s=n,i=r)}return i>=0?Math.trunc(i):0}getDirectionData(e){if(e===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let t=this._directions.get(e);return t||(t=this._defaultDirection),this._lastDirection=e,this._lastDirectionData=t,this._lastDirectionData}getLayerTag(e,t){const s=this.getDirectionData(e);return s?s.getLayerTag(t):tt.DEFAULT_TAG}getLayerInk(e,t){const s=this.getDirectionData(e);return s?s.getLayerInk(t):tt.DEFAULT_INK}getLayerAlpha(e,t){const s=this.getDirectionData(e);return s?s.getLayerAlpha(t):tt.DEFAULT_ALPHA}getLayerColor(e,t){const s=this._colors[t];return s?s.getLayerColor(e):dr.DEFAULT_COLOR}getLayerIgnoreMouse(e,t){const s=this.getDirectionData(e);return s?s.getLayerIgnoreMouse(t):tt.DEFAULT_IGNORE_MOUSE}getLayerXOffset(e,t){const s=this.getDirectionData(e);return s?s.getLayerXOffset(t):tt.DEFAULT_XOFFSET}getLayerYOffset(e,t){const s=this.getDirectionData(e);return s?s.getLayerYOffset(t):tt.DEFAULT_YOFFSET}getLayerZOffset(e,t){const s=this.getDirectionData(e);return s?s.getLayerZOffset(t):tt.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};let Mh=v_;Mh.MAX_LAYERS=26;class Ra extends Mh{constructor(t,s){super(t,s),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const s in t){const i=t[s];if(!i)return!1;let r=parseInt(s.split("_")[0]),n=!1;const a=i.transitionTo,o=i.transitionFrom;a!==void 0&&(r=xt.getTransitionToAnimationId(a),n=!0),o!==void 0&&(r=xt.getTransitionFromAnimationId(o),n=!0);const u=this.createAnimationData();if(!u.initialize(i))return u.dispose(),!1;const l=i.immediateChangeFrom;if(l!==void 0){const c=l.split(","),g=[];for(const f of c){const R=parseInt(f);g.indexOf(R)===-1&&g.push(R)}u.setImmediateChanges(g)}this._animations.set(r,u),n||this._animationIds.push(r)}return!0}createAnimationData(){return new xt}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const s=this.getAnimationCount();return t<0||s<=0?0:this._animationIds[t%s]}isImmediateChange(t,s){const i=this._animations.get(t);return i?i.isImmediateChange(s):!1}getStartFrame(t,s){const i=this._animations.get(t);return i?i.getStartFrame(s):0}getFrame(t,s,i,r){const n=this._animations.get(t);return n?n.getFrame(s,i,r):null}getFrameFromSequence(t,s,i,r,n,a){const o=this._animations.get(t);return o?o.getFrameFromSequence(s,i,r,n,a):null}}class eE{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(t=!0){(t||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let s=0;for(;s<this._layerCount;){if(t||this._frames.length<=s)this._frames[s]=null;else{const i=this._frames[s];i&&(i.recycle(),this._frames[s]=ns.allocate(i.id,i.x,i.y,i.repeats,0,i.isLastFrame))}this._lastFramePlayed[s]=!1,this._animationPlayed[s]=!1,s++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,s){if(t<0||t>=this._layerCount)return;const i=this._frames[t];i&&i.recycle(),this._frames[t]=s}getAnimationPlayed(t){return t<0||t>=this._layerCount?!0:this._animationPlayed[t]}setAnimationPlayed(t,s){t<0||t>=this._layerCount||(this._animationPlayed[t]=s)}getLastFramePlayed(t){return t<0||t>=this._layerCount?!0:this._lastFramePlayed[t]}setLastFramePlayed(t,s){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=s)}}const sE=class extends Ra{constructor(e,t){super(e,t),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(e){if(!e||(e.defaultPosture&&e.defaultPosture.length&&(this._defaultPosture=e.defaultPosture),!e.postures))return!1;for(const t of e.postures)this._posturesToAnimations.get(t.id)||(this._defaultPosture===null&&(this._defaultPosture=t.id),this._posturesToAnimations.set(t.id,t.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(e){if(!e)return!1;for(const t of e)this._gesturesToAnimations.get(t.id)||this._gesturesToAnimations.set(t.id,t.animationId);return!0}postureToAnimation(e){return this._posturesToAnimations.get(e)||(e=this._defaultPosture),this._posturesToAnimations.get(e)}getGestureDisabled(e){return e==="ded"}gestureToAnimation(e){return this._gesturesToAnimations.get(e)?this._gesturesToAnimations.get(e):sE.DEFAULT}animationToPosture(e,t){if(e>=0&&e<this._posturesToAnimations.size){const s=this._posturesToAnimations.keys();for(;;){const i=s.next();if(i.done)return null;if(e<=0)return i.value;--e}}return t?this._defaultPosture:null}animationToGesture(e){if(e>=0&&e<this._gesturesToAnimations.size){const t=this._gesturesToAnimations.keys();for(;;){const s=t.next();if(s.done)return null;if(e<=0)return s.value;--e}}return null}getGestureForAnimationId(e){for(const t of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(t)===e)return t;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};let qi=sE;qi.DEFAULT=-1;class Us{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),t?(this._type=t.name,this.defineVisualizations(t.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,s,i){return new Mh(s,i)}defineVisualizations(t){if(!t)return!1;for(const s in t){const i=t[s],r=i.layerCount,n=i.angle;let a=i.size;if(a<1&&(a=1),this._sizeDatas.get(a))return!1;const o=this.createSizeData(a,r,n);if(!o)return!1;for(const u in i){const l=i[u];if(!this.processVisualElement(o,u,l))return o.dispose(),!1}this._sizeDatas.set(a,o),this._sizes.push(a)}return this._sizes.sort(),!0}processVisualElement(t,s,i){if(!t||!s||!i)return!1;switch(s){case"layers":if(!t.processLayers(i))return!1;break;case"directions":if(!t.processDirections(i))return!1;break;case"colors":if(!t.processColors(i))return!1;break}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const s=this.getSizeIndex(t);let i=-1;return s<this._sizes.length&&(i=this._sizes[s]),this._lastSizeScale=t,this._lastSize=i,i}getSizeIndex(t){if(t<=0)return 0;let s=0,i=1;for(;i<this._sizes.length;){if(this._sizes[i]>t){this._sizes[i]/t<t/this._sizes[i-1]&&(s=i);break}s=i,i++}return s}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const s=this.getSizeIndex(t);return s<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[s]):this._lastSizeData=null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const s=this.getSizeData(t);return s?s.layerCount:tt.DEFAULT_COUNT}getValidDirection(t,s){const i=this.getSizeData(t);return i?i.getValidDirection(s):tt.DEFAULT_DIRECTION}getLayerTag(t,s,i){const r=this.getSizeData(t);return r?r.getLayerTag(s,i):tt.DEFAULT_TAG}getLayerInk(t,s,i){const r=this.getSizeData(t);return r?r.getLayerInk(s,i):tt.DEFAULT_INK}getLayerAlpha(t,s,i){const r=this.getSizeData(t);return r?r.getLayerAlpha(s,i):tt.DEFAULT_ALPHA}getLayerColor(t,s,i){const r=this.getSizeData(t);return r?r.getLayerColor(s,i):dr.DEFAULT_COLOR}getLayerIgnoreMouse(t,s,i){const r=this.getSizeData(t);return r?r.getLayerIgnoreMouse(s,i):tt.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,s,i){const r=this.getSizeData(t);return r?r.getLayerXOffset(s,i):tt.DEFAULT_XOFFSET}getLayerYOffset(t,s,i){const r=this.getSizeData(t);return r?r.getLayerYOffset(s,i):tt.DEFAULT_YOFFSET}getLayerZOffset(t,s,i){const r=this.getSizeData(t);return r?r.getLayerZOffset(s,i):tt.DEFAULT_ZOFFSET}get type(){return this._type}}Us.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];class Ch extends Us{createSizeData(t,s,i){return new Ra(s,i)}processVisualElement(t,s,i){if(!t||!s||!i)return!1;switch(s){case"animations":if(!(t instanceof Ra)||!t.defineAnimations(i))return!1;break;default:if(!super.processVisualElement(t,s,i))return!1;break}return!0}hasAnimation(t,s){const i=this.getSizeData(t);return i?i.hasAnimation(s):null}getAnimationCount(t){const s=this.getSizeData(t);return s?s.getAnimationCount():null}getAnimationId(t,s){const i=this.getSizeData(t);return i?i.getAnimationId(s):null}isImmediateChange(t,s,i){const r=this.getSizeData(t);return r?r.isImmediateChange(s,i):null}getStartFrame(t,s,i){const r=this.getSizeData(t);return r?r.getStartFrame(s,i):null}getFrame(t,s,i,r,n){const a=this.getSizeData(t);return a?a.getFrame(s,i,r,n):null}getFrameFromSequence(t,s,i,r,n,a,o){const u=this.getSizeData(t);return u?u.getFrameFromSequence(s,i,r,n,a,o):null}}const iE=class extends an{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(e){return this.reset(),e instanceof Us?(this._type=e.type,this._data=e,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(e,t){this._cacheDirection===t&&this._cacheScale===e||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=t,this._cacheScale=e,this._cacheSize=this.getValidSize(e),this.setLayerCount((this._data&&this._data.getLayerCount(e)||0)+this.getAdditionalLayerCount()))}update(e,t,s,i){if(!e)return;const r=e.scale;let n=!1;this.updateObject(r,e.direction.x)&&(n=!0),this.updateModel(r)&&(n=!0);let a=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(r):(a=this.updateAnimation(r)|this._animationNumber,this._animationNumber=0),(n||a!==0)&&(this.updateSprites(r,n,a),this._scale=r,this.updateSpriteCounter++)}updateObject(e,t){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&e===this._scale&&this._lastCameraAngle===t)return!1;let s=this.object.getDirection().x-(t+135);if(s=(s%360+360)%360,this._data){const i=this._data.getValidDirection(e,s);this.setDirection(i)}return this._lastCameraAngle=t,this._scale=e,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(e,this._direction),!0}updateModel(e){const t=this.object&&this.object.model;if(!t||this.updateModelCounter===t.updateCounter)return!1;this._selectedColor=t.getValue(d.FURNITURE_COLOR),this._clickUrl=t.getValue(d.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=t.getValue(d.FURNITURE_LIFT_AMOUNT)||0;let s=t.getValue(d.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=t.updateCounter,!0}updateSprites(e,t,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),t){let i=this.totalSprites-1;for(;i>=0;)this.updateSprite(e,i),i--}else{let i=0;for(;s>0;)s&&this.updateSprite(e,i),i++,s=s>>1}this._alphaChanged=!1}updateSprite(e,t){const s=this.getSpriteAssetName(e,t),i=this.getSprite(t);if(s&&i){const r=this.getAsset(s,t);if(r&&r.texture){i.visible=!0,i.type=this._type,i.texture=r.texture,i.flipH=r.flipH,i.flipV=r.flipV,i.direction=this._direction;let n=0;t!==this._shadowLayerIndex?(i.tag=this.getLayerTag(e,this._direction,t),i.alpha=this.getLayerAlpha(e,this._direction,t),i.color=this.getLayerColor(e,t,this._selectedColor),i.offsetX=r.offsetX+this.getLayerXOffset(e,this._direction,t),i.offsetY=r.offsetY+this.getLayerYOffset(e,this._direction,t),i.blendMode=this.getLayerInk(e,this._direction,t),i.alphaTolerance=this.getLayerIgnoreMouse(e,this._direction,t)?Le.MATCH_NOTHING:Le.MATCH_OPAQUE_PIXELS,n=this.getLayerZOffset(e,this._direction,t),n=n-t*.001):(i.offsetX=r.offsetX,i.offsetY=r.offsetY+this.getLayerYOffset(e,this._direction,t),i.alpha=48*this._alphaMultiplier,i.alphaTolerance=Le.MATCH_NOTHING,n=1),i.relativeDepth=n*iE.DEPTH_MULTIPLIER,i.name=s,i.libraryAssetName=this.getLibraryAssetNameForSprite(r,i),i.posture=this.getPostureForAsset(e,r.source),i.clickHandling=this._clickHandling}else this.resetSprite(i)}else i&&this.resetSprite(i)}getLibraryAssetNameForSprite(e,t){return e.source}getPostureForAssetFile(e,t){return null}resetSprite(e){e&&(e.texture=null,e.libraryAssetName="",e.posture="",e.tag="",e.offsetX=0,e.offsetY=0,e.flipH=!1,e.flipV=!1,e.relativeDepth=0,e.clickHandling=!1)}getSpriteAssetName(e,t){if(!this._data||t>=Us.LAYER_LETTERS.length)return"";let s=this._assetNames[t],i=this._updatedLayers[t];return(!s||!s.length)&&(s=this.cacheSpriteAssetName(e,t,!0),i=this._cacheSize!==1),i&&(s+=this.getFrameNumber(e,t)),s}cacheSpriteAssetName(e,t,s){this._type;const i=s?this._cacheSize:this.getValidSize(e);let r="";const n=i!==1;if(t!==this._shadowLayerIndex?r=Us.LAYER_LETTERS[t]||"":r="sd",r==="")return null;const a=this._type+(n?"_"+i+"_"+r+"_"+this._direction+"_":"_icon_"+r);return s&&(this._assetNames[t]=a,this._updatedLayers[t]=n),a}getLayerTag(e,t,s){const i=this._spriteTags[s];if(i!==void 0)return i;if(!this._data)return tt.DEFAULT_TAG;const r=this._data.getLayerTag(e,t,s);return this._spriteTags[s]=r,r}getLayerInk(e,t,s){const i=this._spriteInks[s];if(i!==void 0)return i;if(!this._data)return tt.DEFAULT_INK;const r=this._data.getLayerInk(e,t,s);return this._spriteInks[s]=r,r}getLayerAlpha(e,t,s){if(!this._alphaChanged){const r=this._spriteAlphas[s];if(r!==void 0)return r}if(!this._data)return tt.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(e,t,s);return this._alphaMultiplier!==null&&(i=i*this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(e,t,s){const i=this._spriteColors[t];if(i!==void 0)return i;if(!this._data)return dr.DEFAULT_COLOR;const r=this._data.getLayerColor(e,t,s);return this._spriteColors[t]=r,r}getLayerIgnoreMouse(e,t,s){const i=this._spriteMouseCaptures[s];if(i!==void 0)return i;if(!this._data)return tt.DEFAULT_IGNORE_MOUSE;const r=this._data.getLayerIgnoreMouse(e,t,s);return this._spriteMouseCaptures[s]=r,r}getLayerXOffset(e,t,s){const i=this._spriteXOffsets[s];if(i!==void 0)return i;if(!this._data)return tt.DEFAULT_XOFFSET;const r=this._data.getLayerXOffset(e,t,s);return this._spriteXOffsets[s]=r,r}getLayerYOffset(e,t,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(e/2));const i=this._spriteYOffsets[s];if(i!==void 0)return i;if(!this._data)return tt.DEFAULT_YOFFSET;const r=this._data.getLayerYOffset(e,t,s);return this._spriteYOffsets[s]=r,r}getLayerZOffset(e,t,s){const i=this._spriteZOffsets[s];if(i!==void 0)return i;if(!this._data)return tt.DEFAULT_ZOFFSET;const r=this._data.getLayerZOffset(e,t,s);return this._spriteZOffsets[s]=r,r}getValidSize(e){return this._data?this._data.getValidSize(e):e}setLayerCount(e){this._layerCount=e,this._shadowLayerIndex=e-this.getAdditionalLayerCount()}setDirection(e){this._direction!==e&&(this._direction=e)}getAdditionalLayerCount(){return 1}updateAnimation(e){return 0}getFrameNumber(e,t){return 0}getPostureForAsset(e,t){return null}getAsset(e,t=-1){return this.asset?this.asset.getAsset(e):null}get direction(){return this._direction}get data(){return this._data}};let Bs=iE;Bs.DEPTH_MULTIPLIER=Math.sqrt(.5);Bs.TYPE=y.FURNITURE_STATIC;const b_=class extends Bs{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new eE,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(e){return e instanceof Ch?super.initialize(e):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(e){return this.animationId!==b_.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:b_.DEFAULT_ANIMATION_ID}updateObject(e,t){if(super.updateObject(e,t)){const s=this.object.getState(0);return s!==this._state&&(this.setAnimation(s),this._state=s,this._animationChangeTime=this.object.model.getValue(d.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(e){if(super.updateModel(e)){if(this.usesAnimationResetting()){const s=this.object.model.getValue(d.FURNITURE_STATE_UPDATE_TIME);s>this._animationChangeTime&&(this._animationChangeTime=s,this.setAnimation(this._state))}const t=this.object.model.getValue(d.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(t)){const s=this.data.getAnimationId(this._animationScale,t);this.setAnimation(s)}return!0}return!1}isPlayingTransition(e,t){return!(!xt.isTransitionFromAnimation(e.animationId)&&!xt.isTransitionToAnimation(e.animationId)||t!==e.animationAfterTransitionId||e.animationOver)}getCurrentState(e){const t=e.animationId;return!xt.isTransitionFromAnimation(t)&&!xt.isTransitionToAnimation(t)?t:e.animationAfterTransitionId}setAnimation(e){this.data&&this.setSubAnimation(this._animationData,e,this._state>=0)}setSubAnimation(e,t,s=!0){const i=e.animationId;if(s){if(this.isPlayingTransition(e,t))return!1;const r=this.getCurrentState(e);if(t!==r){if(!this.data.isImmediateChange(this._animationScale,t,r)){let n=xt.getTransitionFromAnimationId(r);this.data.hasAnimation(this._animationScale,n)?(e.animationAfterTransitionId=t,t=n):(n=xt.getTransitionToAnimationId(t),this.data.hasAnimation(this._animationScale,n)&&(e.animationAfterTransitionId=t,t=n))}}else if(xt.isTransitionFromAnimation(e.animationId)){const n=xt.getTransitionToAnimationId(t);this.data.hasAnimation(this._animationScale,n)&&(e.animationAfterTransitionId=t,t=n)}else if(!xt.isTransitionToAnimation(e.animationId)&&this.usesAnimationResetting()){const n=xt.getTransitionFromAnimationId(r);if(this.data.hasAnimation(this._animationScale,n))e.animationAfterTransitionId=t,t=n;else{const a=xt.getTransitionToAnimationId(t);this.data.hasAnimation(this._animationScale,a)&&(e.animationAfterTransitionId=t,t=a)}}}return i!==t?(e.animationId=t,!0):!1}getLastFramePlayed(e){return this._animationData.getLastFramePlayed(e)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(e){if(!this.data)return 0;e!==this._animationScale&&(this._animationScale=e,this._animatedLayerCount=this.data.getLayerCount(e),this.resetAllAnimationFrames());const t=this.updateAnimations(e);return this._directionChanged=!1,t}updateAnimations(e){if(this._animationData.animationOver&&!this._directionChanged)return 0;const t=this.updateFramesForAnimation(this._animationData,e);return this._animationData.animationOver&&(xt.isTransitionFromAnimation(this._animationData.animationId)||xt.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),t}updateFramesForAnimation(e,t){if(e.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(e);let i=e.frameCounter;i||(i=this.data.getStartFrame(t,s,this._direction)),i+=this.frameIncrease,e.frameCounter=i,e.animationOver=!0;let r=!1,n=this._animatedLayerCount-1,a=0,o=1<<this._animatedLayerCount-1;for(;n>=0;){let u=0;if(r=e.getAnimationPlayed(n),!r||this._directionChanged){let l=e.getLastFramePlayed(n),c=e.getFrame(n);c&&c.isLastFrame&&c.remainingFrameRepeats<=this.frameIncrease&&(l=!0),(this._directionChanged||!c||c.remainingFrameRepeats>=0&&(c.remainingFrameRepeats=c.remainingFrameRepeats-this.frameIncrease)<=0)&&(u=ns.SEQUENCE_NOT_DEFINED,c&&(u=c.activeSequence),u===ns.SEQUENCE_NOT_DEFINED?c=this.data.getFrame(t,s,this._direction,n,i):c=this.data.getFrameFromSequence(t,s,this._direction,n,u,c.activeSequenceOffset+c.repeats,i),e.setFrame(n,c),a=a|o),!c||c.remainingFrameRepeats==ns.FRAME_REPEAT_FOREVER?(l=!0,r=!0):e.animationOver=!1,e.setLastFramePlayed(n,l),e.setAnimationPlayed(n,r)}o=o>>1,n--}return a}getFrameNumber(e,t){const s=this._animationData.getFrame(t);return s?s.id:super.getFrameNumber(e,t)}getLayerXOffset(e,t,s){const i=super.getLayerXOffset(e,t,s),r=this._animationData.getFrame(s);return r?i+r.x:i}getLayerYOffset(e,t,s){const i=super.getLayerYOffset(e,t,s),r=this._animationData.getFrame(s);return r?i+r.y:i}usesAnimationResetting(){return!1}setDirection(e){this._direction!==e&&(super.setDirection(e),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};let bt=b_;bt.TYPE=y.FURNITURE_ANIMATED;bt.DEFAULT_ANIMATION_ID=0;const kn=class extends bt{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(e){let t=super.updateModel(e);const s=this.object.model.getValue(d.FURNITURE_BADGE_IMAGE_STATUS),i=this.object.model.getValue(d.FURNITURE_BADGE_ASSET_NAME);if(s===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(s===1&&i!==this._badgeId){this._badgeId=i,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const r=this.object.model.getValue(d.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(r)||(this._badgeVisibleInState=r),t=!0}return t}getSpriteAssetName(e,t){return this.getLayerTag(e,this.direction,t)!==kn.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(e,t):e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(e,t,s){let i=super.getLayerXOffset(e,t,s);if(this.getLayerTag(e,t,s)===kn.BADGE){const r=this.getAsset(e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);r&&(e===64?i+=(40-r.width)/2:i+=(20-r.width)/2)}return i}getLayerYOffset(e,t,s){let i=super.getLayerYOffset(e,t,s);if(this.getLayerTag(e,t,s)===kn.BADGE){const r=this.getAsset(e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);r&&(e===64?i+=(40-r.height)/2:i+=(20-r.height)/2)}return i}};let rE=kn;rE.BADGE="BADGE";const Ti=class extends Bs{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(e,t){return super.updateObject(e,t)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(e){const t=super.updateModel(e);if(t&&(this._offsetX=this.object.model.getValue(d.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(d.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(d.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(d.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return t}checkIfImageChanged(){const e=this.object.model.getValue(d.FURNITURE_BRANDING_IMAGE_URL);return e&&e===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const t=this.object.model.getValue(d.FURNITURE_BRANDING_IMAGE_URL);if(!t||this._imageUrl&&this._imageUrl===t)return!1;if(this.object.model.getValue(d.FURNITURE_BRANDING_IMAGE_STATUS)===1){let i=null;if(this._isAnimated){const r=B.instance.roomEngine.roomContentLoader.getGifCollection(t);r&&(this._gifCollection=r,i=r.textures[0])}else i=Pe().getTexture(t);return i?(this.imageReady(i,t),!0):!1}return!1}imageReady(e,t){if(!e){this._imageUrl=null;return}this._imageUrl=t}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const e=Pe().getTexture(this._imageUrl);if(!e)return;const t=this.object.getState(0);this.addBackgroundAsset(e,t,0)}buildAssetsForGif(){if(!this._gifCollection)return;const e=this._gifCollection.textures,t=this._gifCollection.durations;if(!e.length||!t.length||e.length!==t.length)return;const s=this.object.getState(0);for(let i=0;i<e.length;i++){const r=e[i];t[i],r&&this.addBackgroundAsset(r,s,i)}this._currentFrame=-1,this._totalFrames=e.length}addBackgroundAsset(e,t,s){let i=0,r=0,n=!1,a=!1;switch(t){case Ti.STATE_0:i=0,r=0,n=!1,a=!1;break;case Ti.STATE_1:i=-e.width,r=0,n=!0,a=!1;break;case Ti.STATE_2:i=-e.width,r=-e.height,n=!0,a=!0;break;case Ti.STATE_3:i=0,r=-e.height,n=!1,a=!0;break}this.asset.addAsset(`${this._imageUrl}_${s}`,e,!0,i,r,n,a)}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===Ti.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(e,t)}`:super.getSpriteAssetName(e,t)}updateAnimation(e){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(e,t){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(e,this._direction,t)===Ti.BRANDED_IMAGE&&this._imageUrl){let i=this._currentFrame;return i<0?i=0:i+=1,i===this._totalFrames&&(i=0),this._currentFrame=i,this._currentFrame}return 0}};let gi=Ti;gi.BRANDED_IMAGE="branded_image";gi.STATE_0=0;gi.STATE_1=1;gi.STATE_2=2;gi.STATE_3=3;class nE extends gi{getLayerXOffset(t,s,i){return super.getLayerXOffset(t,s,i)+this._offsetX}getLayerYOffset(t,s,i){return super.getLayerYOffset(t,s,i)+this._offsetY}getLayerZOffset(t,s,i){return super.getLayerZOffset(t,s,i)+this._offsetZ}}const Kn=class extends bt{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(e===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Kn.ANIMATION_ID_ROLL);return}if(e>=0&&e<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Kn.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(Kn.ANIMATION_ID_OFFSET_SLOW2+e),this._stateQueue.push(e);return}super.setAnimation(e)}}updateAnimation(e){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}};let Ja=Kn;Ja.ANIMATION_ID_OFFSET_SLOW1=20;Ja.ANIMATION_ID_OFFSET_SLOW2=9;Ja.ANIMATION_ID_ROLL=-1;class nB extends Bs{}const Hr=class extends bt{getFrameNumber(e,t){const s=this.getLayerTag(e,this.direction,t),i=this.object.getState(0);switch(s){case Hr.SECONDS_SPRITE:return Math.floor(i%60%10);case Hr.TEN_SECONDS_SPRITE:return Math.floor(i%60/10);case Hr.MINUTES_SPRITE:return Math.floor(i/60%10);case Hr.TEN_MINUTES_SPRITE:return Math.floor(i/60/10%10);default:return super.getFrameNumber(e,t)}}get animationId(){return 0}};let pn=Hr;pn.SECONDS_SPRITE="seconds_sprite";pn.TEN_SECONDS_SPRITE="ten_seconds_sprite";pn.MINUTES_SPRITE="minutes_sprite";pn.TEN_MINUTES_SPRITE="ten_minutes_sprite";class aB extends an{}const F_=class extends bt{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(e){this._thumbnailImageNormal=e,this._thumbnailChanged=!0}updateModel(e){const t=super.updateModel(e);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?t:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(e,t){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(t,this.direction,s)===F_.THUMBNAIL){const i=this.cacheSpriteAssetName(t,s,!1)+this.getFrameNumber(t,s),r=this.getAsset(i,s);if(r){const n=this.generateTransformedThumbnail(e,r),a=this.getThumbnailAssetName(t);this.asset.disposeAsset(a),this.asset.addAsset(a,n,!0,r.offsetX,r.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(e,t){if(this._hasOutline){const a=new Pt,o=new Pt(lu.WHITE);o.tint=0,o.width=e.width+40,o.height=e.height+40;const u=new Pt(e),l=(o.width-u.width)/2,c=(o.height-u.height)/2;u.position.set(l,c),a.addChild(o,u),e=Ot.generateTexture(a)}const s=1.1,i=new ue,r=t.width/e.width;switch(this.direction){case 2:i.a=r,i.b=-.5*r,i.c=0,i.d=r*s,i.tx=0,i.ty=.5*r*e.width;break;case 0:case 4:i.a=r,i.b=.5*r,i.c=0,i.d=r*s,i.tx=0,i.ty=0;break;default:i.a=r,i.b=0,i.c=0,i.d=r,i.tx=0,i.ty=0}const n=new Pt(e);return n.transform.setFromMatrix(i),Ot.generateTexture(n)}getSpriteAssetName(e,t){return this._thumbnailImageNormal&&this.getLayerTag(e,this.direction,t)===F_.THUMBNAIL?this.getThumbnailAssetName(e):super.getSpriteAssetName(e,t)}getThumbnailAssetName(e){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(e,t){return[this._type,e,"thumb",t].join("_")}};let Nh=F_;Nh.THUMBNAIL="THUMBNAIL";class aE extends Nh{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(t){if(this.object){const s=this.getThumbnailURL();if(this._cachedUrl!==s)if(this._cachedUrl=s,this._cachedUrl&&this._cachedUrl!==""){const i=new Image;i.src=s,i.crossOrigin="*",i.onload=()=>{const r=Dt.from(i);r.baseTexture.scaleMode=Eo.LINEAR,this.setThumbnailImages(r)}}else this.setThumbnailImages(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class oB extends aE{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(d.FURNITURE_DATA);if(!t||t==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let i=JSON.parse(t).w||"";return i=this.buildThumbnailUrl(i),this._url=i,this._url}buildThumbnailUrl(t){return t=t.replace(".png","_small.png"),t.indexOf(".png")===-1&&(t=t+"_small.png"),t}}class $h{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(t,s,i,r,n,a,o,u=!1,l=null,c=!1){this._x=t,this._y=s,this._z=i,this._particleDirection=new Se(r.x,r.y,r.z),this._particleDirection.scaleBy(n),this._lastX=this._x-this._particleDirection.x*a,this._lastY=this._y-this._particleDirection.y*a,this._lastZ=this._z-this._particleDirection.z*a,this._age=0,this._hasMoved=!1,this._lifeTime=o,this._isEmitter=u,this._frames=l,this._fade=c,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}get lastX(){return this._lastX}set lastX(t){this._hasMoved=!0,this._lastX=t}get lastY(){return this._lastY}set lastY(t){this._hasMoved=!0,this._lastY=t}get lastZ(){return this._lastZ}set lastZ(t){this._hasMoved=!0,this._lastZ=t}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(t,s){this._x=t._x*s,this._y=t._y*s,this._z=t._z*s,this._lastX=t._lastX*s,this._lastY=t._lastY*s,this._lastZ=t._lastZ*s,this._hasMoved=t.hasMoved,this._particleDirection=t._particleDirection,this._age=t._age,this._lifeTime=t._lifeTime,this._isEmitter=t._isEmitter,this._fade=t._fade,this._fadeTime=t._fadeTime,this._alphaMultiplier=t._alphaMultiplier}}const Xn=class extends $h{constructor(e="",t=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=e,this._roomObjectSpriteId=t,this._particleConfigurations=[]}dispose(){for(const e of this._particles)e.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(e,t,s,i,r,n,a,o,u,l){this._maxNumberOfParticles=e,this._particlesPerFrame=t,this._force=s,this._emitterDirection=i,this._emitterDirection.normalize(),this._gravity=r,this._airFriction=n,this._explosionShape=a,this._fuseTime=u,this._energy=o,this._burstPulse=l,this.reset()}reset(){for(const e of this._particles)e.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(e,t){super.copy(e,t),this._force=e._force,this._emitterDirection=e._emitterDirection,this._gravity=e._gravity,this._airFriction=e._airFriction,this._explosionShape=e._explosionShape,this._fuseTime=e._fuseTime,this._energy=e._energy,this._burstPulse=e._burstPulse,this._timeStep=e._timeStep,this._hasIgnited=e._hasIgnited}configureParticle(e,t,s,i){const r={};r.lifeTime=e,r.isEmitter=t,r.frames=s,r.fade=i,this._particleConfigurations.push(r)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(e,t=null){t||(t=new Se);const s=new Se,i=this.getRandomParticleConfiguration();let r=0;for(;r<this._particlesPerFrame;){switch(this._explosionShape){case Xn.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case Xn.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case Xn.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break}s.normalize();const n=new $h;let a=0,o=!1,u=!1,l=[];i?(a=Math.floor(Math.random()*i.lifeTime+10),o=i.isEmitter,l=i.frames,u=i.fade):(a=Math.trunc(Math.floor(Math.random()*20+10)),o=!1,l=[]),n.init(e.x,e.y,e.z,s,this._energy,this._timeStep,a,o,l,u),this._particles.push(n),this._emittedParticles++,r++}}getRandomParticleConfiguration(){const e=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[e]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const t=this.x,s=this.y,i=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=t,this.lastY=s,this.lastZ=i}const e=[];for(const t of this._particles){t.update();const s=t.x,i=t.y,r=t.z;t.x=(2-this._airFriction)*t.x-(1-this._airFriction)*t.lastX,t.y=(2-this._airFriction)*t.y-(1-this._airFriction)*t.lastY+this._gravity*this._timeStep*this._timeStep,t.z=(2-this._airFriction)*t.z-(1-this._airFriction)*t.lastZ,t.lastX=s,t.lastY=i,t.lastZ=r,(t.y>10||!t.isAlive)&&e.push(t)}for(const t of e)t.isEmitter,this._particles.splice(this._particles.indexOf(t),1),t.dispose()}satisfyConstraints(){}accumulateForces(){for(const e of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(e){return Math.random()<e}get roomObjectSpriteId(){return this._roomObjectSpriteId}};let Za=Xn;Za.CONE="cone";Za.PLANE="plane";Za.SPHERE="sphere";class _B{constructor(t){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new Gt,this._visualization=t,this._blackOverlayAlphaTransform=new co,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new co,this._identityMatrix=new ue,this._translationMatrix=new ue}dispose(){for(const t of this._emitters.getValues())t.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(t){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(t),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(t,s,i){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===i?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(t){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==t:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const t=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const s=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const i of this._currentEmitter.particles){const r=this._centerX+(i.x-i.z)*t/10*this._scaleMultiplier,n=this._centerY-s+(i.y+(i.x+i.z)/2)*t/10*this._scaleMultiplier,a=i.getAsset();if(a&&a.texture)if(i.fade&&i.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(r+a.offsetX,n+a.offsetY);const o=new Pt(a.texture);this._particleColorTransform.alpha=i.alphaMultiplier,o.filters=[this._particleColorTransform],Yt.instance.renderer.render(o,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const o=new $n(r+a.offsetX,n+a.offsetY),u=new Pt(a.texture);u.x=o.x,u.y=o.y,Yt.instance.renderer.render(u,{renderTexture:this._canvasTexture,clear:!1})}else{const o=new Pt(Dt.WHITE);o.tint=16777215,o.x=r-1,o.y=n-1,o.width=2,o.height=2,Yt.instance.renderer.render(o,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(t){this._size=t.size,this._canvasId=t.canvasId!==void 0?t.canvasId:-1,this._offsetY=t.offsetY!==void 0?t.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=t.blend!==void 0?t.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const s=t.bgColor!==void 0?t.bgColor:"0";if(this._bgColor=parseInt(s,16)||0,!(!t.emitters||!t.emitters.length))for(const i of t.emitters){const r=i.id,n=i.name,a=i.spriteId,o=new Za(n,a);this._emitters.add(r,o);const u=i.maxNumParticles,l=i.particlesPerFrame,c=i.burstPulse!==void 0?i.burstPulse:1,g=i.fuseTime,f=i.simulation.force,R=i.simulation.direction,m=i.simulation.gravity,T=i.simulation.airFriction,O=i.simulation.shape,C=i.simulation.energy;for(const N of i.particles){const S=N.lifeTime,D=N.isEmitter||!1,v=N.fade||!1,b=[];for(const w of N.frames)b.push(this._visualization.asset.getAsset(w));o.configureParticle(S,D,b,v)}o.setup(u,l,f,new Se(0,R,0),m,T,O,C,g,c)}}copyStateFrom(t){let s=0;t._emitters&&t._currentEmitter&&(s=t._emitters.getKey(t._emitters.getValues().indexOf(t._currentEmitter))),this.setAnimation(s),this._currentEmitter&&this._currentEmitter.copyStateFrom(t._currentEmitter,t._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new Pt(Dt.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?Yt.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=ze.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class oE extends bt{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const t of this._particleSystems.getValues())t.dispose();this._particleSystems=null}}updateObject(t,s){if(super.updateObject(t,s)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(t):G.log("ERROR Particle systems could not be read!",this.object.type);else if(t!==this._scale||this._particleSystems.getValue(t)!==this._currentParticleSystem){const i=this._particleSystems.getValue(t);i.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=i}return!0}return!1}updateSprites(t,s,i){super.updateSprites(t,s,i),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(t){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(t)}setAnimation(t){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(t),super.setAnimation(t)}getLayerYOffset(t,s,i){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(i)?this._currentParticleSystem.getLayerYOffset(t,s,i):super.getLayerYOffset(t,s,i)}readDefinition(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(d.FURNITURE_FIREWORKS_DATA);if(!t||!t.length)return!1;this._particleSystems=new Gt;for(const s of t){const i=s.size,r=new _B(this);r.parseData(s),this._particleSystems.add(i,r)}return!0}}const qn=class extends oE{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(e,t,s,i){this.updatePresentWrap(),super.update(e,t,s,i)}updatePresentWrap(){if(!this.object)return;const e=1e3,t=this.object.model.getValue(d.FURNITURE_EXTRAS),s=parseInt(t),i=Math.floor(s/e),r=s%e;this._packetType=i>qn.MAX_PACKET_TYPE_VALUE?0:i,this._ribbonType=r>qn.MAX_RIBBON_TYPE_VALUE?0:r}getFrameNumber(e,t){if(this._lastAnimationId===qn.PRESENT_DEFAULT_STATE){if(t<=1)return this._packetType;if(t===2)return this._ribbonType}return super.getFrameNumber(e,t)}getSpriteAssetName(e,t){const s=this.getValidSize(e);let i=this._type,r="";t<this.spriteCount-1?r=String.fromCharCode("a".charCodeAt(0)+t):r="sd";const n=this.getFrameNumber(e,t);return i=i+("_"+s+"_"+r+"_"+this.direction),i=i+("_"+n),i}setAnimation(e){this._lastAnimationId=e,super.setAnimation(e)}};let $a=qn;$a.PRESENT_DEFAULT_STATE=0;$a.MAX_PACKET_TYPE_VALUE=9;$a.MAX_RIBBON_TYPE_VALUE=11;class hB extends Bs{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(t,s,i,r){this.updatePresentWrap(),super.update(t,s,i,r)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(d.FURNITURE_EXTRAS),s=1e3,i=parseInt(t);this._packetType=Math.floor(i/s),this._ribbonType=i%s}getFrameNumber(t,s){return s<=1?this._packetType:this._ribbonType}getSpriteAssetName(t,s){const i=this.getValidSize(t);let r=this._type,n="";s<this.spriteCount-1?n=String.fromCharCode("a".charCodeAt(0)+s):n="sd";const a=this.getFrameNumber(t,s);return r=r+("_"+i+"_"+n+"_"+this.direction),r=r+("_"+a),r}}const Es=class extends bt{constructor(){super(),this._color1=Es.DEFAULT_COLOR_1,this._color2=Es.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(e){const t=super.updateModel(e);if(this._badgeAssetNameNormalScale===""){const r=this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);r&&(this._badgeAssetNameNormalScale=r,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Es.DEFAULT_COLOR_1;const i=this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||Es.DEFAULT_COLOR_2,t}getLayerColor(e,t,s){switch(this.getLayerTag(e,this._direction,t)){case Es.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Es.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(e,t,s)}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===Es.BADGE?e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(e,t)}getLibraryAssetNameForSprite(e,t){return t.tag===Es.BADGE?"%group.badge.url%"+t.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(e,t)}};let Ar=Es;Ar.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";Ar.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";Ar.BADGE="BADGE";Ar.DEFAULT_COLOR_1=15658734;Ar.DEFAULT_COLOR_2=4934475;const Qi=class extends Nh{updateModel(e){const t=super.updateModel(e);if(!this.hasThumbnailImage){const r=this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);r&&r.length&&this.setThumbnailImages(this.getBitmapAsset(r))}const s=this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Qi.DEFAULT_COLOR_1;const i=this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||Qi.DEFAULT_COLOR_2,t}generateTransformedThumbnail(e,t){const i=new ue,r=t.width/e.width;switch(this.direction){case 2:i.a=r,i.b=-.5*r,i.c=0,i.d=r*1.1,i.tx=0,i.ty=.5*r*e.width;break;case 0:case 4:i.a=r,i.b=.5*r,i.c=0,i.d=r*1.1,i.tx=0,i.ty=0;break;default:i.a=r,i.b=0,i.c=0,i.d=r,i.tx=0,i.ty=0}const n=new Pt(e);return n.transform.setFromMatrix(i),n.position.set(0),Ot.generateTexture(n)}getLayerColor(e,t,s){switch(this.getLayerTag(e,this._direction,t)){case Qi.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Qi.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(e,t,s)}getLibraryAssetNameForSprite(e,t){return t.tag===Qi.THUMBNAIL&&this.object&&this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(e,t)}getBitmapAsset(e){const t=this.asset.getAsset(e);return!t||!t.texture?null:t.texture}};let On=Qi;On.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";On.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";On.DEFAULT_COLOR_1=15658734;On.DEFAULT_COLOR_2=4934475;const Ji=class extends bt{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(e===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ji.ANIMATION_ID_START_ROLL),this._stateQueue.push(Ji.ANIMATION_ID_ROLL);return}if(e>0&&e<=Ji.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Ji.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(Ji.ANIMATION_ID_OFFSET_SLOW2+e),this._stateQueue.push(e);return}super.setAnimation(e)}}updateAnimation(e){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}};let An=Ji;An.ANIMATION_ID_OFFSET_SLOW1=10;An.ANIMATION_ID_OFFSET_SLOW2=20;An.ANIMATION_ID_START_ROLL=31;An.ANIMATION_ID_ROLL=32;class uB extends nE{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(t){if(!this._gifCollection)return;const s=this._gifCollection.textures;if(s.length){for(let i=0;i<s.length;i++){const r=s[i];if(!r||!this.getAsset(`${this._imageUrl}_${i}`))continue;const a=1.1,o=new ue,u=t.width/r.width;switch(this.direction){case 2:o.a=u,o.b=-.5*u,o.c=0,o.d=u*a,o.tx=0,o.ty=.5*u*r.width;break;case 0:case 4:o.a=u,o.b=.5*u,o.c=0,o.d=u*a,o.tx=0,o.ty=0;break;default:o.a=u,o.b=0,o.c=0,o.d=u,o.tx=0,o.ty=0}const l=new Pt(r),c=ze.create({width:t.width+o.tx,height:t.height+o.ty});Yt.instance.renderer.render(l,{renderTexture:c,clear:!0,transform:o}),this.asset.disposeAsset(`${this._imageUrl}_${i}`),this.asset.addAsset(`${this._imageUrl}_${i}`,c,!0,t.x,t.y,t.flipH,t.flipV)}this._needsTransform=!1}}generateTransformedImage(t,s){const r=new ue,n=s.width/t.width;switch(this.direction){case 2:r.a=n,r.b=-.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=.5*n*t.width;break;case 0:case 4:r.a=n,r.b=.5*n,r.c=0,r.d=n*1.1,r.tx=0,r.ty=0;break;default:r.a=n,r.b=0,r.c=0,r.d=n,r.tx=0,r.ty=0}const a=new Pt(t),o=ze.create({width:s.width+r.tx,height:s.height+r.ty});Yt.instance.renderer.render(a,{renderTexture:o,clear:!0,transform:r}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,o,!0,a.x,a.y,s.flipH,s.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(t,s){return this.getLayerTag(t,this._direction,s)===gi.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(t,s))):this.generateTransformedImage(Pe().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(t,s)))),`${this._imageUrl}_${this.getFrameNumber(t,s)}`):super.getSpriteAssetName(t,s)}}class x_ extends Us{constructor(){super(),this._avatarData=new Ia}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,s,i=null,r=null,n=null){return this._avatarData.createAvatarImage(t,s,i,r,n)}set avatarManager(t){this._avatarData.avatarManager=t}}const Qn=class extends Bs{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(e){return e instanceof x_?super.initialize(e):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(e,t){const s=super.updateObject(e,t);return s&&this._mannequinScale!==e&&(this._mannequinScale=e,this.updateAvatar()),s}updateModel(e){let t=super.updateModel(e);if(t){const s=this.object.model.getValue(d.FURNITURE_MANNEQUIN_FIGURE)||null;s&&(this._figure=s+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(d.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return t=t||this._needsUpdate,this._needsUpdate=!1,t}updateAvatar(e=!1){if(!this.avatarExists()||e){const t=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);t&&(t.setDirection(ee.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),t.getImage(ee.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,t.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(e){e===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(e,t){const s=this.getLayerTag(e,this.direction,t);return this._figure&&s===Qn.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(e,t)}getLayerXOffset(e,t,s){return this.getLayerTag(e,t,s)===Qn.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).width/2:super.getLayerXOffset(e,t,s)}getLayerYOffset(e,t,s){return this.getLayerTag(e,t,s)===Qn.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).height:super.getLayerYOffset(e,t,s)}get disposed(){return this._disposed}get data(){return this._data}};let _E=Qn;_E.AVATAR_IMAGE_SPRITE_TAG="avatar_image";const pi=class extends bt{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(e){this._animSpeedIndex||this.initItems(e);let t=this.getSprite(2);return t&&(this._animOffsetIndex[0]=this.getNewPoint(e,0)),t=this.getSprite(3),t&&(this._animOffsetIndex[1]=this.getNewPoint(e,1)),super.updateAnimation(e)}getNewPoint(e,t){let s=0,i=this._animPhaseIndex[t],r=this._animDirectionIndex[t];const n=this._animSpeedIndex[t],a=this._animFactorIndex[t];let o=1;e==32?(s=pi.AREA_DIAMETER_SMALL,o=.5):s=pi.AREA_DIAMETER_LARGE;const u=i+r*n;Math.abs(u)>=s&&(r>0?i=i-(u-s):i=i+(-s-u),r=-r,this._animDirectionIndex[t]=r);const l=(s-Math.abs(i))*a;let c=r*Math.sin(Math.abs(i/4))*l;return r>0?c=c-l:c=c+l,i=i+r*n*o,this._animPhaseIndex[t]=i,Math.trunc(c)==0&&(this._animFactorIndex[t]=this.getRandomAmplitudeFactor()),new $n(i,c)}initItems(e){let t;e===32?t=pi.AREA_DIAMETER_SMALL:t=pi.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*t*1.5),this._animPhaseIndex.push(Math.random()*t*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(pi.ANIM_SPEED_FAST),this._animSpeedIndex.push(pi.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(e,t,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].x:super.getLayerXOffset(e,t,s)}getLayerYOffset(e,t,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].y:super.getLayerYOffset(e,t,s)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};let Sr=pi;Sr.UPDATE_INTERVAL=2;Sr.AREA_DIAMETER_SMALL=15;Sr.AREA_DIAMETER_LARGE=31;Sr.ANIM_SPEED_FAST=2;Sr.ANIM_SPEED_SLOW=1;const hE=class{constructor(e,t,s,i,r,n){this._name=e,this._index=t,this._radius=s,this._arcSpeed=i*Math.PI*2/360,this._arcOffset=r*Math.PI*2/360,this._height=n,this._position=0,this._positionVector=new I(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(e,t,s){this._position=this._position+this._arcSpeed/hE.SYSTEM_TEMPO,e[this._index]=this.getPositionVector(t,s);for(const i of this._children)i.update(e,this._positionVector,s)}getPositionVector(e,t){const s=this._radius*Math.cos(this._position+this._arcOffset),i=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(s-i)*(t/2),this._positionVector.y=(i+s)*(t/2)*.5-this._height*(t/2),this._positionVector.z=-Math.trunc(4*(s+i)-.7),e&&this._positionVector.add(e),this._positionVector}addChild(e){this._children.indexOf(e)>=0||this._children.push(e)}hasChild(e){return!!this.getChild(e)}getChild(e){for(const t of this._children){if(t.name===e)return t;if(t.hasChild(e))return t.getChild(e)}return null}get name(){return this._name}};let uE=hE;uE.SYSTEM_TEMPO=30;class lB extends bt{constructor(){super(),this._offsetArray=[],this._rootPosition=new I}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(t){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const s of this._planetIndex)s.update(this._offsetArray,this._rootPosition,t);return super.updateAnimation(t)}return 0}getLayerXOffset(t,s,i){return this._offsetArray[i]?this._offsetArray[i].x:super.getLayerXOffset(t,s,i)}getLayerYOffset(t,s,i){return this._offsetArray[i]?this._offsetArray[i].y:super.getLayerYOffset(t,s,i)}getLayerZOffset(t,s,i){return this._offsetArray[i]?this._offsetArray[i].z:super.getLayerZOffset(t,s,i)}processPlanets(){if(!this.object||!this.object.model)return;const t=this.object.model.getValue(d.FURNITURE_PLANETSYSTEM_DATA);if(!t)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const s of t)this.getSprite(s.id)&&this.addPlanet(s.name,s.id,s.parent,s.radius||0,s.arcSpeed||0,s.arcOffset||0,s.height||0);return!0}addPlanet(t,s,i,r,n,a,o){if(!this._planetIndex)return;const u=new uE(t,s,r,n,a,o),l=this.getPlanet(i);l?l.addChild(u):(this._planetIndex.push(u),this._planetNameIndex.push(t))}getPlanet(t){for(const s of this._planetIndex){if(s.name===t)return s;if(s.hasChild(t))return s.getChild(t)}return null}}class cB extends bt{}const Jn=class extends bt{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(e){return e===Jn.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(Jn.ANIMATION_ID_NORMAL),this._animationCounter=Jn.ANIMATION_DURATION),super.setAnimation(e)}updateAnimation(e){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}usesAnimationResetting(){return!0}};let Sn=Jn;Sn.ANIMATION_ID_ROLL=3;Sn.ANIMATION_ID_ROLL_ONCE=2;Sn.ANIMATION_ID_NORMAL=1;Sn.ANIMATION_DURATION=15;class dB extends bt{usesAnimationResetting(){return!0}}class gB extends gi{imageReady(t,s){super.imageReady(t,s),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,s){const i=new tE;i.setDirection(1,0,-s),i.setDirection(3,0,0),i.setDirection(5,-t,0),i.setDirection(7,-t,-s),i.setDirection(4,-t/2,-s/2),this._imageOffset=i}getLayerXOffset(t,s,i){if(this._imageOffset){const r=this._imageOffset.getXOffset(s,0);if(r!==void 0)return r+this._offsetX}return super.getLayerXOffset(t,s,i)+this._offsetX}getLayerYOffset(t,s,i){if(this._imageOffset){const r=this._imageOffset.getYOffset(s,0);if(r!==void 0)return r+this._offsetY}return super.getLayerYOffset(t,s,i)+this._offsetY}getLayerZOffset(t,s,i){return super.getLayerZOffset(t,s,i)+-this._offsetZ}getLayerIgnoreMouse(t,s,i){return!0}}const Vr=class extends bt{getFrameNumber(e,t){const s=this.getLayerTag(e,this.direction,t),i=this.object.getState(0);switch(s){case Vr.ONES_SPRITE:return Math.floor(i%10);case Vr.TENS_SPRITE:return Math.floor(i/10%10);case Vr.HUNDREDS_SPRITE:return Math.floor(i/100%10);case Vr.THOUSANDS_SPRITE:return Math.floor(i/1e3%10);default:return super.getFrameNumber(e,t)}}};let Mn=Vr;Mn.ONES_SPRITE="ones_sprite";Mn.TENS_SPRITE="tens_sprite";Mn.HUNDREDS_SPRITE="hundreds_sprite";Mn.THOUSANDS_SPRITE="thousands_sprite";class EB extends bt{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(t){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(d.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(t)}}class fB extends Bs{getLayerColor(t,s,i){return this._data?this._data.getLayerColor(t,s,i):dr.DEFAULT_COLOR}}const Be=class extends bt{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(Be.ANIMATION_ID_OFF)}setAnimation(e){if(e===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Be.ANIMATION_ID_START_ROLL),this._stateQueue.push(Be.ANIMATION_ID_ROLL);return}if(e>0&&e<=Be.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(Be.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(Be.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(Be.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(Be.ANIMATION_ID_OFFSET_SLOW2+e)),this._stateQueue.push(Be.ANIMATION_ID_OFF);return}super.setAnimation(Be.ANIMATION_ID_OFF)}}updateAnimation(e){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}};let Mr=Be;Mr.ANIMATION_ID_OFFSET_SLOW1=20;Mr.ANIMATION_ID_OFFSET_SLOW2=10;Mr.ANIMATION_ID_START_ROLL=31;Mr.ANIMATION_ID_ROLL=32;Mr.ANIMATION_ID_OFF=30;const zs=class extends bt{updateObject(e,t){return super.updateObject(e,t),!0}getFrameNumber(e,t){const s=this.object.model.getValue(d.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(e,this.direction,t)){case zs.ONES_SPRITE:return s%10;case zs.TENS_SPRITE:return s/10%10;case zs.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(e,t)}}getLayerAlpha(e,t,s){if(this.object.model.getValue(d.FURNITURE_VOTE_COUNTER_COUNT)===zs.HIDE_COUNTER_SCORE)switch(this.getLayerTag(e,t,s)){case zs.ONES_SPRITE:case zs.TENS_SPRITE:case zs.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,t,s)}};let Cn=zs;Cn.ONES_SPRITE="ones_sprite";Cn.TENS_SPRITE="tens_sprite";Cn.HUNDREDS_SPRITE="hundreds_sprite";Cn.HIDE_COUNTER_SCORE=-1;const fs=class extends bt{getFrameNumber(e,t){const s=this.object.model.getValue(d.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(e,this.direction,t)){case fs.ONES_SPRITE:return s%10;case fs.TENS_SPRITE:return s/10%10;case fs.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(e,t)}}getLayerAlpha(e,t,s){const i=this.object.model.getValue(d.FURNITURE_VOTE_MAJORITY_RESULT);if(fs.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||i===fs.HIDE_RESULTS_VALUE)switch(this.getLayerTag(e,t,s)){case fs.ONES_SPRITE:case fs.TENS_SPRITE:case fs.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,t,s)}};let Cr=fs;Cr.ONES_SPRITE="ones_sprite";Cr.TENS_SPRITE="tens_sprite";Cr.HUNDREDS_SPRITE="hundreds_sprite";Cr.HIDE_RESULTS_STATES=[-1,1];Cr.HIDE_RESULTS_VALUE=-1;class mB extends bt{}const lE=class extends aE{getThumbnailURL(){if(!this.object)return null;const e=this.object.model.getValue(d.FURNITURE_DATA);return e&&e[lE.THUMBNAIL_URL]||null}};let cE=lE;cE.THUMBNAIL_URL="THUMBNAIL_URL";class IB{constructor(t){this._sprite=new Pt(t),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(t){if(!this._sprite||this._amount===t)return null;const s=new je;s.addChild(this._sprite);const i=new jE("+"+t,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return i.anchor.x=.5,i.x=this._sprite.width/2,i.y=19,s.addChild(i),this._texture?Yt.instance.renderer.render(s,{renderTexture:this._texture,clear:!0}):this._texture=Ot.generateTexture(s),this._texture}get amount(){return this._amount}set amount(t){this._amount=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}class dE extends Ch{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(t,s,i){return t>1?new qi(s,i):new Ra(s,i)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,s,i){if(!t||!s||!i)return!1;switch(s){case"postures":if(!(t instanceof qi)||!t.processPostures(i))return!1;break;case"gestures":if(!(t instanceof qi)||!t.processGestures(i))return!1;break;default:if(!super.processVisualElement(t,s,i))return!1;break}return!0}postureToAnimation(t,s){const i=this.getSizeData(t);return i?i.postureToAnimation(s):qi.DEFAULT}getGestureDisabled(t,s){const i=this.getSizeData(t);return i?i.getGestureDisabled(s):!1}gestureToAnimation(t,s){const i=this.getSizeData(t);return i?i.gestureToAnimation(s):qi.DEFAULT}animationToPosture(t,s,i){const r=this.getSizeData(t);return r?r.animationToPosture(s,i):null}animationToGesture(t,s){const i=this.getSizeData(t);return i?i.animationToGesture(s):null}getGestureForAnimationId(t,s){const i=this.getSizeData(t);return i?i.getGestureForAnimationId(s):null}totalPostures(t){const s=this.getSizeData(t);return s?s.totalPostures:0}totalGestures(t){const s=this.getSizeData(t);return s?s.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const qt=class extends bt{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<qt.ANIMATION_INDEX_COUNT;)this._animationStates.push(new eE)}initialize(e){if(!(e instanceof dE))return!1;const t=this.getPetAdditionAsset(qt.PET_EXPERIENCE_BUBBLE);return t&&(this._experienceData=new IB(t)),super.initialize(e)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const e=this._animationStates[0];e&&e.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(e){return e.animationId}update(e,t,s,i){super.update(e,t,s,i),this.updateExperienceBubble(t)}updateExperienceBubble(e){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const t=e-this._experienceTimestamp;t<qt.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(t/qt.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const i=this._experienceData.renderBubble(this._experience);if(i){s.texture=i,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,s.relativeDepth=-.2;return}}s.texture=null,s.visible=!1}}}updateModel(e){const t=this.object&&this.object.model;if(!t||this.updateModelCounter===t.updateCounter)return!1;const s=t.getValue(d.FIGURE_POSTURE),i=t.getValue(d.FIGURE_GESTURE);this.setPostureAndGesture(s,i);let r=t.getValue(d.FURNITURE_ALPHA_MULTIPLIER)||null;(r===null||isNaN(r))&&(r=1),this._alphaMultiplier!==r&&(this._alphaMultiplier=r,this._alphaChanged=!0),this._isSleeping=t.getValue(d.FIGURE_SLEEP)>0;const n=t.getValue(d.HEAD_DIRECTION);!isNaN(n)&&this.data.isAllowedToTurnHead?this._headDirection=n:this._headDirection=this.object.getDirection().x,this._experience=t.getValue(d.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=t.getValue(d.FIGURE_EXPERIENCE_TIMESTAMP);const a=t.getValue(d.PET_PALETTE_INDEX),o=t.getValue(d.PET_CUSTOM_LAYER_IDS),u=t.getValue(d.PET_CUSTOM_PARTS_IDS),l=t.getValue(d.PET_CUSTOM_PALETTE_IDS),c=t.getValue(d.PET_IS_RIDING),g=t.getValue(d.PET_HEAD_ONLY),f=t.getValue(d.PET_COLOR);return a!==this._paletteIndex&&(this._paletteIndex=a,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=o||[],this._customPartIds=u||[],this._customPaletteIds=l||[],this._isRiding=!isNaN(c)&&c>0,this._headOnly=!isNaN(g)&&g>0,!isNaN(f)&&this._color!==f&&(this._color=f),this.updateModelCounter=t.updateCounter,!0}updateAnimation(e){if(this.object){const t=this.object.getDirection().x;t!==this._previousAnimationDirection&&(this._previousAnimationDirection=t,this.resetAllAnimationFrames())}return super.updateAnimation(e)}setPostureAndGesture(e,t){this.data&&(e!==this._posture&&(this._posture=e,this.setAnimationForIndex(qt.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,e))),this.data.getGestureDisabled(this._scale,e)&&(t=null),t!==this._gesture&&(this._gesture=t,this.setAnimationForIndex(qt.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,t))))}getAnimationStateData(e){return e>=0&&e<this._animationStates.length?this._animationStates[e]:null}setAnimationForIndex(e,t){const s=this.getAnimationStateData(e);s&&this.setSubAnimation(s,t)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let e=this._animationStates.length-1;for(;e>=0;){const t=this._animationStates[e];t&&t.setLayerCount(this.animatedLayerCount),e--}}updateAnimations(e){if(this._animationOver)return 0;let t=!0,s=0,i=0;for(;i<this._animationStates.length;){const r=this._animationStates[i];if(r&&!r.animationOver){const n=this.updateFramesForAnimation(r,e);s=s|n,r.animationOver?(xt.isTransitionFromAnimation(r.animationId)||xt.isTransitionToAnimation(r.animationId))&&(this.setAnimationForIndex(i,r.animationAfterTransitionId),t=!1):t=!1}i++}return this._animationOver=t,s}getSpriteAssetName(e,t){if(this._headOnly&&this.isNonHeadSprite(t)||this._isRiding&&this._parser3(t))return null;const s=this.totalSprites;if(t<s-qt.ADDITIONAL_SPRITE_COUNT){const i=this.getValidSize(e);if(t<s-(1+qt.ADDITIONAL_SPRITE_COUNT)){if(t>=Us.LAYER_LETTERS.length)return null;const r=Us.LAYER_LETTERS[t];return i===1?this._type+"_icon_"+r:this._type+"_"+i+"_"+r+"_"+this.getDirection(e,t)+"_"+this.getFrameNumber(i,t)}return this._type+"_"+i+"_sd_"+this.getDirection(e,t)+"_0"}return null}getLayerColor(e,t,s){return t<this.totalSprites-qt.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(e,t,s){let i=super.getLayerXOffset(e,t,s),r=this._animationStates.length-1;for(;r>=0;){const n=this._animationStates[r];if(n){const a=n.getFrame(s);a&&(i+=a.x)}r--}return i}getLayerYOffset(e,t,s){let i=super.getLayerYOffset(e,t,s),r=this._animationStates.length-1;for(;r>=0;){const n=this._animationStates[r];if(n){const a=n.getFrame(s);a&&(i+=a.y)}r--}return i}getLayerZOffset(e,t,s){return this.data?this.data.getLayerZOffset(e,this.getDirection(e,s),s):tt.DEFAULT_ZOFFSET}getDirection(e,t){return this.isHeadSprite(t)?this.data.getValidDirection(e,this._headDirection):this._direction}getFrameNumber(e,t){let s=this._animationStates.length-1;for(;s>=0;){const i=this._animationStates[s];if(i){const r=i.getFrame(t);if(r)return r.id}s--}return super.getFrameNumber(e,t)}isHeadSprite(e){if(this._headSprites[e]===void 0){const t=this.data.getLayerTag(this._scale,Mi.USE_DEFAULT_DIRECTION,e)===qt.HEAD,s=this.data.getLayerTag(this._scale,Mi.USE_DEFAULT_DIRECTION,e)===qt.HAIR;t||s?this._headSprites[e]=!0:this._headSprites[e]=!1}return this._headSprites[e]}isNonHeadSprite(e){if(this._nonHeadSprites[e]===void 0)if(e<this.totalSprites-(1+qt.ADDITIONAL_SPRITE_COUNT)){const t=this.data.getLayerTag(this._scale,Mi.USE_DEFAULT_DIRECTION,e);t&&t.length>0&&t!==qt.HEAD&&t!==qt.HAIR?this._nonHeadSprites[e]=!0:this._nonHeadSprites[e]=!1}else this._nonHeadSprites[e]=!0;return this._nonHeadSprites[e]}_parser3(e){return this._saddleSprites[e]===void 0&&(this.data.getLayerTag(this._scale,Mi.USE_DEFAULT_DIRECTION,e)===qt.SADDLE?this._saddleSprites[e]=!0:this._saddleSprites[e]=!1),this._saddleSprites[e]}getAsset(e,t=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(t);let i=this._paletteName,r=-1,n=-1;return s>-1&&(r=this._customPartIds[s],n=this._customPaletteIds[s],i=n>-1?n.toString():this._paletteName),!isNaN(r)&&r>-1&&(e=e+"_"+r),this.asset.getAssetWithPalette(e,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+qt.ADDITIONAL_SPRITE_COUNT}setLayerCount(e){super.setLayerCount(e),this._headSprites=[]}getPostureForAsset(e,t){const s=t.split("_");let i=s.length,r=0;for(;r<s.length;){if(s[r]==="64"||s[r]==="32"){i=r+3;break}r++}let n=null;if(i<s.length){let a=s[i];a=a.split("@")[0],n=this.data.animationToPosture(e,parseInt(a)/100,!1),n||(n=this.data.getGestureForAnimationId(e,parseInt(a)/100))}return n}getPetAdditionAsset(e){return Pe().getTexture(e)}get data(){return this._data}};let Qe=qt;Qe.TYPE=y.PET_ANIMATED;Qe.HEAD="head";Qe.SADDLE="saddle";Qe.HAIR="hair";Qe.ADDITIONAL_SPRITE_COUNT=1;Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3;Qe.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble";Qe.POSTURE_ANIMATION_INDEX=0;Qe.GESTURE_ANIMATION_INDEX=1;Qe.ANIMATION_INDEX_COUNT=2;class Dh{constructor(t,s=-1,i=1,r=-1,n=1){this._normalMinX=s,this._normalMaxX=i,this._normalMinY=r,this._normalMaxY=n,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}Dh.MIN_NORMAL_COORDINATE_VALUE=-1;Dh.MAX_NORMAL_COORDINATE_VALUE=1;class Ci{constructor(){this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}addBitmap(t,s=-1,i=1,r=-1,n=1){this._bitmaps.push(new Dh(t,s,i,r,n))}getAsset(t){if(!t)return null;for(const s of this._bitmaps)if(s&&t.x>=s.normalMinX&&t.x<=s.normalMaxX&&t.y>=s.normalMinY&&t.y<=s.normalMaxY)return s.asset;return null}}Ci.MIN_NORMAL_COORDINATE_VALUE=-1;Ci.MAX_NORMAL_COORDINATE_VALUE=1;class RB{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(t){if(this._maskVisualizations.get(t))return null;const i=new Ci;return this._maskVisualizations.set(t,i),this._sizes.push(t),this._sizes.sort(),i}getSizeIndex(t){let s=0,i=1;for(;i<this._sizes.length;){if(this._sizes[i]>t){this._sizes[i]-t<t-this._sizes[i-1]&&(s=i);break}s=i,i++}return s}getMaskVisualization(t){if(t===this._lastSize)return this._lastMaskVisualization;const s=this.getSizeIndex(t);return s<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[s]):this._lastMaskVisualization=null,this._lastSize=t,this._lastMaskVisualization}getGraphicAsset(t,s){const i=this.getMaskVisualization(t);return i?i.getAsset(s):null}getAssetName(t){return this._assetNames&&this._assetNames.get(t)||null}setAssetName(t,s){this._assetNames&&this._assetNames.set(t,s)}}class TB{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}initializeAssetCollection(t){this.data&&(this._assetCollection=t,this.parseMasks(this.data,t))}parseMasks(t,s){if(!(!t||!s)&&t.masks&&t.masks.length){let i=0;for(;i<t.masks.length;){const r=t.masks[i];if(r){const n=r.id;if(this._masks.get(n))continue;const o=new RB;if(r.visualizations&&r.visualizations.length){let u=0;for(;u<r.visualizations.length;){const l=r.visualizations[u];if(l){const c=l.size,g=o.createMaskVisualization(c);if(g){const f=this.parseMaskBitmaps(l.bitmaps,g,s);o.setAssetName(c,f)}}u++}}this._masks.set(n,o)}i++}}}parseMaskBitmaps(t,s,i){if(!t||!t.length)return null;let r=null;for(const n of t){if(!n)continue;const a=n.assetName,o=i.getAsset(a);if(!o)continue;let u=Ci.MIN_NORMAL_COORDINATE_VALUE,l=Ci.MAX_NORMAL_COORDINATE_VALUE,c=Ci.MIN_NORMAL_COORDINATE_VALUE,g=Ci.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(u=n.normalMinX),n.normalMaxX!==void 0&&(l=n.normalMaxX),n.normalMinY!==void 0&&(c=n.normalMinY),n.normalMaxY!==void 0&&(g=n.normalMaxY),o.flipH||(r=a),s.addBitmap(o,u,l,c,g)}return r}updateMask(t,s,i,r,n,a){const o=this._masks.get(s);if(!o)return!0;const u=o.getGraphicAsset(i,r);if(!u)return!0;const l=u.texture;if(!l)return!0;const c=new Y(n+u.offsetX,a+u.offsetY),g=new ue;let f=1,R=1,m=0,T=0,O=c.x+m,C=c.y+T;return u.flipH&&(f=-1,m=l.width,O=c.x+m-l.width),u.flipV&&(R=-1,T=l.height,C=c.y+T-l.height),g.scale(f,R),g.translate(O,C),Yt.instance.renderer.render(new Nt(l),{renderTexture:t,clear:!1,transform:g}),!0}getMask(t){return!this._masks||!this._masks.size?null:this._masks.get(t)||null}}class jr{constructor(t=null,s=0,i=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],t!=null&&(this._maskAssetNames=t._maskAssetNames,this._maskAssetLocations=t._maskAssetLocations,this._maskAssetFlipHs=t._maskAssetFlipHs,this._maskAssetFlipVs=t._maskAssetFlipVs),this._color=s,this._alignBottom=i}addMask(t,s,i,r){this._maskAssetNames.push(t),this._maskAssetLocations.push(s),this._maskAssetFlipHs.push(i),this._maskAssetFlipVs.push(r)}addAssetColumn(t){this._assetNames.push(t)}set z(t){this._z=t}get z(){return this._z}set cornerPoints(t){this._points=t}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class pB{constructor(t,s,i,r,n){this._x=t,this._y=s,this._speedX=i,this._speedY=r,this._asset=n,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(t,s,i,r,n){let a=this._x,o=this._y;i>0&&(a=a+this._speedX/i*n/1e3),r>0&&(o=o+this._speedY/r*n/1e3);const u=Math.trunc(a%1*t),l=Math.trunc(o%1*s);return new Y(u,l)}}const Ph=class{constructor(e,t,s,i=0){this._material=e,this._offset=i,this._align=s,this._color=t,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(e,t,s,i,r,n,a,o,u){const l=this._color>>16,c=this._color>>8&255,g=this._color&255,f=l<255||c<255||g<255;if(this._material){const R=this._material.render(e,t,f?null:s,i,r,n,a,o,u+this.offset,this.align===Ph.ALIGN_TOP);if(R&&f){const m=new Nt(R);f&&(m.tint=this._color),t.writeToRenderTexture(m,s,!1)}}else{const R=t.createAndFillRenderTexture(i,r,e,this._color);t.writeToRenderTexture(new Nt(R),s,!1)}return s}getMaterial(){return this._material}getColor(){return this._color}};let Ee=Ph;Ee.DEFAULT_OFFSET=0;Ee.ALIGN_TOP=1;Ee.ALIGN_BOTTOM=2;Ee.ALIGN_DEFAULT=Ph.ALIGN_TOP;class OB{constructor(t,s,i){this._layers=[],this._geometry=i,this._cachedBitmapNormal=new I,this._isCached=!1,this._hasAnimationLayers=!1,s<0&&(s=0);let r=0;for(;r<s;)this._layers.push(null),r++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const t of this._layers)t&&t.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new I),this._layers&&this._layers.length)for(const t of this._layers){if(!t)continue;t.clearCache()}this._isCached=!1}}setLayer(t,s,i,r,n=0){if(t<0||t>this._layers.length)return!1;let a=this._layers[t];return a&&a.dispose(),a=new Ee(s,i,r,n),this._layers[t]=a,!0}setAnimationLayer(t,s,i){if(t<0||t>this._layers.length)return!1;let r=this._layers[t];return r&&r.dispose(),r=new tu(s,i),this._layers[t]=r,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(t,s,i,r,n,a,o,u=0,l=0,c=0,g=0,f=0,R=0,m=0){r<1&&(r=1),n<1&&(n=1),(!i||i.width!==r||i.height!==n)&&(i=null),this._isCached=!0;const T=s.createAndFillRenderTexture(r,n,t);if(this._cachedBitmapNormal.assign(a),this._layers&&this._layers.length)for(const O of this._layers)O&&(O instanceof Ee?O.render(`${t}:${this._layers.indexOf(O)}`,s,T,r,n,a,o,u,l):O instanceof tu&&O.render(s,T,r,n,a,u,l,c,g,f,R,m));return T}}class yh{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(t){return!0}dispose(){for(const t of this._planeVisualizations.values())t&&t.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const t of this._planeVisualizations.values())t&&t.clearCache()}createPlaneVisualization(t,s,i){if(this._planeVisualizations.get(t.toString()))return null;const n=new OB(t,s,i);return this._planeVisualizations.set(t.toString(),n),this._sizes.push(t),this._sizes.sort(),n}getSizeIndex(t){let s=0,i=1;for(;i<this._sizes.length;){if(this._sizes[i]>t){this._sizes[i]-t<t-this._sizes[i-1]&&(s=i);break}s=i,i++}return s}getPlaneVisualization(t){if(t===this._lastSize)return this._lastPlaneVisualization;const s=this.getSizeIndex(t);return s<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[s].toString()):this._lastPlaneVisualization=null,this._lastSize=t,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}class Pi extends yh{render(t,s,i,r,n,a,o,u,l,c){const g=this.getPlaneVisualization(a);if(!g||!g.geometry)return null;const f=g.geometry.getScreenPoint(new I(0,0,0)),R=g.geometry.getScreenPoint(new I(0,n/g.geometry.scale,0)),m=g.geometry.getScreenPoint(new I(r/g.geometry.scale,0,0));let T=0,O=0;if(f&&R&&m){r=Math.round(Math.abs(f.x-m.x)),n=Math.round(Math.abs(f.x-R.x));const C=f.x-g.geometry.getScreenPoint(new I(1,0,0)).x;T=l*Math.trunc(Math.abs(C)),O=c*Math.trunc(Math.abs(C))}return g.render(t,s,i,r,n,o,u,T,O)}}Pi.DEFAULT_COLOR=16777215;Pi.HORIZONTAL_ANGLE_DEFAULT=45;Pi.VERTICAL_ANGLE_DEFAULT=30;class Ta{constructor(t,s){this._texture=t,this._timeStamp=s}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}const Qt=class{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(e=1){Qt._randomizer||(Qt._randomizer=new Qt),Qt._randomizer.seed=e}static setModulus(e=16777216){Qt._randomizer||(Qt._randomizer=new Qt),Qt._randomizer.modulus=e}static getValues(e,t,s){return Qt._randomizer||(Qt._randomizer=new Qt),Qt._randomizer.getRandomValues(e,t,s)}static getArray(e,t){return Qt._randomizer||(Qt._randomizer=new Qt),Qt._randomizer.getRandomArray(e,t)}set seed(e){this._seed=e}set modulus(e){e<1&&(e=1),this._modulus=e}dispose(){}getRandomValues(e,t,s){const i=[];let r=0;for(;r<e;)i.push(this.iterateScaled(t,s-t)),r++;return i}getRandomArray(e,t){if(e>t||t>1e3)return null;const s=[];let i=0;for(;i<=t;)s.push(i),i++;const r=[];let n=0;for(;n<e;){const a=this.iterateScaled(0,s.length-1);r.push(s[a]),s.splice(a,1),n++}return r}iterate(){let e=ME(Math.trunc(this._multiplier*this._seed)+this._increment);return e<0&&(e=-e),e=e%this._modulus,this._seed=e,e}iterateScaled(e,t){let s=this.iterate();return t<1?e:(s=Math.trunc(e+s/this._modulus*t),s)}};let bs=Qt;bs.DEFAULT_SEED=1;bs.DEFAULT_MODULUS=16777216;bs._randomizer=null;const Ws=class{constructor(e,t,s=1){if(this._cells=[],this._repeatMode=s,this._width=e<1?1:e,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,t&&t.length){let i=0;for(;i<t.length;){const r=t[i];r&&(this._cells.push(r),r.isStatic||(this._isStatic=!1)),i++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==Ws.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const e of this._cells)e&&e.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const e of this._cells)e&&e.clearCache();this._isCached=!1}}render(e,t,s,i,r,n){if(this._repeatMode===Ws.REPEAT_MODE_NONE&&(s=this.getCellsHeight(this._cells,i)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new I),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===s&&I.isEqual(this._cachedBitmapNormal,i)&&this._cachedBitmapDataOffsetX===r&&this._cachedBitmapDataOffsetY===n)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=t.createRenderTexture(this._width,s,`${e}:column`)),this._cachedBitmapNormal.assign(i),this._cachedBitmapDataOffsetX=r,this._cachedBitmapDataOffsetY=n,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case Ws.REPEAT_MODE_NONE:this.renderRepeatNone(i);break;case Ws.REPEAT_MODE_BORDERS:this.renderRepeatBorders(i);break;case Ws.REPEAT_MODE_CENTER:this.renderRepeatCenter(i);break;case Ws.REPEAT_MODE_FIRST:this.renderRepeatFirst(i);break;case Ws.REPEAT_MODE_LAST:this.renderRepeatLast(i);break;default:this.renderRepeatAll(i,r,n);break}return this._cachedBitmapData}getCellsHeight(e,t){if(!e||!e.length)return 0;let s=0,i=0;for(;i<e.length;){const r=e[i];r&&(s+=r.getHeight(t)),i++}return s}renderCells(e,t,s,i,r=0,n=0){if(!e||!e.length||!this._cachedBitmapData)return t;let a=0;for(;a<e.length;){let o=null;if(s?o=e[a]:o=e[e.length-1-a],o){const u=o.render(i,r,n);if(u&&(s||(t-=u.height),u.y=t,Ot.writeToRenderTexture(u,this._cachedBitmapData,!1),s&&(t=t+u.height),s&&t>=this._cachedBitmapData.height||!s&&t<=0))return t}a++}return t}renderRepeatNone(e){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,e)}renderRepeatAll(e,t,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this.renderCells(this._cells,i,!0,e,t,s),!i)return}renderRepeatBorders(e){if(!this._cells.length||!this._cachedBitmapData)return;const t=[];let s=0,i=1;for(;i<this._cells.length-1;){const o=this._cells[i];if(o){const u=o.getHeight(e);u>0&&(s=s+u,t.push(o))}i++}if(this._cells.length==1){const o=this._cells[0];if(o){const u=o.getHeight(e);u>0&&(s=s+u,t.push(o))}}let r=this._cachedBitmapData.height-s>>1,n=this.renderCells(t,r,!0,e),a=this._cells[0];if(a){const o=[a];for(;r>=0;)r=this.renderCells(o,r,!1,e)}if(a=this._cells[this._cells.length-1],a){const o=[a];for(;n<this._cachedBitmapData.height;)n=this.renderCells(o,n,!0,e)}}renderRepeatCenter(e){if(!this._cells.length||!this._cachedBitmapData)return;const t=[],s=[];let i=0,r=0,n=0;for(;n<this._cells.length>>1;){const u=this._cells[n];if(u){const l=u.getHeight(e);l>0&&(i=i+l,t.push(u))}n++}for(n=(this._cells.length>>1)+1;n<this._cells.length;){const u=this._cells[n];if(u){const l=u.getHeight(e);l>0&&(r=r+l,s.push(u))}n++}let a=0,o=this._cachedBitmapData.height;if(i+r>this._cachedBitmapData.height&&(a=i+r-this._cachedBitmapData.height,o=o+(a-(a>>1))),a==0){const u=this._cells[this._cells.length>>1];if(u){const l=u.getHeight(e);if(l>0){const c=this._cachedBitmapData.height-(i+r),g=Math.ceil(c/l)*l;let f=i-(g-c>>1);const R=f+g,m=[u];for(;f<R;)f=this.renderCells(m,f,!0,e)}}}this.renderCells(t,0,!0,e),this.renderCells(s,o,!1,e)}renderRepeatFirst(e){if(!this._cells.length||!this._cachedBitmapData)return;let t=this.renderCells(this._cells,this._cachedBitmapData.height,!1,e);const s=this._cells[0];if(!s)return;const i=[s];for(;t>=0;)t=this.renderCells(i,t,!1,e)}renderRepeatLast(e){if(!this._cells.length||!this._cachedBitmapData)return;let t=this.renderCells(this._cells,0,!0,e);const s=this._cells[this._cells.length-1];if(!s)return;const i=[s];for(;t<this._cachedBitmapData.height;)t=this.renderCells(i,t,!0,e)}getCells(){return this._cells}};let ge=Ws;ge.REPEAT_MODE_NONE=0;ge.REPEAT_MODE_ALL=1;ge.REPEAT_MODE_BORDERS=2;ge.REPEAT_MODE_CENTER=3;ge.REPEAT_MODE_FIRST=4;ge.REPEAT_MODE_LAST=5;const oe=class{constructor(e,t=1,s=1,i=-1,r=1,n=-1,a=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],e<1&&(e=1);let o=0;for(;o<e;)this._columns.push(null),o++;this._repeatMode=t,this._align=s,this._normalMinX=i,this._normalMaxX=r,this._normalMinY=n,this._normalMaxY=a,this._repeatMode===oe.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(e){return bs.getValues(1,0,e*17631)[0]%e}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===oe.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const e of this._columns)e&&e.clearCache();this._isCached=!1}}createColumn(e,t,s,i=1){if(e<0||e>=this._columns.length)return!1;const r=new ge(t,s,i),n=this._columns[e];return n&&n.dispose(),this._columns[e]=r,r&&!r.isStatic&&(this._isStatic=!1),!0}render(e,t,s,i,r,n,a,o,u,l){if(i<1&&(i=1),r<1&&(r=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new I),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===i&&this._cachedBitmapData.height===r&&I.isEqual(this._cachedBitmapNormal,n))return s?(this.copyCachedBitmapOnCanvas(s,this._cachedBitmapHeight,u,l),s):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(n),!a)return this._cachedBitmapHeight=r,this._cachedBitmapData?t.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=t.createAndFillRenderTexture(i,r,`${e}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=r,this._cachedBitmapData=t.createRenderTexture(i,r,`${e}:matrix`),t.clearRenderTexture(this._cachedBitmapData));const c=[];let g=0;for(;g<this._columns.length;){const R=this._columns[g];if(R){const m=R.render(e,t,r,n,o,u);m&&c.push(m)}g++}if(!c.length)return s||this._cachedBitmapData;let f=0;switch(this._repeatMode){case oe.REPEAT_MODE_BORDERS:G.log("REPEAT_MODE_BORDERS");break;case oe.REPEAT_MODE_CENTER:G.log("REPEAT_MODE_CENTER");break;case oe.REPEAT_MODE_FIRST:G.log("REPEAT_MODE_FIRST");break;case oe.REPEAT_MODE_LAST:G.log("REPEAT_MODE_LAST");break;case oe.REPEAT_MODE_RANDOM:f=this.renderRepeatRandom(this._cachedBitmapData,c);break;default:f=this.renderRepeatAll(this._cachedBitmapData,c);break}return this._cachedBitmapHeight=f,s?(this.copyCachedBitmapOnCanvas(s,f,u,l),s):this._cachedBitmapData}copyCachedBitmapOnCanvas(e,t,s,i){if(!e||!this._cachedBitmapData||e===this._cachedBitmapData)return;i||(s=e.height-t-s);let r=null;this._align===oe.ALIGN_TOP?r=new fe(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):r=new fe(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const n=new ze(this._cachedBitmapData.baseTexture,r),a=new Nt(n);a.position.set(0,s),Ot.writeToRenderTexture(a,e,!1)}getColumnsWidth(e){if(!e||!e.length)return 0;let t=0;for(const s of e)s&&(t+=s.width);return t}renderColumns(e,t,s,i){if(!e||!t||!t.length)return new Y(s,0);let r=0,n=0;for(;n<t.length;){const a=i?t[n]:t[t.length-1-n];if(a){i||(s=s-a.width);let o=0;this._align==oe.ALIGN_BOTTOM&&(o=e.height-a.height);const u=new Nt(a);if(u.position.set(s,o),Ot.writeToRenderTexture(u,e,!1),a.height>r&&(r=a.height),i&&(s=s+a.width),i&&s>=e.width||!i&&s<=0)return new Y(s,r)}n++}return new Y(s,r)}renderRepeatAll(e,t){if(!e||!t||!t.length)return 0;this.getColumnsWidth(t);let s=0,i=0;for(;s<e.width;){const r=this.renderColumns(e,t,s,!0);if(s=r.x,r.y>i&&(i=r.y),!r.x)return i}return i}renderRepeatRandom(e,t){if(!e||!t||!t.length)return 0;let s=0,i=0;for(;i<e.width;){const r=t[oe.nextRandomColumnIndex(t.length)];if(r!=null){const n=this.renderColumns(e,[r],i,!0);i=n.x,n.y>s&&(s=n.y)}else return s}return s}getColumns(e){if(this._repeatMode===oe.REPEAT_MODE_RANDOM){const t=[];let s=0;for(;s<e;){const i=this._columns[oe.nextRandomColumnIndex(this._columns.length)];if(i)if(t.push(i),i.width>1)s+=i.width;else break;else break}return t}return this._columns}};let Tt=oe;Tt.REPEAT_MODE_ALL=1;Tt.REPEAT_MODE_BORDERS=2;Tt.REPEAT_MODE_CENTER=3;Tt.REPEAT_MODE_FIRST=4;Tt.REPEAT_MODE_LAST=5;Tt.REPEAT_MODE_RANDOM=6;Tt.REPEAT_MODE_DEFAULT=oe.REPEAT_MODE_ALL;Tt.MIN_NORMAL_COORDINATE_VALUE=-1;Tt.MAX_NORMAL_COORDINATE_VALUE=1;Tt.ALIGN_TOP=1;Tt.ALIGN_BOTTOM=2;Tt.ALIGN_DEFAULT=oe.ALIGN_TOP;class Lh{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)t&&t.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const t of this._planeMaterialItems)t&&t.clearCache();this._isCached=!1}}addMaterialCellMatrix(t,s,i,r=-1,n=1,a=-1,o=1){const u=new Tt(t,s,i,r,n,a,o);return this._planeMaterialItems.push(u),u}getMaterialCellMatrix(t){if(!t)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const s of this._planeMaterialItems)if(s&&t.x>=s.normalMinX&&t.x<=s.normalMaxX&&t.y>=s.normalMinY&&t.y<=s.normalMaxY)return s}return null}render(t,s,i,r,n,a,o,u,l,c){r<1&&(r=1),n<1&&(n=1);const g=this.getMaterialCellMatrix(a);return g?(this._isCached=!0,g.render(t,s,i,r,n,a,o,u,l,c)):null}}Lh.MIN_NORMAL_COORDINATE_VALUE=-1;Lh.MAX_NORMAL_COORDINATE_VALUE=1;class AB{constructor(t,s=null,i=null,r=0){if(this._extraItemCount=0,this._texture=t,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,s&&s.length&&r>0){let n=0;for(;n<s.length;){const a=s[n];a&&this._extraItemAssets.push(a),n++}if(this._extraItemAssets.length){if(i){let a=0;for(;a<i.length;){const o=i[a];o&&this._extraItemOffsets.push(new Y(o.x,o.y)),a++}}this._extraItemCount=r}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(t){if(this._texture){const s=this._texture.getBitmap(t);if(s)return s.height}return 0}render(t,s,i){if(!this._texture)return null;const r=this._texture.getBitmap(t);if(!r)return null;const n=new YE(r,r.width,r.height);if(s!==0||i!==0){for(;s<0;)s+=r.width;for(;i<0;)i+=r.height;n.tilePosition.set(s%r.width,i%r.height),n.uvRespectAnchor=!0,s&&(n.anchor.x=1,n.scale.x=-1),i&&(n.anchor.y=1,n.scale.y=-1)}if(!this.isStatic){const a=Math.min(this._extraItemCount,this._extraItemOffsets.length),o=Math.max(this._extraItemCount,this._extraItemOffsets.length),u=bs.getArray(this._extraItemCount,o);let l=0;for(;l<a;){const c=this._extraItemOffsets[u[l]],g=this._extraItemAssets[l%this._extraItemAssets.length];if(c&&g){const f=g.texture;if(f){let R=g.offsetX,m=g.offsetY,T=1,O=1,C=0,N=0;g.flipH&&(T=-1,C=f.width,R=-(g.width+g.x)),g.flipV&&(O=-1,N=f.height,m=-(g.height+g.y));const S=new Y(c.x+R,c.y+m),D=new ue;let v=S.x+C;v=v>>1<<1,D.scale(T,O),D.translate(v,S.y+N);const b=new Nt(f);b.transform.setFromMatrix(D),n.addChild(b)}}l++}}return n}getAssetName(t){return this._texture==null?null:this._texture.getAssetName(t)}}class Uh{constructor(t,s=-1,i=1,r=-1,n=1,a=null){this._bitmap=t,this._normalMinX=s,this._normalMaxX=i,this._normalMinY=r,this._normalMaxY=n,this._assetName=a}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}Uh.MIN_NORMAL_COORDINATE_VALUE=-1;Uh.MAX_NORMAL_COORDINATE_VALUE=1;class Ai{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}}addBitmap(t,s=-1,i=1,r=-1,n=1,a=null){this._bitmaps.push(new Uh(t,s,i,r,n,a))}getBitmap(t){const s=this.getPlaneTextureBitmap(t);return s?s.bitmap:null}getPlaneTextureBitmap(t){if(!t)return null;for(const s of this._bitmaps)if(s&&t.x>=s.normalMinX&&t.x<=s.normalMaxX&&t.y>=s.normalMinY&&t.y<=s.normalMaxY)return s;return null}getAssetName(t){const s=this.getPlaneTextureBitmap(t);return s?s.assetName:null}}Ai.MIN_NORMAL_COORDINATE_VALUE=-1;Ai.MAX_NORMAL_COORDINATE_VALUE=1;const gE=class{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(e,t){return!0}dispose(){if(this._planes){for(const e of this._planes.values())e&&e.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const e of this._geometries.values())e&&e.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const e of this._planes.values())e&&e.clearCache();for(const e of this._materials.values())e&&e.clearCache()}initialize(e){this._data=e}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const e of this._materials.values())e&&e.dispose();this._materials.clear()}resetTextures(){for(const e of this._textures.values())e&&e.dispose();this._textures.clear()}getTexture(e){return this._textures.get(e)}getMaterial(e){return this._materials.get(e)}getPlane(e){return this._planes.get(e)}addPlane(e,t){return t?this._planes.get(e)?!1:(this._planes.set(e,t),!0):!1}initializeAssetCollection(e){this._data&&(this._assetCollection=e,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(e,t){if(!(!e||!t)&&e.length)for(const s of e){if(!s)continue;const i=s.id;if(!this._textures.get(i)){const r=new Ai;if(s.bitmaps&&s.bitmaps.length)for(const n of s.bitmaps){if(!n)continue;const a=n.assetName;let o=Ai.MIN_NORMAL_COORDINATE_VALUE,u=Ai.MAX_NORMAL_COORDINATE_VALUE,l=Ai.MIN_NORMAL_COORDINATE_VALUE,c=Ai.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(o=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(l=n.normalMinY),n.normalMaxY!==void 0&&(c=n.normalMaxY);const g=t.getAsset(a);if(g){const f=g.texture;if(f){let R=f;g.flipH?R=Yf.getFlipHBitmapData(f):R=R.clone(),r.addBitmap(R,o,u,l,c,a)}}}this._textures.set(i,r)}}}parsePlaneMaterials(e){if(!(!e||!e.length))for(const t of e){if(!t)continue;const s=t.id,i=new Lh;if(t.matrices&&t.matrices.length)for(const r of t.matrices){if(!r)continue;let n=Tt.REPEAT_MODE_DEFAULT,a=Tt.ALIGN_DEFAULT,o=Tt.MIN_NORMAL_COORDINATE_VALUE,u=Tt.MAX_NORMAL_COORDINATE_VALUE,l=Tt.MIN_NORMAL_COORDINATE_VALUE,c=Tt.MAX_NORMAL_COORDINATE_VALUE;switch(r.normalMinX!==void 0&&(o=r.normalMinX),r.normalMaxX!==void 0&&(u=r.normalMaxX),r.normalMinY!==void 0&&(l=r.normalMinY),r.normalMaxY!==void 0&&(c=r.normalMaxY),r.repeatMode){case"borders":n=Tt.REPEAT_MODE_BORDERS;break;case"center":n=Tt.REPEAT_MODE_CENTER;break;case"first":n=Tt.REPEAT_MODE_FIRST;break;case"last":n=Tt.REPEAT_MODE_LAST;break;case"random":n=Tt.REPEAT_MODE_RANDOM;break;default:n=Tt.REPEAT_MODE_DEFAULT;break}switch(r.align){case"top":a=Tt.ALIGN_TOP;break;case"bottom":a=Tt.ALIGN_BOTTOM;break;default:a=Tt.ALIGN_DEFAULT;break}if(r.columns&&r.columns.length){const g=i.addMaterialCellMatrix(r.columns.length,n,a,o,u,l,c);let f=0;for(;f<r.columns.length;){const R=r.columns[f];R&&this.parsePlaneMaterialCellColumn(R,g,f),f++}}}this._materials.set(s,i)}}parsePlaneMaterialCellColumn(e,t,s){if(!e||!t)return;let i=ge.REPEAT_MODE_ALL;const r=e.width,n=this.parsePlaneMaterialCells(e);switch(e.repeatMode){case"borders":i=ge.REPEAT_MODE_BORDERS;break;case"center":i=ge.REPEAT_MODE_CENTER;break;case"first":i=ge.REPEAT_MODE_FIRST;break;case"last":i=ge.REPEAT_MODE_LAST;break;case"none":i=ge.REPEAT_MODE_NONE;break;default:i=ge.REPEAT_MODE_ALL;break}t.createColumn(s,r,n,i)}parsePlaneMaterialCells(e){if(!e||!e.cells||!e.cells.length)return null;const t=[];let s=0;for(;s<e.cells.length;){const i=e.cells[s];if(i){const r=i.textureId;let n=null,a=null,o=null,u=0;if(i.extraData){const g=i.extraData.extraItemTypes,f=i.extraData.offsets;g&&f&&g.length&&f.length&&(n=this.parseExtraItemTypes(g),a=this.parseExtraItemOffsets(f),u=a.length,i.extraData.limitMax!==void 0&&(u=i.extraData.limitMax))}if(n&&n.length){o=[];for(const g of n){if(!g)continue;const f=this._assetCollection.getAsset(g);f&&o.push(f)}}const l=this.getTexture(r),c=new AB(l,o,a,u);t.push(c)}s++}return!t||!t.length?null:t}parseExtraItemTypes(e){const t=[];if(e&&e.length){let s=0;for(;s<e.length;){const i=e[s];i&&t.push(i),s++}}return t}parseExtraItemOffsets(e){const t=[];if(e&&e.length){let s=0;for(;s<e.length;){const[i,r]=e[s];t.push(new Y(i,r)),s++}}return t}getGeometry(e,t,s){t=Math.abs(t),t>90&&(t=90),s=Math.abs(s),s>90&&(s=90);const i=`${e}_${Math.round(t)}_${Math.round(s)}`;let r=this._geometries.get(i);return r||(r=new yi(e,new I(t,s),new I(-10,0,0)),this._geometries.set(i,r),r)}parseVisualizations(e,t){if(!(!e||!t)&&t&&t.length)for(const s of t){if(!s)continue;const i=s.size;let r=Pi.HORIZONTAL_ANGLE_DEFAULT,n=Pi.VERTICAL_ANGLE_DEFAULT;s.horizontalAngle!==void 0&&(r=s.horizontalAngle),s.verticalAngle!==void 0&&(n=s.verticalAngle);const a=s.allLayers,o=e.createPlaneVisualization(i,a&&a.length||0,this.getGeometry(i,r,n));if(o&&a&&a.length){let u=0;for(;u<a.length;){const l=a[u];if(l){let c=null,g=Ee.ALIGN_DEFAULT,f=Pi.DEFAULT_COLOR,R=Ee.DEFAULT_OFFSET;l.materialId&&(c=this.getMaterial(l.materialId)),l.color&&(f=l.color),l.offset&&(R=l.offset),l.align&&(l.align==="bottom"?g=Ee.ALIGN_BOTTOM:l.align=="top"&&(g=Ee.ALIGN_TOP)),o.setLayer(u,c,f,g,R)}u++}}}}render(e,t,s,i,r,n,a,o,u,l=0,c=0,g=0,f=0,R=0){return null}getTextureIdentifier(e,t){return e.toString()}getLayers(e){let t=this.getPlane(e);return t||(t=this.getPlane(gE.DEFAULT)),t.getLayers()}};let gr=gE;gr.DEFAULT="default";class SB extends gr{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseFloors(t)}parseFloors(t){if(t)for(const s in t){const i=t[s];if(!i)continue;const r=i.id,n=i.visualizations,a=new Pi;this.parseVisualizations(a,n),this.addPlane(r,a)||a.dispose()}}render(t,s,i,r,n,a,o,u,l,c=0,g=0,f=0,R=0,m=0){let T=this.getPlane(r);if(T||(T=this.getPlane(gr.DEFAULT)),!T)return null;i&&s.clearAndFillRenderTexture(i);let O=T.render(t,s,i,n,a,o,u,l,c,g);return O&&O!==i&&(O=new ze(O.baseTexture),!O)?null:new Ta(O,-1)}}class to extends yh{render(t,s,i,r,n,a,o,u){const l=this.getPlaneVisualization(a);if(!l||!l.geometry)return null;const c=l.geometry.getScreenPoint(new I(0,0,0)),g=l.geometry.getScreenPoint(new I(0,0,n/l.geometry.scale)),f=l.geometry.getScreenPoint(new I(0,r/l.geometry.scale,0));return c&&g&&f&&(r=Math.round(Math.abs(c.x-f.x)),n=Math.round(Math.abs(c.y-g.y))),l.render(t,s,i,r,n,o,u)}}to.DEFAULT_COLOR=16777215;to.HORIZONTAL_ANGLE_DEFAULT=45;to.VERTICAL_ANGLE_DEFAULT=30;class MB extends gr{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseWalls(t)}parseWalls(t){if(t)for(const s in t){const i=t[s];if(!i)continue;const r=i.id,n=i.visualizations,a=new to;this.parseVisualizations(a,n),this.addPlane(r,a)||a.dispose()}}render(t,s,i,r,n,a,o,u,l,c=0,g=0,f=0,R=0,m=0){let T=this.getPlane(r);if(T||(T=this.getPlane(gr.DEFAULT)),!T)return null;i&&s.clearAndFillRenderTexture(i);let O=T.render(t,s,i,n,a,o,u,l);return O&&O!==i&&(O=new ze(O.baseTexture),!O)?null:new Ta(O,-1)}getTextureIdentifier(t,s){return s?`${t}_${s.x}_${s.y}_${s.z}`:super.getTextureIdentifier(t,s)}}class Ni extends yh{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(t){const s=this.getPlaneVisualization(t);return s?!s.hasAnimationLayers:super.isStatic(t)}initializeDimensions(t,s){t<0&&(t=0),s<0&&(s=0),(t!==this._width||s!==this._height)&&(this._width=t,this._height=s)}render(t,s,i,r,n,a,o,u,l,c,g,f,R){const m=this.getPlaneVisualization(a);if(!m||!m.geometry)return null;const T=m.geometry.getScreenPoint(new I(0,0,0)),O=m.geometry.getScreenPoint(new I(0,0,1)),C=m.geometry.getScreenPoint(new I(0,1,0));if(T&&O&&C){r=Math.round(Math.abs((T.x-C.x)*r/m.geometry.scale)),n=Math.round(Math.abs((T.y-O.y)*n/m.geometry.scale));const N=Math.trunc(l*Math.abs(T.x-C.x)),S=Math.trunc(c*Math.abs(T.y-O.y)),D=Math.trunc(g*Math.abs(T.x-C.x)),v=Math.trunc(f*Math.abs(T.y-O.y));return m.render(t,s,i,r,n,o,u,N,S,D,v,g,f,R)}return null}}Ni.DEFAULT_COLOR=16777215;Ni.HORIZONTAL_ANGLE_DEFAULT=45;Ni.VERTICAL_ANGLE_DEFAULT=30;const Zi=class extends gr{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(e,t){return e<0&&(e=0),t<0&&(t=0),this._landscapeWidth=e,this._landscapeHeight=t,!0}initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseLandscapes(e)}parseLandscapes(e){if(!e)return;const t=Math.trunc(Math.random()*654321);for(const s in e){const i=e[s];if(!i)continue;const r=i.id,n=i.animatedVisualization,a=new Ni;for(const o of n){if(!o)continue;const u=o.size;let l=Ni.HORIZONTAL_ANGLE_DEFAULT,c=Ni.VERTICAL_ANGLE_DEFAULT;o.horizontalAngle!==void 0&&(l=o.horizontalAngle),o.verticalAngle!==void 0&&(c=o.verticalAngle);const g=o.allLayers.length??0,f=a.createPlaneVisualization(u,g||0,this.getGeometry(u,l,c));if(f){bs.setSeed(t);let R=0;for(;R<g;){const m=o.allLayers[R];if(m){if(m.items===void 0){const T=m;let O=null,C=Ee.ALIGN_DEFAULT,N=Ni.DEFAULT_COLOR,S=Ee.DEFAULT_OFFSET;T.materialId&&(O=this.getMaterial(T.materialId)),T.color&&(N=T.color),T.offset&&(S=T.offset),T.align&&(T.align==="bottom"?C=Ee.ALIGN_BOTTOM:T.align==="top"&&(C=Ee.ALIGN_TOP)),f.setLayer(R,O,N,C,S)}else{const O=m.items,C=[];if(O&&O.length){for(const N of O)if(N){N.id;const S=N.assetId,D=this.getCoordinateValue(N.x||"",N.randomX||""),v=this.getCoordinateValue(N.y||"",N.randomY||""),b=N.speedX,w=N.speedY;C.push({asset:S,x:D,y:v,speedX:b,speedY:w})}}f.setAnimationLayer(R,C,this.assetCollection)}R++}}}}this.addPlane(r,a)||a.dispose()}}getCoordinateValue(e,t){let s=0;if(e.length>0&&e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),s=parseFloat(e)/100),t.length>0){const n=bs.getValues(1,0,1e4)[0]/1e4;t.charAt(t.length-1)==="%"&&(t=t.substr(0,t.length-1),s=s+n*parseFloat(t)/100)}return s}render(e,t,s,i,r,n,a,o,u,l=0,c=0,g=0,f=0,R=0){let m=this.getPlane(i);if(m||(m=this.getPlane(Zi.DEFAULT)),!m)return null;s&&t.clearRenderTexture(s);let T=m.render(e,t,s,r,n,a,o,u,l,c,g,f,R);if(T&&T!==s&&(T=new ze(T.baseTexture),!T))return null;let O=null;return!m.isStatic(a)&&Zi.UPDATE_INTERVAL>0?O=new Ta(T,Math.round(R/Zi.UPDATE_INTERVAL)*Zi.UPDATE_INTERVAL+Zi.UPDATE_INTERVAL):O=new Ta(T,-1),O}getTextureIdentifier(e,t){return t?t.x<0?e+"_0":e+"_1":super.getTextureIdentifier(e,t)}};let Nn=Zi;Nn.LANDSCAPES_ENABLED=!0;Nn.LANDSCAPE_DEFAULT_COLOR=8828617;Nn.UPDATE_INTERVAL=500;class tu{constructor(t,s){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],t&&s)for(const i of t){if(!i)continue;const r=i.asset;if(r){const n=s.getAsset(r);n&&this._items.push(new pB(i.x,i.y,i.speedX,i.speedY,n))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const t of this._items)t&&t.dispose();this._items=[]}}clearCache(){}render(t,s,i,r,n,a,o,u,l,c,g,f){if(u>0&&l>0){let R=0;for(;R<this._items.length;){const m=this._items[R];if(m){const T=m.getPosition(u,l,c,g,f);if(T.x=Math.trunc(T.x-a),T.y=Math.trunc(T.y-o),m.bitmapData){if(T.x>-m.bitmapData.width&&T.x<s.width&&T.y>-m.bitmapData.height&&T.y<s.height){const O=new Nt(m.bitmapData.texture);O.position.set(T.x,T.y),t.writeToRenderTexture(O,s,!1)}if(T.x-u>-m.bitmapData.width&&T.x-u<s.width&&T.y>-m.bitmapData.height&&T.y<s.height){const O=new Nt(m.bitmapData.texture);O.position.set(T.x-u,T.y),t.writeToRenderTexture(O,s,!1)}if(T.x>-m.bitmapData.width&&T.x<s.width&&T.y-l>-m.bitmapData.height&&T.y-l<s.height){const O=new Nt(m.bitmapData.texture);O.position.set(T.x,T.y-l),t.writeToRenderTexture(O,s,!1)}if(T.x-u>-m.bitmapData.width&&T.x-u<s.width&&T.y-l>-m.bitmapData.height&&T.y-l<s.height){const O=new Nt(m.bitmapData.texture);O.position.set(T.x-u,T.y-l),t.writeToRenderTexture(O,s,!1)}}}R++}}return s}}class eu{constructor(t,s,i){this._type=t,this._leftSideLoc=s,this._rightSideLoc=i}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class su{constructor(t,s,i,r){this._leftSideLoc=t,this._rightSideLoc=s,this._leftSideLength=i,this._rightSideLength=r}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const ks=class{constructor(e,t,s,i,r,n,a,o,u,l=0,c=0,g=0,f=0){if(this._maskManager=null,this._width=0,this._height=0,this._textureCache=e,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=u,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new I,this._origin.assign(t),this._location=new I,this._location.assign(s),this._leftSide=new I,this._leftSide.assign(i),this._rightSide=new I,this._rightSide.assign(r),this._normal=I.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),o!=null)for(const R of o){if(!R)continue;const m=new I;m.assign(R),this._secondaryNormals.push(m)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new Y,this._relativeDepth=0,this._type=n,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new I,this._cornerB=new I,this._cornerC=new I,this._cornerD=new I,this._width=0,this._height=0,this._textureOffsetX=l,this._textureOffsetY=c,this._textureMaxX=g,this._textureMaxY=f,this._useMask=a,this._uniqueId=++ks._uniqueIdCounter}static blend(e,t){return ia.colorize(t,e|4278190080)&16777215}set canBeVisible(e){e!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=e)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(e){this._color=e}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(e){this._hasTexture=e}set rasterizer(e){this._rasterizer=e}set maskManager(e){this._maskManager=e}set id(e){e!==this._id&&(this.resetTextureCache(),this._id=e)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(e){return!this.visible||!this._bitmapData||!e||this._bitmapData.width!==e.width||this._bitmapData.height!==e.height?null:e}resetTextureCache(e=null){this._activeTexture=null}getTextureIdentifier(e){return this._rasterizer?this._rasterizer.getTextureIdentifier(e,this.normal):e.toString()}needsNewTexture(e,t){if(!e)return!1;const s=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!s||s.timeStamp>=0&&t>s.timeStamp||this._maskChanged))}getTexture(e,t){if(!e)return null;let s=null;if(this.needsNewTexture(e,t)){this.getTextureIdentifier(e.scale);const i=this._leftSide.length*e.scale,r=this._rightSide.length*e.scale,n=e.getCoordinatePosition(this._normal);s=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,i,r,e.scale,n,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,t),s&&this.updateMask(s.texture,e)}else this._activeTexture&&(s=this._activeTexture);return s?(this._activeTexture=s,s.texture):null}resolveMasks(e){if(!this._useMask)return null;const t=new jr,s=0;for(;s<this._bitmapMasks.length;){const i=this._bitmapMasks[s];if(i){const r=this._maskManager.getMask(i.type);if(r){const n=r.getAssetName(e.scale);if(n){const a=e.getCoordinatePosition(this._normal),o=r.getGraphicAsset(e.scale,a);if(o){const u=this._maskBitmapData.width*(1-i.leftSideLoc/this._leftSide.length),l=this._maskBitmapData.height*(1-i.rightSideLoc/this._rightSide.length);t.addMask(n,new Y(u+o.offsetX,l+o.offsetY),o.flipH,o.flipV)}}}}}return t}screenWidth(e){const t=e.getScreenPoint(new I(0,0,0)),s=e.getScreenPoint(new I(0,1,0));return Math.round(this._leftSide.length*Math.abs(t.x-s.x))}getDrawingDatas(e){const t=[];if(this._isVisible){const s=this.resolveMasks(e),i=this._rasterizer.getLayers(this._id);for(const r of i)if(this._hasTexture&&r.getMaterial()){const n=e.getCoordinatePosition(this._normal),a=r.getMaterial().getMaterialCellMatrix(n),o=new jr(s,ks.blend(this._color,r.getColor()),a.isBottomAligned());bs.setSeed(this._randomSeed);for(const u of a.getColumns(this.screenWidth(e))){const l=[];for(const c of u.getCells()){const g=c.getAssetName(n);g&&l.push(g)}l.length>0&&(u.isRepeated()||l.push(""),o.addAssetColumn(l))}o.assetNameColumns.length>0&&t.push(o)}else{const n=new jr(s,ks.blend(this._color,r.getColor()));t.push(n)}t.length||t.push(new jr(s,this._color))}return t}update(e,t){if(!e||this._disposed)return!1;let s=!1;if(this._geometryUpdateId!=e.updateId&&(s=!0),(!s||!this._canBeVisible)&&!this.visible)return!1;if(s){this._activeTexture=null;let i=0;if(i=I.cosAngle(e.directionAxis,this.normal),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let r=0;for(;r<this._secondaryNormals.length;){if(i=I.cosAngle(e.directionAxis,this._secondaryNormals[r]),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;r++}this.updateCorners(e);const a=e.getScreenPosition(this._origin).z;let o=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-a;this._type===ks.TYPE_FLOOR&&(o=o-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===ks.TYPE_LANDSCAPE&&(o=o+.02),this._relativeDepth=o,this._isVisible=!0,this._geometryUpdateId=e.updateId}if(s||this.needsNewTexture(e,t)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);bs.setSeed(this._randomSeed);const i=this.getTexture(e,t);if(i)this.renderTexture(e,i);else return this.dispose(),!1;return i!==null||s}return!1}updateCorners(e){this._cornerA.assign(e.getScreenPosition(this._location)),this._cornerB.assign(e.getScreenPosition(I.sum(this._location,this._rightSide))),this._cornerC.assign(e.getScreenPosition(I.sum(I.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(e.getScreenPosition(I.sum(this._location,this._leftSide))),this._offset=e.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const t=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-t,i=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),r=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-i;this._offset.x=this._offset.x-t,this._cornerA.x=this._cornerA.x-t,this._cornerB.x=this._cornerB.x-t,this._cornerC.x=this._cornerC.x-t,this._cornerD.x=this._cornerD.x-t,this._offset.y=this._offset.y-i,this._cornerA.y=this._cornerA.y-i,this._cornerB.y=this._cornerB.y-i,this._cornerC.y=this._cornerC.y-i,this._cornerD.y=this._cornerD.y-i,this._width=s,this._height=r}getMatrixForDimensions(e,t){let s=this._cornerD.x-this._cornerC.x,i=this._cornerD.y-this._cornerC.y,r=this._cornerB.x-this._cornerC.x,n=this._cornerB.y-this._cornerC.y;(this._type===ks.TYPE_WALL||this._type===ks.TYPE_LANDSCAPE)&&(Math.abs(r-e)<=1&&(r=e),Math.abs(n-e)<=1&&(n=e),Math.abs(s-t)<=1&&(s=t),Math.abs(i-t)<=1&&(i=t));const a=r/e,o=n/e,u=s/t,l=i/t,c=new ue(a,o,u,l);return c.translate(this._cornerC.x,this._cornerC.y),c}renderTexture(e,t){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||t==null||this._bitmapData==null||this.draw(t,this.getMatrixForDimensions(t.width,t.height))}draw(e,t){this._textureCache.writeToRenderTexture(new Nt(e),this._bitmapData,!0,t)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(e,t,s){if(!this._useMask)return!1;for(const r of this._bitmapMasks)if(r&&r.type===e&&r.leftSideLoc===t&&r.rightSideLoc===s)return!1;const i=new eu(e,t,s);return this._bitmapMasks.push(i),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(e,t,s,i){if(this._useMask){for(const n of this._rectangleMasks)if(n&&n.leftSideLoc===e&&n.rightSideLoc===t&&n.leftSideLength===s&&n.rightSideLength===i)return!1;const r=new su(e,t,s,i);return this._rectangleMasks.push(r),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let e=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const t of this._bitmapMasks){if(!t)continue;let s=!1;for(const i of this._bitmapMasksOld)if(i&&i.type===t.type&&i.leftSideLoc===t.leftSideLoc&&i.rightSideLoc===t.rightSideLoc){s=!0;break}if(!s){e=!1;break}}else e=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(e=!1),e&&(this._maskChanged=!1)}updateMask(e,t){if(!e||!t||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const s=e.width,i=e.height;if(this.updateMaskChangeStatus(),(!this._maskBitmapData||this._maskBitmapData.width!==s||this._maskBitmapData.height!==i)&&(this._maskBitmapData=this._textureCache.createAndFillRenderTexture(s,i,"mask"),this._maskChanged=!0),this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(e);const r=t.getCoordinatePosition(this._normal);let n=null,a=0,o=0,u=0;for(;u<this._bitmapMasks.length;){const l=this._bitmapMasks[u];l&&(n=l.type,a=this._maskBitmapData.width-this._maskBitmapData.width*l.leftSideLoc/this._leftSide.length,o=this._maskBitmapData.height-this._maskBitmapData.height*l.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,n,t.scale,r,a,o),this._bitmapMasksOld.push(new eu(n,l.leftSideLoc,l.rightSideLoc))),u++}for(u=0;u<this._rectangleMasks.length;){const l=this._rectangleMasks[u];if(l){a=this._maskBitmapData.width-this._maskBitmapData.width*l.leftSideLoc/this._leftSide.length,o=this._maskBitmapData.height-this._maskBitmapData.height*l.rightSideLoc/this._rightSide.length;const c=this._maskBitmapData.width*l.leftSideLength/this._leftSide.length,g=this._maskBitmapData.height*l.rightSideLength/this._rightSide.length,f=new Nt(Dt.WHITE);f.tint=0,f.width=c,f.height=g,f.position.set(a-c,o-g),this._textureCache.writeToRenderTexture(f,this._maskBitmapData,!1),this._rectangleMasksOld.push(new su(l.leftSideLength,l.rightSideLoc,l.leftSideLength,l.rightSideLength))}u++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(e,this._maskPixels)}combineTextureMask(e,t){var n,a;if(!e||!t)return;const s=this._textureCache.getPixels(e);for(let o=0;o<s.length;o+=4){const u=t[o],l=t[o+1],c=t[o+2];t[o+3],!u&&!l&&!c&&(s[o+3]=0)}const i=(n=e.baseTexture._glTextures[1])==null?void 0:n.texture,r=(a=Yt.instance.renderer)==null?void 0:a.gl;!i||!r||(r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width,e.height,0,r.RGBA,r.UNSIGNED_BYTE,s),r.bindTexture(r.TEXTURE_2D,null))}};let at=ks;at.ZERO_POINT=new Y(0,0);at.TYPE_UNDEFINED=0;at.TYPE_WALL=1;at.TYPE_FLOOR=2;at.TYPE_LANDSCAPE=3;at._uniqueIdCounter=1;class EE extends Ie{constructor(){super(),this._wallRasterizer=new MB,this._floorRasterizer=new SB,this._landscapeRasterizer=new Nn,this._maskManager=new TB,this._initialized=!1}initialize(t){if(!t.roomVisualization)return!1;const s=t.roomVisualization.wallData;s&&this._wallRasterizer.initialize(s);const i=t.roomVisualization.floorData;i&&this._floorRasterizer.initialize(i);const r=t.roomVisualization.landscapeData;r&&this._landscapeRasterizer.initialize(r);const n=t.roomVisualization.maskData;return n&&this._maskManager.initialize(n),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(t){this._initialized||(this._wallRasterizer.initializeAssetCollection(t),this._floorRasterizer.initializeAssetCollection(t),this._landscapeRasterizer.initializeAssetCollection(t),this._maskManager.initializeAssetCollection(t),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}const Kt=class extends an{constructor(){super(),this._data=null,this._roomPlaneParser=new Lt,this._roomPlaneBitmapMaskParser=new Jg,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new du,this._typeVisibility[at.TYPE_UNDEFINED]=!1,this._typeVisibility[at.TYPE_FLOOR]=!0,this._typeVisibility[at.TYPE_WALL]=!0,this._typeVisibility[at.TYPE_LANDSCAPE]=!0}initialize(e){return e instanceof EE?(this._data=e,super.initialize(e),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(e,t,s,i){if(!this.object||!e)return;const r=this.updateGeometry(e),n=this.object.model;let a=!1;if(this.updateThickness(n)&&(a=!0),this.updateHole(n)&&(a=!0),this.initializeRoomPlanes(),a=this.updateMasks(n),!(t<this._lastUpdateTime+this._updateIntervalTime&&!r&&!a)){if(this.updatePlaneTexturesAndVisibilities(n)&&(a=!0),this.updatePlanes(e,r,t)&&(a=!0),a){let o=0;for(;o<this._visiblePlanes.length;){const u=this._visiblePlaneSpriteNumbers[o],l=this.getSprite(u),c=this._visiblePlanes[o];if(l&&c&&c.type!==at.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let g=c.color;const f=(g&255)*this._redColor/255,R=(g>>8&255)*this._greenColor/255,m=(g>>16&255)*this._blueColor/255;g=(g>>24<<24)+(m<<16)+(R<<8)+f,l.color=g}else l.color=c.color;o++}this.updateSpriteCounter++}this.updateModelCounter=n.updateCounter,this._lastUpdateTime=t}}updateGeometry(e){if(!e||this._geometryUpdateId===e.updateId)return!1;this._geometryUpdateId=e.updateId,this._boundingRectangle=null;const t=e.direction;return t&&(t.x!==this._directionX||t.y!==this._directionY||t.z!==this._directionZ||e.scale!==this._roomScale)?(this._directionX=t.x,this._directionY=t.y,this._directionZ=t.z,this._roomScale=e.scale,!0):!1}updateThickness(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(d.ROOM_FLOOR_THICKNESS),s=e.getValue(d.ROOM_WALL_THICKNESS);return!isNaN(t)&&!isNaN(s)&&(t!==this._floorThickness||s!==this._wallThickness)?(this._floorThickness=t,this._wallThickness=s,this.clearPlanes(),!0):!1}updateHole(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(d.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(t)&&t!==this._holeUpdateTime?(this._holeUpdateTime=t,this.clearPlanes(),!0):!1}updateMasks(e){if(this.updateModelCounter===e.updateCounter)return!1;let t=!1;const s=e.getValue(d.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,t=!0);const i=e.getValue(d.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,t=!0);const r=e.getValue(d.ROOM_COLORIZE_BG_ONLY)||!1;return r!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=r,t=!0),t}updatePlaneTexturesAndVisibilities(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(d.ROOM_FLOOR_TYPE),s=e.getValue(d.ROOM_WALL_TYPE),i=e.getValue(d.ROOM_LANDSCAPE_TYPE),r=e.getValue(d.ROOM_FLOOR_VISIBILITY)===1,n=e.getValue(d.ROOM_WALL_VISIBILITY)===1,a=e.getValue(d.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(t,s,i)||this.updatePlaneVisibility(r,n,a)}clearPlanes(){if(this._planes){for(;this._planes.length;){const e=this._planes[0];e&&e.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const e=this.object.model.getValue(d.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(e))return;const t=this.getLandscapeWidth(),s=this.getLandscapeHeight();let i=0,r=this.object.model.getValue(d.ROOM_RANDOM_SEED),n=0;for(;n<this._roomPlaneParser.planeCount;){const a=this._roomPlaneParser.getPlaneLocation(n),o=this._roomPlaneParser.getPlaneLeftSide(n),u=this._roomPlaneParser.getPlaneRightSide(n),l=this._roomPlaneParser.getPlaneSecondaryNormals(n),c=this._roomPlaneParser.getPlaneType(n);let g=null;if(a&&o&&u){const f=I.crossProduct(o,u);if(r=ME(Math.trunc(r*7613+517)>>>0),g=null,c===pt.PLANE_FLOOR){const R=a.x+o.x+.5,m=a.y+u.y+.5,T=Math.trunc(R)-R,O=Math.trunc(m)-m;g=new at(this._textureCache,this.object.getLocation(),a,o,u,at.TYPE_FLOOR,!0,l,r,-T,-O),f.z!==0?g.color=Kt.FLOOR_COLOR:g.color=f.x!==0?Kt.FLOOR_COLOR_RIGHT:Kt.FLOOR_COLOR_LEFT,this._data&&(g.rasterizer=this._data.floorRasterizer)}else c===pt.PLANE_WALL?(g=new at(this._textureCache,this.object.getLocation(),a,o,u,at.TYPE_WALL,!0,l,r),(o.length<1||u.length<1)&&(g.hasTexture=!1),f.x===0&&f.y===0?g.color=Kt.WALL_COLOR_BORDER:f.y>0?g.color=Kt.WALL_COLOR_TOP:f.y===0?g.color=Kt.WALL_COLOR_SIDE:g.color=Kt.WALL_COLOR_BOTTOM,this._data&&(g.rasterizer=this._data.wallRasterizer)):c===pt.PLANE_LANDSCAPE?(g=new at(this._textureCache,this.object.getLocation(),a,o,u,at.TYPE_LANDSCAPE,!0,l,r,i,0,t,s),f.y>0?g.color=Kt.LANDSCAPE_COLOR_TOP:f.y==0?g.color=Kt.LANDSCAPE_COLOR_SIDE:g.color=Kt.LANDSCAPE_COLOR_BOTTOM,this._data&&(g.rasterizer=this._data.landscapeRasterizer),i=i+o.length):c==pt.PLANE_BILLBOARD&&(g=new at(this._textureCache,this.object.getLocation(),a,o,u,at.TYPE_WALL,!0,l,r),(o.length<1||u.length<1)&&(g.hasTexture=!1),f.x==0&&f.y==0?g.color=Kt.WALL_COLOR_BORDER:f.y>0?g.color=Kt.WALL_COLOR_TOP:f.y==0?g.color=Kt.WALL_COLOR_SIDE:g.color=Kt.WALL_COLOR_BOTTOM);if(g){g.maskManager=this._data.maskManager;let R=0;for(;R<this._roomPlaneParser.getPlaneMaskCount(n);){const m=this._roomPlaneParser.getPlaneMaskLeftSideLoc(n,R),T=this._roomPlaneParser.getPlaneMaskRightSideLoc(n,R),O=this._roomPlaneParser.getPlaneMaskLeftSideLength(n,R),C=this._roomPlaneParser.getPlaneMaskRightSideLength(n,R);g.addRectangleMask(m,T,O,C),R++}this._planes.push(g)}}else return;n++}this._isPlaneSet=!0,this.defineSprites()}defineSprites(){this.createSprites(this._planes.length);let e=0;for(;e<this._planes.length;){const t=this._planes[e],s=this.getSprite(e);t&&s&&t.leftSide&&t.rightSide&&(t.type===at.TYPE_WALL&&(t.leftSide.length<1||t.rightSide.length<1)?s.alphaTolerance=Le.MATCH_NOTHING:s.alphaTolerance=Le.MATCH_OPAQUE_PIXELS,t.type===at.TYPE_WALL?s.tag="plane.wall@"+(e+1):t.type===at.TYPE_FLOOR?s.tag="plane.floor@"+(e+1):s.tag="plane@"+(e+1),s.spriteType=he.ROOM_PLANE),e++}}getLandscapeWidth(){let e=0,t=0;for(;t<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(t)===pt.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneLeftSide(t);e+=i.length}t++}return e}getLandscapeHeight(){let e=0,t=0;for(;t<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(t)===pt.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneRightSide(t);i.length>e&&(e=i.length)}t++}return e>5&&(e=5),e}updatePlaneTypes(e,t,s){if(e!==this._floorType?this._floorType=e:e=null,t!==this._wallType?this._wallType=t:t=null,s!==this._landscapeType?this._landscapeType=s:s=null,!e&&!t&&!s)return!1;let i=0;for(;i<this._planes.length;){const r=this._planes[i];r&&(r.type===at.TYPE_FLOOR&&e?r.id=e:r.type===at.TYPE_WALL&&t?r.id=t:r.type===at.TYPE_LANDSCAPE&&s&&(r.id=s)),i++}return!0}updatePlaneVisibility(e,t,s){return e===this._typeVisibility[at.TYPE_FLOOR]&&t===this._typeVisibility[at.TYPE_WALL]&&s===this._typeVisibility[at.TYPE_LANDSCAPE]?!1:(this._typeVisibility[at.TYPE_FLOOR]=e,this._typeVisibility[at.TYPE_WALL]=t,this._typeVisibility[at.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(e,t,s){if(!e||!this.object)return!1;this._assetUpdateCounter++,t&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const i=this._visiblePlanes.length>0;let r=this._visiblePlanes;this._visiblePlanes.length||(r=this._planes);let n=0,a=!1,o=0;for(;o<r.length;){let u=o;i&&(u=this._visiblePlaneSpriteNumbers[o]);const l=this.getSprite(u);if(l){const c=r[o];c?(l.id=c.uniqueId,c.update(e,s)&&(c.visible&&(n=c.relativeDepth+this.floorRelativeDepth+u/1e3,c.type!==at.TYPE_FLOOR&&(n=c.relativeDepth+this.wallRelativeDepth+u/1e3,(c.leftSide.length<1||c.rightSide.length<1)&&(n=n+Kt.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(l,e,c,`plane ${u} ${e.scale}`,n)),a=!0),l.visible!=(c.visible&&this._typeVisibility[c.type])&&(l.visible=!l.visible,a=!0),l.visible&&(i||(this._visiblePlanes.push(c),this._visiblePlaneSpriteNumbers.push(o)))):(l.id=0,l.visible&&(l.visible=!1,a=!0))}o++}return a}updatePlaneMasks(e){if(!e)return;this._roomPlaneBitmapMaskParser.initialize(e);const t=[],s=[];let i=!1,r=0;for(;r<this._planes.length;){const n=this._planes[r];n&&(n.resetBitmapMasks(),n.type===at.TYPE_LANDSCAPE&&t.push(r)),r++}for(const n of this._roomPlaneBitmapMaskParser.masks.values()){const a=this._roomPlaneBitmapMaskParser.getMaskType(n),o=this._roomPlaneBitmapMaskParser.getMaskLocation(n),u=this._roomPlaneBitmapMaskParser.getMaskCategory(n);if(o){let l=0;for(;l<this._planes.length;){const c=this._planes[l];if((c.type===at.TYPE_WALL||c.type===at.TYPE_LANDSCAPE)&&c&&c.location&&c.normal){const g=I.dif(o,c.location);if(Math.abs(I.scalarProjection(g,c.normal))<.01&&c.leftSide&&c.rightSide){const R=I.scalarProjection(g,c.leftSide),m=I.scalarProjection(g,c.rightSide);c.type===at.TYPE_WALL||c.type===at.TYPE_LANDSCAPE&&u===Li.HOLE?c.addBitmapMask(a,R,m):c.type===at.TYPE_LANDSCAPE&&(c.canBeVisible||(i=!0),c.canBeVisible=!0,s.push(l))}}l++}}}for(r=0;r<t.length;){const n=t[r];if(s.indexOf(n)<0){const a=this._planes[n];a.canBeVisible=!1,i=!0}r++}i&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(e,t,s,i,r){const n=s.offset;e.offsetX=-n.x,e.offsetY=-n.y,e.relativeDepth=r,e.color=s.color,e.texture=s.bitmapData,e.name=i+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new fe(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const e=[];for(const t of this._visiblePlanes)e.push(t);return e}get floorRelativeDepth(){return Kt.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return Kt.ROOM_DEPTH_OFFSET+.5}};let Fe=Kt;Fe.FLOOR_COLOR=16777215;Fe.FLOOR_COLOR_LEFT=14540253;Fe.FLOOR_COLOR_RIGHT=12303291;Fe.WALL_COLOR_TOP=16777215;Fe.WALL_COLOR_SIDE=13421772;Fe.WALL_COLOR_BOTTOM=10066329;Fe.WALL_COLOR_BORDER=10066329;Fe.LANDSCAPE_COLOR_TOP=16777215;Fe.LANDSCAPE_COLOR_SIDE=13421772;Fe.LANDSCAPE_COLOR_BOTTOM=10066329;Fe.ROOM_DEPTH_OFFSET=1e3;class CB extends bt{constructor(){super(),this._tileHeight=0}getLayerYOffset(t,s,i){return i===1?(this._tileHeight=this.object.model.getValue(d.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(t,s,i)}}const fE=class{constructor(){this._visualizationDatas=new Map}getVisualization(e){const t=this.getVisualizationType(e);return t?new t:null}getVisualizationType(e){if(!e)return null;let t=null;switch(e){case y.ROOM:t=Fe;break;case y.TILE_CURSOR:t=CB;break;case y.USER:case y.BOT:case y.RENTABLE_BOT:t=vt;break;case y.PET_ANIMATED:t=Qe;break;case y.FURNITURE_STATIC:t=Bs;break;case y.FURNITURE_ANIMATED:t=bt;break;case y.FURNITURE_RESETTING_ANIMATED:t=dB;break;case y.FURNITURE_BADGE_DISPLAY:t=rE;break;case y.FURNITURE_BG:t=gB;break;case y.FURNITURE_BB:t=nE;break;case y.FURNITURE_ISOMETRIC_BB:t=uB;break;case y.FURNITURE_BOTTLE:t=Ja;break;case y.FURNITURE_BUILDER_PLACEHOLDER:t=nB;break;case y.FURNITURE_COUNTER_CLOCK:t=pn;break;case y.FURNITURE_CUBOID:t=aB;break;case y.FURNITURE_EXTERNAL_IMAGE:t=oB;break;case y.FURNITURE_FIREWORKS:t=oE;break;case y.FURNITURE_GIFT_WRAPPED_FIREWORKS:t=$a;break;case y.FURNITURE_GIFT_WRAPPED:t=hB;break;case y.FURNITURE_GUILD_CUSTOMIZED:t=Ar;break;case y.FURNITURE_GUILD_ISOMETRIC_BADGE:t=On;break;case y.FURNITURE_HABBOWHEEL:t=An;break;case y.FURNITURE_MANNEQUIN:t=_E;break;case y.FURNITURE_PARTY_BEAMER:t=Sr;break;case y.FURNITURE_PLANET_SYSTEM:t=lB;break;case y.FURNITURE_POSTER:t=cB;break;case y.FURNITURE_QUEUE_TILE:t=Sn;break;case y.FURNITURE_SCORE_BOARD:t=Mn;break;case y.FURNITURE_SOUNDBLOCK:t=EB;break;case y.FURNITURE_STICKIE:t=fB;break;case y.FURNITURE_VAL_RANDOMIZER:t=Mr;break;case y.FURNITURE_VOTE_COUNTER:t=Cn;break;case y.FURNITURE_VOTE_MAJORITY:t=Cr;break;case y.FURNITURE_WATER_AREA:t=mB;break;case y.FURNITURE_YOUTUBE:t=cE;break}return t||(G.log("Unknown Visualization",e),null)}getVisualizationData(e,t,s){const i=this._visualizationDatas.get(e);if(i)return i;let r=null;switch(t){case y.FURNITURE_STATIC:case y.FURNITURE_GIFT_WRAPPED:case y.FURNITURE_BB:case y.FURNITURE_ISOMETRIC_BB:case y.FURNITURE_BG:case y.FURNITURE_STICKIE:case y.FURNITURE_BUILDER_PLACEHOLDER:r=new Us;break;case y.FURNITURE_ANIMATED:case y.FURNITURE_RESETTING_ANIMATED:case y.FURNITURE_POSTER:case y.FURNITURE_HABBOWHEEL:case y.FURNITURE_VAL_RANDOMIZER:case y.FURNITURE_BOTTLE:case y.FURNITURE_PLANET_SYSTEM:case y.FURNITURE_QUEUE_TILE:case y.FURNITURE_PARTY_BEAMER:case y.FURNITURE_COUNTER_CLOCK:case y.FURNITURE_WATER_AREA:case y.FURNITURE_SCORE_BOARD:case y.FURNITURE_FIREWORKS:case y.FURNITURE_GIFT_WRAPPED_FIREWORKS:case y.FURNITURE_GUILD_CUSTOMIZED:case y.FURNITURE_GUILD_ISOMETRIC_BADGE:case y.FURNITURE_VOTE_COUNTER:case y.FURNITURE_VOTE_MAJORITY:case y.FURNITURE_SOUNDBLOCK:case y.FURNITURE_BADGE_DISPLAY:case y.FURNITURE_EXTERNAL_IMAGE:case y.FURNITURE_YOUTUBE:case y.TILE_CURSOR:r=new Ch;break;case y.FURNITURE_MANNEQUIN:r=new x_;break;case y.ROOM:r=new EE;break;case y.USER:case y.BOT:case y.RENTABLE_BOT:r=new Ia;break;case y.PET_ANIMATED:r=new dE;break}return r?r.initialize(s)?((r instanceof Ia||r instanceof x_)&&(r.avatarManager=B.instance.avatar),fE.CACHING_ENABLED&&this._visualizationDatas.set(e,r),r):(r.dispose(),null):null}};let mE=fE;mE.CACHING_ENABLED=!0;class mt{}mt.ROOM_MIN_X="room_min_x";mt.ROOM_MAX_X="room_max_x";mt.ROOM_MIN_Y="room_min_y";mt.ROOM_MAX_Y="room_max_y";mt.ROOM_IS_PUBLIC="room_is_public";mt.ROOM_Z_SCALE="room_z_scale";mt.AD_DISPLAY_DELAY="ad_display_delay";mt.IS_PLAYING_GAME="is_playing_game";mt.RESTRICTS_DRAGGING="restricts_dragging";mt.RESTRICTS_SCALING="restricts_scaling";mt.RESTRICTED_SCALE="room_scale";class NB{constructor(t,s){this._width=t,this._height=s,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let i=t*s;for(;i>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),i--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,s){return t>=0&&t<this._width&&s>=0&&s<this._height}getTileHeight(t,s){return this.validPosition(t,s)?this._heights[s*this._width+t]:0}setTileHeight(t,s,i){this.validPosition(t,s)&&(this._heights[s*this._width+t]=i)}setStackingBlocked(t,s,i){this.validPosition(t,s)&&(this._isNotStackable[s*this._width+t]=i)}setIsRoomTile(t,s,i){this.validPosition(t,s)&&(this._isRoomTile[s*this._width+t]=i)}validateLocation(t,s,i,r,n,a,o,u,l,c=-1){let g=0,f=0;if(!this.validPosition(t,s)||!this.validPosition(t+i-1,s+r-1))return!1;(n<0||n>=this._width)&&(n=0),(a<0||a>=this._height)&&(a=0),o=Math.min(o,this._width-n),u=Math.min(u,this._height-a),c===-1&&(c=this.getTileHeight(t,s));let R=s;for(;R<s+r;){for(g=t;g<t+i;){if(g<n||g>=n+o||R<a||R>=a+u){if(f=R*this._width+g,l){if(!this._isRoomTile[f])return!1}else if(this._isNotStackable[f]||!this._isRoomTile[f]||Math.abs(this._heights[f]-c)>.01)return!1}g++}R++}return!0}get width(){return this._width}get height(){return this._height}}const ms=class{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(e){this._scale=e}dispose(){this.reset(),this._isDisposed=!0}initialize(e,t,s){if(e<=this._width&&t<=this._height){this._width=e,this._height=t,this._floorHeight=s;return}this.reset();let i=0;for(;i<t;){const r=[];this._heightMap.push(r);let n=0;for(;n<e;)r.push(0),n++;i++}this._width=e,this._height=t,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(e,t,s){if(e<0||e>=this._width||t<0||t>=this._height)return!1;const i=this._heightMap[t];return i?(i[e]=s,!0):!1}getHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return 0;const s=this._heightMap[t];return s?s[e]:0}getLocation(e,t,s,i,r){if(e==0&&t==0){e=this._width,t=this._height;const l=Math.round(this.scale/10);if(r==ms.R){let c=this._width-1;for(;c>=0;){let g=1;for(;g<this._height;){if(this.getHeight(c,g)<=this._floorHeight){g-1<t&&(e=c,t=g-1);break}g++}c--}i=i+(this.scale/4-l/2),s=s+this.scale/2}else{let c=this._height-1;for(;c>=0;){let g=1;for(;g<this._width;){if(this.getHeight(g,c)<=this._floorHeight){g-1<e&&(e=g-1,t=c);break}g++}c--}i=i+(this.scale/4-l/2),s=s-l}}let n=e,a=t,o=this.getHeight(e,t);return r==ms.R?(n=n+(s/(this._scale/2)-.5),a=a+.5,o=o-(i-s/2)/(this._scale/2)):(a=a+((this._scale/2-s)/(this._scale/2)-.5),n=n+.5,o=o-(i-(this._scale/2-s)/2)/(this._scale/2)),new I(n,a,o)}getLocationOldFormat(e,t,s){let i,r,n=0,a=0;r=Math.ceil(e),n=r-e;let o,u,l,c=0;for(i=0;i<this._width;){if(r>=0&&r<this._height){if(this.getHeight(i,r)<=this._floorHeight){o=i-1,u=r,a=i,s=ms.L;break}if(this.getHeight(i,r+1)<=this._floorHeight){o=i,u=r,a=u-e,s=ms.R;break}}r++,i++}const g=this.scale/2*n;let f=-a*this.scale/2;return f=f+-t*18/32*this.scale/2,c=this.getHeight(o,u),l=c*this.scale/2+f,s==ms.R?l=l+n*this.scale/4:l=l+(1-n)*this.scale/4,this.getLocation(o,u,g,l,s)}getOldLocation(e,t){if(e==null)return null;let s=0,i=0,r=0,n=0,a="",o=0;if(t==90)s=Math.floor(e.x-.5),i=Math.floor(e.y+.5),o=this.getHeight(s,i),r=this._scale/2-(e.y-i+.5)*(this._scale/2),n=(o-e.z)*(this._scale/2)+(this._scale/2-r)/2,a=ms.L;else if(t==180)s=Math.floor(e.x+.5),i=Math.floor(e.y-.5),o=this.getHeight(s,i),r=(e.x+.5-s)*(this._scale/2),n=(o-e.z)*(this._scale/2)+r/2,a=ms.R;else return null;return[s,i,r,n,a]}getOldLocationString(e,t){const s=this.getOldLocation(e,t);if(s==null)return null;const i=Math.trunc(s[0]),r=Math.trunc(s[1]),n=Math.trunc(s[2]),a=Math.trunc(s[3]),o=s[4];return":w="+i+","+r+" l="+n+","+a+" "+o}getDirection(e){return e==ms.R?180:90}getFloorAltitude(e,t){const s=this.getHeight(e,t),i=s+1;return s+(Math.trunc(this.getHeight(e-1,t-1))==i||Math.trunc(this.getHeight(e,t-1))==i||Math.trunc(this.getHeight(e+1,t-1))==i||Math.trunc(this.getHeight(e-1,t))==i||Math.trunc(this.getHeight(e+1,t))==i||Math.trunc(this.getHeight(e-1,t+1))==i||Math.trunc(this.getHeight(e,t+1))==i||Math.trunc(this.getHeight(e+1,t+1))==i?.5:0)}isRoomTile(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height&&this._heightMap[t][e]>=0}};let Nr=ms;Nr.DEFAULT_SCALE=32;Nr.L="l";Nr.R="r";const IE=class{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new I}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(e){this._targetId=e}get targetCategory(){return this._targetCategory}set targetCategory(e){this._targetCategory=e}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(e){this._targetObjectLoc.assign(e)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(e){this._limitedLocX=e}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(e){this._limitedLocY=e}get centeredLocX(){return this._centeredLocX}set centeredLocX(e){this._centeredLocX=e}get centeredLocY(){return this._centeredLocY}set centeredLocY(e){this._centeredLocY=e}get screenWd(){return this._screenWd}set screenWd(e){this._screenWd=e}get screenHt(){return this._screenHt}set screenHt(e){this._screenHt=e}get scale(){return this._scale}set scale(e){this._scale!=e&&(this._scale=e,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(e){this._roomWd=e}get roomHt(){return this._roomHt}set roomHt(e){this._roomHt=e}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(e){this._geometryUpdateId=e}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(e){let t;this._targetLoc==null&&(this._targetLoc=new I),(this._targetLoc.x!=e.x||this._targetLoc.y!=e.y||this._targetLoc.z!=e.z)&&(this._targetLoc.assign(e),t=I.dif(this._targetLoc,this._currentLoc),this._moveDistance=t.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(e){this._currentLoc==null&&(this._currentLoc=new I,this._currentLoc.assign(e))}resetLocation(e){this._currentLoc==null&&(this._currentLoc=new I),this._currentLoc.assign(e)}update(e,t){let s,i,r,n,a;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}s=I.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=t?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(i=Math.sin(Math.PI*s.length/this._moveDistance),r=t*.5,n=this._moveDistance/IE.MOVE_SPEED_DENOMINATOR,a=r+(n-r)*i,this._maintainPreviousMoveSpeed&&(a<this._previousMoveSpeed?(a=this._previousMoveSpeed,a>s.length&&(a=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=a,s.divide(s.length),s.multiply(a),this._currentLoc=I.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(e){this._followDuration=e}};let RE=IE;RE.MOVE_SPEED_DENOMINATOR=12;class iu{constructor(t,s){this._roomId=t,this._data=s,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}class uo{constructor(t,s,i,r,n,a,o,u=NaN,l=-1,c=0,g=0,f="",R=!0,m=!0,T=-1){this._id=t,this._typeId=s,this._type=i,this._state=a,this._data=o,this._extra=u,this._expiryTime=l,this._usagePolicy=c,this._ownerId=g,this._ownerName=f,this._synchronized=R,this._realRoomObject=m,this._sizeZ=T,this._location=new I,this._direction=new I,this._location.assign(r),this._direction.assign(n)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class DB{constructor(t,s){this._tileObjectMap=new Map;let i=0;for(;i<s;)this._tileObjectMap.set(i,new Map),i++;this._width=t,this._height=s}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const s of t)this.addRoomObject(s)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(t,s){if(t>=0&&t<this._width&&s>=0&&s<this._height){const i=this._tileObjectMap.get(s);if(i)return i.get(t)}return null}setObjectInTile(t,s,i){if(!i.isReady){G.log("Assigning non initialized object to tile object map!");return}if(t>=0&&t<this._width&&s>=0&&s<this._height){const r=this._tileObjectMap.get(s);r&&r.set(t,i)}}addRoomObject(t){if(!t||!t.model||!t.isReady)return;const s=t.getLocation(),i=t.getDirection();if(!s||!i)return;let r=t.model.getValue(d.FURNITURE_SIZE_X),n=t.model.getValue(d.FURNITURE_SIZE_Y);r<1&&(r=1),n<1&&(n=1);const a=Math.trunc(i.x+45)%360/90;(a===1||a===3)&&([r,n]=[n,r]);let o=s.y;for(;o<s.y+n;){let u=s.x;for(;u<s.x+r;){const l=this.getObjectIntTile(u,o);(!l||l!==t&&l.getLocation().z<=s.z)&&this.setObjectInTile(u,o,t),u++}o++}}}class PB{constructor(t){this._roomId=t,this._modelName=null,this._legacyGeometry=new Nr,this._tileObjectMap=null,this._roomCamera=new RE,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new DB(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const s=this._floorStack.get(t);return s?(this._floorStack.delete(t),s):null}getPendingFurnitureFloor(t){const s=this._floorStack.get(t);return s?(this._floorStack.delete(t),s):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const s=this._wallStack.get(t);return s?(this._wallStack.delete(t),s):null}getPendingFurnitureWall(t){const s=this._wallStack.get(t);return s?(this._wallStack.delete(t),s):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}addButtonMouseCursorOwner(t){return this._mouseButtonCursorOwners.indexOf(t)===-1?(this._mouseButtonCursorOwners.push(t),!0):!1}removeButtonMouseCursorOwner(t){const s=this._mouseButtonCursorOwners.indexOf(t);return s>-1?(this._mouseButtonCursorOwners.splice(s,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class yB{constructor(t,s){this._object=t,this._groupBadge=s}get object(){return this._object}get groupBadge(){return this._groupBadge}}class lo{constructor(t,s,i,r,n,a=0,o=null,u=null,l=-1,c=-1,g=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=s,this._operation=i,this._loc=new I,this._loc.assign(r),this._dir=new I,this._dir.assign(n),this._typeId=a,this._instanceData=o,this._stuffData=u,this._state=l,this._animFrame=c,this._posture=g}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}const Ze=class{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(e,t){const s=[];for(const i of e)if(i)if(i.type==="boutique_mannequin1"&&i.name.indexOf("mannequin_")===0){const r=t.getRoomObject(t.activeRoomId,i.objectId,A.FLOOR);if(r){const n=r.visualization.getSpriteList();if(n)for(const a of n)a.x=a.x+(i.x+i.width/2+Ze.MANNEQUIN_MAGIC_X_OFFSET),a.y=a.y+(i.y+i.height+Ze.MANNEQUIN_MAGIC_Y_OFFSET),a.z=a.z+i.z,s.push(a)}}else s.push(i);return s}static sortSpriteDataObjects(e,t){return e.z<t.z?1:(e.z>t.z,-1)}static isSpriteInViewPort(e,t,s){return!0}static sortQuadPoints(e,t,s,i){const r=[];if(e.x==t.x?r.push(e,s,t,i):e.x==s.x?r.push(e,t,s,i):t.x<e.x&&t.y>e.y||t.x>e.x&&t.y<e.y?r.push(e,s,t,i):r.push(e,t,s,i),r[0].x<r[1].x){let n=r[0];r[0]=r[1],r[1]=n,n=r[2],r[2]=r[3],r[3]=n}if(r[0].y<r[2].y){let n=r[0];r[0]=r[2],r[2]=n,n=r[1],r[1]=r[3],r[3]=n}return r}getFurniData(e,t,s,i){const r=[];let n=t.getSortableSpriteList();const a=s.getRoomObjects(s.activeRoomId,A.UNIT);for(const o of a)if(o.id!==i){const u=o.visualization.getSpriteList();if(u){let l=0,c=0;for(const f of n)if(f.name==="avatar_"+o.id){l=f.z,c=f.y+f.height-t.geometry.scale/4;break}const g=s.getRoomObjectScreenLocation(s.activeRoomId,o.id,A.UNIT,t.id);if(g){c===0&&(c=g.y);for(const f of u)f.x=f.x+(g.x-t.screenOffsetX),f.y=f.y+c,f.z=f.z+l,(f.name.indexOf("h_std_fx29_")===0||f.name.indexOf("h_std_fx185_")===0)&&(f.y=f.y+Ze.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),n.push(f)}}}n=Ze.addMannequinSprites(n,s),n.sort(Ze.sortSpriteDataObjects);for(const o of n)o.name!==null&&o.name.length>0&&o.name.indexOf("tile_cursor_")!==0&&Ze.isSpriteInViewPort(o,e,t)&&(i<0||o.objectId!=i)&&(r.push(this.getSpriteDataObject(o,e,t,s)),this.maxZ||(this.maxZ=o.z),this.spriteCount++);return JSON.stringify(r)}getRoomRenderingModifiers(e){return JSON.stringify(new Object)}getSpriteDataObject(e,t,s,i){let r=[];const n={};let a=e.name;return e.name.indexOf("@")!==-1&&(r=e.name.split("@"),a=r[0],r[1]),n.name=a,n.x=e.x-t.x,n.y=e.y-t.y,n.x=n.x+s.screenOffsetX,n.y=n.y+s.screenOffsetY,n.z=e.z,e.alpha&&e.alpha.toString()!=="255"&&(n.alpha=e.alpha),e.flipH&&(n.flipH=e.flipH),e.skew&&(n.skew=e.skew),e.frame&&(n.frame=e.frame),e.color&&e.color.length>0&&(n.color=parseInt(e.color)),e.blendMode&&e.blendMode!=="normal"&&(n.blendMode=e.blendMode),a.indexOf("http")===0&&(n.width=e.width,n.height=e.height,this.externalImageCount++,this.externalImageCount>Ze.MAX_EXTERNAL_IMAGE_COUNT&&(n.name="box")),e.posture&&(n.posture=e.posture),n}makeBackgroundPlane(e,t,s){const i=new Y(0,0),r=new Y(e.width,0),n=new Y(0,e.height),a=new Y(e.width,e.height),o=Ze.sortQuadPoints(i,r,n,a);let u=0;s.length>0?(u=s[0].z,this.maxZ&&(u=Math.max(this.maxZ,u))):u=this.maxZ?this.maxZ:0,u=u+(this.spriteCount*1.776104+s.length*2.31743);const l=new jr(null,t);return l.cornerPoints=o,l.z=u,l}sortRoomPlanes(e,t,s){const i=new Map;let r=1;this.maxZ&&(r=r+this.maxZ);for(const o of e){const u={plane:o,z:r};i.set(o.uniqueId,u)}const n=t.getPlaneSortableSprites();n.sort((o,u)=>u.z-o.z),n.reverse();let a=[];for(const o of n){const u=o.sprite;if(u){const l=i.get(u.id);l&&(i.delete(u.id),l.z=o.z,a.push(l))}}return a=a.concat(Array.from(i.values())),a}getRoomPlanes(e,t,s,i){const r=[],a=s.getRoomObject(s.activeRoomId,Ce.ROOM_OBJECT_ID,A.ROOM).visualization;if(a){const o=t.geometry,u=this.sortRoomPlanes(a.planes,t,s),l=Yt.instance.stage;for(const c of u){const g=c.plane,f=[],R=I.sum(g.location,g.leftSide),m=o.getScreenPoint(g.location),T=o.getScreenPoint(R),O=o.getScreenPoint(I.sum(g.location,g.rightSide)),C=o.getScreenPoint(I.sum(R,g.rightSide));f.push(m,T,O,C);let N=0,S=0;for(const D of f)D.x+=l.width/2,D.y+=l.height/2,D.x+=t.screenOffsetX,D.y+=t.screenOffsetY,D.x+=-e.x,D.y+=-e.y,D.x<0?N--:D.x>=e.width&&N++,D.y<0?S--:D.y>=e.height&&S++;if(!(Math.abs(N)===4||Math.abs(S)===4)){const D=Ze.sortQuadPoints(m,T,O,C);for(const v of g.getDrawingDatas(o))v.cornerPoints=D,v.z=c.z,r.push(v)}}r.unshift(this.makeBackgroundPlane(e,i,r))}return r}};let Dn=Ze;Dn.MANNEQUIN_MAGIC_X_OFFSET=1;Dn.MANNEQUIN_MAGIC_Y_OFFSET=-16;Dn.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52;Dn.MAX_EXTERNAL_IMAGE_COUNT=30;class LB extends Ie{constructor(t){super(),this._connection=null,this._roomCreator=t,this._planeParser=new Lt,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(t){this._connection||!t||(this._connection=t,this._connection.addMessageEvent(new ca(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new lr(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new E_(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new l_(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new d_(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new g_(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new f_(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new c_(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new Jo(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new Qo(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new i_(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new $o(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new t_(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new e_(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new s_(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new o_(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new __(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new h_(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new u_(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new r_(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new n_(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new a_(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new _a(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new I_(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new ha(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new R_(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new T_(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new p_(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new ua(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new O_(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new la(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new A_(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new ch(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new aa(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new oa(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new m_(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new na(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new Cc(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new Pc(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new Zo(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new Eh(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new ac(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new rc(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new nc(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(t){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof ca)||!t.connection)return;const s=t.getParser();s&&(this._ownUserId=s.userInfo.userId)}onRoomReadyMessageEvent(t){const s=t.getParser();if(this._currentRoomId!==s.roomId&&this.setRoomId(s.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(s.roomId,s.name),this._initialConnection){t.connection.send(new wd),this._initialConnection=!1;return}t.connection.send(new D_)}onRoomPaintEvent(t){if(!(t instanceof E_))return;const s=t.getParser();if(!s)return;const i=s.floorType,r=s.wallType,n=s.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,i,r,n)}onRoomModelEvent(t){if(!(t instanceof l_)||!t.connection||!this._roomCreator)return;const s=t.getParser();if(!s)return;const i=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!i)return;this._planeParser.reset();const r=s.width,n=s.height;this._planeParser.initializeTileMap(r,n);let a=null;this._latestEntryTileEvent&&(a=this._latestEntryTileEvent.getParser());let o=-1,u=-1,l=0,c=0,g=0;for(;g<n;){let m=0;for(;m<r;){const T=s.getHeight(m,g);(g>0&&g<n-1||m>0&&m<r-1)&&T!=Lt.TILE_BLOCKED&&(a==null||m==a.x&&g==a.y)&&(s.getHeight(m,g-1)==Lt.TILE_BLOCKED&&s.getHeight(m-1,g)==Lt.TILE_BLOCKED&&s.getHeight(m,g+1)==Lt.TILE_BLOCKED&&(o=m+.5,u=g,l=T,c=90),s.getHeight(m,g-1)==Lt.TILE_BLOCKED&&s.getHeight(m-1,g)==Lt.TILE_BLOCKED&&s.getHeight(m+1,g)==Lt.TILE_BLOCKED&&(o=m,u=g+.5,l=T,c=180)),this._planeParser.setTileHeight(m,g,T),m++}g++}this._planeParser.setTileHeight(Math.floor(o),Math.floor(u),l),this._planeParser.initializeFromTileData(s.wallHeight),this._planeParser.setTileHeight(Math.floor(o),Math.floor(u),l+this._planeParser.wallHeight),s.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),i.scale=Nr.DEFAULT_SCALE,i.initialize(r,n,this._planeParser.floorHeight);let f=s.height-1;for(;f>=0;){let m=s.width-1;for(;m>=0;)i.setHeight(m,f,this._planeParser.getTileHeight(m,f)),m--;f--}const R=this._planeParser.getMapData();R.doors.push({x:o,y:u,z:l,dir:c}),this._roomCreator.createRoomInstance(this._currentRoomId,R)}onRoomHeightMapEvent(t){if(!(t instanceof d_)||!t.connection||!this._roomCreator)return;const s=t.getParser();if(!s)return;const i=s.width,r=s.height,n=new NB(i,r);let a=0;for(;a<r;){let o=0;for(;o<i;)n.setTileHeight(o,a,s.getTileHeight(o,a)),n.setStackingBlocked(o,a,s.getStackingBlocked(o,a)),n.setIsRoomTile(o,a,s.isRoomTile(o,a)),o++;a++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof g_)||!t.connection||!this._roomCreator)return;const s=t.getParser();if(!s)return;const i=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(i){for(;s.next();)i.setTileHeight(s.x,s.y,s.tileHeight()),i.setStackingBlocked(s.x,s.y,s.isStackingBlocked()),i.setIsRoomTile(s.x,s.y,s.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof f_))return;const s=t.getParser();if(!s)return;const i=!s.hideWalls,r=!0,n=s.thicknessWall,a=s.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,i,r),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,n,a))}onRoomDoorEvent(t){t instanceof c_&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof Jo)||!t.connection||!this._roomCreator)return;const s=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.rollerId,null,null,2,null);const i=s.itemsRolling;if(i&&i.length)for(const n of i)n&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,n.id,n.location,n.targetLocation);const r=s.unitRolling;if(r){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,r.id,r.location,r.targetLocation);const n=this._roomCreator.getRoomObjectUser(this._currentRoomId,r.id);if(n&&n.type!==et.MONSTER_PLANT){let a="std";switch(r.movementType){case As.MOVE:a="mv";break;case As.SLIDE:a="std";break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,a)}}}onObjectsDataUpdateEvent(t){if(!(t instanceof Qo)||!t.connection||!this._roomCreator)return;const s=t.getParser();if(s)for(const i of s.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,i.id,null,null,i.state,i.data)}onFurnitureAliasesEvent(t){!(t instanceof i_)||!t.connection||!this._roomCreator||(t.getParser().aliases,this._connection.send(new D_))}onFurnitureFloorAddEvent(t){if(!(t instanceof $o)||!t.connection||!this._roomCreator)return;const s=t.getParser().item;s&&this.addRoomObjectFurnitureFloor(this._currentRoomId,s)}onFurnitureFloorEvent(t){if(!(t instanceof t_)||!t.connection||!this._roomCreator)return;const s=t.getParser();if(!s)return;const i=s.items.length;let r=0;for(;r<i;){const n=s.items[r];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),r++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof e_)||!t.connection||!this._roomCreator)return;const s=t.getParser();s&&(s.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,s.itemId,s.isExpired?-1:s.userId,!0)},s.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,s.itemId,s.isExpired?-1:s.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof s_)||!t.connection||!this._roomCreator)return;const s=t.getParser().item;if(!s)return;const i=new I(s.x,s.y,s.z),r=new I(s.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.itemId,i,r,s.data.state,s.data,s.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,s.itemId,s.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,s.itemId,s.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof o_)||!t.connection||!this._roomCreator)return;const s=t.getParser().item;s&&this.addRoomObjectFurnitureWall(this._currentRoomId,s)}onFurnitureWallEvent(t){if(!(t instanceof __)||!t.connection||!this._roomCreator)return;const s=t.getParser();if(!s)return;const i=s.items.length;let r=0;for(;r<i;){const n=s.items[r];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),r++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof h_)||!t.connection||!this._roomCreator)return;const s=t.getParser();s&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,s.itemId,s.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof u_)||!t.connection||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;const i=t.getParser().item;if(!i)return;const r=s.getLocation(i.width,i.height,i.localX,i.localY,i.direction),n=new I(s.getDirection(i.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,i.itemId,r,n,i.state,i.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,i.itemId,i.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof r_)||!t.connection||!this._roomCreator)return;const s=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.furnitureId,null,null,s.objectData.state,s.objectData)}onItemDataUpdateMessageEvent(t){if(!(t instanceof n_)||!t.connection||!this._roomCreator)return;const s=t.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,s.furnitureId,s.data)}onOneWayDoorStatusMessageEvent(t){if(!(t instanceof a_)||!t.connection||!this._roomCreator)return;const s=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.itemId,null,null,s.state,new me)}onDiceValueMessageEvent(t){if(!(t instanceof Zo)||!t.connection||!this._roomCreator)return;const s=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.itemId,null,null,s.value,new me)}onRoomUnitDanceEvent(t){!(t instanceof _a)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,d.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){!(t instanceof I_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof ha)||!t.connection||!this._roomCreator)return;const s=t.getParser().users;if(!(!s||!s.length)){for(const i of s){if(!i)continue;const r=new I(i.x,i.y,i.z),n=new I(i.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,i.roomIndex,r,n,i.dir,i.userType,i.figure),i.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,i.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,i.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,i.roomIndex,i.figure,i.sex,i.subType,i.isRiding),et.getTypeString(i.userType)===et.PET&&this._roomCreator.getPetTypeId(i.figure)===ht.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.roomIndex,i.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,d.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(i.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(t){!(t instanceof R_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,d.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){!(t instanceof T_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,d.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){!(t instanceof p_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,d.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){!(t instanceof ua)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof O_)||!t.connection||!this._roomCreator)return;const s=t.getParser();s&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.unitId,d.FIGURE_NUMBER_VALUE,s.value)}onRoomUnitRemoveEvent(t){!(t instanceof la)||!t.connection||!this._roomCreator||(this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(t){if(!(t instanceof A_)||!t.connection||!this._roomCreator)return;const s=t.getParser().statuses;if(!s||!s.length)return;const i=this._roomCreator.getRoomInstance(this._currentRoomId);if(!i)return;const r=i.model.getValue(mt.ROOM_Z_SCALE)||1;for(const n of s){if(!n)continue;let a=n.height;a&&(a=a/r);const o=new I(n.x,n.y,n.z+a),u=new I(n.direction);let l=null;n.didMove&&(l=new I(n.targetX,n.targetY,n.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,o,l,n.canStandUp,a,u,n.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let c=!0,g=!1,f=d.STD,R="";if(n.actions&&n.actions.length){for(const m of n.actions)if(m)switch(m.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,m.value);break;case"sign":n.actions.length===1&&(c=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.id,d.FIGURE_SIGN,parseInt(m.value));break;case"gst":n.actions.length===1&&(c=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,m.value);break;case"wav":case"mv":g=!0,f=m.action,R=m.value;break;case"trd":break;default:g=!0,f=m.action,R=m.value;break}}g?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,f,R):c&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,d.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(t){if(!t.connection||!this._roomCreator)return;const s=t.getParser();s&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,s.roomIndex,s.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,d.FIGURE_TALK,s.message.length/10))}onRoomUnitTypingEvent(t){!(t instanceof m_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,d.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof na)||!t.connection||!this._roomCreator)return;const s=t.getParser();s&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figureData.figuredata,"","",s.isRiding)}onPetExperienceEvent(t){const s=t.getParser();s&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,d.FIGURE_GAINED_EXPERIENCE,s.gainedExperience)}onYouArePlayingGameEvent(t){if(!t)return;const s=t.getParser();s&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,s.isPlaying)}addRoomObjectFurnitureFloor(t,s){if(!s||!this._roomCreator)return;const i=new I(s.x,s.y,s.z),r=new I(s.direction);s.spriteName?this._roomCreator.addFurnitureFloorByTypeName(t,s.itemId,s.spriteName,i,r,s.state,s.data,s.extra,s.expires,s.usagePolicy,s.userId,s.username,!0,!0,s.stackHeight):this._roomCreator.addFurnitureFloor(t,s.itemId,s.spriteId,i,r,s.state,s.data,s.extra,s.expires,s.usagePolicy,s.userId,s.username,!0,!0,s.stackHeight)}addRoomObjectFurnitureWall(t,s){if(!s||!this._roomCreator)return;const i=this._roomCreator.getLegacyWallGeometry(t);if(!i)return;let r=null;s.isOldFormat||(r=i.getLocation(s.width,s.height,s.localX,s.localY,s.direction));const n=new I(i.getDirection(s.direction));this._roomCreator.addFurnitureWall(t,s.itemId,s.spriteId,r,n,s.state,s.stuffData,s.secondsToExpiration,s.usagePolicy,s.userId,s.username)}onIgnoreResultEvent(t){if(!t)return;const s=t.getParser();if(!s)return;const i=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!i)return;const r=i.userDataManager.getUserDataByName(s.name);if(r)switch(s.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,d.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,d.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(t){const s=t.getParser();this._guideId=s.guideUserId,this._requesterId=s.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(t){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(t){this.removeGuideMarker()}updateGuideMarker(){const t=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===t?He.GUIDE:He.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===t?He.REQUESTER:He.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,He.NONE),this.setUserGuideStatus(this._requesterId,He.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(t,s){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const i=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!i)return;const r=i.userDataManager.getDataByType(t,Ye.USER);r&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,d.FIGURE_GUIDE_STATUS,s)}get currentRoomId(){return this._currentRoomId}}class UB extends Ie{constructor(t){super(),this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(H.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(H.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(t){let s=this.getSelectedRoomObjectData(t.roomId);if(s&&s.operation===K.OBJECT_PLACE&&s.id===t.objectId){const i=this._roomEngine.getRoomObject(t.roomId,s.id,s.category);if(i&&i.model&&s.category===A.FLOOR){const r=i.model.getValue(d.FURNITURE_ALLOWED_DIRECTIONS);if(r&&r.length){const n=new I(r[0]);if(i.setDirection(n),this.updateSelectedObjectData(t.roomId,s.id,s.category,s.loc,n,s.operation,s.typeId,s.instanceData,s.stuffData,s.state,s.animFrame,s.posture),s=this.getSelectedRoomObjectData(t.roomId),!s)return}}this.setFurnitureAlphaMultiplier(i,.5)}}processRoomCanvasMouseEvent(t,s,i){if(!t||!s||Xt.isRunning())return;const r=s.type;let n=this._roomEngine.getRoomObjectCategoryForType(r);if(n!==A.ROOM&&(!this._roomEngine.isPlayingGame()||n!==A.UNIT)&&(n=A.MINIMUM),this.getMouseEventId(n,t.type)===t.eventId){if(t.type===F.MOUSE_CLICK||t.type===F.DOUBLE_CLICK||t.type===F.MOUSE_DOWN||t.type===F.MOUSE_UP||t.type===F.MOUSE_MOVE)return}else t.eventId&&this.setMouseEventId(n,t.type,t.eventId);s.mouseHandler&&s.mouseHandler.mouseEvent(t,i)}processRoomObjectPlacement(t,s,i,r,n,a=null,o=null,u=-1,l=-1,c=null){this._objectPlacementSource=t;const g=new I(-100,-100),f=new I(0);return this.setSelectedRoomObjectData(s,i,r,g,f,K.OBJECT_PLACE,n,a,o,u,l,c),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,r,!1,a,o,u,l,c),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(t){return this.resetSelectedObjectData(t),!0}getMouseEventId(t,s){const i=this._eventIds.get(t);return i&&i.get(s)||null}setMouseEventId(t,s,i){let r=this._eventIds.get(t);r||(r=new Map,this._eventIds.set(t,r)),r.delete(s),r.set(s,i)}handleRoomObjectEvent(t,s){if(t){if(t instanceof V){this.handleRoomObjectMouseEvent(t,s);return}switch(t.type){case rt.STATE_CHANGE:case rt.STATE_RANDOM:this.onRoomObjectStateChangedEvent(t,s);return;case _r.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(t,s);return;case se.POSITION_CHANGED:case se.OBJECT_REMOVED:this.handleSelectedObjectRemove(t,s);return;case p.OPEN_WIDGET:case p.CLOSE_WIDGET:case p.OPEN_FURNI_CONTEXT_MENU:case p.CLOSE_FURNI_CONTEXT_MENU:case p.PLACEHOLDER:case p.CREDITFURNI:case p.STACK_HEIGHT:case p.EXTERNAL_IMAGE:case p.STICKIE:case p.PRESENT:case p.TROPHY:case p.TEASER:case p.ECOTRONBOX:case p.DIMMER:case p.WIDGET_REMOVE_DIMMER:case p.CLOTHING_CHANGE:case p.JUKEBOX_PLAYLIST_EDITOR:case p.MANNEQUIN:case p.PET_PRODUCT_MENU:case p.GUILD_FURNI_CONTEXT_MENU:case p.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case p.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case p.BACKGROUND_COLOR:case p.MYSTERYBOX_OPEN_DIALOG:case p.EFFECTBOX_OPEN_DIALOG:case p.MYSTERYTROPHY_OPEN_DIALOG:case p.ACHIEVEMENT_RESOLUTION_OPEN:case p.ACHIEVEMENT_RESOLUTION_ENGRAVING:case p.ACHIEVEMENT_RESOLUTION_FAILED:case p.FRIEND_FURNITURE_CONFIRM:case p.FRIEND_FURNITURE_ENGRAVING:case p.BADGE_DISPLAY_ENGRAVING:case p.HIGH_SCORE_DISPLAY:case p.HIDE_HIGH_SCORE_DISPLAY:case p.INERNAL_LINK:case p.ROOM_LINK:case p.YOUTUBE:this.onRoomObjectWidgetRequestEvent(t,s);return;case L.DICE_ACTIVATE:case L.DICE_OFF:case L.USE_HABBOWHEEL:case L.STICKIE:case L.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(t,s);return;case L.SOUND_MACHINE_INIT:case L.SOUND_MACHINE_START:case L.SOUND_MACHINE_STOP:case L.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(t,s);return;case L.JUKEBOX_INIT:case L.JUKEBOX_START:case L.JUKEBOX_MACHINE_STOP:case L.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(t,s);return;case $t.ADD_HOLE:case $t.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(t,s);return;case It.ROOM_AD_FURNI_CLICK:case It.ROOM_AD_FURNI_DOUBLE_CLICK:case It.ROOM_AD_TOOLTIP_SHOW:case It.ROOM_AD_TOOLTIP_HIDE:case It.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(t,s);return;case rs.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(t,s);return;case L.MOUSE_ARROW:case L.MOUSE_BUTTON:this.handleMousePointer(t,s);return;case Ms.PLAY_SOUND:case Ms.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(t,s);return;case yt.ROOM_OBJECT_INITIALIZED:case yt.ROOM_OBJECT_DISPOSED:case yt.PLAY_SAMPLE:case yt.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(t,s);return;case qs.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(t,s);return;case ye.RODRE_CURRENT_USER_ID:case ye.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(t,s);return;default:G.warn("Unhandled Event",t.constructor.name,"Object ID",t.object.id);return}}}handleRoomObjectMouseEvent(t,s){if(!(!t||!t.type))switch(t.type){case V.CLICK:this.handleRoomObjectMouseClickEvent(t,s);return;case V.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(t,s);return;case V.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(t,s);return;case V.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(t,s);return;case V.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(t,s);return;case V.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(t,s);return;case V.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(t,s);return}}handleRoomObjectMouseClickEvent(t,s){if(!t)return;let i=K.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(s);r&&(i=r.operation);let n=!1,a=!1;this._whereYouClickIsWhereYouGo&&(!i||i===K.OBJECT_UNDEFINED)&&(n=this.handleMoveTargetFurni(s,t));const o=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(i){case K.OBJECT_MOVE:o===A.ROOM?r&&this.modifyRoomObject(s,r.id,r.category,K.OBJECT_MOVE_TO):o===A.UNIT&&(r&&t.objectType===et.MONSTER_PLANT&&this.modifyRoomObject(s,r.id,r.category,K.OBJECT_MOVE_TO),t.eventId&&this.setMouseEventId(A.ROOM,F.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(s,t.objectId,o)),a=!0,t.objectId!==-1&&this.setSelectedObject(s,t.objectId,o);break;case K.OBJECT_PLACE:if(o===A.ROOM)this.placeObject(s,t instanceof us,t instanceof Yi);else if(o===A.UNIT)switch(t.objectType){case et.MONSTER_PLANT:case et.RENTABLE_BOT:this.placeObject(s,t instanceof us,t instanceof Yi);break;default:t.eventId&&this.setMouseEventId(A.ROOM,F.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(s,t.objectId,o);break}break;case K.OBJECT_UNDEFINED:o===A.ROOM?!n&&t instanceof us&&this.onRoomObjectTileMouseEvent(s,t):(this.setSelectedObject(s,t.objectId,o),a=!1,o===A.UNIT?(t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===et.RENTABLE_BOT?this.modifyRoomObject(s,t.objectId,o,K.OBJECT_PICKUP_BOT):t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===et.MONSTER_PLANT?this.modifyRoomObject(s,t.objectId,o,K.OBJECT_PICKUP_PET):!t.ctrlKey&&!t.altKey&&t.shiftKey&&t.objectType===et.MONSTER_PLANT&&this.modifyRoomObject(s,t.objectId,o,K.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?a=!0:n=!0):(o===A.FLOOR||o===A.WALL)&&(t.altKey||t.ctrlKey||t.shiftKey)&&(!t.ctrlKey&&!t.altKey&&t.shiftKey?o===A.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.REQUEST_ROTATE,s,t.objectId,o)):t.ctrlKey&&!t.altKey&&!t.shiftKey&&this.modifyRoomObject(s,t.objectId,o,K.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?a=!0:n=!0),t.eventId&&(n&&this.setMouseEventId(A.ROOM,F.MOUSE_CLICK,t.eventId),a&&this.setMouseEventId(A.MINIMUM,F.MOUSE_CLICK,t.eventId)));break}if(o===A.ROOM){const u=this.getMouseEventId(A.MINIMUM,F.MOUSE_CLICK),l=this.getMouseEventId(A.UNIT,F.MOUSE_CLICK);u!==t.eventId&&l!==t.eventId&&!a&&(this.deselectObject(s),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.DESELECTED,s,-1,A.MINIMUM)),this.setSelectedAvatar(s,0,!1))}}handleRoomObjectMouseDoubleClickEvent(t,s){const i=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.DOUBLE_CLICK,s,i,n))}handleRoomObjectMouseMoveEvent(t,s){if(!t)return;let i=K.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(s);r&&(i=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const a=this._roomEngine.getRoomObjectCursor(s);if(a&&a.logic){let o=null;t instanceof us?o=this.handleMouseOverTile(t,s):t.object&&t.object.id!==-1?this._whereYouClickIsWhereYouGo&&(o=this.handleMouseOverObject(n,s,t)):o=new Wi(null,0,!1,t.eventId),a.processUpdateMessage(o)}}switch(i){case K.OBJECT_MOVE:n===A.ROOM&&this.handleObjectMove(t,s);return;case K.OBJECT_PLACE:n===A.ROOM&&this.handleObjectPlace(t,s);return}}handleRoomObjectMouseDownEvent(t,s){if(!t)return;let i=K.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(s);r&&(i=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(i){case K.OBJECT_UNDEFINED:(n===A.FLOOR||n===A.WALL||t.objectType===et.MONSTER_PLANT)&&(t.altKey&&!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.REQUEST_MOVE,s,t.objectId,n));return}}handleRoomObjectMouseDownLongEvent(t,s){if(!t)return;let i=K.OBJECT_UNDEFINED;const r=this.getSelectedRoomObjectData(s);r&&(i=r.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(i){case K.OBJECT_UNDEFINED:(n===A.FLOOR||n===A.WALL||t.objectType===et.MONSTER_PLANT)&&(!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.REQUEST_MANIPULATION,s,t.objectId,n));return}}handleRoomObjectMouseEnterEvent(t,s){const i=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.MOUSE_ENTER,s,i,n))}handleRoomObjectMouseLeaveEvent(t,s){const i=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);if(n!==A.ROOM&&n===A.UNIT){const a=this._roomEngine.getRoomObjectCursor(s);a&&a.processUpdateMessage(new Et(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new H(H.MOUSE_LEAVE,s,i,n))}onRoomObjectStateChangedEvent(t,s){if(t)switch(t.type){case rt.STATE_CHANGE:this.changeObjectState(s,t.object.id,t.object.type,t.state,!1);return;case rt.STATE_RANDOM:this.changeObjectState(s,t.object.id,t.object.type,t.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(t,s){if(t)switch(t.type){case _r.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new yu(s,t.state,t.presetId,t.effectId,t.color,t.brightness));return}}handleSelectedObjectRemove(t,s){if(!(!t||!this._roomEngine))switch(t.type){case se.POSITION_CHANGED:{const i=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r),a=this._roomEngine.getRoomObject(s,i,n),o=this._roomEngine.getRoomObjectSelectionArrow(s);if(a&&o&&o.logic){const u=a.getLocation();o.logic.processUpdateMessage(new Bt(u,null))}return}case se.OBJECT_REMOVED:this.setSelectedAvatar(s,0,!1);return}}onRoomObjectWidgetRequestEvent(t,s){if(!t||!this._roomEngine)return;const i=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r),a=this._roomEngine.events;if(a&&!Q_.isRoomPreviewerId(s))switch(t.type){case p.OPEN_WIDGET:a.dispatchEvent(new U(U.OPEN_WIDGET,s,i,n,t.object.logic.widget));return;case p.CLOSE_WIDGET:a.dispatchEvent(new U(U.CLOSE_WIDGET,s,i,n,t.object.logic.widget));return;case p.OPEN_FURNI_CONTEXT_MENU:a.dispatchEvent(new U(U.OPEN_FURNI_CONTEXT_MENU,s,i,n,t.object.logic.contextMenu));return;case p.CLOSE_FURNI_CONTEXT_MENU:a.dispatchEvent(new U(U.CLOSE_FURNI_CONTEXT_MENU,s,i,n));return;case p.PLACEHOLDER:a.dispatchEvent(new U(U.REQUEST_PLACEHOLDER,s,i,n));return;case p.CREDITFURNI:a.dispatchEvent(new U(U.REQUEST_CREDITFURNI,s,i,n));return;case p.STACK_HEIGHT:a.dispatchEvent(new U(U.REQUEST_STACK_HEIGHT,s,i,n));return;case p.EXTERNAL_IMAGE:a.dispatchEvent(new U(U.REQUEST_EXTERNAL_IMAGE,s,i,n));return;case p.STICKIE:a.dispatchEvent(new U(U.REQUEST_STICKIE,s,i,n));return;case p.PRESENT:a.dispatchEvent(new U(U.REQUEST_PRESENT,s,i,n));return;case p.TROPHY:a.dispatchEvent(new U(U.REQUEST_TROPHY,s,i,n));return;case p.TEASER:a.dispatchEvent(new U(U.REQUEST_TEASER,s,i,n));return;case p.ECOTRONBOX:a.dispatchEvent(new U(U.REQUEST_ECOTRONBOX,s,i,n));return;case p.DIMMER:a.dispatchEvent(new U(U.REQUEST_DIMMER,s,i,n));return;case p.WIDGET_REMOVE_DIMMER:a.dispatchEvent(new U(U.REMOVE_DIMMER,s,i,n));return;case p.CLOTHING_CHANGE:a.dispatchEvent(new U(U.REQUEST_CLOTHING_CHANGE,s,i,n));return;case p.JUKEBOX_PLAYLIST_EDITOR:a.dispatchEvent(new U(U.REQUEST_PLAYLIST_EDITOR,s,i,n));return;case p.MANNEQUIN:a.dispatchEvent(new U(U.REQUEST_MANNEQUIN,s,i,n));return;case p.PET_PRODUCT_MENU:a.dispatchEvent(new ea(ea.USE_PRODUCT_FROM_ROOM,s,i,n));return;case p.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new Hd(t.objectId,t.object.model.getValue(d.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case p.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:a.dispatchEvent(new U(U.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,s,i,n));return;case p.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:a.dispatchEvent(new U(U.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,s,i,n));return;case p.BACKGROUND_COLOR:a.dispatchEvent(new U(U.REQUEST_BACKGROUND_COLOR,s,i,n));return;case p.MYSTERYBOX_OPEN_DIALOG:a.dispatchEvent(new U(U.REQUEST_MYSTERYBOX_OPEN_DIALOG,s,i,n));return;case p.EFFECTBOX_OPEN_DIALOG:a.dispatchEvent(new U(U.REQUEST_EFFECTBOX_OPEN_DIALOG,s,i,n));return;case p.MYSTERYTROPHY_OPEN_DIALOG:a.dispatchEvent(new U(U.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,s,i,n));return;case p.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new Jc(t.objectId,0));return;case p.ACHIEVEMENT_RESOLUTION_ENGRAVING:a.dispatchEvent(new U(U.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,s,i,n));return;case p.ACHIEVEMENT_RESOLUTION_FAILED:a.dispatchEvent(new U(U.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,s,i,n));return;case p.FRIEND_FURNITURE_CONFIRM:a.dispatchEvent(new U(U.REQUEST_FRIEND_FURNITURE_CONFIRM,s,i,n));return;case p.FRIEND_FURNITURE_ENGRAVING:a.dispatchEvent(new U(U.REQUEST_FRIEND_FURNITURE_ENGRAVING,s,i,n));return;case p.BADGE_DISPLAY_ENGRAVING:a.dispatchEvent(new U(U.REQUEST_BADGE_DISPLAY_ENGRAVING,s,i,n));return;case p.HIGH_SCORE_DISPLAY:a.dispatchEvent(new U(U.REQUEST_HIGH_SCORE_DISPLAY,s,i,n));return;case p.HIDE_HIGH_SCORE_DISPLAY:a.dispatchEvent(new U(U.REQUEST_HIDE_HIGH_SCORE_DISPLAY,s,i,n));return;case p.INERNAL_LINK:a.dispatchEvent(new U(U.REQUEST_INTERNAL_LINK,s,i,n));return;case p.ROOM_LINK:a.dispatchEvent(new U(U.REQUEST_ROOM_LINK,s,i,n));return;case p.YOUTUBE:a.dispatchEvent(new U(U.REQUEST_YOUTUBE,s,i,n));return}}onRoomObjectFurnitureActionEvent(t,s){t&&this.useObject(s,t.object.id,t.object.type,t.type)}handleObjectSoundMachineEvent(t,s){if(!t)return;const i=this._roomEngine.getRoomObjectCategoryForType(t.objectType),r=this.getSelectedRoomObjectData(s);if(!(r&&r.category===i&&r.id===t.objectId&&r.operation===K.OBJECT_PLACE))switch(t.type){case L.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new gt(gt.SOUND_MACHINE_INIT,s,t.objectId,i));return;case L.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new gt(gt.SOUND_MACHINE_SWITCHED_ON,s,t.objectId,i));return;case L.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new gt(gt.SOUND_MACHINE_SWITCHED_OFF,s,t.objectId,i));return;case L.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new gt(gt.SOUND_MACHINE_DISPOSE,s,t.objectId,i));return}}handleObjectJukeboxEvent(t,s){if(!t)return;const i=this._roomEngine.getRoomObjectCategoryForType(t.objectType),r=this.getSelectedRoomObjectData(s);if(!(r&&r.category===i&&r.id===t.objectId&&r.operation===K.OBJECT_PLACE))switch(t.type){case L.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new gt(gt.JUKEBOX_INIT,s,t.objectId,i));return;case L.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new gt(gt.JUKEBOX_SWITCHED_ON,s,t.objectId,i));return;case L.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new gt(gt.JUKEBOX_SWITCHED_OFF,s,t.objectId,i));return;case L.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new gt(gt.JUKEBOX_DISPOSE,s,t.objectId,i));return}}onRoomObjectFloorHoleEvent(t,s){if(t)switch(t.type){case $t.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(s,t.objectId);return;case $t.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(s,t.objectId);return}}onRoomObjectRoomAdEvent(t,s){if(!t)return;let i=null;switch(t.type){case It.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(t),t.clickUrl&&t.clickUrl.length>0&&B.instance.createLinkEvent(t.clickUrl),i=ti.FURNI_CLICK;break;case It.ROOM_AD_FURNI_DOUBLE_CLICK:if(t.clickUrl&&t.clickUrl.length>0){const r="CATALOG_PAGE";t.clickUrl.indexOf(r)===0&&B.instance.createLinkEvent(t.clickUrl.substr(r.length))}i=ti.FURNI_DOUBLE_CLICK;break;case It.ROOM_AD_TOOLTIP_SHOW:i=ti.TOOLTIP_SHOW;break;case It.ROOM_AD_TOOLTIP_HIDE:i=ti.TOOLTIP_HIDE;break}i&&this._roomEngine.events.dispatchEvent(new H(i,s,t.objectId,this._roomEngine.getRoomObjectCategoryForType(t.objectType)))}onRoomObjectBadgeAssetEvent(t,s){if(!(!t||!this._roomEngine))switch(t.type){case rs.LOAD_BADGE:{const i=t.objectId,r=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(r);this._roomEngine.loadRoomObjectBadgeImage(s,i,n,t.badgeId,t.groupBadge);return}}}handleMousePointer(t,s){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}handleRoomObjectPlaySoundEvent(t,s){const i=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case Ms.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new sr(sr.PLAY_SOUND,s,t.objectId,i,t.soundId,t.pitch));return;case Ms.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new sr(sr.PLAY_SOUND_AT_PITCH,s,t.objectId,i,t.soundId,t.pitch));return}}handleRoomObjectSamplePlaybackEvent(t,s){if(!t)return;const i=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case yt.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new _e(_e.ROOM_OBJECT_INITIALIZED,s,t.objectId,i,t.sampleId,t.pitch));break;case yt.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new _e(_e.ROOM_OBJECT_DISPOSED,s,t.objectId,i,t.sampleId,t.pitch));break;case yt.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new _e(_e.PLAY_SAMPLE,s,t.objectId,i,t.sampleId,t.pitch));break;case yt.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new _e(_e.CHANGE_PITCH,s,t.objectId,i,t.sampleId,t.pitch));break}}onHSLColorEnableEvent(t,s){if(!(!t||!this._roomEngine))switch(t.type){case qs.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new So(So.ROOM_BACKGROUND_COLOR,s,t.enable,t.hue,t.saturation,t.lightness));return}}onRoomObjectDataRequestEvent(t,s){if(!(!t||!this._roomEngine||!t.object))switch(t.type){case ye.RODRE_CURRENT_USER_ID:t.object.model.setValue(d.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case ye.RODRE_URL_PREFIX:t.object.model.setValue(d.SESSION_URL_PREFIX,W.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(t,s){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const i=this._roomEngine.roomSessionManager.getSession(t);!i||i.isSpectator||this.sendWalkUpdate(s.tileXAsInt,s.tileYAsInt)}handleObjectMove(t,s){if(!t||!this._roomEngine||!this._roomEngine.events)return;const r=this.getSelectedRoomObjectData(s);if(!r)return;const n=this._roomEngine.getRoomObject(s,r.id,r.category);if(!n)return;let a=!0;if(r.category===A.FLOOR||r.category===A.UNIT){const o=this._roomEngine.getFurnitureStackingHeightMap(s);t instanceof us&&this.handleFurnitureMove(n,r,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),o)||(this.handleFurnitureMove(n,r,r.loc.x,r.loc.y,o),a=!1)}else if(r.category===A.WALL){if(a=!1,t instanceof Yi){const o=t.wallLocation,u=t.wallWidth,l=t.wallHeight,c=t.x,g=t.y,f=t.direction;this.handleWallItemMove(n,r,o,u,l,c,g,f)&&(a=!0)}a||(n.setLocation(r.loc),n.setDirection(r.dir)),this._roomEngine.updateRoomObjectMask(s,r.id,a)}a?(this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(n,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(t,s){if(!t||!this._roomEngine||!this._roomEngine.events)return;let r=this.getSelectedRoomObjectData(s);if(!r)return;let n=this._roomEngine.getRoomObject(s,r.id,r.category);if(!n){if(t instanceof us){if(r.category===A.FLOOR)this._roomEngine.addFurnitureFloor(s,r.id,r.typeId,r.loc,r.dir,0,r.stuffData,parseFloat(r.instanceData),-1,0,0,"",!1);else if(r.category===A.UNIT){this._roomEngine.addRoomObjectUser(s,r.id,new I,new I(180),180,r.typeId,r.instanceData);const a=this._roomEngine.getRoomObject(s,r.id,r.category);a&&r.posture&&a.model.setValue(d.FIGURE_POSTURE,r.posture)}}else t instanceof Yi&&r.category===A.WALL&&this._roomEngine.addFurnitureWall(s,r.id,r.typeId,r.loc,r.dir,0,r.instanceData,0);if(n=this._roomEngine.getRoomObject(s,r.id,r.category),n&&r.category===A.FLOOR){const a=n.model.getValue(d.FURNITURE_ALLOWED_DIRECTIONS);if(a&&a.length){const o=new I(a[0]);if(n.setDirection(o),this.updateSelectedObjectData(s,r.id,r.category,r.loc,o,r.operation,r.typeId,r.instanceData,r.stuffData,r.state,r.animFrame,r.posture),r=this.getSelectedRoomObjectData(s),!r)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let a=!0;const o=this._roomEngine.getFurnitureStackingHeightMap(s);if(r.category===A.FLOOR)t instanceof us&&this.handleFurnitureMove(n,r,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),o)||(this._roomEngine.removeRoomObjectFloor(s,r.id),a=!1);else if(r.category===A.WALL){if(a=!1,t instanceof Yi){const u=t.wallLocation,l=t.wallWidth,c=t.wallHeight,g=t.x,f=t.y,R=t.direction;this.handleWallItemMove(n,r,u,l,c,g,f,R)&&(a=!0)}a||this._roomEngine.removeRoomObjectWall(s,r.id),this._roomEngine.updateRoomObjectMask(s,r.id,a)}else r.category===A.UNIT&&(t instanceof us&&this.handleUserPlace(n,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(s))||(this._roomEngine.removeRoomObjectUser(s,r.id),a=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!a)}}handleFurnitureMove(t,s,i,r,n){if(!t||!s)return!1;const a=new I;a.assign(t.getDirection()),t.setDirection(s.dir);const o=new I(i,r,0),u=new I;u.assign(t.getDirection());let l=this.validateFurnitureLocation(t,o,s.loc,s.dir,n);return l||(u.x=this.getValidRoomObjectDirection(t,!0),t.setDirection(u),l=this.validateFurnitureLocation(t,o,s.loc,s.dir,n)),l?(t.setLocation(l),u&&t.setDirection(u),!0):(t.setDirection(a),!1)}handleWallItemMove(t,s,i,r,n,a,o,u){if(!t||!s)return!1;const l=new I(u),c=this.validateWallItemLocation(t,i,r,n,a,o,s);return c?(t.setLocation(c),t.setDirection(l),!0):!1}validateFurnitureLocation(t,s,i,r,n){if(!t||!t.model||!s)return null;let a=null;const o=t.getDirection();if(!o||!i||!r)return null;if(s.x===i.x&&s.y===i.y&&o.x===r.x)return a=new I,a.assign(i),a;let u=t.model.getValue(d.FURNITURE_SIZE_X),l=t.model.getValue(d.FURNITURE_SIZE_Y);u<1&&(u=1),l<1&&(l=1);const c=i.x,g=i.y;let f=u,R=l,m=0,T=Math.trunc(Math.trunc(o.x+45)%360/90);if((T===1||T===3)&&(m=u,u=l,l=m),T=Math.trunc(Math.trunc(r.x+45)%360/90),(T===1||T===3)&&(m=f,f=R,R=m),n&&s){const O=t.model.getValue(d.FURNITURE_ALWAYS_STACKABLE)===1;return n.validateLocation(s.x,s.y,u,l,c,g,f,R,O)?new I(s.x,s.y,n.getTileHeight(s.x,s.y)):null}return null}validateWallItemLocation(t,s,i,r,n,a,o){if(t==null||t.model==null||s==null||i==null||r==null||o==null)return null;const u=t.model.getValue(d.FURNITURE_SIZE_X),l=t.model.getValue(d.FURNITURE_SIZE_Z),c=t.model.getValue(d.FURNITURE_CENTER_Z);if((n<u/2||n>i.length-u/2||a<c||a>r.length-(l-c))&&(n<u/2&&n<=i.length-u/2?n=u/2:n>=u/2&&n>i.length-u/2&&(n=i.length-u/2),a<c&&a<=r.length-(l-c)?a=c:a>=c&&a>r.length-(l-c)&&(a=r.length-(l-c))),n<u/2||n>i.length-u/2||a<c||a>r.length-(l-c))return null;let g=I.sum(I.product(i,n/i.length),I.product(r,a/r.length));return g=I.sum(s,g),g}changeObjectState(t,s,i,r,n){const a=this._roomEngine.getRoomObjectCategoryForType(i);this.changeRoomObjectState(t,s,a,r,n)}useObject(t,s,i,r){if(!(!this._roomEngine||!this._roomEngine.connection))switch(r){case L.DICE_ACTIVATE:this._roomEngine.connection.send(new Wd(s));return;case L.DICE_OFF:this._roomEngine.connection.send(new kd(s));return;case L.USE_HABBOWHEEL:this._roomEngine.connection.send(new zd(s));return;case L.STICKIE:this._roomEngine.connection.send(new Dd(s));return;case L.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new Kd(s));return}}changeRoomObjectState(t,s,i,r,n){return!this._roomEngine||!this._roomEngine.connection||(i===A.FLOOR?n?this._roomEngine.connection.send(new Xd(s,r)):this._roomEngine.connection.send(new fh(s,r)):i===A.WALL&&this._roomEngine.connection.send(new qd(s,r))),!0}sendWalkUpdate(t,s){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new ug(t,s))}handleMouseOverObject(t,s,i){if(t!==A.FLOOR)return null;const r=this._roomEngine.getRoomObject(s,i.objectId,A.FLOOR);if(!r)return null;const n=this.getActiveSurfaceLocation(r,i);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(s))return null;const o=n.x,u=n.y,l=n.z;return new Wi(new I(o,u,r.getLocation().z),l,!0,i.eventId)}handleMoveTargetFurni(t,s){if(s.objectType===et.USER||s.objectType===et.PET||s.objectType===et.BOT||s.objectType===et.RENTABLE_BOT||s.objectType===et.MONSTER_PLANT)return;const i=this._roomEngine.getRoomObject(t,s.objectId,A.FLOOR),r=this.getActiveSurfaceLocation(i,s);return r?(this.sendWalkUpdate(r.x,r.y),!0):!1}getActiveSurfaceLocation(t,s){if(!t||!s)return null;const i=this._roomEngine.sessionDataManager.getFloorItemDataByName(t.type);if(!i||!i.canStandOn&&!i.canSitOn&&!i.canLayOn)return null;const r=t.model;if(!r)return null;const n=t.getLocation(),a=t.getDirection();let o=r.getValue(d.FURNITURE_SIZE_X),u=r.getValue(d.FURNITURE_SIZE_Y);const l=r.getValue(d.FURNITURE_SIZE_Z);(a.x===90||a.x===270)&&([o,u]=[u,o]),o<1&&(o=1),u<1&&(u=1);const c=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!c)return null;const g=c.geometry.scale,f=i.canSitOn?.5:0,R=(g/2+s.spriteOffsetX+s.localX)/(g/4),m=(s.spriteOffsetY+s.localY+(l-f)*g/2)/(g/4),T=(R+2*m)/4,O=(R-2*m)/4,C=Math.floor(n.x+T),N=Math.floor(n.y-O+1);let S=!1;(C<n.x||C>=n.x+o||N<n.y||N>=n.y+u)&&(S=!0);const D=i.canSitOn?l-.5:l;return S?null:new I(C,N,D)}handleMouseOverTile(t,s){if(this._whereYouClickIsWhereYouGo)return new Wi(new I(t.tileXAsInt,t.tileYAsInt,t.tileZAsInt),0,!0,t.eventId);const i=this._roomEngine.getRoomObjectCursor(s);if(i&&i.visualization){const r=t.tileXAsInt,n=t.tileYAsInt,a=t.tileZAsInt;if(this._roomEngine.getRoomInstance(s)){const u=this._roomEngine.getRoomTileObjectMap(s);if(u){const l=u.getObjectIntTile(r,n),c=this._roomEngine.getFurnitureStackingHeightMap(s);if(c){if(l&&l.model&&l.model.getValue(d.FURNITURE_IS_VARIABLE_HEIGHT)>0){const g=c.getTileHeight(r,n),f=this._roomEngine.getLegacyWallGeometry(s).getHeight(r,n);return new Wi(new I(r,n,a),g-f,!0,t.eventId)}return new Wi(new I(r,n,a),0,!0,t.eventId)}}}}return null}placeObject(t,s,i){const r=this.getSelectedRoomObjectData(t);if(!r)return;let n=null,a=r.id;const o=r.category;let u=0,l=0,c=0,g=0,f="";if(this._roomEngine&&this._roomEngine.connection&&(n=this._roomEngine.getRoomObject(t,a,o),n)){const R=n.getLocation();if(g=n.getDirection().x,o===A.FLOOR||o===A.UNIT)u=R.x,l=R.y,c=R.z;else if(o===A.WALL){u=R.x,l=R.y,c=R.z;const m=this._roomEngine.getLegacyWallGeometry(t);m&&(f=m.getOldLocationString(R,g))}g=(g/45%8+8)%8,a<0&&o===A.UNIT&&(a=a*-1),this._objectPlacementSource!==k_.CATALOG&&(o===A.UNIT?r.typeId===Ye.PET?this._roomEngine.connection.send(new yd(a,Math.trunc(u),Math.trunc(l))):r.typeId===Ye.RENTABLE_BOT&&this._roomEngine.connection.send(new Sd(a,Math.trunc(u),Math.trunc(l))):n.model.getValue(d.FURNITURE_IS_STICKIE)!==void 0?this._roomEngine.connection.send(new Yd(a,f)):this._roomEngine.connection.send(new jd(a,o,f,Math.trunc(u),Math.trunc(l),g)))}if(this._roomEngine.setPlacedRoomObjectData(t,new lo(r.id,r.category,null,r.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&this._roomEngine.events){const R=n&&n.id===r.id;this._roomEngine.events.dispatchEvent(new nf(H.PLACED,t,a,o,f,u,l,c,g,R,s,i,r.instanceData))}}modifyRoomObject(t,s,i,r){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(t,s,i);if(!n)return!1;let a=!0;switch(r){case K.OBJECT_ROTATE_POSITIVE:case K.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let o=0;r==K.OBJECT_ROTATE_NEGATIVE?o=this.getValidRoomObjectDirection(n,!1):o=this.getValidRoomObjectDirection(n,!0);const u=n.getLocation().x,l=n.getLocation().y;if(this.isValidLocation(n,new I(o),this._roomEngine.getFurnitureStackingHeightMap(t)))if(o=Math.trunc(o/45),n.type===et.MONSTER_PLANT){const c=this._roomEngine.roomSessionManager.getSession(t);if(c){const g=c.userDataManager.getUserDataByIndex(s);g&&this._roomEngine.connection.send(new C_(g.webID,Math.trunc(u),Math.trunc(l),o))}}else this._roomEngine.connection.send(new N_(s,u,l,o))}break;case K.OBJECT_EJECT:case K.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new Vd(i,s));break;case K.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(t);if(o){const u=o.userDataManager.getUserDataByIndex(s);o.pickupPet(u.webID)}}break;case K.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(t);if(o){const u=o.userDataManager.getUserDataByIndex(s);o.pickupBot(u.webID)}}break;case K.OBJECT_MOVE:a=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(t,n.id,i,n.getLocation(),n.getDirection(),r),this._roomEngine.setObjectMoverIconSprite(n.id,i,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case K.OBJECT_MOVE_TO:{const o=this.getSelectedRoomObjectData(t);if(this.updateSelectedObjectData(t,o.id,o.category,o.loc,o.dir,K.OBJECT_MOVE_TO,o.typeId,o.instanceData,o.stuffData,o.state,o.animFrame,o.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(i===A.FLOOR){const u=n.getDirection().x%360,l=n.getLocation(),c=u/45;this._roomEngine.connection.send(new N_(s,l.x,l.y,c))}else if(i===A.WALL){const u=n.getDirection().x%360,l=this._roomEngine.getLegacyWallGeometry(t);if(l){const c=l.getOldLocationString(n.getLocation(),u);c&&this._roomEngine.connection.send(new Zd(s,c))}}else if(i===A.UNIT){const u=n.getDirection().x%360,l=n.getLocation(),c=u/45;parseInt(n.model.getValue(d.RACE));const g=this._roomEngine.roomSessionManager.getSession(t);if(g){const f=g.userDataManager.getUserDataByIndex(s);f&&this._roomEngine.connection.send(new C_(f.webID,l.x,l.y,c))}}}break}}return a&&this.resetSelectedObjectData(t),!0}modifyRoomObjectDataWithMap(t,s,i,r,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(t,s,i))return!1;switch(r){case K.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new Fd(s,n));break}return!0}modifyWallItemData(t,s,i,r){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new bd(s,i,r)),!0)}deleteWallItem(t,s){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new Ud(s)),!0)}getValidRoomObjectDirection(t,s){if(!t||!t.model)return 0;let i=0,r=0,n=[];t.type===et.MONSTER_PLANT?n=t.model.getValue(d.PET_ALLOWED_DIRECTIONS):n=t.model.getValue(d.FURNITURE_ALLOWED_DIRECTIONS);let a=t.getDirection().x;if(n&&n.length){if(i=n.indexOf(a),i<0){for(i=0,r=0;r<n.length&&!(a<=n[r]);)i++,r++;i=i%n.length}s?i=(i+1)%n.length:i=(i-1+n.length)%n.length,a=n[i]}return a}isValidLocation(t,s,i){if(!t||!t.model||!s)return!1;const r=t.getDirection(),n=t.getLocation();if(!r||!n)return!1;if(r.x%180===s.x%180)return!0;let a=t.model.getValue(d.FURNITURE_SIZE_X),o=t.model.getValue(d.FURNITURE_SIZE_Y);a<1&&(a=1),o<1&&(o=1);let u=a,l=o,c=Math.trunc(Math.trunc(s.x+45)%360/90);if((c===1||c===3)&&([a,o]=[o,a]),c=Math.trunc(Math.trunc(r.x+45)%360/90),(c===1||c===3)&&([u,l]=[l,u]),i&&n){const g=t.model.getValue(d.FURNITURE_ALWAYS_STACKABLE)===1;if(i.validateLocation(n.x,n.y,a,o,n.x,n.y,u,l,g,n.z))return!0}return!1}placeObjectOnUser(t,s,i){const r=this.getSelectedRoomObjectData(t);!r||!this._roomEngine.getRoomObject(t,s,i)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new af(H.PLACED_ON_USER,t,s,i,r.id,r.category))}setSelectedObject(t,s,i){if(!this._roomEngine)return;const r=this._roomEngine.events;if(r)switch(i){case A.UNIT:case A.FLOOR:case A.WALL:if(i===A.UNIT)this.deselectObject(t),this.setSelectedAvatar(t,s,!0);else if(this.setSelectedAvatar(t,0,!1),s!==this._selectedObjectId){this.deselectObject(t);const n=this._roomEngine.getRoomObject(t,s,i);n&&n.logic&&(n.logic.processUpdateMessage(new $r(!0)),this._selectedObjectId=s,this._selectedObjectCategory=i)}r.dispatchEvent(new H(H.SELECTED,t,s,i));return}}deselectObject(t){if(this._selectedObjectId===-1)return;const s=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);s&&s.logic&&(s.logic.processUpdateMessage(new $r(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=A.MINIMUM)}setSelectedAvatar(t,s,i){if(!this._roomEngine)return;const r=A.UNIT,n=this._roomEngine.getRoomObject(t,this._selectedAvatarId,r);n&&n.logic&&(n.logic.processUpdateMessage(new Ea(!1)),this._selectedAvatarId=-1);let a=!1;if(i){const u=this._roomEngine.getRoomObject(t,s,r);if(u&&u.logic){u.logic.processUpdateMessage(new Ea(!0)),a=!0,this._selectedAvatarId=s;const l=u.getLocation();l&&this._roomEngine.connection.send(new og(~~l.x,~~l.y))}}const o=this._roomEngine.getRoomObjectSelectionArrow(t);o&&o.logic&&(a&&!this._roomEngine.isPlayingGame()?o.logic.processUpdateMessage(new ys(ys.ENABLED)):o.logic.processUpdateMessage(new ys(ys.DISABLED)))}resetSelectedObjectData(t){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const s=this.getSelectedRoomObjectData(t);if(s){if(s.operation===K.OBJECT_MOVE||s.operation===K.OBJECT_MOVE_TO){const i=this._roomEngine.getRoomObject(t,s.id,s.category);i&&s.operation!==K.OBJECT_MOVE_TO&&(i.setLocation(s.loc),i.setDirection(s.dir)),this.setFurnitureAlphaMultiplier(i,1),s.category===A.WALL&&this._roomEngine.updateRoomObjectMask(t,s.id,!0),this.updateSelectedObjectData(t,s.id,s.category,s.loc,s.dir,K.OBJECT_MOVE,s.typeId,s.instanceData,s.stuffData,s.state,s.animFrame,s.posture)}else if(s.operation===K.OBJECT_PLACE){const i=s.id;switch(s.category){case A.FLOOR:this._roomEngine.removeRoomObjectFloor(t,i);break;case A.WALL:this._roomEngine.removeRoomObjectWall(t,i);break;case A.UNIT:this._roomEngine.removeRoomObjectUser(t,i);break}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,s){!t||!t.model||t.model.setValue(d.FURNITURE_ALPHA_MULTIPLIER,s)}decorateModeMove(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this.resetSelectedObjectData(t),!0}setSelectedRoomObjectData(t,s,i,r,n,a,o=0,u=null,l=null,c=-1,g=-1,f=null){if(this.resetSelectedObjectData(t),!this._roomEngine)return;const R=new lo(s,i,a,r,n,o,u,l,c,g,f);this._roomEngine.setSelectedRoomObjectData(t,R)}updateSelectedObjectData(t,s,i,r,n,a,o=0,u=null,l=null,c=-1,g=-1,f=null){if(!this._roomEngine)return null;const R=new lo(s,i,a,r,n,o,u,l,c,g,f);this._roomEngine.setSelectedRoomObjectData(t,R)}handleUserPlace(t,s,i,r){return r.isRoomTile(s,i)?(t.setLocation(new I(s,i,r.getHeight(s,i))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class vB{constructor(){this._events=new Me,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const s=this.getLogicType(t);if(!s)return null;const i=new s;if(!i)return null;if(i.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const r=i.getEventTypes();for(const n of r)n&&this.registerEventType(n)}return i}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const s of this._functions)s&&this._events.addEventListener(t,s)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const s of this._registeredEvents.keys())s&&this._events.addEventListener(s,t)}}removeEventFunction(t){if(!t)return;const s=this._functions.indexOf(t);if(s!==-1){this._functions.splice(s,1);for(const i of this._registeredEvents.keys())i&&this._events.removeEventListener(i,t)}}getLogicType(t){if(!t)return null;let s=null;switch(t){case M.ROOM:s=QG;break;case M.TILE_CURSOR:s=Qa;break;case M.SELECTION_ARROW:s=JG;break;case M.USER:case M.BOT:case M.RENTABLE_BOT:s=ci;break;case M.PET:s=kG;break;case M.FURNITURE_BASIC:s=ut;break;case M.FURNITURE_BADGE_DISPLAY:s=zg;break;case M.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:s=tG;break;case M.FURNITURE_COUNTER_CLOCK:s=sG;break;case M.FURNITURE_CRACKABLE:s=iG;break;case M.FURNITURE_CREDIT:s=nG;break;case M.FURNITURE_CUSTOM_STACK_HEIGHT:s=oG;break;case M.FURNITURE_DICE:s=_G;break;case M.FURNITURE_EDITABLE_INTERNAL_LINK:s=uG;break;case M.FURNITURE_EDITABLE_ROOM_LINK:s=lG;break;case M.FURNITURE_EXTERNAL_IMAGE_WALLITEM:s=dG;break;case M.FURNITURE_FIREWORKS:s=gG;break;case M.FURNITURE_FLOOR_HOLE:s=Wg;break;case M.FURNITURE_GUILD_CUSTOMIZED:s=Ir;break;case M.FURNITURE_HIGH_SCORE:s=Kg;break;case M.FURNITURE_HOCKEY_SCORE:s=mG;break;case M.FURNITURE_ES:s=RG;break;case M.FURNITURE_MANNEQUIN:s=Ka;break;case M.FURNITURE_MULTIHEIGHT:s=SG;break;case M.FURNITURE_MULTISTATE:s=Ut;break;case M.FURNITURE_ONE_WAY_DOOR:s=NG;break;case M.FURNITURE_PET_CUSTOMIZATION:s=DG;break;case M.FURNITURE_PRESENT:s=Rr;break;case M.FURNITURE_PURCHASABLE_CLOTHING:s=LG;break;case M.FURNITURE_PUSHABLE:s=Xa;break;case M.FURNITURE_BACKGROUND_COLOR:s=FG;break;case M.FURNITURE_BG:s=xG;break;case M.FURNITURE_BB:s=GG;break;case M.FURNITURE_ROOMDIMMER:s=BG;break;case M.FURNITURE_SCORE:s=Ah;break;case M.FURNITURE_SOUNDBLOCK:s=qa;break;case M.FURNITURE_STICKIE:s=qg;break;case M.FURNITURE_TROPHY:s=VG;break;case M.FURNITURE_VOTE_COUNTER:s=Sh;break;case M.FURNITURE_VOTE_MAJORITY:s=jG;break;case M.FURNITURE_WINDOW:s=zG;break;case M.FURNITURE_LOVELOCK:s=OG;break;case M.FURNITURE_YOUTUBE:s=WG;break;case M.FURNITURE_CRAFTING_GIZMO:s=rG;break;case M.FURNITURE_RENTABLE_SPACE:s=bG;break;case M.FURNITURE_EFFECTBOX:s=cG;break;case M.FURNITURE_MONSTERPLANT_SEED:s=AG;break;case M.FURNITURE_MYSTERYBOX:s=MG;break;case M.FURNITURE_MYSTERYTROPHY:s=CG;break;case M.FURNITURE_RANDOM_TELEPORT:s=vG;break;case M.FURNITURE_CLOTHING_CHANGE:s=eG;break;case M.FURNITURE_CUCKOO_CLOCK:s=aG;break;case M.FURNITURE_ECOTRON_BOX:s=hG;break;case M.FURNITURE_GROUP_FORUM_TERMINAL:s=EG;break;case M.FURNITURE_HWEEN_LOVELOCK:s=IG;break;case M.FURNITURE_INTERNAL_LINK:s=TG;break;case M.FURNITURE_JUKEBOX:s=pG;break;case M.FURNITURE_PLACEHOLDER:s=PG;break;case M.FURNITURE_PLANET_SYSTEM:s=yG;break;case M.FURNITURE_RANDOMSTATE:s=UG;break;case M.FURNITURE_SONG_DISK:s=wG;break;case M.FURNITURE_SOUND_MACHINE:s=HG;break;case M.FURNITURE_WELCOME_GIFT:s=YG;break;case M.FURNITURE_ACHIEVEMENT_RESOLUTION:s=wi;break;case M.FURNITURE_HABBOWHEEL:s=fG;break;default:s=ut;break}return s||(G.warn("Unknown Logic",t),null)}get events(){return this._events}}const ft=class extends as{constructor(e){super(),this._communication=e,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new UB(this),this._roomMessageHandler=new LB(this),this._roomContentLoader=new Ae,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new Xf,this._visualizationFactory=new mE,this._logicFactory=new vB,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new kh(1e3),this._thumbnailObjectIdBank=new kh(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(A.FLOOR),this._roomManager.addUpdateCategory(A.WALL),this._roomManager.addUpdateCategory(A.UNIT),this._roomManager.addUpdateCategory(A.CURSOR),this._roomManager.addUpdateCategory(A.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(k.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(k.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(Ae.LOADER_READY,this.onRoomContentLoaderReadyEvent),Os().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[e,t]of this._roomInstanceDatas)this.removeRoomInstance(e);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),Os().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(Ae.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(k.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(k.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(e){if(e instanceof k)switch(e.type){case k.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(e.session.roomId);return;case k.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(e.session.roomId));return}}onRoomContentLoaderReadyEvent(e){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(e){this._activeRoomId=e}destroyRoom(e){this.removeRoomInstance(e)}getRoomInstance(e){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(e))||null}removeRoomInstance(e){this.getRoomInstance(e)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(e));const s=this._roomInstanceDatas.get(e);s&&(this._roomInstanceDatas.delete(s.roomId),s.dispose()),this.events.dispatchEvent(new ct(ct.DISPOSED,e))}createRoomInstance(e,t){let s="111",i="201",r="1";if(!this._ready){let o=this._roomDatas.get(e);o&&(this._roomDatas.delete(e),s=o.floorType,i=o.wallType,r=o.landscapeType),o=new iu(e,t),o.floorType=s,o.wallType=i,o.landscapeType=r,this._roomDatas.set(e,o),G.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!t){G.warn("Room property messages");return}const n=this._roomDatas.get(e);n&&(this._roomDatas.delete(e),n.floorType&&(s=n.floorType),n.wallType&&(i=n.wallType),n.landscapeType&&(r=n.landscapeType)),this.setupRoomInstance(e,t,s,i,r,this.getRoomInstanceModelName(e))&&(t.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new ct(ct.INITIALIZED,e)))}setupRoomInstance(e,t,s,i,r,n){if(!this._ready||!this._roomManager)return;const a=this._roomManager.createRoomInstance(this.getRoomId(e));if(!a)return null;const o=A.ROOM,u=a.createRoomObjectAndInitalize(ft.ROOM_OBJECT_ID,ft.ROOM_OBJECT_TYPE,o);if(a.model.setValue(mt.ROOM_IS_PUBLIC,0),a.model.setValue(mt.ROOM_Z_SCALE,1),t&&(a.model.setValue(mt.RESTRICTS_DRAGGING,t.restrictsDragging),a.model.setValue(mt.RESTRICTS_SCALING,t.restrictsScaling),a.model.setValue(mt.RESTRICTED_SCALE,t.restrictedScale),t.dimensions)){const g=t.dimensions.minX,f=t.dimensions.maxX,R=t.dimensions.minY,m=t.dimensions.maxY;a.model.setValue(mt.ROOM_MIN_X,g),a.model.setValue(mt.ROOM_MAX_X,f),a.model.setValue(mt.ROOM_MIN_Y,R),a.model.setValue(mt.ROOM_MAX_Y,m);const T=Math.trunc(g*423+f*671+R*913+m*7509);u&&u.model&&u.model.setValue(d.ROOM_RANDOM_SEED,T)}const l=u&&u.logic||null;if(l&&(l.initialize(t),s&&(l.processUpdateMessage(new zt(zt.ROOM_FLOOR_UPDATE,s)),a.model.setValue(d.ROOM_FLOOR_TYPE,s)),i&&(l.processUpdateMessage(new zt(zt.ROOM_WALL_UPDATE,i)),a.model.setValue(d.ROOM_WALL_TYPE,i)),r&&(l.processUpdateMessage(new zt(zt.ROOM_LANDSCAPE_UPDATE,r)),a.model.setValue(d.ROOM_LANDSCAPE_TYPE,r))),t&&t.doors.length){let c=0;for(;c<t.doors.length;){const g=t.doors[c];if(g){const f=g.x,R=g.y,m=g.z,T=g.dir,O=Wt.DOOR,C="door_"+c,N=new I(f,R,m);l.processUpdateMessage(new Wt(Wt.ADD_MASK,C,O,N,Wt.HOLE)),(T===90||T===180)&&(T===90&&(a.model.setValue(d.ROOM_DOOR_X,f-.5),a.model.setValue(d.ROOM_DOOR_Y,R)),T===180&&(a.model.setValue(d.ROOM_DOOR_X,f),a.model.setValue(d.ROOM_DOOR_Y,R-.5)),a.model.setValue(d.ROOM_DOOR_Z,m),a.model.setValue(d.ROOM_DOOR_DIR,T))}c++}}return a.createRoomObjectAndInitalize(ft.CURSOR_OBJECT_ID,ft.CURSOR_OBJECT_TYPE,A.CURSOR),W.getValue("enable.avatar.arrow",!1)&&a.createRoomObjectAndInitalize(ft.ARROW_OBJECT_ID,ft.ARROW_OBJECT_TYPE,A.CURSOR),a}getRoomInstanceDisplay(e,t,s,i,r){const n=this.getRoomInstance(e);if(!n)return null;let a=n.renderer;if(!a&&(a=this._roomRendererFactory.createRenderer(),!a))return null;a.roomObjectVariableAccurateZ=d.OBJECT_ACCURATE_Z_VALUE,n.setRenderer(a);const o=a.createCanvas(t,s,i,r);if(!o)return null;if(n.model.getValue(mt.RESTRICTS_SCALING)){let l=n.model.getValue(mt.RESTRICTED_SCALE);l||(l=1),o.setScale(l),o.restrictsScaling=!0}else o.restrictsScaling=!1;if(o.setMouseListener(this._roomObjectEventHandler),o.geometry){o.geometry.z_scale=n.model.getValue(mt.ROOM_Z_SCALE);const l=n.model.getValue(d.ROOM_DOOR_X),c=n.model.getValue(d.ROOM_DOOR_Y),g=n.model.getValue(d.ROOM_DOOR_Z),f=n.model.getValue(d.ROOM_DOOR_DIR),R=new I(l,c,g);let m=null;f===90&&(m=new I(-2e3,0,0)),f===180&&(m=new I(0,-2e3,0)),o.geometry.setDisplacement(R,m);const T=o.master;if(T){const O=new Pt(Dt.EMPTY);O.name=ft.OVERLAY,O.interactive=!1,T.addChild(O)}}return o.master}setRoomInstanceRenderingCanvasMask(e,t,s){const i=this.getRoomInstanceRenderingCanvas(e,t);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(e,t,s,i=null,r=null,n=!1,a=!1){const o=this.getRoomInstanceRenderingCanvas(e,t);if(o){if(o.restrictsScaling&&!n)return;o.setScale(s,i,r,n,a),this.events.dispatchEvent(new ct(ct.ROOM_ZOOMED,e))}}getRoomInstanceRenderingCanvas(e,t=-1){const s=this.getRoomInstance(e);if(!s)return null;const i=s.renderer;if(!i)return null;t===-1&&(t=this._activeRoomActiveCanvas);const r=i.getCanvas(t);return r||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(e,t=-1){t===-1&&(t=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(e,t);return s?new Y(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(e,t,s){const i=this.getRoomInstanceRenderingCanvas(e,t);if(!i||!s)return!1;const r=~~s.x,n=~~s.y;if(!(i.screenOffsetX===r&&i.screenOffsetY===n))return this.events.dispatchEvent(new Du(e,-(i.screenOffsetX-r),-(i.screenOffsetY-n))),i.screenOffsetX=r,i.screenOffsetY=n,!0}getRoomInstanceRenderingCanvasScale(e=-1e3,t=-1){e===-1e3&&(e=this._activeRoomId),t===-1&&(t=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(e,t);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(e,t,s,i){const r=this.getRoomInstanceRenderingCanvas(e,t);r&&r.initialize(s,i)}getRoomInstanceGeometry(e,t=-1){const s=this.getRoomInstance(e);if(!s)return null;const i=s.renderer;if(!i)return null;t===-1&&(t=this._activeRoomActiveCanvas);const r=i.getCanvas(t);return r?r.geometry:null}getRoomInstanceVariable(e,t){const s=this.getRoomInstance(e);return s&&s.model&&s.model.getValue(t)||null}updateRoomInstancePlaneVisibility(e,t,s=!0){const i=this.getRoomOwnObject(e);return i?(i.processUpdateMessage(new Ps(Ps.WALL_VISIBILITY,t)),i.processUpdateMessage(new Ps(Ps.FLOOR_VISIBILITY,s)),!0):!1}updateRoomInstancePlaneThickness(e,t,s){const i=this.getRoomOwnObject(e);return i?(i.processUpdateMessage(new Ds(Ds.WALL_THICKNESS,t)),i.processUpdateMessage(new Ds(Ds.FLOOR_THICKNESS,s)),!0):!1}updateRoomInstancePlaneType(e,t=null,s=null,i=null,r=!1){const n=this.getRoomOwnObject(e),a=this.getRoomInstance(e);if(!n){let o=this._roomDatas.get(e);return o||(o=new iu(e,null),this._roomDatas.set(e,o)),t&&(o.floorType=t),s&&(o.wallType=s),i&&(o.landscapeType=i),!0}return t&&(a&&!r&&a.model.setValue(d.ROOM_FLOOR_TYPE,t),n.processUpdateMessage(new zt(zt.ROOM_FLOOR_UPDATE,t))),s&&(a&&!r&&a.model.setValue(d.ROOM_WALL_TYPE,s),n.processUpdateMessage(new zt(zt.ROOM_WALL_UPDATE,s))),i&&(a&&!r&&a.model.setValue(d.ROOM_LANDSCAPE_TYPE,i),n.processUpdateMessage(new zt(zt.ROOM_LANDSCAPE_UPDATE,i))),!0}updateObjectRoomColor(e,t,s,i){const r=this.getRoomOwnObject(e);if(!r||!r.logic)return!1;const n=new ma(ma.BACKGROUND_COLOR,t,s,i);return r.logic.processUpdateMessage(n),this.events.dispatchEvent(new Cu(e,t,s,i)),!0}addRoomInstanceFloorHole(e,t){if(t<0)return;const s=this.getRoomOwnObject(e),i=this.getRoomObjectFloor(e,t);if(s&&s.logic&&i&&i.model){const r=i.getLocation(),n=i.model.getValue(d.FURNITURE_SIZE_X),a=i.model.getValue(d.FURNITURE_SIZE_Y);s.processUpdateMessage(new Ns(Ns.ADD,t,r.x,r.y,n,a))}}removeRoomInstanceFloorHole(e,t){if(t<0)return;const s=this.getRoomOwnObject(e);s&&s.processUpdateMessage(new Ns(Ns.REMOVE,t))}setRoomEngineGameMode(e,t){const s=this.getRoomInstance(e);if(!s)return;const i=t?1:0;s.model.setValue(mt.IS_PLAYING_GAME,i),i===0?this.events.dispatchEvent(new ct(ct.NORMAL_MODE,e)):this.events.dispatchEvent(new ct(ct.GAME_MODE,e))}isRoomIdPlayingGame(e){const t=this.getRoomInstance(e);return t?t.model.getValue(mt.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(e){e?Os().remove(this.update,this):(Os().remove(this.update,this),Os().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(e,t=!1){this._roomManager&&(e=Z(),Xt.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(e,t),this.updateRoomCameras(e),this._mouseCursorUpdate&&this.setPointer(),Xt.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const e=this.getRoomInstanceData(this._activeRoomId);e&&e.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const e=new Date().valueOf(),t=5;for(const s of this._roomInstanceDatas.values()){if(!s)continue;let i=null,r=0,n=!1;for(;i=s.getNextPendingFurnitureFloor();)if(n=this.processPendingFurnitureFloor(s.roomId,i.id,i),!(++r%t)&&new Date().valueOf()-e>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(i=s.getNextPendingFurnitureWall());)if(n=this.processPendingFurnitureWall(s.roomId,i.id,i),!(++r%t)&&new Date().valueOf()-e>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(n&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(s.roomId)).hasUninitializedObjects()||this.objectsInitialized(s.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(e){if(e){this._ready=!0,this.events.dispatchEvent(new ct(ct.ENGINE_INITIALIZED,0));for(const t of this._roomDatas.values())t&&this.createRoomInstance(t.roomId,t.data)}}processPendingFurnitureFloor(e,t,s){if(!s){const o=this.getRoomInstanceData(e);if(o&&(s=o.getPendingFurnitureFloor(t)),!s)return!1}let i=s.type;i||(i=this.getFurnitureFloorName(s.typeId));const r=this.createRoomObjectFloor(e,t,i);if(!r)return!1;const n=r.model;if(n&&(n.setValue(d.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),n.setValue(d.FURNITURE_TYPE_ID,s.typeId),n.setValue(d.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),n.setValue(d.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),n.setValue(d.FURNITURE_EXPIRY_TIME,s.expiryTime),n.setValue(d.FURNITURE_EXPIRTY_TIMESTAMP,Z()),n.setValue(d.FURNITURE_USAGE_POLICY,s.usagePolicy),n.setValue(d.FURNITURE_OWNER_ID,s.ownerId),n.setValue(d.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(e,t,s.location,s.direction,s.state,s.data,s.extra)||s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(e,t,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new H(H.ADDED,e,t,A.FLOOR));const a=this.getPlacedRoomObjectData(e);return a&&a.id===t&&a.category===A.FLOOR&&this.selectRoomObject(e,t,A.FLOOR),r.isReady&&s.synchronized&&this.addObjectToTileMap(e,r),!0}processPendingFurnitureWall(e,t,s){if(!s){const u=this.getRoomInstanceData(e);if(u&&(s=u.getPendingFurnitureWall(t)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let r=this.getFurnitureWallName(s.typeId,i);r||(r="");const n=this.createRoomObjectWall(e,t,r);if(!n)return!1;const a=n.model;if(a&&(a.setValue(d.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),a.setValue(d.FURNITURE_TYPE_ID,s.typeId),a.setValue(d.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),a.setValue(d.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(d.OBJECT_ACCURATE_Z_VALUE,1),a.setValue(d.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(d.FURNITURE_EXPIRTY_TIMESTAMP,Z()),a.setValue(d.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(d.FURNITURE_OWNER_ID,s.ownerId),a.setValue(d.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(e,t,s.location,s.direction,s.state,i))return!1;this.events&&this.events.dispatchEvent(new H(H.ADDED,e,t,A.WALL));const o=this.getPlacedRoomObjectData(e);return o&&Math.abs(o.id)===t&&o.category===A.WALL&&this.selectRoomObject(e,t,A.WALL),!0}setRoomSessionOwnUser(e,t){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(e);s&&s.setOwnRoomIndex(t);const i=this.getRoomCamera(e);i&&(i.targetId=t,i.targetCategory=A.UNIT,i.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(e){for(const t of this._roomInstanceDatas.values()){if(!t)continue;const s=t.roomCamera;if(!s)continue;let i=null;const r=this.getRoomObject(t.roomId,s.targetId,s.targetCategory);r&&(i=r.getLocation()),i&&(t.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(t.roomId,1,i,e)}if(this._activeRoomWasDragged){const t=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);t&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new Y(t.screenOffsetX+this._activeRoomDragX,t.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(e,t,s,i){const r=this.getRoomInstanceRenderingCanvas(e,t),n=this.getRoomInstanceData(e);if(!r||!n||r.scale!==1)return;const a=r.geometry,o=n.roomCamera,u=this.getRoomInstance(e);if(!a||!o||!u)return;const l=this.getRoomCanvasRectangle(e,t);if(!l)return;let c=Math.floor(s.z)+1;const g=Math.round(l.width),f=Math.round(l.height),R=this.getCanvasBoundingRectangle(t);if(R&&(R.right<0||R.bottom<0||R.left>=g||R.top>=f)&&o.reset(),o.screenWd!==g||o.screenHt!==f||o.scale!==a.scale||o.geometryUpdateId!==a.updateId||!I.isEqual(s,o.targetObjectLoc)||o.isMoving){o.targetObjectLoc=s;const m=new I;m.assign(s),m.x=Math.round(m.x),m.y=Math.round(m.y);const T=u.model.getValue(mt.ROOM_MIN_X)-.5,O=u.model.getValue(mt.ROOM_MIN_Y)-.5,C=u.model.getValue(mt.ROOM_MAX_X)+.5,N=u.model.getValue(mt.ROOM_MAX_Y)+.5,S=Math.round((T+C)/2),D=Math.round((O+N)/2),v=2;let b=new Y(m.x-S,m.y-D);const w=a.scale/Math.sqrt(2),Q=w/2,$=new ue;$.rotate(-(a.direction.x+90)/180*Math.PI),b=$.apply(b),b.y=b.y*(Q/w);const X=l.width/2/w-1,Ct=l.height/2/Q-1;let Ht=0,re=0,pe=0,hs=0,Vt=a.getScreenPoint(new I(S,D,v));if(!Vt)return;if(Vt.x=Vt.x+Math.round(l.width/2),Vt.y=Vt.y+Math.round(l.height/2),R)if(R.x+=-r.screenOffsetX,R.y+=-r.screenOffsetY,R.width>1&&R.height>1)Ht=(R.left-Vt.x-a.scale*.25)/w,pe=(R.right-Vt.x+a.scale*.25)/w,re=(R.top-Vt.y-a.scale*.5)/Q,hs=(R.bottom-Vt.y+a.scale*.5)/Q;else{a.adjustLocation(new I(-30,-30),25);return}else{a.adjustLocation(new I(0,0),25);return}let Un=!1,Pr=!1,so=!1,io=!1;Math.round((pe-Ht)*w)<l.width?(c=2,b.x=(pe+Ht)/2,so=!0):(b.x>pe-X&&(b.x=pe-X,Un=!0),b.x<Ht+X&&(b.x=Ht+X,Un=!0)),Math.round((hs-re)*Q)<l.height?(c=2,b.y=(hs+re)/2,io=!0):(b.y>hs-Ct&&(b.y=hs-Ct,Pr=!0),b.y<re+Ct&&(b.y=re+Ct,Pr=!0),Pr&&(b.y=b.y/(Q/w))),$.invert(),b=$.apply(b),b.x=b.x+S,b.y=b.y+D;let Hi=.35,Ei=.2,vn=.2;const Gh=10,Bh=10;if(vn*g>100&&(vn=100/g),Hi*f>150&&(Hi=150/f),Ei*f>150&&(Ei=150/f),o.limitedLocationX&&o.screenWd==g&&o.screenHt==f&&(vn=0),o.limitedLocationY&&o.screenWd==g&&o.screenHt==f&&(Hi=0,Ei=0),l.width=l.width*(1-vn*2),l.height=l.height*(1-(Hi+Ei)),l.width<Gh&&(l.width=Gh),l.height<Bh&&(l.height=Bh),Hi+Ei>0?(l.x+=-l.width/2,l.y+=-l.height*(Ei/(Hi+Ei))):(l.x+=-l.width/2,l.y+=-l.height/2),Vt=a.getScreenPoint(m),!Vt)return;if(Vt){Vt.x=Vt.x+r.screenOffsetX,Vt.y=Vt.y+r.screenOffsetY,m.z=c,m.x=Math.round(b.x*2)/2,m.y=Math.round(b.y*2)/2,o.location||(a.location=m,this.useOffsetScrolling?o.initializeLocation(new I(0,0,0)):o.initializeLocation(m));const ro=a.getScreenPoint(m),no=new I(0,0,0);ro&&(no.x=ro.x,no.y=ro.y),(Vt.x<l.left||Vt.x>l.right)&&!o.centeredLocX||(Vt.y<l.top||Vt.y>l.bottom)&&!o.centeredLocY||so&&!o.centeredLocX&&o.screenWd!=g||io&&!o.centeredLocY&&o.screenHt!=f||o.roomWd!=R.width||o.roomHt!=R.height||o.screenWd!=g||o.screenHt!=f?(o.limitedLocationX=Un,o.limitedLocationY=Pr,this.useOffsetScrolling?o.target=no:o.target=m):(Un||(o.limitedLocationX=!1),Pr||(o.limitedLocationY=!1))}o.centeredLocX=so,o.centeredLocY=io,o.screenWd=g,o.screenHt=f,o.scale=a.scale,o.geometryUpdateId=a.updateId,o.roomWd=R.width,o.roomHt=R.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?o.update(i,8):o.update(i,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new Y(-o.location.x,-o.location.y)):a.adjustLocation(o.location,25)}else o.limitedLocationX=!1,o.limitedLocationY=!1,o.centeredLocX=!1,o.centeredLocY=!1}getRoomCanvasRectangle(e,t){const s=this.getRoomInstanceRenderingCanvas(e,t);return s?new fe(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(e,t,s,i){const r=this.getRoomInstanceGeometry(e,i);if(!r)return null;const n=this.getRoomObject(e,t,s);if(!n)return null;const a=n.visualization;if(!a)return null;const o=a.getBoundingRectangle(),u=this.getRoomInstanceRenderingCanvas(e,i),l=u?u.scale:1,c=r.getScreenPoint(n.getLocation());return!c||(c.x=Math.round(c.x),c.y=Math.round(c.y),o.x=o.x*l,o.y=o.y*l,o.width=o.width*l,o.height=o.height*l,c.x=c.x*l,c.y=c.y*l,o.x+=c.x,o.y+=c.y,!u)?null:(o.x+=Math.round(u.width/2)+u.screenOffsetX,o.y+=Math.round(u.height/2)+u.screenOffsetY,o)}getCanvasBoundingRectangle(e){return this.getRoomObjectBoundingRectangle(this._activeRoomId,ft.ROOM_OBJECT_ID,A.ROOM,e)}getFurnitureFloorName(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(e):null}getFurnitureWallName(e,t=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(e,t):null}getFurnitureFloorColorIndex(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(e):null}getFurnitureWallColorIndex(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(e):null}getRoomInstanceData(e){const t=this._roomInstanceDatas.get(e);if(t)return t;const s=new PB(e);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(e){const t=this.getRoomInstanceData(e);return t?t.modelName:null}setRoomInstanceModelName(e,t){const s=this.getRoomInstanceData(e);s&&s.setModelName(t)}getRoomTileObjectMap(e){const t=this.getRoomInstanceData(e);return t?t.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(e){const t=this.getRoomInstanceData(e);return t?t.roomCamera:null}getSelectedRoomObjectData(e){const t=this.getRoomInstanceData(e);return t?t.selectedObject:null}setSelectedRoomObjectData(e,t){const s=this.getRoomInstanceData(e);if(!s)return null;s.setSelectedObject(t),t&&s.setPlacedObject(null)}getPlacedRoomObjectData(e){const t=this.getRoomInstanceData(e);return t?t.placedObject:null}setPlacedRoomObjectData(e,t){const s=this.getRoomInstanceData(e);if(!s)return null;s.setPlacedObject(t)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(e){const t=this.getRoomInstanceData(e);return t?t.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(e,t){const s=this.getRoomInstanceData(e);if(!s)return null;s.setFurnitureStackingHeightMap(t)}getLegacyWallGeometry(e){const t=this.getRoomInstanceData(e);return t?t.legacyGeometry:null}createRoomObjectAndInitialize(e,t,s,i){const r=this.getRoomInstance(e);return r?r.createRoomObjectAndInitalize(t,s,i):null}getTotalObjectsForManager(e,t){const s=this.getRoomInstance(e);return s?s.getTotalObjectsForManager(t):0}getRoomObject(e,t,s){if(!this._ready)return null;let i=this.getRoomId(e);return e===0&&(i=ft.TEMPORARY_ROOM),this.getObject(i,t,s)}getObject(e,t,s){let i=null;if(this._roomManager&&(i=this._roomManager.getRoomInstance(e)),!i)return null;let r=i.getRoomObject(t,s);if(!r)switch(s){case A.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(e),t,null),r=i.getRoomObject(t,s);break;case A.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(e),t,null),r=i.getRoomObject(t,s);break}return r}getRoomObjectByIndex(e,t,s){const i=this.getRoomInstance(e);return i?i.getRoomObjectByIndex(t,s):null}getRoomObjectCategoryForType(e){return!e||!this._roomContentLoader?A.MINIMUM:this._roomContentLoader.getCategoryForType(e)}getRoomObjectCursor(e){return this.getObject(this.getRoomId(e),ft.CURSOR_OBJECT_ID,A.CURSOR)}getRoomObjectSelectionArrow(e){return this.getObject(this.getRoomId(e),ft.ARROW_OBJECT_ID,A.CURSOR)}getRoomOwnObject(e){return this.getObject(this.getRoomId(e),ft.ROOM_OBJECT_ID,A.ROOM)}getRoomObjectUser(e,t){return this.getObject(this.getRoomId(e),t,A.UNIT)}removeRoomObjectUser(e,t){return this.removeRoomObject(e,t,A.UNIT)}createRoomObjectUser(e,t,s){return this.createRoomObjectAndInitialize(e,t,s,A.UNIT)}getRoomObjectFloor(e,t){return this.getObject(this.getRoomId(e),t,A.FLOOR)}createRoomObjectFloor(e,t,s){return this.createRoomObjectAndInitialize(e,t,s,A.FLOOR)}removeRoomObjectFloor(e,t,s=-1,i=!1){const r=this.getRoomInstanceData(e);if(r&&r.removePendingFunitureFloor(t),this._sessionDataManager&&s===this._sessionDataManager.userId&&!H_.isBuilderClubId(t)){const n=this.getRoomObject(e,t,A.FLOOR);if(n){const a=this.getRoomObjectScreenLocation(e,t,A.FLOOR,this._activeRoomActiveCanvas);if(a&&!(n.model.getValue(d.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const u=n.model.getValue(d.FURNITURE_TYPE_ID),l=n.model.getValue(d.FURNITURE_EXTRAS),c=n.model.getValue(d.FURNITURE_DATA_FORMAT),g=$s.getData(c),f=this.getFurnitureFloorIcon(u,null,l,g).data;if(f){const R=Ot.generateImage(f);if(this.events){const m=new Ao(R,a.x,a.y);m.iconName=vs.INVENTORY,this.events.dispatchEvent(m)}}}}}this.removeRoomObject(e,t,A.FLOOR),this.setMouseDefault(e,A.FLOOR,t),i&&this.refreshTileObjectMap(e,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(e,t){return this.getObject(this.getRoomId(e),t,A.WALL)}removeRoomObjectWall(e,t,s=-1){if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!H_.isBuilderClubId(t)){const i=this.getRoomObject(e,t,A.WALL);if(i&&i.type.indexOf("post_it")===-1&&i.type.indexOf("external_image_wallitem")===-1){const r=this.getRoomObjectScreenLocation(e,t,A.WALL,this._activeRoomActiveCanvas);if(r){const n=i.model.getValue(d.FURNITURE_TYPE_ID),a=i.model.getValue(d.FURNITURE_DATA),o=this.getFurnitureWallIcon(n,null,a).data;if(o){const u=Ot.generateImage(o);if(this.events){const l=new Ao(u,r.x,r.y);l.iconName=vs.INVENTORY,this.events.dispatchEvent(l)}}}}}this.removeRoomObject(e,t,A.WALL),this.updateRoomObjectMask(e,t,!1),this.setMouseDefault(e,A.WALL,t)}createRoomObjectWall(e,t,s){return this.createRoomObjectAndInitialize(e,t,s,A.WALL)}removeRoomObject(e,t,s){const i=this.getRoomInstance(e);if(!i)return null;i.removeRoomObject(t,s),this.events&&this.events.dispatchEvent(new H(H.REMOVED,e,t,s))}addFurnitureFloor(e,t,s,i,r,n,a,o=NaN,u=-1,l=0,c=0,g="",f=!0,R=!0,m=-1){const T=this.getRoomInstanceData(e);if(!T)return!1;const O=new uo(t,s,null,i,r,n,a,o,u,l,c,g,f,R,m);return T.addPendingFurnitureFloor(O),!0}addFurnitureFloorByTypeName(e,t,s,i,r,n,a,o=NaN,u=-1,l=0,c=0,g="",f=!0,R=!0,m=-1){const T=this.getRoomInstanceData(e);if(!T)return!1;const O=new uo(t,0,s,i,r,n,a,o,u,l,c,g,f,R,m);return T.addPendingFurnitureFloor(O),!0}addFurnitureWall(e,t,s,i,r,n,a,o=-1,u=0,l=0,c="",g=!0){const f=this.getRoomInstanceData(e);if(!f)return!1;const R=new me;R.setString(a);const m=new uo(t,s,null,i,r,n,R,NaN,o,u,l,c,!0,g);return f.addPendingFurnitureWall(m),!0}updateRoomObjectFloor(e,t,s,i,r,n,a=null){const o=this.getRoomObjectFloor(e,t);return o?(o.processUpdateMessage(new Bt(s,i)),o.processUpdateMessage(new Et(r,n,a)),!0):!1}updateRoomObjectWall(e,t,s,i,r,n=null){const a=this.getRoomObjectWall(e,t);if(!a||!a.logic)return!1;const o=new Bt(s,i),u=new me,l=new Et(r,u);return u.setString(n),a.logic.processUpdateMessage(o),a.logic.processUpdateMessage(l),this.updateRoomObjectMask(e,t),!0}updateRoomObjectWallItemData(e,t,s){const i=this.getRoomObjectWall(e,t);return!i||!i.logic?!1:(i.logic.processUpdateMessage(new ph(s)),!0)}updateRoomObjectFloorHeight(e,t,s){const i=this.getRoomObjectFloor(e,t);return i?(i.processUpdateMessage(new Vg(null,null,s)),!0):!1}updateRoomObjectFloorExpiration(e,t,s){const i=this.getRoomObjectFloor(e,t);return i?(i.model.setValue(d.FURNITURE_EXPIRY_TIME,s),i.model.setValue(d.FURNITURE_EXPIRTY_TIMESTAMP,Z()),!0):!1}updateRoomObjectWallExpiration(e,t,s){const i=this.getRoomObjectWall(e,t);return i?(i.model.setValue(d.FURNITURE_EXPIRY_TIME,s),i.model.setValue(d.FURNITURE_EXPIRTY_TIMESTAMP,Z()),!0):!1}updateRoomObjectMask(e,t,s=!0){const i=A.WALL+"_"+t,r=this.getRoomObjectWall(e,t);let n=null;if(r&&r.model){if(r.model.getValue(d.FURNITURE_USES_PLANE_MASK)>0){const o=r.model.getValue(d.FURNITURE_PLANE_MASK_TYPE),u=r.getLocation();s?n=new Wt(Wt.ADD_MASK,i,o,u):n=new Wt(Wt.REMOVE_MASK,i)}}else n=new Wt(Wt.REMOVE_MASK,i);const a=this.getRoomOwnObject(e);a&&a.logic&&n&&a.logic.processUpdateMessage(n)}rollRoomObjectFloor(e,t,s,i){const r=this.getRoomObjectFloor(e,t);r&&r.processUpdateMessage(new ii(s,i,null,!!i))}updateRoomObjectWallLocation(e,t,s){const i=this.getRoomObjectWall(e,t);return i?(i.logic&&i.logic.processUpdateMessage(new ii(s,null,null)),this.updateRoomObjectMask(e,t),!0):!1}addRoomObjectUser(e,t,s,i,r,n,a){if(this.getRoomObjectUser(e,t))return!1;let u=et.getTypeString(n);u===et.PET&&(u=this.getPetType(a));const l=this.createRoomObjectUser(e,t,u);return l?(l.processUpdateMessage(new fa(this.fixedUserLocation(e,s),null,i,r,!1,0)),a&&l.processUpdateMessage(new ga(a)),this.events&&this.events.dispatchEvent(new H(H.ADDED,e,t,A.UNIT)),!0):!1}updateRoomObjectUserLocation(e,t,s,i,r=!1,n=0,a=null,o=NaN){const u=this.getRoomObjectUser(e,t);if(!u)return!1;s||(s=u.getLocation()),a||(a=u.getDirection()),isNaN(o)&&(o=u.model.getValue(d.HEAD_DIRECTION)),u.processUpdateMessage(new fa(this.fixedUserLocation(e,s),this.fixedUserLocation(e,i),a,o,r,n));const l=this._roomSessionManager&&this._roomSessionManager.getSession(e)||null;return l&&l.ownRoomIndex===t&&this._logicFactory.events.dispatchEvent(new Qr(Qr.ROAME_MOVE_TO,i)),!0}fixedUserLocation(e,t){if(!t)return null;const s=this.getFurnitureStackingHeightMap(e),i=this.getLegacyWallGeometry(e);if(!s||!i)return t;let r=t.z;const n=s.getTileHeight(t.x,t.y),a=i.getHeight(t.x,t.y);return Math.abs(r-n)<.1&&Math.abs(n-a)<.1&&(r=i.getFloorAltitude(t.x,t.y)),new I(t.x,t.y,r)}updateRoomObjectUserAction(e,t,s,i,r=null){const n=this.getRoomObjectUser(e,t);if(!n)return!1;let a=null;switch(s){case d.FIGURE_TALK:a=new Ih(i);break;case d.FIGURE_SLEEP:a=new Th(i===1);break;case d.FIGURE_IS_TYPING:a=new wg(i===1);break;case d.FIGURE_IS_MUTED:a=new vg(i===1);break;case d.FIGURE_CARRY_OBJECT:a=new Cg(i,r);break;case d.FIGURE_USE_OBJECT:a=new Hg(i);break;case d.FIGURE_DANCE:a=new Ng(i);break;case d.FIGURE_GAINED_EXPERIENCE:a=new Pg(i);break;case d.FIGURE_NUMBER_VALUE:a=new xg(i);break;case d.FIGURE_SIGN:a=new Bg(i);break;case d.FIGURE_EXPRESSION:a=new yg(i);break;case d.FIGURE_IS_PLAYING_GAME:a=new Gg(i===1);break;case d.FIGURE_GUIDE_STATUS:a=new $1(i);break}return a?(n.processUpdateMessage(a),!0):!1}updateRoomObjectUserFigure(e,t,s,i=null,r=null,n=!1){const a=this.getRoomObjectUser(e,t);return a?(a.processUpdateMessage(new ga(s,i,r,n)),!0):!1}updateRoomObjectUserFlatControl(e,t,s){const i=this.getRoomObjectUser(e,t);return i?(i.processUpdateMessage(new Lg(parseInt(s))),!0):!1}updateRoomObjectUserEffect(e,t,s,i=0){const r=this.getRoomObjectUser(e,t);return r?(r.processUpdateMessage(new Dg(s,i)),!0):!1}updateRoomObjectUserGesture(e,t,s){const i=this.getRoomObjectUser(e,t);return i?(i.processUpdateMessage(new Ug(s)),!0):!1}updateRoomObjectUserPetGesture(e,t,s){const i=this.getRoomObjectUser(e,t);return i?(i.processUpdateMessage(new Fg(s)),!0):!1}updateRoomObjectUserPosture(e,t,s,i=null){const r=this.getRoomObjectUser(e,t);return r?(r.processUpdateMessage(new Rh(s,i)),!0):!1}updateRoomObjectUserOwn(e,t){const s=this.getRoomObjectUser(e,t);s&&s.processUpdateMessage(new bg)}useRoomObject(e,t){const s=this.getRoomObject(this._activeRoomId,e,t);if(s){const i=s.logic;if(i)return i.useObject(),!0}return!1}objectInitialized(e,t,s){const i=this.getRoomIdFromString(e);s===A.WALL&&this.updateRoomObjectMask(i,t);const r=this.getRoomObject(i,t,s);if(r&&r.model&&r.logic){const n=r.model.getValue(d.FURNITURE_DATA_FORMAT);if(!isNaN(n)){const a=$s.getData(n);a.initializeFromRoomObjectModel(r.model),r.processUpdateMessage(new Et(r.getState(0),a))}this.events.dispatchEvent(new H(H.CONTENT_UPDATED,i,t,s))}e!==ft.TEMPORARY_ROOM&&this.addObjectToTileMap(i,r)}changeObjectModelData(e,t,s,i,r){const n=this.getObject(this.getRoomId(e),t,s);if(!n||!n.logic)return!1;const a=new jg(i,r);return n.processUpdateMessage(a),!0}changeObjectState(e,t,s){const i=this.getObject(this.getRoomId(e),t,s);if(!i||!i.model)return;let r=i.model.getValue(d.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(r)?r=1:r=r+1,i.model.setValue(d.FURNITURE_AUTOMATIC_STATE_INDEX,r);const n=i.model.getValue(d.FURNITURE_DATA_FORMAT),a=$s.getData(n);a.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new Et(r,a))}loadRoomObjectBadgeImage(e,t,s,i,r=!0){if(!this._sessionDataManager)return;let n=null;if(e===0){const o=this._roomManager.getRoomInstance(ft.TEMPORARY_ROOM);o&&(n=o.getRoomObject(t,s))}else n=this.getRoomObjectFloor(e,t);if(!n||!n.logic)return;let a=r?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(a)this.putBadgeInObjectAssets(n,i,r);else{a="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(Jr.IMAGE_READY,this.onBadgeImageReadyEvent);let o=this._badgeListenerObjects.get(i);o||(o=[]),o.push(new yB(n,r)),this._badgeListenerObjects.set(i,o)}n.logic.processUpdateMessage(new cr(i,a))}onBadgeImageReadyEvent(e){if(!this._sessionDataManager)return;const t=this._badgeListenerObjects&&this._badgeListenerObjects.get(e.badgeId);if(t){for(const s of t){if(!s)continue;this.putBadgeInObjectAssets(s.object,e.badgeId,s.groupBadge);const i=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(e.badgeId):this._sessionDataManager.loadBadgeImage(e.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new cr(e.badgeId,i))}this._badgeListenerObjects.delete(e.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(Jr.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(e,t,s=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(t):this._sessionDataManager.loadBadgeImage(t),r=s?this._sessionDataManager.getGroupBadgeImage(t):this._sessionDataManager.getBadgeImage(t);r&&this._roomContentLoader.addAssetToCollection(e.type,i,r,!1)}dispatchMouseEvent(e,t,s,i,r,n,a,o){const u=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e);if(!u)return;const l=this.getRenderingCanvasOverlay(u),c=this.getOverlayIconSprite(l,ft.OBJECT_ICON_SPRITE);if(c){const g=c.getLocalBounds();c.x=t-g.width/2,c.y=s-g.height/2}if(!this.handleRoomDragging(u,t,s,i,r,n,a)&&!u.handleMouseEvent(t,s,i,r,n,a,o)){let g=null;i===F.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new H(H.DESELECTED,this._activeRoomId,-1,A.MINIMUM)),g=V.CLICK):i===F.MOUSE_MOVE?g=V.MOUSE_MOVE:i===F.MOUSE_DOWN?g=V.MOUSE_DOWN:i===F.MOUSE_DOWN_LONG?g=V.MOUSE_DOWN_LONG:i===F.MOUSE_UP&&(g=V.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new V(g,this.getRoomObject(this._activeRoomId,ft.ROOM_OBJECT_ID,A.ROOM),null,r),this._activeRoomId)}this._activeRoomActiveCanvas=e,this._activeRoomActiveCanvasMouseX=t,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(e,t,s,i,r,n,a){let o=t-this._activeRoomActiveCanvasMouseX,u=s-this._activeRoomActiveCanvasMouseY;if(i===F.MOUSE_DOWN)!r&&!n&&!a&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(i===F.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const l=this.getRoomInstanceData(this._activeRoomId);if(l){const c=l.roomCamera;c&&(this.useOffsetScrolling&&(c.isMoving||(c.centeredLocX=!1,c.centeredLocY=!1),c.resetLocation(new I(-e.screenOffsetX,-e.screenOffsetY))),this._roomDraggingAlwaysCenters&&c.reset())}}}else if(i===F.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(o=t-this._activeRoomDragStartX,u=s-this._activeRoomDragStartY,(o<=-ft.DRAG_THRESHOLD||o>=ft.DRAG_THRESHOLD||u<=-ft.DRAG_THRESHOLD||u>=ft.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),o=0,u=0),(o!=0||u!=0)&&(this._activeRoomDragX+=o,this._activeRoomDragY+=u,this._activeRoomWasDragged=!0));else if((i===F.MOUSE_CLICK||i===F.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(e,t,s){const i=this.getRoomObjectCategoryForType(s);switch(e){case L.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,i,t);return;default:this.setMouseDefault(this._activeRoomId,i,t);return}}setMouseButton(e,t,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(e);if(i&&(t!==A.FLOOR&&t!==A.WALL||i.controllerLevel>=Oe.GUEST)){const r=this.getRoomInstanceData(e);r&&r.addButtonMouseCursorOwner(t+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(e,t,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(e);i&&i.removeButtonMouseCursorOwner(t+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(e,t,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,e,t,s)}modifyRoomObjectDataWithMap(e,t,s,i){if(!this._roomObjectEventHandler)return!1;t===A.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,e,t,s,i)}modifyRoomObjectData(e,t,s,i){if(!this._roomObjectEventHandler)return!1;t===A.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,e,s,i)}processRoomObjectEvent(e){if(!this._roomObjectEventHandler)return;const t=this.getRoomObjectRoomId(e.object);if(!t)return;const s=this.getRoomIdFromString(t);this._roomObjectEventHandler.handleRoomObjectEvent(e,s)}processRoomObjectPlacement(e,t,s,i,r=null,n=null,a=-1,o=-1,u=null){const l=this.getRoomInstance(this._activeRoomId);return!l||l.model.getValue(mt.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(e,this._activeRoomId,t,s,i,r,n,a,o,u)}getRoomObjectScreenLocation(e,t,s,i=-1){i==-1&&(i=this._activeRoomActiveCanvas);const r=this.getRoomInstanceGeometry(e,i);if(!r)return null;const n=this.getRoomObject(e,t,s);if(!n)return null;const a=r.getScreenPoint(n.getLocation());if(!a)return null;const o=this.getRoomInstanceRenderingCanvas(e,i);return o?(a.x=a.x*o.scale,a.y=a.y*o.scale,a.x+=o.width/2+o.screenOffsetX,a.y+=o.height/2+o.screenOffsetY,a.x=Math.round(a.x),a.y=Math.round(a.y),a):null}selectRoomObject(e,t,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(e,t,s)}setSelectedAvatar(e,t){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(e,t,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(e,t,s,i=1){if(!e||!s)return;let r=this.getOverlayIconSprite(e,t);return r?null:(r=new Pt(s),r.name=t,r.scale.set(i),e.addChild(r),r)}onRoomContentLoaded(e,t,s){if(!this._roomContentLoader||e===-1)return;this._thumbnailObjectIdBank.freeNumber(e-1);const i=this._thumbnailCallbacks.get(t);if(i){this._thumbnailCallbacks.delete(t);const r=this._roomContentLoader.getImage(t);if(r)for(const n of i)n&&n.imageReady(e,null,r)}}setObjectMoverIconSprite(e,t,s,i=null,r=null,n=-1,a=-1,o=null){let u=null,l=0,c=null;const g=1;if(s)c=this.getRoomObjectImage(this._activeRoomId,e,t,new I,1,null);else if(this._roomContentLoader)if(t===A.FLOOR?(u=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),l=this._roomContentLoader.getFurnitureFloorColorIndex(e)):t===A.WALL&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(e,i),l=this._roomContentLoader.getFurnitureWallColorIndex(e)),t===A.UNIT)if(u=et.getTypeString(e),u==="pet"){u=this.getPetType(i);const T=new pa(i);c=this.getRoomObjectPetImage(T.typeId,T.paletteId,T.color,new I(180),64,null,!0,0,T.customParts,o)}else c=this.getGenericRoomObjectImage(u,i,new I(180),64,null,0,null,r,n,a,o);else c=this.getGenericRoomObjectImage(u,l.toString(),new I,1,null,0,i,r,n,a,o);if(!c||!c.data)return;const f=this.getActiveRoomInstanceRenderingCanvas();if(!f)return;const R=this.getRenderingCanvasOverlay(f);this.removeOverlayIconSprite(R,ft.OBJECT_ICON_SPRITE);const m=this.addOverlayIconSprite(R,ft.OBJECT_ICON_SPRITE,c.data,g);m&&(m.x=this._activeRoomActiveCanvasMouseX-c.data.width/2,m.y=this._activeRoomActiveCanvasMouseY-c.data.height/2)}getRoomObjectImage(e,t,s,i,r,n,a=0){if(!this._roomManager)return null;let o=-1,u=null,l=null,c="",g=null;const f=this.getRoomId(e),R=this._roomManager.getRoomInstance(f);if(R){const m=R.getRoomObject(t,s);if(m&&m.model)switch(o=m.id,u=m.type,s){case A.FLOOR:case A.WALL:{c=m.model.getValue(d.FURNITURE_COLOR).toString(),g=m.model.getValue(d.FURNITURE_EXTRAS);const T=m.model.getValue(d.FURNITURE_DATA_FORMAT);T!==me.FORMAT_KEY&&(l=$s.getData(T),l.initializeFromRoomObjectModel(m.model));break}case A.UNIT:c=m.model.getValue(d.FIGURE);break}}return this.getGenericRoomObjectImage(u,c,i,r,n,a,g,l,-1,-1,null,o)}getFurnitureFloorIconUrl(e){let t=null,s="";return this._roomContentLoader?(t=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),s=this._roomContentLoader.getFurnitureFloorColorIndex(e).toString(),this._roomContentLoader.getAssetIconUrl(t,s)):null}getFurnitureFloorIcon(e,t,s=null,i=null){return this.getFurnitureFloorImage(e,new I,1,t,0,s,-1,-1,i)}getFurnitureWallIconUrl(e,t=null){let s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(e,t),i=this._roomContentLoader.getFurnitureWallColorIndex(e).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(e,t,s=null){return this.getFurnitureWallImage(e,new I,1,t,0,s)}getFurnitureFloorImage(e,t,s,i,r=0,n=null,a=-1,o=-1,u=null){let l=null,c="";return this._roomContentLoader&&(l=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),c=this._roomContentLoader.getFurnitureFloorColorIndex(e).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(l,c,i,n,u):this.getGenericRoomObjectImage(l,c,t,s,i,r,n,u,a,o)}getFurnitureWallImage(e,t,s,i,r=0,n=null,a=-1,o=-1){let u=null,l="";return this._roomContentLoader&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(e),l=this._roomContentLoader.getFurnitureWallColorIndex(e).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(u,l,i,n,null):this.getGenericRoomObjectImage(u,l,t,s,i,r,n,null,a,o)}getRoomObjectPetImage(e,t,s,i,r,n,a=!1,o=0,u=null,l=null){let c=null,g=e+" "+t+" "+s.toString(16);if(a&&(g=g+" head"),u){g=g+(" "+u.length);for(const f of u)g=g+(" "+f.layerId+" "+f.partId+" "+f.paletteId)}return this._roomContentLoader&&(c=this._roomContentLoader.getPetNameForType(e)),this.getGenericRoomObjectImage(c,g,i,r,n,o,null,null,-1,-1,l)}getGenericRoomObjectImage(e,t,s,i,r,n=0,a=null,o=null,u=-1,l=-1,c=null,g=-1){if(!this._roomManager)return null;const f=new Zh;if(f.id=-1,!this._ready||!e)return f;let R=this._roomManager.getRoomInstance(ft.TEMPORARY_ROOM);if(!R&&(R=this._roomManager.createRoomInstance(ft.TEMPORARY_ROOM),!R))return f;let m=this._imageObjectIdBank.reserveNumber();const T=this.getRoomObjectCategoryForType(e);if(m<0)return f;m++;const O=R.createRoomObjectAndInitalize(m,e,T);if(!O||!O.model||!O.logic)return f;const C=O.model;switch(T){case A.FLOOR:case A.WALL:C.setValue(d.FURNITURE_COLOR,parseInt(t)),C.setValue(d.FURNITURE_EXTRAS,a);break;case A.UNIT:if(e===et.USER||e===et.BOT||e===et.RENTABLE_BOT||e===et.PET)C.setValue(d.FIGURE,t);else{const v=new pa(t);C.setValue(d.PET_PALETTE_INDEX,v.paletteId),C.setValue(d.PET_COLOR,v.color),v.headOnly&&C.setValue(d.PET_HEAD_ONLY,1),v.hasCustomParts&&(C.setValue(d.PET_CUSTOM_LAYER_IDS,v.customLayerIds),C.setValue(d.PET_CUSTOM_PARTS_IDS,v.customPartIds),C.setValue(d.PET_CUSTOM_PALETTE_IDS,v.customPaletteIds)),c&&C.setValue(d.FIGURE_POSTURE,c)}break}O.setDirection(s);const N=O.visualization;if(!N)return R.removeRoomObject(m,T),f;(u>-1||o)&&(o&&o.getLegacyString()!==""?O.logic.processUpdateMessage(new Et(parseInt(o.getLegacyString()),o)):O.logic.processUpdateMessage(new Et(u,o)));const S=new yi(i,new I(-135,30,0),new I(11,11,5));if(N.update(S,0,!0,!1),l>0){let v=0;for(;v<l;)N.update(S,0,!0,!1),v++}const D=N.getImage(n,g);if(f.data=D,f.id=m,!this.isRoomContentTypeLoaded(e)&&r){let v=this._imageCallbacks.get(m.toString());v||(v=[],this._imageCallbacks.set(m.toString(),v)),v.push(r),C.setValue(d.IMAGE_QUERY_SCALE,i)}else R.removeRoomObject(m,T),this._imageObjectIdBank.freeNumber(m-1),f.id=0;return S.dispose(),f}getGenericRoomObjectThumbnail(e,t,s,i=null,r=null){if(!this._roomManager)return null;const n=new Zh;if(n.id=-1,!this._ready||!e)return n;let a=this._roomManager.getRoomInstance(ft.TEMPORARY_ROOM);if(!a&&(a=this._roomManager.createRoomInstance(ft.TEMPORARY_ROOM),!a))return n;let o=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(e),o<0)return n;o++,n.id=o,n.data=null,n.image=null;const u=[e,t].join("_"),l=this._roomContentLoader.getImage(u);if(!l&&s){let c=this._thumbnailCallbacks.get(u);c||(c=[],this._thumbnailCallbacks.set(u,c),this._roomContentLoader.downloadImage(o,e,t,null)),c.push(s)}else l&&(n.image=l),this._thumbnailObjectIdBank.freeNumber(o-1),n.id=0;return n}initalizeTemporaryObjectsByType(e,t){const s=this._roomManager.getRoomInstance(ft.TEMPORARY_ROOM);if(!s||!this._roomContentLoader)return;const i=this._roomContentLoader.getCategoryForType(e),r=s.getManager(i);let n=null,a=0;if(r&&r.objects.length){for(const o of r.objects.getValues())if(o&&o.model&&o.type===e){const u=o.id,l=o.visualization;let c=null;if(l){const f=o.model.getValue(d.IMAGE_QUERY_SCALE);n&&a!==f&&(n.dispose(),n=null),n||(a=f,n=new yi(f,new I(-135,30,0),new I(11,11,5))),l.update(n,0,!0,!1),c=l.image}s.removeRoomObject(u,i),this._imageObjectIdBank.freeNumber(u-1);const g=this._imageCallbacks.get(u.toString());if(g){this._imageCallbacks.delete(u.toString());for(const f of g)f&&(c?f.imageReady(u,c):f.imageFailed(u))}}}n&&n.dispose()}setObjectMoverIconSpriteVisible(e){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const s=this.getRenderingCanvasOverlay(t),i=this.getOverlayIconSprite(s,ft.OBJECT_ICON_SPRITE);i&&(i.visible=e)}removeObjectMoverIconSprite(){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const t=this.getRenderingCanvasOverlay(e);this.removeOverlayIconSprite(t,ft.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(e){if(!e)return null;const t=e.master;return t&&t.getChildByName(ft.OVERLAY)||null}removeOverlayIconSprite(e,t){if(!e)return!1;let s=e.children.length-1;for(;s>=0;){const i=e.getChildAt(s);if(i&&i.name===t){if(e.removeChildAt(s),i.children.length){const r=i.getChildAt(0);r.parent.removeChild(r),r.destroy()}return!0}s--}return!1}getOverlayIconSprite(e,t){if(!e)return null;let s=e.children.length-1;for(;s>=0;){const i=e.getChildAt(s);if(i&&i.name===t)return i;s--}return null}getRoomObjects(e,t){if(this._ready){const s=this.getRoomId(e),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(t)}return[]}addObjectToTileMap(e,t){const s=this.getRoomInstanceData(e).tileObjectMap;s&&s.addRoomObject(t)}refreshTileObjectMap(e,t){const s=this.getRoomInstanceData(e).tileObjectMap;s&&s.populate(this.getRoomObjects(e,A.FLOOR))}getRenderRoomMessage(e,t,s=!1,i=!0,r=!1,n=-1){let a=null;if(n>-1?a=this.getRoomInstanceRenderingCanvas(this._activeRoomId,n):a=this.getActiveRoomInstanceRenderingCanvas(),!a)return null;r&&a.skipSpriteVisibilityChecking();let o=-1;!i&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(o=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const u=new Dn,l=u.getFurniData(e,a,this,o),c=u.getRoomRenderingModifiers(this),g=u.getRoomPlanes(e,a,this,t);return r&&a.resumeSpriteVisibilityChecking(),G.log(l,c,g),null}createTextureFromRoom(e,t=-1,s=null){let i=null;t>-1?i=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t):i=this.getActiveRoomInstanceRenderingCanvas();let r=null;return s?r=Ot.generateTexture(i.master,s):r=i.getDisplayAsTexture(),r}saveTextureAsScreenshot(e,t=!1){let s=null;t?s=new S_:s=new da,s.assignBitmap(e),this._communication.connection.send(s)}saveBase64AsScreenshot(e,t=!1){let s=null;t?s=new S_:s=new da,s.assignBase64(e),this._communication.connection.send(s)}objectsInitialized(e){const t=this.getRoomIdFromString(e);this.events.dispatchEvent(new ct(ct.OBJECTS_INITIALIZED,t))}getRoomId(e){return e.toString()}getRoomIdFromString(e){if(!e)return-1;const t=e.split("_");return t.length<=0?-1:parseInt(t[0])||0}getRoomObjectRoomId(e){return!e||!e.model?null:e.model.getValue(d.OBJECT_ROOM_ID)}getRoomObjectAdUrl(e){return this._roomContentLoader.getRoomObjectAdUrl(e)}getPetTypeId(e){let t=-1;if(e){const s=e.split(" ");s.length>1&&(t=parseInt(s[0]))}return t}getPetType(e){if(!e)return null;const t=e.split(" ");if(t.length>1){const s=parseInt(t[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(s):"pet"}return null}isRoomContentTypeLoaded(e){return this._roomContentLoader?this._roomContentLoader.getCollection(e)!==null:!1}getPetColorResult(e,t){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(e,t):null}getPetColorResultsForTag(e,t){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(e,t):null}deleteRoomObject(e,t){return!this._roomObjectEventHandler||t!==A.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,e)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(e){this._sessionDataManager=e}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(e){this._roomSessionManager=e}get roomManager(){return this._roomManager}set roomManager(e){this._roomManager=e}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const e=this._roomSessionManager.getSession(this._activeRoomId);return e&&e.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(e,t){return this._roomManager==null?0:this._roomManager.getRoomInstance(e.toString()).getRoomObjectsForCategory(t).length}};let Ce=ft;Ce.ROOM_OBJECT_ID=-1;Ce.ROOM_OBJECT_TYPE="room";Ce.CURSOR_OBJECT_ID=-2;Ce.CURSOR_OBJECT_TYPE="tile_cursor";Ce.ARROW_OBJECT_ID=-3;Ce.ARROW_OBJECT_TYPE="selection_arrow";Ce.OVERLAY="overlay";Ce.OBJECT_ICON_SPRITE="object_icon_sprite";Ce.DRAG_THRESHOLD=15;Ce.TEMPORARY_ROOM="temporary_room";const x=class{constructor(e,t=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=e,this._planeParser=new Lt,this._previewRoomId=Q_.makeRoomPreviewerId(t),this._addViewOffset=new Y(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(H.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(H.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(ct.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(H.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(H.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(ct.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const t=new Lt;t.initializeTileMap(7+2,7+2);let s=1;for(;s<1+7;){let i=1;for(;i<1+7;)t.setTileHeight(i,s,0),i++;s++}t.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,t.getMapData()),t.dispose()}}reset(e){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,x.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,x.PREVIEW_OBJECT_ID),e||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=A.MINIMUM}updatePreviewModel(e,t,s=!0){const i=new sh;i.flush(),i.parseModel(e,t,s);const r=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!r)return;this._planeParser.reset();const n=i.width,a=i.height;this._planeParser.initializeTileMap(n,a);const o=null;let u=-1,l=-1,c=0,g=0,f=0;for(;f<a;){let O=0;for(;O<n;){const C=i.getHeight(O,f);(f>0&&f<a-1||O>0&&O<n-1)&&C!=Lt.TILE_BLOCKED&&o==null&&(i.getHeight(O,f-1)==Lt.TILE_BLOCKED&&i.getHeight(O-1,f)==Lt.TILE_BLOCKED&&i.getHeight(O,f+1)==Lt.TILE_BLOCKED&&(u=O+.5,l=f,c=C,g=90),i.getHeight(O,f-1)==Lt.TILE_BLOCKED&&i.getHeight(O-1,f)==Lt.TILE_BLOCKED&&i.getHeight(O+1,f)==Lt.TILE_BLOCKED&&(u=O,l=f+.5,c=C,g=180)),this._planeParser.setTileHeight(O,f,C),O++}f++}this._planeParser.setTileHeight(Math.floor(u),Math.floor(l),c),this._planeParser.initializeFromTileData(i.wallHeight),this._planeParser.setTileHeight(Math.floor(u),Math.floor(l),c+this._planeParser.wallHeight),r.scale=Nr.DEFAULT_SCALE,r.initialize(n,a,this._planeParser.floorHeight);let R=i.height-1;for(;R>=0;){let O=i.width-1;for(;O>=0;)r.setHeight(O,R,this._planeParser.getTileHeight(O,R)),O--;R--}const m=this._planeParser.getMapData();m.doors.push({x:u,y:l,z:c,dir:g});const T=this.getRoomPreviewOwnRoomObject();T&&T.processUpdateMessage(new Oh(m))}addFurnitureIntoRoom(e,t,s=null,i=null){if(s||(s=new me),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=A.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID,e,new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),t,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=Z(),this._automaticStateChange=!0;const r=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return r&&i&&r.model.setValue(d.FURNITURE_EXTRAS,i),this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(e,t,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===A.WALL&&this._currentPreviewObjectType===e&&this._currentPreviewObjectData===s)return x.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=A.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,x.PREVIEW_OBJECT_ID,e,new I(.5,2.3,1.8),t,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=Z(),this._automaticStateChange=!0,this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(e,t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=A.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,x.PREVIEW_OBJECT_ID,new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),new I(90,0,0),135,et.getTypeNumber(et.USER),e)&&(this._previousAutomaticStateChangeTime=Z(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(t),this.updateUserPosture("std")),this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=A.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,x.PREVIEW_OBJECT_ID,new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),new I(90,0,0),90,et.getTypeNumber(et.PET),e)&&(this._previousAutomaticStateChangeTime=Z(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID):-1}updateUserPosture(e,t=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,x.PREVIEW_OBJECT_ID,e,t)}updateUserGesture(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,x.PREVIEW_OBJECT_ID,e)}updateUserEffect(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,x.PREVIEW_OBJECT_ID,e)}updateObjectUserFigure(e,t=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,x.PREVIEW_OBJECT_ID,e,t,s,i):!1}updateObjectUserAction(e,t,s=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,x.PREVIEW_OBJECT_ID,e,t,s)}updateObjectStuffData(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID,null,null,e.state,e)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==A.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!e)return;const t=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(e,!0);switch(this._currentPreviewObjectCategory){case A.FLOOR:{const s=new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y),i=new I(t,t,t);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID,s,i,null,null);return}case A.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const e=Z();e>this._previousAutomaticStateChangeTime+x.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=e,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(e,t){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,x.PREVIEW_CANVAS_ID,e,t,this._currentPreviewScale);if(s&&this._backgroundColor!==null){let r=this._backgroundSprite;r||(r=new Pt(Dt.WHITE),s.addChildAt(r,0)),r.width=e,r.height=t,r.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,x.PREVIEW_CANVAS_ID,!0);const i=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID);return i&&i.adjustLocation(new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=t,s}return null}modifyRoomCanvas(e,t){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=t,this._backgroundSprite&&(this._backgroundSprite.width=e,this._backgroundSprite.height=t),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,x.PREVIEW_CANVAS_ID,e,t))}set addViewOffset(e){this._addViewOffset=e}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(e){const t=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,x.PREVIEW_CANVAS_ID);if(t&&e)if(t.x+=-(this._currentPreviewCanvasWidth>>1),t.y+=-(this._currentPreviewCanvasHeight>>1),t.x+=-e.x,t.y+=-e.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=t;else{const s=this._currentPreviewRectangle.clone().enlarge(t);(s.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||s.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=s)}}validatePreviewSize(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;if(this.isRoomEngineReady){const t=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+x.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+x.ALLOWED_IMAGE_CUT)?x.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=x.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,e.x=e.x>>1,e.y=e.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):t.isZoomedIn()&&(t.performZoomOut(),this._currentPreviewScale=x.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(x.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=x.SCALE_NORMAL):t.isZoomedIn()||(t.performZoomIn(),this._currentPreviewScale=x.SCALE_NORMAL))}return e}zoomIn(){this.isRoomEngineReady&&(x.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=x.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(x.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=x.SCALE_SMALL}updateAvatarDirection(e,t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,x.PREVIEW_OBJECT_ID,new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),new I(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new I(e*45,0,0),t*45)}updateObjectRoom(e=null,t=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,e,t,s,i):!1}updateRoomWallsAndFloorVisibility(e,t=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,e,t)}getCanvasOffset(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;let t=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s=s+Math.min(15,i-10):this._currentPreviewObjectCategory!==A.UNIT?s=s+(5-Math.max(0,i/2)):s=s-(5-Math.min(0,i/2)),s=s+this._addViewOffset.y,t=t+this._addViewOffset.x;const r=t-e.x,n=s-e.y;if(r!==0||n!==0){const a=Math.sqrt(r*r+n*n);return a>10&&(t=e.x+r*10/a,s=e.y+n*10/a),new Y(t,s)}return null}updatePreviewRoomView(e=!1){if(!(this._disableUpdate&&!e)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let t=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,x.PREVIEW_CANVAS_ID);if(t&&(this.updatePreviewObjectBoundingRectangle(t),this._currentPreviewRectangle)){const s=this._currentPreviewScale;t=this.validatePreviewSize(t);const i=this.getCanvasOffset(t);i&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,x.PREVIEW_CANVAS_ID,i),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}set disableUpdate(e){this._disableUpdate=e}set disableRoomEngineUpdate(e){this.isRoomEngineReady&&this._roomEngine.disableUpdate(e)}onRoomInitializedonRoomInitialized(e){if(e)switch(e.type){case ct.INITIALIZED:e.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(e){if(e.roomId===this._previewRoomId&&e.objectId===x.PREVIEW_OBJECT_ID&&e.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const t=this._roomEngine.getRoomObject(e.roomId,e.objectId,e.category);if(t&&t.model&&e.category===A.WALL){const s=t.model.getValue(d.FURNITURE_SIZE_Z),i=t.model.getValue(d.FURNITURE_CENTER_Z);(s!==null||i!==null)&&this._roomEngine.updateRoomObjectWallLocation(e.roomId,e.objectId,new I(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const e=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,x.PREVIEW_CANVAS_ID);return e||null}getGenericRoomObjectImage(e,t,s,i,r,n=0,a=null,o=null,u=-1,l=-1,c=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(e,t,s,i,r,n,a,o,u,l,c):null}getRoomObjectImage(e,t,s,i=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,e,t,s,i):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e&&e.visualization)return e.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e)return e}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,Ce.ROOM_OBJECT_ID,A.ROOM);if(e)return e}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};let _s=x;_s.SCALE_NORMAL=64;_s.SCALE_SMALL=32;_s.PREVIEW_COUNTER=0;_s.PREVIEW_CANVAS_ID=1;_s.PREVIEW_OBJECT_ID=1;_s.PREVIEW_OBJECT_LOCATION_X=2;_s.PREVIEW_OBJECT_LOCATION_Y=2;_s.ALLOWED_IMAGE_CUT=.25;_s.AUTOMATIC_STATE_CHANGE_INTERVAL=2500;_s.ZOOM_ENABLED=!0;class ru{constructor(t,s){this._image=t,this._placeHolder=s}get image(){return this._image}get placeHolder(){return this._placeHolder}}class bB{constructor(t){this._code=t,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}const de=class{constructor(e,t=0,s=0,i=0){this.type=e,this.key=t,this.color=s,this.position=i}get code(){return this.key===0?null:de.getCode(this.type,this.key,this.color,this.position)}static getCode(e,t,s,i){return(e===de.BASE?e:t>=100?de.SYMBOL_ALT:de.SYMBOL)+(t<10?"0":"")+(e===de.BASE?t:t>=100?t-100:t)+(s<10?"0":"")+s+i}calculatePosition(e){const t=this.calculateGridPos(this.position);let s=de.CELL_WIDTH*t.x+de.CELL_WIDTH/2-e.width/2,i=de.CELL_HEIGHT*t.y+de.CELL_HEIGHT/2-e.height/2;return s<0&&(s=0),s+e.width>de.IMAGE_WIDTH&&(s=de.IMAGE_WIDTH-e.width),i<0&&(i=0),i+e.height>de.IMAGE_HEIGHT&&(i=de.IMAGE_HEIGHT-e.height),new $n(Math.floor(s),Math.floor(i))}calculateGridPos(e){const t=new $n;return t.x=Math.floor(e%3),t.y=Math.floor(e/3),t}};let Ue=de;Ue.BASE="b";Ue.SYMBOL="s";Ue.SYMBOL_ALT="t";Ue.BASE_PART=0;Ue.LAYER_PART=1;Ue.IMAGE_WIDTH=39;Ue.IMAGE_HEIGHT=39;Ue.CELL_WIDTH=13;Ue.CELL_HEIGHT=13;const Is=class{constructor(e,t){this._assets=e,this._sessionDataManager=t,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new sc(this.onGroupBadgePartsEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._sessionDataManager=null}getBadgeImage(e,t=Is.NORMAL_BADGE,s=!0){let i=this.getBadgeTexture(e,t);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(e){const t=this.getBadgeTexture(e);return t?new ru(t,!1):new ru(this.getBadgePlaceholder(),!0)}loadBadgeImage(e,t=Is.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(e,t))?e:(this.getBadgeTexture(e,t),null)}getBadgeTexture(e,t=Is.NORMAL_BADGE){const s=this.getBadgeUrl(e,t);if(!s||!s.length)return null;const i=this._assets.getTexture(s);if(i)return i.clone();if(t===Is.NORMAL_BADGE){if(this._requestedBadges.get(e))return null;this._requestedBadges.set(e,!0),this._assets.downloadAsset(s).then(r=>{if(!r)return;this._requestedBadges.delete(e);const n=this._assets.getTexture(s);n&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new Jr(e,n.clone()))}).catch(r=>{})}else if(t===Is.GROUP_BADGE){if(this._groupBadgesQueue.get(e))return;this._groupBadgesQueue.set(e,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(e)}return null}getBadgePlaceholder(){const e=W.getValue("images.url")+"/loading_icon.png",t=this._assets.getTexture(e);return t?t.clone():null}getBadgeUrl(e,t=Is.NORMAL_BADGE){let s=null;switch(t){case Is.NORMAL_BADGE:s=W.getValue("badge.asset.url").replace("%badgename%",e);break;case Is.GROUP_BADGE:s=e;break}return s}loadGroupBadge(e){const t=new bB(e),s=[...e.matchAll(/[b|s][0-9]{4,6}/g)];for(const i of s){const r=i[0],n=r.length===6,a=r[0],o=parseInt(r.slice(1,n?3:4)),u=parseInt(r.slice(n?3:4,n?5:6)),l=r.length<6?0:parseInt(r.slice(n?5:6,n?6:7)),c=new Ue(a,o,u,l);t.parts.push(c)}this.renderGroupBadge(t)}renderGroupBadge(e){const t=new je,s=new Pt(lu.EMPTY);s.width=Ue.IMAGE_WIDTH,s.height=Ue.IMAGE_HEIGHT,t.addChild(s);for(const r of e.parts){let n=!0;const a=r.type==="b"?this._groupBases.get(r.key):this._groupSymbols.get(r.key);if(a)for(const o of a){if(!o||!o.length)continue;const u=this._assets.getTexture(`badgepart_${o}`);if(!u)continue;const{x:l,y:c}=r.calculatePosition(u),g=new Pt(u);g.position.set(l,c),n&&(g.tint=parseInt(this._groupPartColors.get(r.color),16)),n=!1,t.addChild(g)}}this._requestedBadges.delete(e.code),this._groupBadgesQueue.delete(e.code);const i=Ot.generateTexture(t);this._assets.setTexture(e.code,i),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new Jr(e.code,i))}onGroupBadgePartsEvent(e){if(!e)return;const t=e.getParser();if(t){t.bases.forEach((s,i)=>this._groupBases.set(i,s.map(r=>r.replace(".png","").replace(".gif","")))),t.symbols.forEach((s,i)=>this._groupSymbols.set(i,s.map(r=>r.replace(".png","").replace(".gif","")))),this._groupPartColors=t.partColors,this._readyToGenerateGroupBadges=!0;for(const s of this._groupBadgesQueue.keys())this.loadGroupBadge(s)}}get disposed(){return!!this._sessionDataManager}};let nr=Is;nr.GROUP_BADGE="group_badge";nr.NORMAL_BADGE="normal_badge";class nu{constructor(t,s,i,r,n,a,o,u,l,c,g,f,R,m,T,O,C,N,S,D,v,b,w,Q,$,X,Ct,Ht,re){this._type=t,this._id=s,this._fullName=i,this._className=r,this._category=n,this._revision=u,this._tileSizeX=l,this._tileSizeY=c,this._tileSizeZ=g,this._colors=f,this._hasIndexedColor=R,this._colourIndex=m,this._localizedName=a,this._description=o,this._adUrl=T,this._purchaseOfferId=O,this._purchaseCouldBeUsedForBuyout=C,this._rentOfferId=N,this._rentCouldBeUsedForBuyout=S,this._customParams=v,this._specialType=b,this._availableForBuildersClub=D,this._canStandOn=w,this._canSitOn=Q,this._canLayOn=$,this._excludedFromDynamic=X,this._furniLine=Ct,this._environment=Ht,this._rare=re}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(t){this._className=t}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}const G_=class extends Me{constructor(e,t,s){super(),this._floorItems=e,this._wallItems=t,this._localization=s}loadFurnitureData(e){e&&fetch(e).then(t=>t.json()).then(t=>this.onFurnitureDataLoaded(t)).catch(t=>this.onFurnitureDataError(t))}onFurnitureDataLoaded(e){e&&((typeof e.roomitemtypes>"u"||typeof e.wallitemtypes>"u")&&G.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),e.roomitemtypes&&this.parseFloorItems(e.roomitemtypes),e.wallitemtypes&&this.parseWallItems(e.wallitemtypes),this.dispatchEvent(new nt(G_.FURNITURE_DATA_READY)))}onFurnitureDataError(e){e&&(G.error(e),this.dispatchEvent(new nt(G_.FURNITURE_DATA_ERROR)))}parseFloorItems(e){if(!(!e||!e.furnitype))for(const t of e.furnitype){if(!t)continue;const s=[];if(t.partcolors)for(const u of t.partcolors.color){let l=u;l.charAt(0)==="#"&&(l=l.replace("#","")),s.push(parseInt(l,16))}const i=t.classname.split("*"),r=i[0],n=i.length>1?parseInt(i[1]):0,a=i.length>1,o=new nu(Si.FLOOR,t.id,t.classname,r,t.category,t.name,t.description,t.revision,t.xdim,t.ydim,0,s,a,n,t.adurl,t.offerid,t.buyout,t.rentofferid,t.rentbuyout,t.bc,t.customparams,t.specialtype,t.canstandon,t.cansiton,t.canlayon,t.excludeddynamic,t.furniline,t.environment,t.rare);this._floorItems.set(o.id,o),this.updateLocalizations(o)}}parseWallItems(e){if(!(!e||!e.furnitype))for(const t of e.furnitype){if(!t)continue;const s=new nu(Si.WALL,t.id,t.classname,t.classname,t.category,t.name,t.description,t.revision,0,0,0,null,!1,0,t.adurl,t.offerid,t.buyout,t.rentofferid,t.rentbuyout,t.bc,null,t.specialtype,!1,!1,!1,t.excludeddynamic,t.furniline,t.environment,t.rare);this._wallItems.set(s.id,s),this.updateLocalizations(s)}}updateLocalizations(e){if(this._localization)switch(e.type){case Si.FLOOR:this._localization.setValue("roomItem.name."+e.id,e.name),this._localization.setValue("roomItem.desc."+e.id,e.description);return;case Si.WALL:this._localization.setValue("wallItem.name."+e.id,e.name),this._localization.setValue("wallItem.desc."+e.id,e.description);return}}};let kr=G_;kr.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY";kr.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";class FB{constructor(t){this._sessionDataManager=t,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new lr(this.onRoomReadyMessageEvent.bind(this)),new Wc(this.onGroupBadgesEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(t){this._sessionDataManager.send(new Og)}onGroupBadgesEvent(t){const s=t.getParser();for(const[i,r]of s.badges.entries())this._groupBadges.set(i,r)}getGroupBadge(t){return this._groupBadges.get(t)}get disposed(){return!!this._sessionDataManager}}class vh{}vh.NO_CLUB=0;vh.CLUB=1;vh.VIP=2;class Je extends Ie{constructor(t,s){super(),this._connection=t,this._listener=s,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class xB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new jo(this.onRoomGenericError.bind(this)))}onRoomGenericError(t){if(!(t instanceof jo))return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;let r=null;switch(s.errorCode){case K_.KICKED_OUT_OF_ROOM:r=At.RSEME_KICKED;break;default:return}!r||r.length==0||this.listener.events.dispatchEvent(new At(r,i))}}class GB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new dc(this.onOpenPetPackageRequested.bind(this))),t.addMessageEvent(new gc(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new ir(ir.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,i,s.objectId,s.figureData,0,null))}onOpenPetPackageResult(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new ir(ir.RSOPPE_OPEN_PET_PACKAGE_RESULT,i,s.objectId,null,s.nameValidationStatus,s.nameValidationInfo))}}class BB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new mc(this.onPollContentsEvent.bind(this))),t.addMessageEvent(new Rc(this.onPollOfferEvent.bind(this))),t.addMessageEvent(new Ic(this.onPollErrorEvent.bind(this)))}onPollContentsEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=new Ts(Ts.CONTENT,s,i.id);r.startMessage=i.startMessage,r.endMessage=i.endMessage,r.numQuestions=i.numQuestions,r.questionArray=i.questionArray,r.npsPoll=i.npsPoll,this.listener.events.dispatchEvent(r)}onPollOfferEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=new Ts(Ts.OFFER,s,i.id);r.summary=i.headline,r.summary=i.summary,this.listener.events.dispatchEvent(r)}onPollErrorEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s||!t.getParser())return;const r=new Ts(Ts.ERROR,s,-1);r.headline="???",r.summary="???",this.listener.events.dispatchEvent(r)}}class wB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new ch(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new aa(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new oa(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new vc(this.onRoomUnitHandItemReceivedEvent.bind(this))),t.addMessageEvent(new Qc(this.onRespectReceivedEvent.bind(this))),t.addMessageEvent(new Xc(this.onPetRespectNoficationEvent.bind(this))),t.addMessageEvent(new qc(this.onPetSupplementedNotificationEvent.bind(this))),t.addMessageEvent(new Lc(this.onFloodControlEvent.bind(this))),t.addMessageEvent(new Uc(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;let r=it.CHAT_TYPE_SPEAK;t instanceof aa?r=it.CHAT_TYPE_SHOUT:t instanceof oa&&(r=it.CHAT_TYPE_WHISPER);const n=new it(it.CHAT_EVENT,s,i.roomIndex,i.message,r,i.bubble);this.listener.events.dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();i&&this.listener.events.dispatchEvent(new it(it.CHAT_EVENT,s,i.giverUserId,"",it.CHAT_TYPE_HAND_ITEM_RECEIVED,Xs.GENERIC,null,i.handItemType))}onRespectReceivedEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=s.userDataManager.getUserData(i.userId);r&&this.listener.events.dispatchEvent(new it(it.CHAT_EVENT,s,r.roomIndex,"",it.CHAT_TYPE_RESPECT,Xs.GENERIC))}onPetRespectNoficationEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=s.userDataManager.getPetData(i.petData.id);if(!r)return;let n=it.CHAT_TYPE_PETRESPECT;i.isTreat&&(n=it.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new it(it.CHAT_EVENT,s,r.roomIndex,"",n,Xs.GENERIC))}onPetSupplementedNotificationEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=s.userDataManager.getPetData(i.petId);if(!r)return;let n=-1;const a=s.userDataManager.getUserData(i.userId);a&&(n=a.roomIndex);let o=it.CHAT_TYPE_PETREVIVE;switch(i.supplementType){case si.REVIVE:o=it.CHAT_TYPE_PETREVIVE;break;case si.REBREED_FERTILIZER:o=it.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case si.SPEED_FERTILIZER:o=it.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new it(it.CHAT_EVENT,s,r.roomIndex,"",o,Xs.GENERIC,null,n))}onFloodControlEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=i.seconds;this.listener.events.dispatchEvent(new it(it.FLOOD_EVENT,s,-1,r.toString(),0,0))}onRemainingMuteEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();i&&this.listener.events.dispatchEvent(new it(it.CHAT_EVENT,s,s.ownRoomIndex,"",it.CHAT_TYPE_MUTE_REMAINING,Xs.GENERIC,null,i.seconds))}}class HB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new zo(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(t){if(!(t instanceof zo))return;const s=t.getParser();if(!s||s.roomForward)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=s.data;i.tradeMode=r.tradeMode,i.isGuildRoom=r.habboGroupId!==0,i.doorMode=r.doorMode,i.allowPets=r.allowPets,i.moderationSettings=s.moderation,this.listener.events.dispatchEvent(new No(No.RSDUE_ALLOW_PETS,i)),this.listener.events.dispatchEvent(new k(k.ROOM_DATA,i))}}class VB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new Sc(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(t){if(!t)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=new Mo(Mo.ROOM_DIMMER_PRESETS,i);r.selectedPresetId=s.selectedPresetId;let n=0;for(;n<s.presetCount;){const a=s.getPreset(n);a&&r.storePreset(a.id,a.type,a.color,a.brightness),n++}this.listener&&this.listener.events.dispatchEvent(r)}}class jB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new Ko(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new ko(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new Xo(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof Ko))return;const s=this.listener.getSession(this.roomId);s&&s.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof ko))return;const s=this.listener.getSession(this.roomId);s&&s.setControllerLevel(Oe.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof Xo))return;const s=this.listener.getSession(this.roomId);s&&s.setRoomOwner()}}class YB extends Je{constructor(t,s){super(t,s),t&&t.addMessageEvent(new _c(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(t){if(!t)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new Co(Co.RSPE_PRESENT_OPENED,i,s.classId,s.itemType,s.productCode,s.placedItemId,s.placedItemType,s.placedInRoom,s.petFigureString))}}const Yr=class extends Je{constructor(e,t){super(e,t),e.addMessageEvent(new qo(this.onRoomEnterEvent.bind(this))),e.addMessageEvent(new lr(this.onRoomReadyMessageEvent.bind(this))),e.addMessageEvent(new Vo(this.onDesktopViewEvent.bind(this))),e.addMessageEvent(new Wo(this.onRoomDoorbellAcceptedEvent.bind(this))),e.addMessageEvent(new Yo(this.onRoomDoorbellRejectedEvent.bind(this))),e.addMessageEvent(new yc(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(e){e instanceof qo&&this.listener&&this.listener.sessionUpdate(this.roomId,Yr.RS_CONNECTED)}onRoomReadyMessageEvent(e){if(!(e instanceof lr))return;const t=this.roomId,s=e.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(t,s),this.listener.sessionUpdate(this.roomId,Yr.RS_READY))}onDesktopViewEvent(e){e instanceof Vo&&this.listener&&this.listener.sessionUpdate(this.roomId,Yr.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(e){if(!(e instanceof Wo)||!this.listener)return;const t=e.getParser();if(!t)return;const s=t.userName;if(!s||!s.length)this.connection.send(new tg(this.roomId));else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new Cs(Cs.RSDE_ACCEPTED,i,s))}}onRoomDoorbellRejectedEvent(e){if(!(e instanceof Yo)||!this.listener)return;const t=e.getParser();if(!t)return;const s=t.userName;if(!s||!s.length)this.listener.sessionUpdate(this.roomId,Yr.RS_DISCONNECTED);else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new Cs(Cs.RSDE_REJECTED,i,s))}}onYouAreSpectatorMessageEvent(e){if(this.listener){const t=this.listener.getSession(this.roomId);if(!t)return;t.isSpectator=!0,this.listener.events.dispatchEvent(new Do(Do.SPECTATOR_MODE,t))}}};let Di=Yr;Di.RS_CONNECTED="RS_CONNECTED";Di.RS_READY="RS_READY";Di.RS_DISCONNECTED="RS_DISCONNECTED";class zB{constructor(){this._adultLevel=7}get id(){return this._id}set id(t){this._id=t}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get unknownRarity(){return this._unknownRarity}set unknownRarity(t){this._unknownRarity=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get skillTresholds(){return this._skillThresholds}set skillTresholds(t){this._skillThresholds=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}get adultLevel(){return this._adultLevel}}class WB{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get groupId(){return this._groupID}set groupId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isModerator=t}}class kB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new ha(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new ua(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new la(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new _a(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new jc(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new uc(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new gh(this.onUserNameChangeMessageEvent.bind(this))),t.addMessageEvent(new tc(this.onNewFriendRequestEvent.bind(this))),t.addMessageEvent(new Nc(this.onPetInfoEvent.bind(this))),t.addMessageEvent(new Dc(this.onPetStatusUpdateEvent.bind(this))),t.addMessageEvent(new wy(this.onPetBreedingMessageEvent.bind(this))),t.addMessageEvent(new Ec(this.onPetLevelUpdateMessageEvent.bind(this))),t.addMessageEvent(new iP(this.onConfirmBreedingResultEvent.bind(this))),t.addMessageEvent(new rP(this.onNestBreedingSuccessEvent.bind(this))),t.addMessageEvent(new sP(this.onConfirmBreedingRequestEvent.bind(this))),t.addMessageEvent(new na(this.onPetFigureUpdateEvent.bind(this))),t.addMessageEvent(new Mc(this.onPetBreedingResultEvent.bind(this))),t.addMessageEvent(new cc(this.onPetPlacingError.bind(this))),t.addMessageEvent(new lc(this.onBotError.bind(this))),t.addMessageEvent(new Ac(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser().users,r=[];if(i&&i.length)for(const n of i){if(!n)continue;const a=new WB(n.roomIndex);a.name=n.name,a.custom=n.custom,a.activityPoints=n.activityPoints,a.figure=n.figure,a.type=n.userType,a.webID=n.webID,a.groupId=n.groupID,a.groupName=n.groupName,a.groupStatus=n.groupStatus,a.sex=n.sex,a.ownerId=n.ownerId,a.ownerName=n.ownerName,a.rarityLevel=n.rarityLevel,a.hasSaddle=n.hasSaddle,a.isRiding=n.isRiding,a.canBreed=n.canBreed,a.canHarvest=n.canHarvest,a.canRevive=n.canRevive,a.hasBreedingPermission=n.hasBreedingPermission,a.petLevel=n.petLevel,a.botSkills=n.botSkills,a.isModerator=n.isModerator,s.userDataManager.getUserData(n.roomIndex)||r.push(a),s.userDataManager.updateUserData(a)}this.listener.events.dispatchEvent(new cl(s,r))}onRoomUnitInfoEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();i&&(s.userDataManager.updateFigure(i.unitId,i.figure,i.gender,!1,!1),s.userDataManager.updateMotto(i.unitId,i.motto),s.userDataManager.updateAchievementScore(i.unitId,i.achievementScore),this.listener.events.dispatchEvent(new gl(s,i.unitId,i.figure,i.gender,i.motto,i.achievementScore)))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new ju(i,s.unitId,s.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&(i.userDataManager.setUserBadges(s.userId,s.badges),this.listener.events.dispatchEvent(new ul(i,s.userId,s.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=s.userName;if(!i||!i.length)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new Cs(Cs.DOORBELL,r,i))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&i.userDataManager.updateName(s.id,s.newName)}onNewFriendRequestEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=s.request;this.listener.events.dispatchEvent(new ku(i,r.requestId,r.requesterUserId,r.requesterName))}onPetInfoEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=new zB;r.id=s.id,r.level=s.level,r.maximumLevel=s.maximumLevel,r.experience=s.experience,r.levelExperienceGoal=s.levelExperienceGoal,r.energy=s.energy,r.maximumEnergy=s.maximumEnergy,r.happyness=s.happyness,r.maximumHappyness=s.maximumHappyness,r.ownerId=s.ownerId,r.ownerName=s.ownerName,r.respect=s.respect,r.age=s.age,r.unknownRarity=s.unknownRarity,r.saddle=s.saddle,r.rider=s.rider,r.breedable=s.breedable,r.fullyGrown=s.fullyGrown,r.rarityLevel=s.rarityLevel,r.dead=s.dead,r.skillTresholds=s.skillTresholds,r.publiclyRideable=s.publiclyRideable,r.maximumTimeToLive=s.maximumTimeToLive,r.remainingTimeToLive=s.remainingTimeToLive,r.remainingGrowTime=s.remainingGrowTime,r.publiclyBreedable=s.publiclyBreedable,this.listener.events.dispatchEvent(new il(i,r))}onPetStatusUpdateEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&(i.userDataManager.updatePetBreedingStatus(s.roomIndex,s.canBreed,s.canHarvest,s.canRevive,s.hasBreedingPermission),this.listener.events.dispatchEvent(new ol(i,s.petId,s.canBreed,s.canHarvest,s.canRevive,s.hasBreedingPermission)))}onPetBreedingMessageEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Qu(i,s.state,s.ownPetId,s.otherPetId))}onPetLevelUpdateMessageEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&(i.userDataManager.updatePetLevel(s.roomIndex,s.level),this.listener.events.dispatchEvent(new nl(i,s.petId,s.level)))}onConfirmBreedingResultEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Hu(i,s.breedingNestStuffId,s.result))}onNestBreedingSuccessEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Xu(i,s.petId,s.rarityCategory))}onConfirmBreedingRequestEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Bu(i,s.nestId,s.pet1,s.pet2,s.rarityCategories,s.resultPetType))}onPetFigureUpdateEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;const r=s.figureData.figuredata;i.userDataManager.updateFigure(s.roomIndex,r,"",s.hasSaddle,s.isRiding),this.listener.events.dispatchEvent(new el(i,s.petId,r))}onPetBreedingResultEvent(t){if(!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Zu(i,s.resultData,s.otherResultData))}onPetPlacingError(t){if(!t||!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;let r=null;switch(s.errorCode){case 0:r=At.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:r=At.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:r=At.RSEME_MAX_PETS;break;case 3:r=At.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:r=At.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:r=At.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!r||r.length==0||this.listener.events.dispatchEvent(new At(r,i))}onBotError(t){if(!t||!this.listener)return;const s=t.getParser();if(!s)return;const i=this.listener.getSession(this.roomId);if(!i)return;let r=null;switch(s.errorCode){case 0:r=At.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:r=At.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:r=At.RSEME_BOT_LIMIT_REACHED;break;case 3:r=At.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:r=At.RSEME_BOT_NAME_NOT_ACCEPTED;break}!r||r.length==0||this.listener.events.dispatchEvent(new At(r,i))}onFavoriteMembershipUpdateMessageEvent(t){if(!this.listener)return;const s=t.getParser(),i=this.listener.getSession(this.roomId);if(!i)return;const r=i.userDataManager.getUserDataByIndex(s.roomIndex);r&&(r.groupId=s.groupId,r.groupName=s.groupName,this.listener.events.dispatchEvent(new zu(i,s.roomIndex,s.groupId,s.status,s.groupName)))}}class KB extends Je{constructor(t,s){super(t,s),t.addMessageEvent(new pc(this.onQuestionEvent.bind(this))),t.addMessageEvent(new Tc(this.onQuestionAnsweredEvent.bind(this))),t.addMessageEvent(new Oc(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=new ps(ps.QUESTION,s,i.pollId);r.question=i.question,r.duration=i.duration,r.pollType=i.pollType,r.questionId=i.questionId,r.pollId=i.pollId,this.listener.events.dispatchEvent(r)}onQuestionAnsweredEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=new ps(ps.ANSWERED,s,i.userId);r.value=i.value,r.userId=i.userId,r.answerCounts=i.answerCounts,this.listener.events.dispatchEvent(r)}onQuestionFinishedEvent(t){if(!this.listener)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.getParser();if(!i)return;const r=new ps(ps.FINISHED,s);r.questionId=i.questionId,r.answerCounts=i.answerCounts,this.listener.events.dispatchEvent(r)}}class XB{constructor(t){this._sessionDataManager=t,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new kc(this.onIgnoredUsersEvent.bind(this)),new Eh(this.onIgnoreResultEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new Eg(this._sessionDataManager.userName))}onIgnoredUsersEvent(t){if(!t)return;const s=t.getParser();s&&(this._ignoredUsers=s.ignoredUsers)}onIgnoreResultEvent(t){if(!t)return;const s=t.getParser();if(!s)return;const i=s.name;switch(s.result){case 0:return;case 1:this.addUserToIgnoreList(i);return;case 2:this.addUserToIgnoreList(i),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(i);return}}addUserToIgnoreList(t){this._ignoredUsers.indexOf(t)<0&&this._ignoredUsers.push(t)}removeUserFromIgnoreList(t){const s=this._ignoredUsers.indexOf(t);s>=0&&this._ignoredUsers.splice(s,1)}ignoreUserId(t){this._sessionDataManager.send(new Ig(t))}ignoreUser(t){this._sessionDataManager.send(new mg(t))}unignoreUser(t){this._sessionDataManager.send(new Rg(t))}isIgnored(t){return this._ignoredUsers.indexOf(t)>=0}get disposed(){return!!this._sessionDataManager}}class qB{constructor(t,s,i){this._type=t,this._name=s,this._description=i}get type(){return this._type}get name(){return this._name}get description(){return this._description}}const B_=class extends Me{constructor(e){super(),this._products=e}dispose(){this._products=null}loadProductData(e){e&&fetch(e).then(t=>t.json()).then(t=>this.onProductDataLoadedEvent(t)).catch(t=>this.onProductDataError(t))}onProductDataLoadedEvent(e){e&&(this.parseProducts(e.productdata),this.dispatchEvent(new nt(B_.PDP_PRODUCT_DATA_READY)))}onProductDataError(e){e&&this.dispatchEvent(new nt(B_.PDP_PRODUCT_DATA_FAILED))}parseProducts(e){if(e)for(const t of e.product)t&&this._products.set(t.code,new qB(t.code,t.name,t.description))}};let Kr=B_;Kr.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY";Kr.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";const zr=class extends Ie{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(e){this._connection=e}getUserData(e){return this.getDataByType(e,zr.TYPE_USER)}getPetData(e){return this.getDataByType(e,zr.TYPE_PET)}getBotData(e){return this.getDataByType(e,zr.TYPE_BOT)}getRentableBotData(e){return this.getDataByType(e,zr.TYPE_RENTABLE_BOT)}getDataByType(e,t){const s=this._userDataByType.get(t);if(!s)return null;const i=s.get(e);return i||null}getUserDataByIndex(e){const t=this._userDataByRoomIndex.get(e);return t||null}getUserDataByName(e){for(const t of this._userDataByRoomIndex.values())if(!(!t||t.name!==e))return t;return null}updateUserData(e){if(!e)return;this.removeUserData(e.roomIndex);let t=this._userDataByType.get(e.type);t||(t=new Map,this._userDataByType.set(e.type,t)),t.set(e.webID,e),this._userDataByRoomIndex.set(e.roomIndex,e)}removeUserData(e){const t=this.getUserDataByIndex(e);if(!t)return;this._userDataByRoomIndex.delete(e);const s=this._userDataByType.get(t.type);s&&s.delete(t.webID)}getUserBadges(e){this._connection&&this._connection.send(new Tg(e));const t=this._userBadges.get(e);return t||[]}setUserBadges(e,t){this._userBadges.set(e,t)}updateFigure(e,t,s,i,r){const n=this.getUserDataByIndex(e);n&&(n.figure=t,n.sex=s,n.hasSaddle=i,n.isRiding=r)}updateName(e,t){const s=this.getUserDataByIndex(e);s&&(s.name=t)}updateMotto(e,t){const s=this.getUserDataByIndex(e);s&&(s.custom=t)}updateAchievementScore(e,t){const s=this.getUserDataByIndex(e);s&&(s.activityPoints=t)}updatePetLevel(e,t){const s=this.getUserDataByIndex(e);s&&(s.petLevel=t)}updatePetBreedingStatus(e,t,s,i,r){const n=this.getUserDataByIndex(e);n&&(n.canBreed=t,n.canHarvest=s,n.canRevive=i,n.hasBreedingPermission=r)}requestPetInfo(e){!this._connection||!this.getPetData(e)||this._connection.send(new hd(e))}get connection(){return this._connection}};let Pn=zr;Pn.TYPE_USER=1;Pn.TYPE_PET=2;Pn.TYPE_BOT=3;Pn.TYPE_RENTABLE_BOT=4;class QB extends Ie{constructor(){super(),this._connection=null,this._userData=new Pn,this._roomId=0,this._password=null,this._state=k.CREATED,this._tradeMode=Na.NO_TRADING,this._doorMode=0,this._controllerLevel=Oe.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(t){this._connection||!t||(this._connection=t,this._userData&&this._userData.setConnection(t))}setControllerLevel(t){if(t>=Oe.NONE&&t<=Oe.MODERATOR){this._controllerLevel=t;return}this._controllerLevel=Oe.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==k.CREATED||!this._connection?!1:(this._state=k.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new md(this._roomId,this._password)),!0):!1}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,s){this._connection.send(new mh(t,s))}sendShoutMessage(t,s){this._connection.send(new eg(t,s))}sendWhisperMessage(t,s,i){this._connection.send(new sg(t,s,i))}sendChatTypingMessage(t){t?this._connection.send(new ig):this._connection.send(new rg)}sendMottoMessage(t){this._connection.send(new pg(t))}sendDanceMessage(t){this._connection.send(new ag(t))}sendExpressionMessage(t){this._connection.send(new ng(t))}sendSignMessage(t){t<0||t>17||this._connection.send(new hg(t))}sendPostureMessage(t){this._connection.send(new _g(t))}sendDoorbellApprovalMessage(t,s){this._connection.send(new fd(t,s))}sendAmbassadorAlertMessage(t){this._connection.send(new Id(t))}sendKickMessage(t){this._connection.send(new pd(t))}sendMuteMessage(t,s){this._connection.send(new Od(t,s,this._roomId))}sendBanMessage(t,s){this._connection.send(new Rd(t,this._roomId,s))}sendGiveRightsMessage(t){this._connection.send(new Td(t))}sendTakeRightsMessage(t){this._connection.send(new Ad(t))}sendPollStartMessage(t){this._connection.send(new Ed(t))}sendPollRejectMessage(t){this._connection.send(new gd(t))}sendPollAnswerMessage(t,s,i){this._connection.send(new dd(t,s,i))}sendPeerUsersClassificationMessage(t){this._connection.send(new Sg(t))}sendOpenPetPackageMessage(t,s){this._connection.send(new Qd(t,s))}sendRoomUsersClassificationMessage(t){this._connection.send(new Mg(t))}updateMoodlightData(t,s,i,r,n){let a="000000"+i.toString(16).toUpperCase();a="#"+a.substring(a.length-6),this.connection.send(new Gd(t,s,a,r,n))}toggleMoodlightState(){this.connection.send(new Bd)}pickupPet(t){this._connection&&this._connection.send(new Ld(t))}pickupBot(t){this._connection&&this._connection.send(new Md(t))}requestMoodlightSettings(){this._connection&&this._connection.send(new xd)}openGift(t){this._connection.send(new Jd(t))}mountPet(t){this._connection.send(new M_(t,!0))}dismountPet(t){this._connection.send(new M_(t,!1))}usePetProduct(t,s){this._connection.send(new cd(t,s))}removePetSaddle(t){this._connection.send(new _d(t))}togglePetBreeding(t){this._connection.send(new ud(t))}togglePetRiding(t){this._connection.send(new ld(t))}useMultistateItem(t){this._connection.send(new fh(t))}harvestPet(t){this._connection.send(new Pd(t))}compostPlant(t){this._connection.send(new Nd(t))}requestPetCommands(t){this._connection.send(new ad(t))}sendScriptProceed(){this._connection.send(new nd)}sendUpdateClothingChangeFurniture(t,s,i){this._connection.send(new vd(t,s,i))}changeQueue(t){this._connection.send(new $d(t))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class JB extends as{constructor(t,s){super(),this._communication=t,this._roomEngine=s,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(ct.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(ct.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const t=this._communication&&this._communication.connection;t&&this._handlers.push(new wB(t,this),new HB(t,this),new VB(t,this),new jB(t,this),new Di(t,this),new kB(t,this),new YB(t,this),new xB(t,this),new KB(t,this),new BB(t,this),new GB(t,this))}setHandlers(t){if(!(!this._handlers||!this._handlers.length))for(const s of this._handlers)s&&s.setRoomId(t.roomId)}onRoomEngineEvent(t){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){const s=this._sessions.get(this.getRoomId(t));return s||null}createSession(t,s=null){const i=new QB;return i.roomId=t,i.password=s,this.addSession(i)}addSession(t){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),t.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(t.roomId),t),this.events.dispatchEvent(new k(k.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0):(this._pendingSession=t,!1)}startSession(t){return t.state===k.STARTED?!1:(this._sessionStarting=!1,t.start()?(this.events.dispatchEvent(new k(k.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t,s=!0){const i=this.getSession(t);i&&(this._sessions.delete(this.getRoomId(t)),this.events.dispatchEvent(new k(k.ENDED,i,s)),i.dispose())}sessionUpdate(t,s){if(this.getSession(t))switch(s){case Di.RS_CONNECTED:return;case Di.RS_READY:return;case Di.RS_DISCONNECTED:this.removeSession(t);return}}sessionReinitialize(t,s){const i=this.getSession(t);i&&(this._sessions.delete(this.getRoomId(t)),i.reset(s),this._sessions.set(this.getRoomId(s),i),this.setHandlers(i))}getRoomId(t){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}const TE=class{static logEventLog(e){try{st.available&&st.call("logEventLog",e)}catch{G.log("External interface not working, failed to log event log.")}}static openPage(e){try{st.available&&st.call("openPage",e)}catch{G.log("Failed to open web page",e)}}static openWebPage(e){window.open(e)}static sendHeartBeat(){try{st.available&&st.call("heartBeat")}catch{G.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(e){try{st.available&&TE.openPage(e)}catch{G.log("Failed to open web page",e)}}static closeWebPageAndRestoreClient(){try{st.available&&st.call("closeWebPageAndRestoreClient")}catch{G.log("Failed to close web page and restore client!")}}static openHabblet(e,t=null){try{st.available&&st.call("openHabblet",e,t)}catch{G.log("Failed to open Habblet",e)}}static closeHabblet(e,t=null){try{st.available&&st.call("closeHabblet",e,t)}catch{G.log("Failed to close Habblet",e)}}static send(e,t){try{st.available&&st.call("disconnect",e,t)}catch{G.log("Failed to close send ")}}static showGame(e){try{st.available&&st.callGame("showGame",e)}catch(t){G.log("Failed to open game",t)}}static hideGame(){try{st.available&&st.callGame("hideGame")}catch{G.log("Failed to hide game")}}static open(e){try{st.available&&st.call("openExternalLink",escape(e))}catch{G.log("External interface not working. Could not request to open: "+e)}}static roomVisited(e){try{st.available&&st.call("roomVisited",e)}catch{G.log("External interface not working. Could not store last room visit.")}}static openMinimail(e){try{st.available&&st.call("openMinimail",e)}catch{G.log("External interface not working. Could not open minimail.")}}static openNews(){try{st.available&&st.call("openNews")}catch{G.log("External interface not working. Could not open news.")}}static closeNews(){try{st.available&&st.call("closeNews")}catch{G.log("External interface not working. Could not close news.")}}static openAvatars(){try{st.available&&st.call("openAvatars")}catch{G.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{st.available&&st.call("openRoomEnterAd")}catch{G.log("External interface not working. Could not open roomenterad.")}}static updateFigure(e){try{st.available&&st.call("updateFigure",e)}catch{G.log("External interface not working. Could not update figure.")}}};let Ui=TE;Ui.ADVERTISEMENT="advertisement";Ui.OPENLINK="openlink";Ui.OPENROOM="openroom";class ZB extends as{constructor(t){super(),this._communication=t,this.resetUserInfo(),this._ignoredUsersManager=new XB(this),this._groupInformationManager=new FB(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new Zl(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new ca(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new Hc(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new Jl(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new fc(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new ke(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new gh(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Yc(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new lr(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new Kc(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new hc(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new ic(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new Vc(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new zc(this.onEmailStatus.bind(this))),B.instance.events.addEventListener(or.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),B.instance.events.removeEventListener(or.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new kr(this._floorItems,this._wallItems,B.instance.localization),this._furnitureData.addEventListener(kr.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(W.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new Kr(this._products),this._productData.addEventListener(Kr.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(W.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new nr(Pe(),this),this._badgeImageManager.init())}hasProductData(t){return this._productsReady?!0:(t&&this._pendingProductListeners.indexOf(t)===-1&&this._pendingProductListeners.push(t),!1)}getAllFurnitureData(t){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(t)===-1&&this._pendingFurnitureListeners.push(t),null;const s=[];for(const i of this._floorItems.values())i&&s.push(i);for(const i of this._wallItems.values())i&&s.push(i);return s}removePendingFurniDataListener(t){if(!this._pendingFurnitureListeners)return;const s=this._pendingFurnitureListeners.indexOf(t);s!==-1&&this._pendingFurnitureListeners.splice(s,1)}onUserFigureEvent(t){!t||!t.connection||(this._figure=t.getParser().figure,this._gender=t.getParser().gender,Ui.updateFigure(this._figure))}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const s=t.getParser().userInfo;s&&(this._userId=s.userId,this._name=s.username,this._figure=s.figure,this._gender=s.gender,this._realName=s.realName,this._respectsReceived=s.respectsReceived,this._respectsLeft=s.respectsRemaining,this._respectsPetLeft=s.respectsPetRemaining,this._canChangeName=s.canChangeName,this._safetyLocked=s.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(t){!t||!t.connection||(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const s=t.getParser();s&&(this._systemOpen=s.isOpen,this._systemShutdown=s.onShutdown,this._isAuthenticHabbo=s.isAuthenticUser)}onPetRespectFailed(t){!t||!t.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const s=t.getParser();s&&s.resultCode===ke.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new Po(s.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const s=t.getParser();s&&s.webId===this.userId&&(this._name=s.newName,this._canChangeName=!1,this.events.dispatchEvent(new Po(this._name)))}onUserTags(t){if(!t||!t.connection)return;const s=t.getParser();s&&(this._tags=s.tags)}onRoomModelNameEvent(t){if(!t)return;const s=t.getParser();s&&Ui.roomVisited(s.roomId)}onFurnitureDataReadyEvent(t){if(this._furnitureData.removeEventListener(kr.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const s of this._pendingFurnitureListeners)s&&s.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(t){this._productData.removeEventListener(Kr.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const s of this._pendingProductListeners)s&&s.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(t){if(!t)return;const s=t.getParser();s&&B.instance.createLinkEvent(s.link)}onMysteryBoxKeysEvent(t){if(!t)return;const s=t.getParser();s&&this.events.dispatchEvent(new Fu(s.boxColor,s.keyColor))}onNoobnessLevelMessageEvent(t){this._noobnessLevel=t.getParser().noobnessLevel,this._noobnessLevel!==ar.OLD_IDENTITY&&W.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(t){if(!t)return;const s=t.getParser();s&&(this._safetyLocked=s.status==va.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(t){if(!t)return;const s=t.getParser();s&&(this._isEmailVerified=s.isVerified)}onNitroSettingsEvent(t){this._isRoomCameraFollowDisabled=t.cameraFollow,this._uiFlags=t.flags,this.events.dispatchEvent(new Il(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(t){const s=this._floorItems.get(t);return s||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const s of this._floorItems.values())if(!(!s||s.className!==t))return s}getWallItemData(t){const s=this._wallItems.get(t);return s||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const s of this._wallItems.values())if(!(!s||s.className!==t))return s}getProductData(t){return this._productsReady||this.loadProductData(),this._products.get(t)}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,nr.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,nr.GROUP_BADGE)}getUserTags(t){t<0||this.send(new fg(t))}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,nr.GROUP_BADGE)}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new Ag(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new od(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t,s=0){this.send(new mh(t))}ignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(t)}unignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(t)}isUserIgnored(t){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(t)}getGroupBadge(t){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(t)}send(t){this._communication.connection.send(t)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==ar.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===ar.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=Ke.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}class pE extends Ya{constructor(t,s,i,r,n=""){super(t,s,i,r),this._jukeboxDiskId=-1,this._songData=n}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(t){this._songData=t}get diskId(){return this._jukeboxDiskId}set diskId(t){this._jukeboxDiskId=t}}class $B{constructor(t,s,i,r,n){this._songId=t,this._startPos=s,this._playLength=i,this._fadeInSeconds=r,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}const OE=class extends nt{constructor(e,t){super(OE.NOTIFY_PLAYED_SONG),this._name=e,this._creator=t}get name(){return this._name}get creator(){return this._creator}};let AE=OE;AE.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";class Ls extends nt{constructor(t,s,i,r){super(t),this._id=i,this._position=r,this._priority=s}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}}Ls.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG";Ls.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG";Ls.NPE_SONG_CHANGED="NPE_SONG_CHANGED";class Ks extends nt{constructor(t){super(t)}}Ks.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED";Ks.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";class Wr extends nt{constructor(t){super(t)}}Wr.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";class tn extends nt{constructor(t,s){super(t),this._id=s}get id(){return this._id}}tn.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";class en extends nt{constructor(t,s){super(t),this._id=s}get id(){return this._id}}en.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";class te{}te.PRIORITY_ROOM_PLAYLIST=0;te.PRIORITY_USER_PLAYLIST=1;te.PRIORITY_SONG_PLAY=2;te.PRIORITY_PURCHASE_PREVIEW=3;te.PRIORITY_COUNT=4;class tw{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new Gc(this.onNowPlayingMessageEvent.bind(this)),new xc(this.onJukeboxSongDisksMessageEvent.bind(this)),new Fc(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(t=>B.instance.communication.connection.addMessageEvent(t)),B.instance.soundManager.events.addEventListener(tn.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return te.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(t){const s=t.getParser();this._isPlaying=s.currentSongId!==-1,s.currentSongId>=0?(B.instance.soundManager.musicController.playSong(s.currentSongId,te.PRIORITY_ROOM_PLAYLIST,s.syncCount/1e3,0,1,1),this._currentEntryId=s.currentSongId):this.stopPlaying(),s.nextSongId>=0&&B.instance.soundManager.musicController.addSongInfoRequest(s.nextSongId),this._playPosition=s.currentPosition,B.instance.soundManager.events.dispatchEvent(new Ls(Ls.NPE_SONG_CHANGED,te.PRIORITY_ROOM_PLAYLIST,s.currentSongId,s.currentPosition))}onJukeboxSongDisksMessageEvent(t){const s=t.getParser();this._entries=[];for(let i=0;i<s.songDisks.length;i++){const r=s.songDisks.getWithIndex(i),n=s.songDisks.getKey(i);let a=B.instance.soundManager.musicController.getSongInfo(r);a==null&&(a=new pE(r,-1,null,null,null),this._missingSongInfo.indexOf(r)<0&&(this._missingSongInfo.push(r),B.instance.soundManager.musicController.requestSongInfoWithoutSamples(r))),a.diskId=n,this._entries.push(a)}this._missingSongInfo.length==0&&B.instance.soundManager.events.dispatchEvent(new Ks(Ks.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(t){B.instance.soundManager.events.dispatchEvent(new Ks(Ks.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(t){for(let i=0;i<this.length;i++){const r=this._entries[i];if(r.id===t.id){const n=r.diskId,a=B.instance.soundManager.musicController.getSongInfo(t.id);a!=null&&(a.diskId=n,this._entries[i]=a);break}}const s=this._missingSongInfo.indexOf(t.id);s>=0&&this._missingSongInfo.splice(s,1),this._missingSongInfo.length==0&&B.instance.soundManager.events.dispatchEvent(new Ks(Ks.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){B.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(t){return t<0||t>=this._entries.length?null:this._entries[t]}requestPlayList(){B.instance.communication.connection.send(new lg)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),B.instance.soundManager.events&&B.instance.soundManager.events.removeEventListener(tn.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(t=>B.instance.communication.connection.removeMessageEvent(t)),this._messageEvents=null)}}class ew{constructor(t){this._id=t,this._items=[]}addChannelItem(t){this._items.push(t)}get items(){return this._items}}class sw{constructor(t,s){this._id=t,this._length=s}get id(){return this._id}get length(){return this._length}}class w_{constructor(t){this._channels=[],this._metaData=new Map;let s=[];const i=t.split(":"),r=i[i.length-1];if(r.indexOf("meta")>-1){const n=r.split(";");for(const a of n){const o=a.split(",");this._metaData.set(o[0],o[1])}s=i.slice(0,i.length-1)}else s=i;for(let n=0;n<s.length/2;n++)if(s[n*2].length>0){const a=parseInt(s[n*2]),o=s[n*2+1].split(";"),u=new ew(a);for(const l of o){const c=l.split(",");if(c.length!==2)return;u.addChannelItem(new sw(parseInt(c[0]),parseInt(c[1])))}this._channels.push(u)}}get channels(){return this._channels}getSampleIds(){const t=[];for(const s of this._channels)for(const i of s.items)t.indexOf(i.id)===-1&&t.push(i.id);return t}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const t=this._metaData.get("t");return t?parseInt(t):null}}class iw{constructor(t){this._sampleUrl=t,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(t,s,i=0,r=-1){this.reset(),this._currentSong=new w_(t),this._startPos=Math.trunc(i),this._playLength=r,this._currentPos=this._startPos,this._currentSongId=s,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),Vi.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,Vi.Howler.stop()}resume(){this._isPlaying=!0}stop(){const t=this._currentSongId;this.reset(),B.instance.soundManager.events.dispatchEvent(new en(en.TRAX_SONG_COMPLETE,t))}setVolume(t){Vi.Howler.volume(t)}getVolume(){return Vi.Howler.volume()}async getSample(t){let s=this._cache.get(t);return s||(s=await this.loadSong(t)),Promise.resolve(s)}async preload(){if(this._sequence=[],!!this._currentSong){for(const t of this._currentSong.channels){const s=[];for(const i of t.items){const r=await this.getSample(i.id),n=Math.ceil(i.length*2/Math.ceil(r.duration()));for(let a=0;a<n;a++)for(let o=0;o<Math.ceil(r.duration());o++)s.push({sampleId:i.id,offset:o})}this._sequence.push(s)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(t=>t.length)))}}async preloadSamplesForSong(t){const s=new w_(t);await Promise.all(s.getSampleIds().map(i=>this.getSample(i)))}async loadSong(t){return new Promise((s,i)=>{const r=new Vi.Howl({src:[this._sampleUrl.replace("%sample%",t.toString())],preload:!0});r.once("load",()=>{this._cache.set(t,r),s(r)}),r.once("loaderror",()=>{G.error("failed to load sample "+t),i("failed to load sample "+t)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(t){if(!(!this._currentSong||!this._sequence)&&Vi.Howler._audioUnlocked)for(const s of this._sequence){const i=s[t];if(!i||i.sampleId===-1||i.sampleId===0)continue;const r=this._cache.get(i.sampleId);r&&(i.offset===0?r.play():r.playing()||(r.seek(i.offset),r.play()))}}}const Zn=class{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new Gt,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new Bc(this.onTraxSongInfoMessageEvent.bind(this)),new wc(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new iw(B.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(e=>B.instance.communication.connection.addMessageEvent(e)),B.instance.roomEngine.events.addEventListener(gt.JUKEBOX_INIT,this.onJukeboxInit),B.instance.roomEngine.events.addEventListener(gt.JUKEBOX_DISPOSE,this.onJukeboxDispose),B.instance.roomEngine.events.addEventListener(gt.SOUND_MACHINE_INIT,this.onSoundMachineInit),B.instance.roomEngine.events.addEventListener(gt.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),B.instance.soundManager.events.addEventListener(en.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(e){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getKey(e):-1}getSongDiskInventorySongId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(e):-1}getSongInfo(e){const t=this.getSongDataEntry(e);return t||this.requestSongInfoWithoutSamples(e),t}getSongIdPlayingAtPriority(e){return e!==this._priorityPlaying?-1:this._songIdPlaying}stop(e){const t=e===this._priorityPlaying,s=this.getTopRequestPriority()===e;t?(this.resetSongStartRequest(e),this.stopSongAtPriority(e)):(this.resetSongStartRequest(e),s&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(e){this.requestSong(e,!0)}requestSongInfoWithoutSamples(e){this.requestSong(e,!1)}requestUserSongDisks(){B.instance.communication.connection.send(new gg)}updateVolume(e){this._musicPlayer.setVolume(e)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(e=>B.instance.communication.connection.removeMessageEvent(e)),B.instance.roomEngine.events.removeEventListener(gt.JUKEBOX_INIT,this.onJukeboxInit),B.instance.roomEngine.events.removeEventListener(gt.JUKEBOX_DISPOSE,this.onJukeboxDispose),B.instance.roomEngine.events.removeEventListener(gt.SOUND_MACHINE_INIT,this.onSoundMachineInit),B.instance.roomEngine.events.removeEventListener(gt.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),B.instance.soundManager.events.removeEventListener(en.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let e,t,s=[];for(let i=0;i<this._songRequestsPerPriority.length;i++)if(this._songRequestsPerPriority[i]&&(e=this._songRequestsPerPriority[i],t=this._availableSongs.get(e.songId),t)){const r=t.songData;if(r.length>0){const n=new w_(r);s=s.concat(n.getSampleIds())}}return s}onSongLoaded(e){const t=this.getTopRequestPriority();if(t>=0){const s=this.getSongIdRequestedAtPriority(t);e===s&&this.playSongObject(t,e)}}samplesUnloaded(e){throw new Error("Method not implemented.")}onTraxSongComplete(e){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===e.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const t=this._priorityPlaying;this.playSongWithHighestPriority(),t>=te.PRIORITY_SONG_PLAY&&B.instance.soundManager.events.dispatchEvent(new Ls(Ls.NPW_USER_STOP_SONG,t,e.id,-1))}}onTraxSongInfoMessageEvent(e){const t=e.getParser();for(const s of t.songs){const i=!!this.getSongDataEntry(s.id);if(this.areSamplesRequested(s.id),!i){const r=new pE(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,r);const n=this.getTopRequestPriority(),a=this.getSongIdRequestedAtPriority(n);for(s.id===a&&this.playSongObject(n,a),B.instance.soundManager.events.dispatchEvent(new tn(tn.SIR_TRAX_SONG_INFO_RECEIVED,s.id));this._diskInventoryMissingData.indexOf(s.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(s.id),1),this._diskInventoryMissingData.length===0&&B.instance.soundManager.events.dispatchEvent(new Wr(Wr.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(e){const t=e.getParser();this._songDiskInventory.reset();for(let s=0;s<t.songDiskCount;s++){const i=t.getDiskId(s),r=t.getSongId(s);this._songDiskInventory.add(i,r),this._availableSongs.get(r)||(this._diskInventoryMissingData.push(r),this.requestSongInfoWithoutSamples(r))}this._diskInventoryMissingData.length===0&&B.instance.soundManager.events.dispatchEvent(new Wr(Wr.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(B.instance.communication.connection.send(new dg(...this._songRequestList)),this._songRequestList=[])}requestSong(e,t){this._requestedSongs.get(e)===void 0&&(this._requestedSongs.set(e,t),this._songRequestList.push(e))}areSamplesRequested(e){return this._requestedSongs.get(e)?this._requestedSongs.get(e):!1}processSongEntryForPlaying(e,t=!0){return this.getSongDataEntry(e)?!0:(this.addSongInfoRequest(e),!1)}playSong(e,t,s=0,i=0,r=.5,n=.5){return!this.addSongStartRequest(t,e,s,i,r,n)||!this.processSongEntryForPlaying(e)?!1:(t>=this._priorityPlaying&&this.playSongObject(t,e),!0)}playSongObject(e,t){if(t===-1||e<0||e>=te.PRIORITY_COUNT)return!1;let s=!1;this.stopSongAtPriority(this._priorityPlaying)&&(s=!0);const i=this.getSongDataEntry(t);if(!i)return!1;if(s)return!0;this._musicPlayer.setVolume(B.instance.soundManager.traxVolume);let r=Zn.SKIP_POSITION_SET,n=0;const a=this.getSongStartRequest(e);return a&&(r=a.startPos,n=a.playLength,a.fadeInSeconds,a.fadeOutSeconds),r>=i.length/1e3?!1:(r<=Zn.SKIP_POSITION_SET&&(r=0),r=Math.trunc(r),this._priorityPlaying=e,this._requestNumberPlaying=this.getSongRequestCountAtPriority(e),this._songIdPlaying=t,this._priorityPlaying<=Zn.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(i),this._musicPlayer.preloadSamplesForSong(i.songData).then(()=>this._musicPlayer.play(i.songData,i.id,r,n)),e>te.PRIORITY_ROOM_PLAYLIST&&B.instance.soundManager.events.dispatchEvent(new Ls(Ls.NPE_USER_PLAY_SONG,e,i.id,-1)),!0)}notifySongPlaying(e){const s=Date.now();e.length>=8e3&&(this._previousNotifiedSongId!=e.id||s>this._previousNotificationTime+8e3)&&(B.instance.soundManager.events.dispatchEvent(new AE(e.name,e.creator)),this._previousNotifiedSongId=e.id,this._previousNotificationTime=s)}addSongStartRequest(e,t,s,i,r,n){if(e<0||e>=te.PRIORITY_COUNT)return!1;const a=new $B(t,s,i,r,n);return this._songRequestsPerPriority[e]=a,this._songRequestCountsPerPriority[e]=this._songRequestCountsPerPriority[e]+1,!0}getSongDataEntry(e){let t;return this._availableSongs&&(t=this._availableSongs.get(e)),t}getSongStartRequest(e){return this._songRequestsPerPriority[e]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(e){return e<0||e>=te.PRIORITY_COUNT||!this._songRequestsPerPriority[e]?-1:this._songRequestsPerPriority[e].songId}getSongRequestCountAtPriority(e){return e<0||e>=te.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[e]}playSongWithHighestPriority(){let e;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let s=this.getTopRequestPriority();for(;s>=0;){if(e=this.getSongIdRequestedAtPriority(s),e>=0&&this.playSongObject(s,e))return;s--}}resetSongStartRequest(e){e>=0&&e<te.PRIORITY_COUNT&&(this._songRequestsPerPriority[e]=void 0)}reRequestSongAtPriority(e){this._songRequestCountsPerPriority[e]=this._songRequestCountsPerPriority[e]+1}stopSongAtPriority(e){if(e===this._priorityPlaying&&this._priorityPlaying>=0){const t=this.getSongIdPlayingAtPriority(e);if(t>=0)return this.getSongDataEntry(t),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(e){this.disposeRoomPlaylist()}onSoundMachineDispose(e){this.disposeRoomPlaylist()}onJukeboxInit(e){this.disposeRoomPlaylist(),this._roomItemPlaylist=new tw,this._roomItemPlaylist.init(),B.instance.communication.connection.send(new cg)}onJukeboxDispose(e){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};let bh=Zn;bh.SKIP_POSITION_SET=-1;bh.MAXIMUM_NOTIFY_PRIORITY=te.PRIORITY_ROOM_PLAYLIST;class rw extends as{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new Gt,this._furniSamples=new Gt,this._furnitureBeingPlayed=new Gt,this._musicController=new bh,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),B.instance.roomEngine.events.addEventListener(_e.PLAY_SAMPLE,this.onEvent),B.instance.roomEngine.events.addEventListener(H.REMOVED,this.onEvent),B.instance.roomEngine.events.addEventListener(ct.DISPOSED,this.onEvent),B.instance.events.addEventListener(or.SETTINGS_UPDATED,this.onEvent),B.instance.events.addEventListener(Bn.PLAY_SOUND,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),B.instance.roomEngine.events.removeEventListener(_e.PLAY_SAMPLE,this.onEvent),B.instance.roomEngine.events.removeEventListener(H.REMOVED,this.onEvent),B.instance.roomEngine.events.removeEventListener(ct.DISPOSED,this.onEvent),B.instance.events.removeEventListener(or.SETTINGS_UPDATED,this.onEvent),B.instance.events.removeEventListener(Bn.PLAY_SOUND,this.onEvent)}onEvent(t){var s;switch(t.type){case _e.PLAY_SAMPLE:{const i=t;this.playFurniSample(i.objectId,i.sampleId,i.pitch);return}case H.REMOVED:{const i=t;this.stopFurniSample(i.objectId);return}case ct.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(i=>{this.stopFurniSample(i)});return}case or.SETTINGS_UPDATED:{const i=t,r=i.volumeFurni!==this._volumeFurni,n=i.volumeTrax!==this._volumeTrax;this._volumeSystem=i.volumeSystem/100,this._volumeFurni=i.volumeFurni/100,this._volumeTrax=i.volumeTrax/100,r&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((s=this._musicController)==null||s.updateVolume(this._volumeTrax));return}case Bn.PLAY_SOUND:{const i=t;this.playInternalSample(i.sampleCode);return}}}playSample(t,s,i=1){t.volume=s,t.currentTime=0;try{t.play()}catch(r){G.error(r)}}playInternalSample(t){let s=this._internalSamples.getValue(t);if(!s){const i=W.getValue("sounds.url");s=new Audio(i.replace("%sample%",t)),this._internalSamples.add(t,s)}this.playSample(s,this._volumeSystem)}playFurniSample(t,s,i){let r=this._furniSamples.getValue(s);if(!r){const n=W.getValue("external.samples.url");r=new Audio(n.replace("%sample%",s.toString())),this._furniSamples.add(s,r)}this._furnitureBeingPlayed.hasKey(t)||this._furnitureBeingPlayed.add(t,s),r.onended=n=>{this.stopFurniSample(t)},r.onpause=n=>{this.stopFurniSample(t)},r.onerror=n=>{this.stopFurniSample(t)},this.playSample(r,this._volumeFurni,i)}stopInternalSample(t){const s=this._internalSamples.getValue(t);if(s)try{s.pause()}catch(i){G.error(i)}}stopFurniSample(t){const s=this._furnitureBeingPlayed.getValue(t);if(!s)return;const i=this._furniSamples.getValue(s);if(this._furnitureBeingPlayed.remove(t),!!i)try{i.pause()}catch(r){G.error(r)}}updateInternalSamplesVolume(t){this._internalSamples.getValues().forEach(s=>{s.volume=t})}updateFurniSamplesVolume(t){this._furniSamples.getValues().forEach(s=>{s.volume=t})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}st.available;Aa.SCALE_MODE=window.devicePixelRatio%1?Eo.LINEAR:Eo.NEAREST;Aa.ROUND_PIXELS=!0;Aa.GC_MAX_IDLE=120;const Oi=class{constructor(e,t){Oi.INSTANCE||(Oi.INSTANCE=this),this._application=new Yt(t),this._core=e,this._events=new Me,this._communication=new Q1(e.communication),this._localization=new Z1(this._communication),this._avatar=new DE,this._roomEngine=new Ce(this._communication),this._sessionDataManager=new ZB(this._communication),this._roomSessionManager=new JB(this._communication,this._roomEngine),this._roomManager=new xi(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new Zf,this._soundManager=new rw,this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(Qs.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(ct.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){Oi.INSTANCE&&(Oi.INSTANCE.dispose(),Oi.INSTANCE=null);const e=document.createElement("canvas"),t=new this(new If,{autoDensity:!1,width:window.innerWidth,height:window.innerHeight,resolution:window.devicePixelRatio,view:e});e.addEventListener("webglcontextlost",()=>t.events.dispatchEvent(new nt(Oi.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new J1(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(e){Os().maxFPS=W.getValue("system.fps.max",24),G.LOG_DEBUG=W.getValue("system.log.debug",!0),G.LOG_WARN=W.getValue("system.log.warn",!1),G.LOG_ERROR=W.getValue("system.log.error",!1),G.LOG_EVENTS=W.getValue("system.log.events",!1),G.LOG_PACKETS=W.getValue("system.log.packets",!1),Nn.LANDSCAPES_ENABLED=W.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(e){this.startSendingHeartBeat()}getConfiguration(e,t=null){return W.getValue(e,t)}getLocalization(e){return this._localization.getValue(e)}getLocalizationWithParameter(e,t,s){return this._localization.getValueWithParameter(e,t,s)}getLocalizationWithParameters(e,t,s){return this._localization.getValueWithParameters(e,t,s)}addLinkEventTracker(e){this._linkTrackers.indexOf(e)>=0||this._linkTrackers.push(e)}removeLinkEventTracker(e){const t=this._linkTrackers.indexOf(e);t!==-1&&this._linkTrackers.splice(t,1)}createLinkEvent(e){if(!(!e||e===""))for(const t of this._linkTrackers){if(!t)continue;const s=t.eventUrlPrefix;s.length>0?e.substr(0,s.length)===s&&t.linkReceived(e):t.linkReceived(e)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){Ui.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}};let B=Oi;B.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST";B.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE";B.READY="NE_READY!";B.INSTANCE=null;const ot=class{static format(e,t="",s=3){return e>s*ot.YEAR?ot.getLocalization("friendlytime.years"+t,Math.round(e/ot.YEAR)):e>s*ot.MONTH?ot.getLocalization("friendlytime.months"+t,Math.round(e/ot.MONTH)):e>s*ot.DAY?ot.getLocalization("friendlytime.days"+t,Math.round(e/ot.DAY)):e>s*ot.HOUR?ot.getLocalization("friendlytime.hours"+t,Math.round(e/ot.HOUR)):e>s*ot.MINUTE?ot.getLocalization("friendlytime.minutes"+t,Math.round(e/ot.MINUTE)):ot.getLocalization("friendlytime.seconds"+t,Math.round(e))}static shortFormat(e,t="",s=3){return e>s*ot.YEAR?ot.getLocalization("friendlytime.years.short"+t,Math.round(e/ot.YEAR)):e>s*ot.MONTH?ot.getLocalization("friendlytime.months.short"+t,Math.round(e/ot.MONTH)):e>s*ot.DAY?ot.getLocalization("friendlytime.days.short"+t,Math.round(e/ot.DAY)):e>s*ot.HOUR?ot.getLocalization("friendlytime.hours.short"+t,Math.round(e/ot.HOUR)):e>s*ot.MINUTE?ot.getLocalization("friendlytime.minutes.short"+t,Math.round(e/ot.MINUTE)):ot.getLocalization("friendlytime.seconds.short"+t,Math.round(e))}static getLocalization(e,t){return B.instance.getLocalizationWithParameter(e,"amount",t.toString())}};let Dr=ot;Dr.MINUTE=60;Dr.HOUR=60*ot.MINUTE;Dr.DAY=24*ot.HOUR;Dr.WEEK=7*ot.DAY;Dr.MONTH=30*ot.DAY;Dr.YEAR=365*ot.DAY;const SE=class{static isBuilderClubId(e){return e>=SE.BUILDER_CLUB_FURNI_ID_BASE}};let H_=SE;H_.BUILDER_CLUB_FURNI_ID_BASE=2147418112;const nw=e=>e>>>0,ME=e=>{const t=nw(e);return t>=Math.pow(2,31)?t-Math.pow(2,32):t};class Fh{constructor(t){if(this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const i of t.avatarSets){if(!i)continue;const r=new Fh(i);this._avatarSets.set(r.id,r)}if(t.bodyParts&&t.bodyParts.length>0)for(const i of t.bodyParts)i&&this._bodyParts.push(i.id);let s=this._bodyParts.concat();for(const i of this._avatarSets.values())i&&(s=s.concat(i.getBodyParts()));this._allBodyParts=s}findAvatarSet(t){if(t===this._id)return this;for(const s of this._avatarSets.values())if(s&&s.findAvatarSet(t))return s;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t.isMain)return!0;return!1}}class Se{constructor(t=0,s=0,i=0){this._x=t,this._y=s,this._z=i}static dot(t,s){return t.x*s.x+t.y*s.y+t.z*s.z}static cross(t,s){const i=new Se;return i.x=t.y*s.z-t.z*s.y,i.y=t.z*s.x-t.x*s.z,i.z=t.x*s.y-t.y*s.x,i}static subtract(t,s){return new Se(t.x-s.x,t.y-s.y,t.z-s.z)}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}cross(t){const s=new Se;return s.x=this._y*t.z-this._z*t.y,s.y=this._z*t.x-this._x*t.z,s.z=this._x*t.y-this._y*t.x,s}subtract(t){this._x=this._x-t.x,this._y=this._y-t.y,this._z=this._z-t.z}add(t){this._x=this._x+t.x,this._y=this._y+t.y,this._z=this._z+t.z}normalize(){const t=1/this.length();this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}scaleBy(t){this._x*=t,this._y*=t,this._z*=t}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}class CE{constructor(t,s,i){this._location=new Se(t,s,i),this._transformedLocation=new Se,this._needsTransformation=!1,(t!=0||s!=0||i!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(t){this._needsTransformation&&(this._transformedLocation=t.vectorMultiplication(this._location))}}class au extends CE{constructor(t,s=!1){super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new Se(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=s}getDistance(t){const s=Math.abs(t.z-this.transformedLocation.z-this._radius),i=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(s,i)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class aw extends CE{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const s of t.items){if(!s)continue;const i=new au(s);this._parts.set(i.id,i)}}getDynamicParts(t){const s=this._dynamicParts.get(t),i=[];if(s)for(const r in s){const n=s[r];n&&i.push(n)}return i}getPartIds(t){const s=[];for(const i of this._parts.values())i&&s.push(i.id);if(t){const i=this._dynamicParts.get(t);if(i)for(const r in i){const n=i[r];n&&s.push(n.id)}}return s}removeDynamicParts(t){return this._dynamicParts.delete(t),!0}addPart(t,s){if(this.hasPart(t.id,s))return!1;let i=this._dynamicParts.get(s);return i||(i={},this._dynamicParts.set(s,i)),i[t.id]=new au(t,!0),!0}hasPart(t,s){let i=this._parts.get(t)||null;return!i&&this._dynamicParts.get(s)!==void 0&&(i=this._dynamicParts.get(s)[t]||null),i!==null}getParts(t,s,i,r){const n=[];for(const u of this._parts.values())u&&(u.applyTransform(t),n.push([u.getDistance(s),u]));const a=this._dynamicParts.get(r);if(a)for(const u in a){const l=a[u];l&&(l.applyTransform(t),n.push([l.getDistance(s),l]))}n.sort((u,l)=>{const c=u[0],g=l[0];return c<g?-1:c>g?1:0});const o=[];for(const u of n)u&&o.push(u[1].id);return o}getDistance(t){const s=Math.abs(t.z-this.transformedLocation.z-this._radius),i=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(s,i)}get id(){return this._id}get radius(){return this._radius}}const ts=class{constructor(e=0,t=0,s=0,i=0,r=0,n=0,a=0,o=0,u=0){this._data=[e,t,s,i,r,n,a,o,u]}static getXRotationMatrix(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new ts(1,0,0,0,s,-i,0,i,s)}static getYRotationMatrix(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new ts(s,0,i,0,1,0,-i,0,s)}static getZRotationMatrix(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new ts(s,-i,0,i,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(e){const t=e.x*this._data[0]+e.y*this._data[3]+e.z*this._data[6],s=e.x*this._data[1]+e.y*this._data[4]+e.z*this._data[7],i=e.x*this._data[2]+e.y*this._data[5]+e.z*this._data[8];return new Se(t,s,i)}multiply(e){const t=this._data[0]*e.data[0]+this._data[1]*e.data[3]+this._data[2]*e.data[6],s=this._data[0]*e.data[1]+this._data[1]*e.data[4]+this._data[2]*e.data[7],i=this._data[0]*e.data[2]+this._data[1]*e.data[5]+this._data[2]*e.data[8],r=this._data[3]*e.data[0]+this._data[4]*e.data[3]+this._data[5]*e.data[6],n=this._data[3]*e.data[1]+this._data[4]*e.data[4]+this._data[5]*e.data[7],a=this._data[3]*e.data[2]+this._data[4]*e.data[5]+this._data[5]*e.data[8],o=this._data[6]*e.data[0]+this._data[7]*e.data[3]+this._data[8]*e.data[6],u=this._data[6]*e.data[1]+this._data[7]*e.data[4]+this._data[8]*e.data[7],l=this._data[6]*e.data[2]+this._data[7]*e.data[5]+this._data[8]*e.data[8];return new ts(t,s,i,r,n,a,o,u,l)}scalarMultiply(e){let t=0;for(;t<this._data.length;)this._data[t]=this._data[t]*e,t++}rotateX(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new ts(1,0,0,0,s,-i,0,i,s).multiply(this)}rotateY(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new ts(s,0,i,0,1,0,-i,0,s).multiply(this)}rotateZ(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new ts(s,-i,0,i,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new ts(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(e){return!1}get data(){return this._data}};let Xr=ts;Xr.IDENTITY=new ts(1,0,0,0,1,0,0,0,1);Xr.TOLERANS=1e-18;class ow{constructor(t){this._camera=new Se(0,0,10),this._avatarSet=new Fh(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new Xr,this._canvases=new Map;const s=t.camera;if(s&&(this._camera.x=parseFloat(s.x),this._camera.y=parseFloat(s.y),this._camera.z=parseFloat(s.z)),t.canvases&&t.canvases.length>0)for(const i of t.canvases){if(!i)continue;const r=i.scale,n=new Map;if(i.geometries&&i.geometries.length>0)for(const a of i.geometries){if(!a)continue;const o=new bf(a,r);n.set(o.id,o)}this._canvases.set(r,n)}if(t.types&&t.types.length>0)for(const i of t.types){if(!i)continue;const r=new Map,n=new Map;if(i.bodyParts&&i.bodyParts.length>0)for(const a of i.bodyParts){if(!a)continue;const o=new aw(a);r.set(o.id,o);for(const u of o.getPartIds(null))n.set(u,o)}this._geometryTypes.set(i.id,r),this._itemIdToBodyPartMap.set(i.id,n)}}removeDynamicItems(t){for(const s of this._geometryTypes.values())if(s)for(const i of s.values())i&&i.removeDynamicParts(t)}getBodyPartIdsInAvatarSet(t){const s=this._avatarSet.findAvatarSet(t);return s?s.getBodyParts():[]}isMainAvatarSet(t){const s=this._avatarSet.findAvatarSet(t);return s?s.isMain:!1}getCanvas(t,s){const i=this._canvases.get(t);return i&&i.get(s)||null}typeExists(t){return!!this._geometryTypes.get(t)}hasBodyPart(t,s){if(this.typeExists(t)){const i=this._geometryTypes.get(t);if(i&&i.get(s))return!0}return!1}getBodyPartIDs(t){const s=this.getBodyPartsOfType(t),i=[];if(s)for(const r of s.values())r&&i.push(r.id);return i}getBodyPartsOfType(t){return this.typeExists(t)?this._geometryTypes.get(t):new Map}getBodyPart(t,s){return this.getBodyPartsOfType(t).get(s)||null}getBodyPartOfItem(t,s,i){const r=this._itemIdToBodyPartMap.get(t);if(r){const n=r.get(s);if(n)return n;const a=this.getBodyPartsOfType(t);if(a){for(const o of a.values())if(o&&o.hasPart(s,i))return o}}return null}getBodyPartsInAvatarSet(t,s){const i=this.getBodyPartIdsInAvatarSet(s),r=[];for(const n of i){if(!n)continue;const a=t.get(n);a&&r.push(a)}return r}getBodyPartsAtAngle(t,s,i){if(!i)return[];const r=this.getBodyPartsOfType(i),n=this.getBodyPartsInAvatarSet(r,t),a=[],o=[];this._transformation=Xr.getYRotationMatrix(s);for(const u of n.values())u&&(u.applyTransform(this._transformation),a.push([u.getDistance(this._camera),u]));a.sort((u,l)=>{const c=u[0],g=l[0];return c<g?-1:c>g?1:0});for(const u of a)u&&o.push(u[1].id);return o}getParts(t,s,i,r,n){if(this.hasBodyPart(t,s)){const a=this.getBodyPartsOfType(t).get(s);return this._transformation=Xr.getYRotationMatrix(i),a.getParts(this._transformation,this._camera,r,n)}return[]}}class _w extends Me{constructor(t){super(),this._renderManager=t,this._geometry=null,this._figureData=new Bf,this._partSetsData=new wf,this._animationData=new vf,this._animationManager=new Df,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(t){t&&(this._geometry=new ow(t))}initActions(t,s){s&&(this._actionManager=new pf(t,s),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(t){this._actionManager.updateActions(t),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(t){return t&&this._partSetsData.parse(t)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(t){return t?this._animationData.parse(t):!1}initFigureData(t){return t?this._figureData.parse(t):!1}injectFigureData(t){this._figureData.injectJSON(t)}registerAnimations(t,s="fx",i=200){let r=0;for(;r<i;){const n=t.getCollection(s+r);if(n){const a=n.data;this._animationManager.registerAnimation(this,a.animations)}r++}}registerAnimation(t){this._animationManager.registerAnimation(this,t)}getPartColor(t,s,i=0){const r=t.getPartColorIds(s);if(!r||r.length<i)return null;const n=this._figureData.getSetType(s);if(n==null)return null;const a=this._figureData.getPalette(n.paletteID);return a?a.getColor(r[i]):null}getBodyPartData(t,s,i){return this._animationManager.getLayerData(t,s,i)}getAnimation(t){return this._animationManager.getAnimation(t)}getActionDefinition(t){return this._actionManager.getActionDefinition(t)}getActionDefinitionWithState(t){return this._actionManager.getActionDefinitionWithState(t)}isMainAvatarSet(t){return this._geometry.isMainAvatarSet(t)}sortActions(t){return this._actionManager.sortActions(t)}maxFrames(t){let s=0;for(const i of t)s=Math.max(s,this._animationData.getFrameCount(i.definition));return s}getMandatorySetTypeIds(t,s){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][s]?this._mandatorySetTypeIds[t][s]:(this._mandatorySetTypeIds[t][s]=this._figureData.getMandatorySetTypeIds(t,s),this._mandatorySetTypeIds[t][s])}getDefaultPartSet(t,s){return this._figureData.getDefaultPartSet(t,s)}getCanvasOffsets(t,s,i){return this._actionManager.getCanvasOffsets(t,s,i)}getCanvas(t,s){return this._geometry.getCanvas(t,s)}removeDynamicItems(t){this._geometry.removeDynamicItems(t)}getActiveBodyPartIds(t,s){let i=[];const r=[],n=t.definition.geometryType;if(t.definition.isAnimation){const a=t.definition.state+"."+t.actionParameter,o=this._animationManager.getAnimation(a);if(o&&(i=o.getAnimatedBodyPartIds(0,t.overridingAction),o.hasAddData())){const u={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},l={setType:""};for(const c of o.addData){const g=this._geometry.getBodyPart(n,c.align);if(g){u.id=c.id,g.addPart(u,s),l.setType=c.id;const f=this._partSetsData.addPartDefinition(l);f.appendToFigure=!0,c.base===""&&(f.staticId=1),r.indexOf(g.id)===-1&&r.push(g.id)}}}for(const u of i){const l=this._geometry.getBodyPart(n,u);l&&r.indexOf(l.id)===-1&&r.push(l.id)}}else{i=this._partSetsData.getActiveParts(t.definition);for(const a of i){const o=this._geometry.getBodyPartOfItem(n,a,s);o&&r.indexOf(o.id)===-1&&r.push(o.id)}}return r}getBodyPartsUnordered(t){return this._geometry.getBodyPartIdsInAvatarSet(t)}getBodyParts(t,s,i){const r=es.DIRECTION_TO_ANGLE[i];return this._geometry.getBodyPartsAtAngle(t,r,s)}getFrameBodyPartOffset(t,s,i,r){const n=this._animationData.getAction(t.definition);return n?n.getFrameBodyPartOffset(s,i,r):sa.DEFAULT_OFFSET}getParts(t,s,i,r,n,a,o,u=null){let l=null,c=[],g=null;if(!i==null)return[];const f=this._partSetsData.getActiveParts(i.definition),R=[];let m=[0];const T=this._animationData.getAction(i.definition);if(i.definition.isAnimation){const S=i.definition.state+"."+i.actionParameter,D=this._animationManager.getAnimation(S);if(D){m=this.getPopulatedArray(D.frameCount(i.overridingAction));for(const v of D.getAnimatedBodyPartIds(0,i.overridingAction))if(v===t){const b=this._geometry.getBodyPart(r,v);if(b)for(const w of b.getDynamicParts(o))f.push(w.id)}}}const O=this._geometry.getParts(r,t,n,f,o),C=s.getPartTypeIds();for(const S of C){if(u&&u.get(S))continue;const D=s.getPartSetId(S),v=s.getPartColorIds(S),b=this._figureData.getSetType(S);if(b){const w=this._figureData.getPalette(b.paletteID);if(w){const Q=b.getPartSet(D);if(Q){a=a.concat(Q.hiddenLayers);for(const $ of Q.parts)if(O.indexOf($.type)>-1){if(T){const pe=T.getPart($.type);pe?c=pe.frames:c=m}else c=m;l=i.definition,f.indexOf($.type)===-1&&(l=this._defaultAction);const X=this._partSetsData.getPartDefinition($.type);let Ct=X?X.flippedSetType:$.type;(!Ct||Ct==="")&&(Ct=$.type),v&&v.length>$.colorLayerIndex-1&&(g=w.getColor(v[$.colorLayerIndex-1]));const Ht=$.colorLayerIndex>0,re=new _o(t,$.type,$.id.toString(),g,c,l,Ht,$.paletteMap,Ct);R.push(re)}}}}}const N=[];for(const S of O){let D=null,v=!1;const b=u&&u.get(S);for(const w of R)w.partType===S&&(b?D=w.color:(v=!0,a.indexOf(S)===-1&&N.push(w)));if(!v){if(b){const w=u.get(S);let Q=0,$=0;for(;$<w.length;)Q=Q+w.charCodeAt($),$++;if(T){const Ct=T.getPart(S);Ct?c=Ct.frames:c=m}else c=m;const X=new _o(t,S,w,D,c,i.definition,D!=null,-1,S,!1,1);N.push(X)}else if(f.indexOf(S)>-1){const w=this._geometry.getBodyPartOfItem(r,S,o);if(t===w.id){const Q=this._partSetsData.getPartDefinition(S);let $=!1,X=1;if(Q.appendToFigure){let Ct="1";if(i.actionParameter!==""&&(Ct=i.actionParameter),Q.hasStaticId()&&(Ct=Q.staticId.toString()),T){const re=T.getPart(S);re?c=re.frames:c=m}else c=m;const Ht=new _o(t,S,Ct,null,c,i.definition,!1,-1,S,$,X);N.push(Ht)}}}}}return N}getPopulatedArray(t){const s=[];let i=0;for(;i<t;)s.push(i),i++;return s}getItemIds(){if(this._actionManager){const t=this._actionManager.getActionDefinition("CarryItem").params,s=[];for(const i of t.values())s.push(i);return s}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const hw={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},uw={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},lw={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},Rs=class extends Me{constructor(e,t,s,i){super(),this._state=Rs.NOT_LOADED,this._libraryName=e,this._revision=t,this._downloadUrl=i,this._assets=s,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=Rs.LOADED)}async downloadAsset(){if(!this._assets||this._state===Rs.LOADING||this._state===Rs.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=Rs.LOADED,this.dispatchEvent(new $i($i.DOWNLOAD_COMPLETE,this));return}if(this._state=Rs.LOADING,!await this._assets.downloadAsset(this._downloadUrl))return;this._state=Rs.LOADED;const s=this._assets.getCollection(this._libraryName);s&&(this._animation=s.data.animations),this.dispatchEvent(new $i($i.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===Rs.LOADED}};let yn=Rs;yn.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE";yn.NOT_LOADED=0;yn.LOADING=1;yn.LOADED=2;const V_=class extends Me{constructor(e,t){super(),this._assets=e,this._structure=t,this._missingMandatoryLibs=W.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(Da.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const e=new XMLHttpRequest;try{e.open("GET",W.getValue("avatar.effectmap.url")),e.send(),e.onloadend=t=>{if(e.responseText){const s=JSON.parse(e.responseText);this.processEffectMap(s.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new nt(V_.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_effect_map")}}catch(t){G.error(t)}}processEffectMap(e){if(e)for(const t of e){if(!t)continue;const s=t.id,i=t.lib,r=t.revision||"";if(this._libraryNames.indexOf(i)>=0)continue;this._libraryNames.push(i);const n=new yn(i,r,this._assets,W.getValue("avatar.asset.effect.url"));n.addEventListener($i.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let a=this._effectMap.get(s);a||(a=[]),a.push(n),this._effectMap.set(s,a)}}downloadAvatarEffect(e,t){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([e,t]);return}const s=this.getAvatarEffectPendingLibraries(e);if(s&&s.length){if(t&&!t.disposed){let i=this._effectListeners.get(e.toString());i||(i=[]),i.push(t),this._effectListeners.set(e.toString(),i)}this._incompleteEffects.set(e.toString(),s);for(const i of s)i&&this.downloadLibrary(i)}else t&&!t.disposed&&t.resetEffect(e)}onAvatarRenderReady(e){if(e){for(const[t,s]of this._initDownloadBuffer)this.downloadAvatarEffect(t,s);this._initDownloadBuffer=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const t=[];this._structure.registerAnimation(e.library.animation);for(const[i,r]of this._incompleteEffects.entries()){let n=!0;for(const a of r)if(!(!a||a.isLoaded)){n=!1;break}if(n){t.push(i);const a=this._effectListeners.get(i);for(const o of a)!o||o.disposed||o.resetEffect(parseInt(i));this._effectListeners.delete(i),this.dispatchEvent(new nt(V_.LIBRARY_LOADED))}}for(const i of t)this._incompleteEffects.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===e.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const e=this._missingMandatoryLibs.slice();for(const t of e){if(!t)continue;const s=this._effectMap.get(t);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarEffectReady(e){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(e).length}getAvatarEffectPendingLibraries(e){const t=[];if(!this._structure)return t;const s=this._effectMap.get(e.toString());if(s)for(const i of s)!i||i.isLoaded||t.indexOf(i)===-1&&t.push(i);return t}downloadLibrary(e){!e||e.isLoaded||this._pendingDownloadQueue.indexOf(e)>=0||this._currentDownloads.indexOf(e)>=0||(this._pendingDownloadQueue.push(e),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};let Zs=V_;Zs.DOWNLOADER_READY="EADM_DOWNLOADER_READY";Zs.LIBRARY_LOADED="EADM_LIBRARY_LOADED";Zs.MAX_DOWNLOADS=2;class cw extends Xe{constructor(t,s,i,r,n){super(t,s,i,r,n,null)}isPlaceholder(){return!0}}const NE=class extends as{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new _w(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new Af(this,Pe()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new Js(Pe(),this._structure),this._avatarAssetDownloadManager.addEventListener(Js.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(Js.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new Zs(Pe(),this._structure),this._effectAssetDownloadManager.addEventListener(Zs.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(Zs.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(Js.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(Js.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(Zs.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(Zs.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(uw.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(lw.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const e=W.getValue("avatar.default.actions");e&&this._structure.initActions(Pe(),e);const t=new XMLHttpRequest;try{t.open("GET",W.getValue("avatar.actions.url")),t.send(),t.onloadend=s=>{this._structure&&(this._structure.updateActions(JSON.parse(t.responseText)),this._actionsReady=!0,this.checkReady())},t.onerror=s=>{throw new Error("invalid_avatar_actions")}}catch(s){G.error(s)}}loadAnimations(){this._structure&&(this._structure.initAnimation(hw.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const e=W.getValue("avatar.default.figuredata");if(!e||typeof e=="string"){G.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(e),new Uo(W.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(Uo.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(e){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(e){e&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(e){e&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(e){e&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(e){e&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new nt(Da.AVATAR_RENDER_READY)))}createFigureContainer(e){return new Hn(e)}isFigureContainerReady(e){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(e):!1}createAvatarImage(e,t,s,i=null,r=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const n=new Hn(e);return s&&this.validateAvatarFigure(n,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(n)?new Xe(this._structure,this._aliasCollection,n,t,this._effectAssetDownloadManager,r):(this._placeHolderFigure||(this._placeHolderFigure=new Hn(NE.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(n,i),new cw(this._structure,this._aliasCollection,this._placeHolderFigure,t,this._effectAssetDownloadManager))}downloadAvatarFigure(e,t){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(e,t)}validateAvatarFigure(e,t){let s=!1;const i=this._structure.getMandatorySetTypeIds(t,2);if(i){const r=this._structure.figureData;for(const n of i)if(e.hasPartType(n)){const a=r.getSetType(n);if(a&&!a.getPartSet(e.getPartSetId(n))){const u=this._structure.getDefaultPartSet(n,t);u&&(e.updatePart(n,u.id,[0]),s=!0)}}else{const a=this._structure.getDefaultPartSet(n,t);a&&(e.updatePart(n,a.id,[0]),s=!0)}}return!s}getFigureClubLevel(e,t,s=null){if(!this._structure)return 0;const i=this._structure.figureData,r=Array.from(e.getPartTypeIds());let n=0;for(const a of r){const o=i.getSetType(a);if(!o)continue;const u=e.getPartSetId(a),l=o.getPartSet(u);if(l){n=Math.max(l.clubLevel,n);const c=i.getPalette(o.paletteID),g=e.getPartColorIds(a);for(const f of g){const R=c.getColor(f);R&&(n=Math.max(R.clubLevel,n))}}}s||(s=this._structure.getBodyPartsUnordered(ee.FULL));for(const a of s){const o=i.getSetType(a);o&&r.indexOf(a)===-1&&(n=Math.max(o.optionalFromClubLevel(t),n))}return n}isValidFigureSetForGender(e,t){const i=this.structureData.getFigurePartSet(e);return!!(i&&(i.gender.toUpperCase()==="U"||i.gender.toUpperCase()===t.toUpperCase()))}getFigureStringWithFigureIds(e,t,s){const i=new wt;i.loadAvatarData(e,t);const r=this.resolveFigureSets(s);for(const n of r)i.savePartData(n.type,n.id,i.getColourIds(n.type));return i.getFigureString()}resolveFigureSets(e){const t=this.structureData,s=[];for(const i of e){const r=t.getFigurePartSet(i);r&&s.push(r)}return s}getMandatoryAvatarPartSetIds(e,t){return this._structure?this._structure.getMandatorySetTypeIds(e,t):null}getAssetByName(e){return this._aliasCollection.getAsset(e)}get assets(){return Pe()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}};let DE=NE;DE.DEFAULT_FIGURE="hd-99999-99999";class dw{constructor(t,s,i){this._layerId=t,this._partId=s,this._paletteId=i}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class pa{constructor(t){this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const s=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(s),this._customPartIds=this.getCustomPartIds(s),this._customPaletteIds=this.getCustomPaletteIds(s),this._customParts=[];let i=0;for(;i<this._customLayerIds.length;)this._customParts.push(new dw(this._customLayerIds[i],this._customPartIds[i],this._customPaletteIds[i])),i++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts){for(const s of this._customParts)if(s.layerId===t)return s}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+(" "+this.customParts.length);for(const s of this.customParts)t=t+(" "+s.layerId+" "+s.partId+" "+s.paletteId);return t}getCustomData(t){let s=[];if(t){const i=t.split(" "),r=this._headOnly?1:0,n=4+r;if(i.length>n){const a=3+r,o=parseInt(i[a]);s=i.slice(n,n+o*3)}}return s}getCustomLayerIds(t){const s=[];let i=0;for(;i<t.length;)s.push(parseInt(t[i+0])),i=i+3;return s}getCustomPartIds(t){const s=[];let i=0;for(;i<t.length;)s.push(parseInt(t[i+1])),i=i+3;return s}getCustomPaletteIds(t){const s=[];let i=0;for(;i<t.length;)s.push(parseInt(t[i+2])),i=i+3;return s}getTypeId(t){if(t){const s=t.split(" ");if(s.length>=1)return parseInt(s[0])}return 0}getPaletteId(t){if(t){const s=t.split(" ");if(s.length>=2)return parseInt(s[1])}return 0}getColor(t){if(t){const s=t.split(" ");if(s.length>=3)return parseInt(s[2],16)}return 16777215}getHeadOnly(t){if(t){const s=t.split(" ");if(s.length>=4)return s[3]==="head"}return!1}}class eo{constructor(t){this._complete=!0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class Sw extends eo{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class xh extends eo{constructor(t,s){super(t),this._complete=!1,this._duration=s}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=Z()}tick(t){super.tick(t);const s=(t-this._startTimeMs)/this._duration;s<1?this.update(s):(this.update(1),this._complete=!0)}}class Mw extends xh{constructor(t,s,i){super(t,s),this._height=i}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?(t=t-.545,7.5625*t*t+.75):t<.909?(t=t-.9091,7.5625*t*t+.9375):(t=t-.955,7.5625*t*t+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class gw extends xh{constructor(t){super(t.target,t.duration),this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class Ew extends gw{constructor(t,s){super(t),this._rate=s}}class Cw extends Ew{constructor(t,s){super(t,s)}update(t){this._interval.update(Math.pow(t,1/this._rate))}}class Nw extends xh{constructor(t,s,i,r,n,a){super(t,s),this._deltaX=i,this._deltaY=r,this._height=-n,this._numJumps=a}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}const J=class{static get TIMER_TIME(){return 1e3/KE()}static runMotion(e){return J._RUNNING_MOTIONS.indexOf(e)===-1&&J._QUEUED_MOTIONS.indexOf(e)===-1&&(J._IS_UPDATING?J._QUEUED_MOTIONS.push(e):(J._RUNNING_MOTIONS.push(e),e.start()),J.startTimer()),e}static removeMotion(e){let t=J._RUNNING_MOTIONS.indexOf(e);t>-1?J._IS_UPDATING?(t=J._REMOVED_MOTIONS.indexOf(e),t==-1&&J._REMOVED_MOTIONS.push(e)):(J._RUNNING_MOTIONS.splice(t,1),e.running&&e.stop(),J._RUNNING_MOTIONS.length||J.stopTimer()):(t=J._QUEUED_MOTIONS.indexOf(e),t>-1&&J._QUEUED_MOTIONS.splice(t,1))}static getMotionByTag(e){for(const t of J._RUNNING_MOTIONS)if(t.tag==e)return t;for(const t of J._QUEUED_MOTIONS)if(t.tag==e)return t;return null}static getMotionByTarget(e){for(const t of J._RUNNING_MOTIONS)if(t.target==e)return t;for(const t of J._QUEUED_MOTIONS)if(t.target==e)return t;return null}static getMotionByTagAndTarget(e,t){for(const s of J._RUNNING_MOTIONS)if(s.tag==e&&s.target==t)return s;for(const s of J._QUEUED_MOTIONS)if(s.tag==e&&s.target==t)return s;return null}static get isRunning(){return!!J._TIMER}static get isUpdating(){return J._IS_UPDATING}static onTick(){J._IS_UPDATING=!0;const e=Z();let t=null;for(;t=J._QUEUED_MOTIONS.pop();)J._RUNNING_MOTIONS.push(t);for(;t=J._REMOVED_MOTIONS.pop();)J._RUNNING_MOTIONS.splice(J._RUNNING_MOTIONS.indexOf(t),1),t.running&&t.stop();for(t of J._RUNNING_MOTIONS)t.running?(t.tick(e),t.complete&&J.removeMotion(t)):J.removeMotion(t);J._RUNNING_MOTIONS.length||J.stopTimer(),J._IS_UPDATING=!1}static startTimer(){J._TIMER||(J._TIMER=setInterval(J.onTick,J.TIMER_TIME))}static stopTimer(){J._TIMER&&(clearInterval(J._TIMER),J._TIMER=null)}getNumRunningMotions(e){let t=0;for(const s of J._RUNNING_MOTIONS)s.target===e&&t++;return t}};let Ln=J;Ln._QUEUED_MOTIONS=[];Ln._RUNNING_MOTIONS=[];Ln._REMOVED_MOTIONS=[];Ln._TIMER=null;Ln._IS_UPDATING=!1;class Dw extends eo{constructor(...t){super(t?t[0].target:null),this._queue=[];for(const s of t)this._queue.push(s);this._motion=t[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const s=this._queue.indexOf(this._motion);s<this._queue.length-1?(this._motion=this._queue[s+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class Pw extends eo{constructor(t){super(null),this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=Z()}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}export{gU as $,P as A,kt as B,ia as C,Rv as D,Me as E,zx as F,YU as G,Ui as H,Na as I,ht as J,hn as K,qE as L,F as M,B as N,$s as O,pa as P,Jr as Q,d as R,ur as S,sn as T,x1 as U,I as V,Tw as W,Os as X,wD as Y,HD as Z,VD as _,W as a,tc as a$,dC as a0,OU as a1,po as a2,Qc as a3,Sy as a4,Ry as a5,py as a6,GP as a7,Ty as a8,YP as a9,iU as aA,yC as aB,NP as aC,CC as aD,MC as aE,IC as aF,RC as aG,nf as aH,CU as aI,MU as aJ,me as aK,JU as aL,jd as aM,GU as aN,bU as aO,yU as aP,NU as aQ,_s as aR,k as aS,zo as aT,mN as aU,RN as aV,Cv as aW,gN as aX,oN as aY,_N as aZ,uN as a_,JM as aa,oP as ab,Cy as ac,Dy as ad,My as ae,NC as af,$M as ag,FP as ah,Ny as ai,ZM as aj,QM as ak,Oy as al,Py as am,Xt as an,qo as ao,G as ap,LU as aq,AC as ar,OC as as,HC as at,BC as au,wC as av,bC as aw,GC as ax,YC as ay,UC as az,Oe as b,xP as b$,Dv as b0,Mv as b1,Sv as b2,vv as b3,yv as b4,Ov as b5,pv as b6,IN as b7,Lv as b8,UN as b9,JD as bA,ZD as bB,$D as bC,tP as bD,eP as bE,C0 as bF,aP as bG,nP as bH,_P as bI,Jh as bJ,hP as bK,Hl as bL,uP as bM,lP as bN,cP as bO,dP as bP,EP as bQ,fP as bR,mP as bS,IP as bT,RP as bU,v0 as bV,B0 as bW,y0 as bX,x0 as bY,L0 as bZ,U0 as b_,TN as ba,vN as bb,ec as bc,Wv as bd,sc as be,ob as bf,r0 as bg,RD as bh,xD as bi,$b as bj,mD as bk,fD as bl,ID as bm,ED as bn,_C as bo,yy as bp,w0 as bq,H0 as br,XD as bs,KD as bt,S0 as bu,M0 as bv,iC as bw,sC as bx,nC as by,Qh as bz,vh as c,kx as c$,UP as c0,wP as c1,vP as c2,LP as c3,bP as c4,oC as c5,aC as c6,Ey as c7,qP as c8,bF as c9,H1 as cA,w1 as cB,dy as cC,Q_ as cD,So as cE,Cu as cF,ct as cG,H as cH,yi as cI,lu as cJ,zE as cK,mt as cL,K as cM,U as cN,e1 as cO,Zt as cP,hL as cQ,j as cR,fv as cS,tN as cT,eN as cU,iN as cV,sN as cW,gv as cX,mv as cY,Mo as cZ,yu as c_,vF as ca,ca as cb,Ke as cc,Hc as cd,$y as ce,st as cf,rL as cg,le as ch,nL as ci,uc as cj,Wo as ck,Yo as cl,jo as cm,ay as cn,hy as co,Iy as cp,my as cq,ey as cr,ry as cs,_n as ct,Zy as cu,oy as cv,nU as cw,aU as cx,on as cy,oU as cz,A as d,F1 as d$,cL as d0,uL as d1,lL as d2,Tv as d3,Xx as d4,fh as d5,qx as d6,O1 as d7,C1 as d8,Ls as d9,il as dA,ol as dB,ea as dC,it as dD,Gx as dE,hf as dF,oi as dG,qe as dH,We as dI,Re as dJ,$n as dK,WB as dL,Du as dM,iL as dN,Xs as dO,Cs as dP,gy as dQ,et as dR,ir as dS,Qd as dT,Ts as dU,ps as dV,Zl as dW,JL as dX,h1 as dY,es as dZ,IU as d_,AE as da,Wr as db,Ks as dc,Co as dd,fL as de,Vx as df,_L as dg,Kx as dh,i1 as di,pL as dj,TL as dk,RL as dl,s1 as dm,r1 as dn,NL as dp,AL as dq,SL as dr,ML as ds,OM as dt,I1 as du,pM as dv,T1 as dw,TM as dx,R1 as dy,cl as dz,Rw as e,Tb as e$,QD as e0,hU as e1,mU as e2,uC as e3,hC as e4,lC as e5,TU as e6,pU as e7,Aw as e8,AU as e9,L1 as eA,KL as eB,kU as eC,iv as eD,MP as eE,K0 as eF,J0 as eG,Yt as eH,Pe as eI,pw as eJ,OL as eK,c_ as eL,a1 as eM,n1 as eN,o1 as eO,l_ as eP,f_ as eQ,lN as eR,Nv as eS,Uv as eT,Pv as eU,Dr as eV,Fv as eW,kv as eX,Hv as eY,Xv as eZ,Rb as e_,SU as ea,EC as eb,fC as ec,QU as ed,PC as ee,U1 as ef,VC as eg,zU as eh,ZU as ei,VL as ej,A1 as ek,te as el,FU as em,KC as en,kC as eo,ev as ep,Ua as eq,PP as er,AP as es,Z0 as et,Q0 as eu,W0 as ev,q0 as ew,Y0 as ex,DP as ey,OP as ez,_t as f,VP as f$,pb as f0,lb as f1,qN as f2,hb as f3,_b as f4,Ib as f5,JN as f6,Ob as f7,Ue as f8,tD as f9,LD as fA,yD as fB,PD as fC,rc as fD,nc as fE,DD as fF,_U as fG,V1 as fH,t0 as fI,gh as fJ,EU as fK,tC as fL,fU as fM,kb as fN,Yb as fO,zb as fP,Wb as fQ,Xb as fR,mC as fS,DU as fT,jy as fU,Rx as fV,TP as fW,V0 as fX,b0 as fY,F0 as fZ,oc as f_,Eb as fa,ZN as fb,QN as fc,ln as fd,nb as fe,ab as ff,fb as fg,mb as fh,ub as fi,$N as fj,Ab as fk,h0 as fl,_0 as fm,u0 as fn,f0 as fo,UD as fp,c0 as fq,a0 as fr,o0 as fs,E0 as ft,be as fu,d0 as fv,By as fw,MD as fx,ND as fy,ac as fz,je as g,gl as g$,rF as g0,BP as g1,sF as g2,In as g3,_F as g4,yP as g5,eF as g6,Wa as g7,fF as g8,EF as g9,UL as gA,yL as gB,LL as gC,Bx as gD,Ad as gE,Ux as gF,FL as gG,wx as gH,kF as gI,OF as gJ,$U as gK,KU as gL,zC as gM,Vo as gN,eD as gO,Fu as gP,MF as gQ,Hy as gR,Hx as gS,dw as gT,Ow as gU,X_ as gV,Fd as gW,tn as gX,Md as gY,bi as gZ,ul as g_,fn as ga,zP as gb,aF as gc,tF as gd,uF as ge,gF as gf,hF as gg,li as gh,lF as gi,oF as gj,jP as gk,nF as gl,HP as gm,iF as gn,AF as go,PF as gp,m1 as gq,_x as gr,XF as gs,hx as gt,Te as gu,BL as gv,vx as gw,PL as gx,xx as gy,bx as gz,Pt as h,zu as h0,qL as h1,G1 as h2,l1 as h3,G0 as h4,u1 as h5,c1 as h6,od as h7,tL as h8,Fx as h9,Y1 as hA,W1 as hB,or as hC,er as hD,Jt as hE,Qs as hF,ju as ha,KP as hb,WP as hc,kP as hd,mF as he,Qx as hf,_1 as hg,aL as hh,ux as hi,$F as hj,ti as hk,At as hl,Ao as hm,Ln as hn,Dw as ho,Pw as hp,Mw as hq,Cw as hr,Nw as hs,Sw as ht,jc as hu,Tg as hv,QL as hw,ZL as hx,j1 as hy,z1 as hz,Ot as i,vi as j,ss as k,ee as l,Bn as m,Z as n,k_ as o,Ye as p,Gt as q,_i as r,Hn as s,Pa as t,db as u,Sb as v,cb as w,gb as x,yF as y,nt as z};
